<?xml version="1.0"?>
<ZopeData>
  <record id="1" aka="AAAAAAAAAAE=">
    <pickle>
      <global name="Notebook" module="erp5.portal_type"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>_Access_contents_information_Permission</string> </key>
            <value>
              <tuple>
                <string>Anonymous</string>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Associate</string>
                <string>Auditor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_Add_portal_content_Permission</string> </key>
            <value>
              <tuple>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_Change_local_roles_Permission</string> </key>
            <value>
              <tuple>
                <string>Assignor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_Modify_portal_content_Permission</string> </key>
            <value>
              <tuple>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_View_Permission</string> </key>
            <value>
              <tuple>
                <string>Anonymous</string>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Associate</string>
                <string>Auditor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>content_md5</string> </key>
            <value>
              <none/>
            </value>
        </item>
        <item>
            <key> <string>default_reference</string> </key>
            <value> <string>olapy_notebook.jsmd</string> </value>
        </item>
        <item>
            <key> <string>id</string> </key>
            <value> <string>olapy_notebook</string> </value>
        </item>
        <item>
            <key> <string>portal_type</string> </key>
            <value> <string>Notebook</string> </value>
        </item>
        <item>
            <key> <string>text_content</string> </key>
            <value> <string>%% meta\r\n
{\r\n
  "title": "Python",\r\n
  "languages": {\r\n
    "js": {\r\n
      "pluginType": "language",\r\n
      "languageId": "js",\r\n
      "displayName": "Javascript",\r\n
      "codeMirrorMode": "javascript",\r\n
      "module": "window",\r\n
      "evaluator": "eval",\r\n
      "keybinding": "j",\r\n
      "url": ""\r\n
    },\r\n
    "py": {\r\n
      "languageId": "py",\r\n
      "displayName": "python",\r\n
      "codeMirrorMode": "python",\r\n
      "keybinding": "p",\r\n
      "url": "/pyodide_dev.js",\r\n
      "module": "pyodide",\r\n
      "evaluator": "runPython",\r\n
      "pluginType": "language"\r\n
    }\r\n
  },\r\n
  "lastExport": "2019-02-15T15:20:07.196Z"\r\n
}\r\n
\r\n
%% plugin\r\n
{\r\n
  "languageId": "py",\r\n
  "displayName": "python",\r\n
  "codeMirrorMode": "python",\r\n
  "keybinding": "p",\r\n
  "url": "/pyodide_dev.js",\r\n
  "module": "pyodide",\r\n
  "evaluator": "runPython",\r\n
  "pluginType": "language"\r\n
}\r\n
\r\n
%% js\r\n
pyodide.loadPackage(\'olapy\')\r\n
\r\n
%% code {"language":"py"}\r\n
import os\r\n
\r\n
import pandas as pd\r\n
import pyodide\r\n
from olapy.core.services.xmla_lib import get_response\r\n
\r\n
# ******************************** CUBEMEMBER **************************** \r\n
def olapy_response(dataframes_paths, mdx_query):\r\n
    dataframes = {}\r\n
    for df_path in dataframes_paths:\r\n
        dataframes[os.path.splitext(os.path.basename(df_path))[0]] = pd.read_csv(pyodide.open_url(df_path), sep=\';\',\r\n
                                                                                 encoding=\'utf8\')\r\n
    #    xmla_request_params = {\'cube\': \'sales\',\r\n
    #                           \'properties\': {\'AxisFormat\': \'TupleFormat\', \'Format\': \'Multidimensional\',\r\n
    #                                          \'Content\': \'SchemaData\',\r\n
    #                                          \'Catalog\': \'sales\',\r\n
    #                                          \'LocaleIdentifier\': \'1033\', \'Timeout\': \'0\'},\r\n
    #                           \'mdx_query\': mdx_query}\r\n
\r\n
    xmla_request_params = {\'cube\': \'sales\',\r\n
                           \'request_type\': \'MDSCHEMA_MEMBERS\',\r\n
\'properties\': {\'Catalog\': \'sales\'},\r\n
                           \'restrictions\': {\'CUBE_NAME\': \'sales\',\r\n
                                            \'MEMBER_UNIQUE_NAME\': \'[Geography].[Geography].[America]\',\r\n
                                            \'TREE_OP\': \'3\',\r\n
                                            \'mdx_query\': mdx_query}\r\n
                           }\r\n
\r\n
    return get_response(xmla_request_params=xmla_request_params, dataframes=dataframes,\r\n
                        output=\'xmla\')  # or output=\'dict\'\r\n
\r\n
# ********************************* CUBEVALUE ********************************** \r\n
def olapy_response2(dataframes_paths, mdx_query):\r\n
    dataframes = {}\r\n
    for df_path in dataframes_paths:\r\n
        dataframes[os.path.splitext(os.path.basename(df_path))[0]] = pd.read_csv(pyodide.open_url(df_path), sep=\';\',\r\n
                                                                                 encoding=\'utf8\')\r\n
\r\n
    xmla_request_params = {\'cube\': \'sales\',\r\n
                           \'properties\': {\'Catalog\': \'sales\',\r\n
                                          \'Content\': \'SchemaData\',\r\n
                                          \'Format\': \'Multidimensional\'},\r\n
                           \'mdx_query\': mdx_query\r\n
                           }\r\n
\r\n
    return get_response(xmla_request_params=xmla_request_params, dataframes=dataframes,\r\n
                        output=\'xmla\')  # or output=\'dict\'\r\n
\r\n
%% js\r\n
function get_olapy_response(dataframes_paths, mdx_query) {\r\n
  var reponse = pyodide.pyimport("olapy_response")\r\n
  return reponse(dataframes_paths, mdx_query)\r\n
}\r\n
\r\n
function get_olapy_response2(dataframes_paths, mdx_query) {\r\n
  var reponse = pyodide.pyimport("olapy_response2")\r\n
  return reponse(dataframes_paths, mdx_query)\r\n
}</string> </value>
        </item>
        <item>
            <key> <string>title</string> </key>
            <value> <string>olapy_notebook.jsmd</string> </value>
        </item>
        <item>
            <key> <string>workflow_history</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAI=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="2" aka="AAAAAAAAAAI=">
    <pickle>
      <global name="PersistentMapping" module="Persistence.mapping"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value>
              <dictionary>
                <item>
                    <key> <string>document_publication_workflow</string> </key>
                    <value>
                      <persistent> <string encoding="base64">AAAAAAAAAAM=</string> </persistent>
                    </value>
                </item>
                <item>
                    <key> <string>edit_workflow</string> </key>
                    <value>
                      <persistent> <string encoding="base64">AAAAAAAAAAQ=</string> </persistent>
                    </value>
                </item>
                <item>
                    <key> <string>processing_status_workflow</string> </key>
                    <value>
                      <persistent> <string encoding="base64">AAAAAAAAAAU=</string> </persistent>
                    </value>
                </item>
              </dictionary>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="3" aka="AAAAAAAAAAM=">
    <pickle>
      <global name="WorkflowHistoryList" module="Products.ERP5Type.patches.WorkflowTool"/>
    </pickle>
    <pickle>
      <tuple>
        <none/>
        <list>
          <dictionary>
            <item>
                <key> <string>action</string> </key>
                <value> <string>publish_alive</string> </value>
            </item>
            <item>
                <key> <string>actor</string> </key>
                <value> <string>zope</string> </value>
            </item>
            <item>
                <key> <string>comment</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>error_message</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>time</string> </key>
                <value>
                  <object>
                    <klass>
                      <global name="DateTime" module="DateTime.DateTime"/>
                    </klass>
                    <tuple>
                      <none/>
                    </tuple>
                    <state>
                      <tuple>
                        <float>1550244384.37</float>
                        <string>UTC</string>
                      </tuple>
                    </state>
                  </object>
                </value>
            </item>
            <item>
                <key> <string>validation_state</string> </key>
                <value> <string>published_alive</string> </value>
            </item>
          </dictionary>
        </list>
      </tuple>
    </pickle>
  </record>
  <record id="4" aka="AAAAAAAAAAQ=">
    <pickle>
      <global name="WorkflowHistoryList" module="Products.ERP5Type.patches.WorkflowTool"/>
    </pickle>
    <pickle>
      <tuple>
        <none/>
        <list>
          <dictionary>
            <item>
                <key> <string>action</string> </key>
                <value> <string>edit</string> </value>
            </item>
            <item>
                <key> <string>actor</string> </key>
                <value> <string>zope</string> </value>
            </item>
            <item>
                <key> <string>comment</string> </key>
                <value>
                  <none/>
                </value>
            </item>
            <item>
                <key> <string>error_message</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>serial</string> </key>
                <value> <string>973.45115.23569.17544</string> </value>
            </item>
            <item>
                <key> <string>state</string> </key>
                <value> <string>current</string> </value>
            </item>
            <item>
                <key> <string>time</string> </key>
                <value>
                  <object>
                    <klass>
                      <global name="DateTime" module="DateTime.DateTime"/>
                    </klass>
                    <tuple>
                      <none/>
                    </tuple>
                    <state>
                      <tuple>
                        <float>1550244208.38</float>
                        <string>UTC</string>
                      </tuple>
                    </state>
                  </object>
                </value>
            </item>
          </dictionary>
        </list>
      </tuple>
    </pickle>
  </record>
  <record id="5" aka="AAAAAAAAAAU=">
    <pickle>
      <global name="WorkflowHistoryList" module="Products.ERP5Type.patches.WorkflowTool"/>
    </pickle>
    <pickle>
      <tuple>
        <none/>
        <list>
          <dictionary>
            <item>
                <key> <string>action</string> </key>
                <value>
                  <none/>
                </value>
            </item>
            <item>
                <key> <string>actor</string> </key>
                <value> <string>zope</string> </value>
            </item>
            <item>
                <key> <string>comment</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>error_message</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>external_processing_state</string> </key>
                <value> <string>empty</string> </value>
            </item>
            <item>
                <key> <string>serial</string> </key>
                <value> <string>0.0.0.0</string> </value>
            </item>
            <item>
                <key> <string>time</string> </key>
                <value>
                  <object>
                    <klass>
                      <global name="DateTime" module="DateTime.DateTime"/>
                    </klass>
                    <tuple>
                      <none/>
                    </tuple>
                    <state>
                      <tuple>
                        <float>1550244041.73</float>
                        <string>UTC</string>
                      </tuple>
                    </state>
                  </object>
                </value>
            </item>
          </dictionary>
        </list>
      </tuple>
    </pickle>
  </record>
</ZopeData>
