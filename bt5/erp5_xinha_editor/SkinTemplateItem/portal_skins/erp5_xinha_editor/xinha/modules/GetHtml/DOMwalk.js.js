/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
function GetHtmlImplementation(a){this.editor=a}GetHtmlImplementation._pluginInfo={name:"GetHtmlImplementation DOMwalk",origin:"Xinha Core",version:"$LastChangedRevision: 1185 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"The Xinha Core Developer Team",developer_url:"$HeadURL: http://svn.xinha.org/trunk/modules/GetHtml/DOMwalk.js $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),sponsor:"",sponsor_url:"",license:"htmlArea"};Xinha.getHTML=function(a,c,b){return Xinha.getHTMLWrapper(a,c,b)};Xinha.emptyAttributes=" checked disabled ismap readonly nowrap compact declare selected defer multiple noresize noshade ";Xinha.getHTMLWrapper=function(m,l,d,k){var j="";if(!k){k=""}switch(m.nodeType){case 10:case 6:case 12:break;case 2:break;case 4:j+=(Xinha.is_ie?("\n"+k):"")+"<![CDATA["+m.data+"]]>";break;case 5:j+="&"+m.nodeValue+";";break;case 7:j+=(Xinha.is_ie?("\n"+k):"")+"<?"+m.target+" "+m.data+" ?>";break;case 1:case 11:case 9:var e;var g;var q=(m.nodeType==1)?m.tagName.toLowerCase():"";if((q=="script"||q=="noscript")&&d.config.stripScripts){break}if(l){l=!(d.config.htmlRemoveTags&&d.config.htmlRemoveTags.test(q))}if(Xinha.is_ie&&q=="head"){if(l){j+=(Xinha.is_ie?("\n"+k):"")+"<head>"}var r=RegExp.multiline;RegExp.multiline=true;var f=m.innerHTML.replace(Xinha.RE_tagName,function(s,i,a){return i+a.toLowerCase()}).replace(/\s*=\s*(([^'"][^>\s]*)([>\s])|"([^"]+)"|'([^']+)')/g,'="$2$4$5"$3').replace(/<(link|meta)((\s*\S*="[^"]*")*)>([\n\r]*)/g,"<$1$2 />\n");RegExp.multiline=r;j+=f+"\n";if(l){j+=(Xinha.is_ie?("\n"+k):"")+"</head>"}break}else{if(l){e=(!(m.hasChildNodes()||Xinha.needsClosingTag(m)));j+=((Xinha.isBlockElement(m))?("\n"+k):"")+"<"+m.tagName.toLowerCase();var p=m.attributes;for(g=0;g<p.length;++g){var n=p.item(g);if(Xinha.is_real_gecko&&(m.tagName.toLowerCase()=="img")&&((n.nodeName.toLowerCase()=="height")||(n.nodeName.toLowerCase()=="width"))){if(!m.complete||m.naturalWidth===0){continue}}if(typeof n.nodeValue=="object"){continue}if(m.tagName.toLowerCase()=="input"&&m.type.toLowerCase()=="checkbox"&&n.nodeName.toLowerCase()=="value"&&n.nodeValue.toLowerCase()=="on"){continue}if(!n.specified&&!(m.tagName.toLowerCase().match(/input|option/)&&n.nodeName=="value")&&!(m.tagName.toLowerCase().match(/area/)&&n.nodeName.match(/shape|coords/i))){continue}var b=n.nodeName.toLowerCase();if(/_moz_editor_bogus_node/.test(b)||(b=="class"&&n.nodeValue=="webkit-block-placeholder")){j="";break}if(/(_moz)|(contenteditable)|(_msh)/.test(b)){continue}var o;if(Xinha.emptyAttributes.indexOf(" "+b+" ")!=-1){o=b}else{if(b!="style"){if(typeof m[n.nodeName]!="undefined"&&b!="href"&&b!="src"&&!(/^on/.test(b))){o=m[n.nodeName]}else{o=n.nodeValue;if(b=="class"){o=o.replace(/Apple-style-span/,"");if(!o){continue}}if(Xinha.is_ie&&(b=="href"||b=="src")){o=d.stripBaseURL(o)}if(d.config.only7BitPrintablesInURLs&&(b=="href"||b=="src")){o=o.replace(/([^!-~]+)/g,function(a){return escape(a)})}}}else{if(!Xinha.is_ie){o=m.style.cssText.replace(/rgb\(.*?\)/ig,function(a){return Xinha._colorToRgb(a)})}else{if(!o){continue}}}}if(/^(_moz)?$/.test(o)){continue}j+=" "+b+'="'+Xinha.htmlEncode(o)+'"'}if(Xinha.is_ie&&m.style.cssText){j+=' style="'+m.style.cssText.replace(/(^)?([^:]*):(.*?)(;|$)/g,function(u,t,s,i,a){return s.toLowerCase()+":"+i+a})+'"'}if(Xinha.is_ie&&m.tagName.toLowerCase()=="option"&&m.selected){j+=' selected="selected"'}if(j!==""){if(e&&q=="p"){j+=">&nbsp;</p>"}else{if(e){j+=" />"}else{j+=">"}}}}}var h=false;if(q=="script"||q=="noscript"){if(!d.config.stripScripts){if(Xinha.is_ie){var c="\n"+m.innerHTML.replace(/^[\n\r]*/,"").replace(/\s+$/,"")+"\n"+k}else{var c=(m.hasChildNodes())?m.firstChild.nodeValue:""}j+=c+"</"+q+">"+((Xinha.is_ie)?"\n":"")}}else{if(q=="pre"){j+=((Xinha.is_ie)?"\n":"")+m.innerHTML.replace(/<br>/g,"\n")+"</"+q+">"}else{for(g=m.firstChild;g;g=g.nextSibling){if(!h&&g.nodeType==1&&Xinha.isBlockElement(g)){h=true}j+=Xinha.getHTMLWrapper(g,true,d,k+"  ")}if(l&&!e){j+=(((Xinha.isBlockElement(m)&&h)||q=="head"||q=="html")?("\n"+k):"")+"</"+m.tagName.toLowerCase()+">"}}}break;case 3:if(/^script|noscript|style$/i.test(m.parentNode.tagName)){j=m.data}else{if(m.data.trim()==""){if(m.data){j=" "}else{j=""}}else{j=Xinha.htmlEncode(m.data)}}break;case 8:j="<!--"+m.data+"-->";break}return j};