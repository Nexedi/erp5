/* This compressed file is part of Xinha. For uncompressed sources, forum, and bug reports, go to xinha.org */
ColorPicker._pluginInfo={name:"colorPicker",version:"$LastChangedRevision: 1237 $".replace(/^[^:]*:\s*(.*)\s*\$$/,"$1"),developer:"James Sleeman",developer_url:"http://www.gogo.co.nz/",c_owner:"Gogo Internet Services",license:"htmlArea",sponsor:"Gogo Internet Services",sponsor_url:"http://www.gogo.co.nz/"};function ColorPicker(){}try{if(window.opener&&window.opener.Xinha){var openerColorPicker=window.opener.Xinha.colorPicker;Xinha._addEvent(window,"unload",function(){Xinha.colorPicker=openerColorPicker})}}catch(e){}Xinha.colorPicker=function(s){if(Xinha.colorPicker.savedColors.length===0){Xinha.colorPicker.loadColors()}this.is_ie_6=(Xinha.is_ie&&Xinha.ie_version<7);var g=this;var d=false;var k=false;var m=0;var r=0;this.callback=s.callback?s.callback:function(x){alert("You picked "+x)};this.websafe=s.websafe?s.websafe:false;this.savecolors=s.savecolors?s.savecolors:20;this.cellsize=parseInt(s.cellsize?s.cellsize:"10px",10);this.side=s.granularity?s.granularity:18;var i=this.side+1;var f=this.side-1;this.value=1;this.saved_cells=null;this.table=document.createElement("table");this.table.className="dialog";this.table.cellSpacing=this.table.cellPadding=0;this.table.onmouseup=function(){d=false;k=false};this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.table.style.border="1px solid WindowFrame";this.table.style.zIndex="1050";var b=document.createElement("tr");var j=document.createElement("td");j.colSpan=this.side;j.className="title";j.style.fontFamily="small-caption,caption,sans-serif";j.style.fontSize="x-small";j.unselectable="on";j.style.MozUserSelect="none";j.style.cursor="default";j.appendChild(document.createTextNode(Xinha._lc("Click a color...")));j.style.borderBottom="1px solid WindowFrame";b.appendChild(j);j=null;var j=document.createElement("td");j.className="title";j.colSpan=2;j.style.fontFamily="Tahoma,Verdana,sans-serif";j.style.borderBottom="1px solid WindowFrame";j.style.paddingRight="0";b.appendChild(j);var n=document.createElement("div");n.title=Xinha._lc("Close");n.className="buttonColor";n.style.height="11px";n.style.width="11px";n.style.cursor="pointer";n.onclick=function(){g.close()};n.appendChild(document.createTextNode("\u00D7"));n.align="center";n.style.verticalAlign="top";n.style.position="relative";n.style.cssFloat="right";n.style.styleFloat="right";n.style.padding="0";n.style.margin="2px";n.style.backgroundColor="transparent";n.style.fontSize="11px";if(!Xinha.is_ie){n.style.lineHeight="9px"}n.style.letterSpacing="0";j.appendChild(n);this.tbody.appendChild(b);n=b=j=null;this.constrain_cb=document.createElement("input");this.constrain_cb.type="checkbox";this.chosenColor=document.createElement("input");this.chosenColor.type="text";this.chosenColor.maxLength=7;this.chosenColor.style.width="50px";this.chosenColor.style.fontSize="11px";this.chosenColor.onchange=function(){if(/#[0-9a-f]{6,6}/i.test(this.value)){g.backSample.style.backgroundColor=this.value;g.foreSample.style.color=this.value}};this.backSample=document.createElement("div");this.backSample.appendChild(document.createTextNode("\u00A0"));this.backSample.style.fontWeight="bold";this.backSample.style.fontFamily="small-caption,caption,sans-serif";this.backSample.fontSize="x-small";this.foreSample=document.createElement("div");this.foreSample.appendChild(document.createTextNode(Xinha._lc("Sample")));this.foreSample.style.fontWeight="bold";this.foreSample.style.fontFamily="small-caption,caption,sans-serif";this.foreSample.fontSize="x-small";function t(y){var x=y.toString(16);if(x.length<2){x="0"+x}return x}function p(x){return"#"+t(x.red)+t(x.green)+t(x.blue)}function q(x,y){return Math.round(Math.round(x/y)*y)}function h(x){return parseInt(x.toString(16)+x.toString(16),16)}function v(x){x.red=h(q(parseInt(t(x.red).charAt(0),16),3));x.blue=h(q(parseInt(t(x.blue).charAt(0),16),3));x.green=h(q(parseInt(t(x.green).charAt(0),16),3));return x}function a(A,F,D){var C;if(F===0){C={red:D,green:D,blue:D}}else{A/=60;var z=Math.floor(A);var B=A-z;var y=D*(1-F);var x=D*(1-F*B);var E=D*(1-F*(1-B));switch(z){case 0:C={red:D,green:E,blue:y};break;case 1:C={red:x,green:D,blue:y};break;case 2:C={red:y,green:D,blue:E};break;case 3:C={red:y,green:x,blue:D};break;case 4:C={red:E,green:y,blue:D};break;default:C={red:D,green:y,blue:x};break}}C.red=Math.ceil(C.red*255);C.green=Math.ceil(C.green*255);C.blue=Math.ceil(C.blue*255);return C}var o=this;function l(x){x=x?x:window.event;el=x.target?x.target:x.srcElement;do{if(el==o.table){return}}while(el=el.parentNode);o.close()}this.open=function(F,B,A){this.table.style.display="";this.pick_color();if(A&&/#[0-9a-f]{6,6}/i.test(A)){this.chosenColor.value=A;this.backSample.style.backgroundColor=A;this.foreSample.style.color=A}Xinha._addEvent(document.body,"mousedown",l);this.table.style.position="absolute";var E=B;var D=0;var C=0;do{if(E.style.position=="fixed"){this.table.style.position="fixed"}D+=E.offsetTop-E.scrollTop;C+=E.offsetLeft-E.scrollLeft;E=E.offsetParent}while(E);var z,G;if(/top/.test(F)||(D+this.table.offsetHeight>document.body.offsetHeight)){if(D-this.table.offsetHeight>0){this.table.style.top=(D-this.table.offsetHeight)+"px"}else{this.table.style.top=0}}else{this.table.style.top=(D+B.offsetHeight)+"px"}if(/left/.test(F)||(C+this.table.offsetWidth>document.body.offsetWidth)){if(C-(this.table.offsetWidth-B.offsetWidth)>0){this.table.style.left=(C-(this.table.offsetWidth-B.offsetWidth))+"px"}else{this.table.style.left=0}}else{this.table.style.left=C+"px"}if(this.is_ie_6){this.iframe.style.top=this.table.style.top;this.iframe.style.left=this.table.style.left}};function w(x){g.chosenColor.value=x.colorCode;g.backSample.style.backgroundColor=x.colorCode;g.foreSample.style.color=x.colorCode;if((x.hue>=195&&x.saturation>0.5)||(x.hue===0&&x.saturation===0&&x.value<0.5)||(x.hue!==0&&g.value<0.75)){x.style.borderColor="#fff"}else{x.style.borderColor="#000"}m=x.thisrow;r=x.thiscol}function c(x){if(g.value<0.5){x.style.borderColor="#fff"}else{x.style.borderColor="#000"}f=x.thisrow;i=x.thiscol;g.chosenColor.value=g.saved_cells[m][r].colorCode;g.backSample.style.backgroundColor=g.saved_cells[m][r].colorCode;g.foreSample.style.color=g.saved_cells[m][r].colorCode}function u(y,x){g.saved_cells[y][x].style.borderColor=g.saved_cells[y][x].colorCode}this.pick_color=function(){var K,L;var z=this;var S=359/(this.side);var E=1/(this.side-1);var A=1/(this.side-1);var T=this.constrain_cb.checked;if(this.saved_cells===null){this.saved_cells=[];for(var F=0;F<this.side;F++){var y=document.createElement("tr");this.saved_cells[F]=[];for(var D=0;D<this.side;D++){var I=document.createElement("td");if(T){I.colorCode=p(v(a(S*F,E*D,this.value)))}else{I.colorCode=p(a(S*F,E*D,this.value))}this.saved_cells[F][D]=I;I.style.height=this.cellsize+"px";I.style.width=this.cellsize-2+"px";I.style.borderWidth="1px";I.style.borderStyle="solid";I.style.borderColor=I.colorCode;I.style.backgroundColor=I.colorCode;if(F==m&&D==r){I.style.borderColor="#000";this.chosenColor.value=I.colorCode;this.backSample.style.backgroundColor=I.colorCode;this.foreSample.style.color=I.colorCode}I.hue=S*F;I.saturation=E*D;I.thisrow=F;I.thiscol=D;I.onmousedown=function(){d=true;z.saved_cells[m][r].style.borderColor=z.saved_cells[m][r].colorCode;w(this)};I.onmouseover=function(){if(d){w(this)}};I.onmouseout=function(){if(d){this.style.borderColor=this.colorCode}};I.ondblclick=function(){Xinha.colorPicker.remember(this.colorCode,z.savecolors);z.callback(this.colorCode);z.close()};I.appendChild(document.createTextNode(" "));I.style.cursor="pointer";y.appendChild(I);I=null}var I=document.createElement("td");I.appendChild(document.createTextNode(" "));I.style.width=this.cellsize+"px";y.appendChild(I);I=null;var I=document.createElement("td");this.saved_cells[F][D+1]=I;I.appendChild(document.createTextNode(" "));I.style.width=this.cellsize-2+"px";I.style.height=this.cellsize+"px";I.constrainedColorCode=p(v(a(0,0,A*F)));I.style.backgroundColor=I.colorCode=p(a(0,0,A*F));I.style.borderWidth="1px";I.style.borderStyle="solid";I.style.borderColor=I.colorCode;if(F==f){I.style.borderColor="black"}I.hue=S*F;I.saturation=E*D;I.hsv_value=A*F;I.thisrow=F;I.thiscol=D+1;I.onmousedown=function(){k=true;z.saved_cells[f][i].style.borderColor=z.saved_cells[f][i].colorCode;z.value=this.hsv_value;z.pick_color();c(this)};I.onmouseover=function(){if(k){z.value=this.hsv_value;z.pick_color();c(this)}};I.onmouseout=function(){if(k){this.style.borderColor=this.colorCode}};I.style.cursor="pointer";y.appendChild(I);I=null;this.tbody.appendChild(y);y=null}var y=document.createElement("tr");this.saved_cells[F]=[];for(var D=0;D<this.side;D++){var I=document.createElement("td");if(T){I.colorCode=p(v(a(0,0,A*(this.side-D-1))))}else{I.colorCode=p(a(0,0,A*(this.side-D-1)))}this.saved_cells[F][D]=I;I.style.height=this.cellsize+"px";I.style.width=this.cellsize-2+"px";I.style.borderWidth="1px";I.style.borderStyle="solid";I.style.borderColor=I.colorCode;I.style.backgroundColor=I.colorCode;I.hue=0;I.saturation=0;I.value=A*(this.side-D-1);I.thisrow=F;I.thiscol=D;I.onmousedown=function(){d=true;z.saved_cells[m][r].style.borderColor=z.saved_cells[m][r].colorCode;w(this)};I.onmouseover=function(){if(d){w(this)}};I.onmouseout=function(){if(d){this.style.borderColor=this.colorCode}};I.ondblclick=function(){Xinha.colorPicker.remember(this.colorCode,z.savecolors);z.callback(this.colorCode);z.close()};I.appendChild(document.createTextNode(" "));I.style.cursor="pointer";y.appendChild(I);I=null}this.tbody.appendChild(y);y=null;var y=document.createElement("tr");var I=document.createElement("td");y.appendChild(I);I.colSpan=this.side+2;I.style.padding="3px";if(this.websafe){var M=document.createElement("div");var J=document.createElement("label");J.appendChild(document.createTextNode(Xinha._lc("Web Safe: ")));this.constrain_cb.onclick=function(){z.pick_color()};J.appendChild(this.constrain_cb);J.style.fontFamily="small-caption,caption,sans-serif";J.style.fontSize="x-small";M.appendChild(J);I.appendChild(M);M=null}var M=document.createElement("div");var J=document.createElement("label");J.style.fontFamily="small-caption,caption,sans-serif";J.style.fontSize="x-small";J.appendChild(document.createTextNode(Xinha._lc("Color: ")));J.appendChild(this.chosenColor);M.appendChild(J);var O=document.createElement("span");O.className="buttonColor ";O.style.fontSize="13px";O.style.width="24px";O.style.marginLeft="2px";O.style.padding="0px 4px";O.style.cursor="pointer";O.onclick=function(){Xinha.colorPicker.remember(z.chosenColor.value,z.savecolors);z.callback(z.chosenColor.value);z.close()};O.appendChild(document.createTextNode(Xinha._lc("OK")));O.align="center";M.appendChild(O);I.appendChild(M);var x=document.createElement("table");x.style.width="100%";var P=document.createElement("tbody");x.appendChild(P);var C=document.createElement("tr");P.appendChild(C);var N=document.createElement("td");C.appendChild(N);N.appendChild(this.backSample);N.style.width="50%";var Q=document.createElement("td");C.appendChild(Q);Q.appendChild(this.foreSample);Q.style.width="50%";I.appendChild(x);var R=document.createElement("div");R.style.clear="both";function H(V){var U=Xinha.is_ie;var W=document.createElement("div");W.style.width=z.cellsize+"px";W.style.height=z.cellsize+"px";W.style.margin="1px";W.style.border="1px solid black";W.style.cursor="pointer";W.style.backgroundColor=V;W.style[U?"styleFloat":"cssFloat"]="left";W.ondblclick=function(){z.callback(V);z.close()};W.onclick=function(){z.chosenColor.value=V;z.backSample.style.backgroundColor=V;z.foreSample.style.color=V};R.appendChild(W)}for(var G=0;G<Xinha.colorPicker.savedColors.length;G++){H(Xinha.colorPicker.savedColors[G])}I.appendChild(R);this.tbody.appendChild(y);document.body.appendChild(this.table);if(this.is_ie_6){if(!this.iframe){this.iframe=document.createElement("iframe");this.iframe.frameBorder=0;this.iframe.src="javascript:;";this.iframe.style.position="absolute";this.iframe.style.width=this.table.offsetWidth;this.iframe.style.height=this.table.offsetHeight;this.iframe.style.zIndex="1049";document.body.insertBefore(this.iframe,this.table)}this.iframe.style.display=""}}else{for(var F=0;F<this.side;F++){for(var D=0;D<this.side;D++){if(T){this.saved_cells[F][D].colorCode=p(v(a(S*F,E*D,this.value)))}else{this.saved_cells[F][D].colorCode=p(a(S*F,E*D,this.value))}this.saved_cells[F][D].style.backgroundColor=this.saved_cells[F][D].colorCode;this.saved_cells[F][D].style.borderColor=this.saved_cells[F][D].colorCode}}var B=this.saved_cells[m][r];this.chosenColor.value=B.colorCode;this.backSample.style.backgroundColor=B.colorCode;this.foreSample.style.color=B.colorCode;if((B.hue>=195&&B.saturation>0.5)||(B.hue===0&&B.saturation===0&&B.value<0.5)||(B.hue!==0&&z.value<0.75)){B.style.borderColor="#fff"}else{B.style.borderColor="#000"}}};this.close=function(){Xinha._removeEvent(document.body,"mousedown",l);this.table.style.display="none";if(this.is_ie_6){if(this.iframe){this.iframe.style.display="none"}}}};Xinha.colorPicker.savedColors=[];Xinha.colorPicker.remember=function(b,d){for(var c=Xinha.colorPicker.savedColors.length;c--;){if(Xinha.colorPicker.savedColors[c]==b){return false}}Xinha.colorPicker.savedColors.splice(0,0,b);Xinha.colorPicker.savedColors=Xinha.colorPicker.savedColors.slice(0,d);var a=new Date();a.setMonth(a.getMonth()+1);document.cookie="XinhaColorPicker="+escape(Xinha.colorPicker.savedColors.join("-"))+";expires="+a.toGMTString();return true};Xinha.colorPicker.loadColors=function(){var b=document.cookie.indexOf("XinhaColorPicker");if(b!=-1){var c=(document.cookie.indexOf("=",b)+1);var a=document.cookie.indexOf(";",b);if(a==-1){a=document.cookie.length}Xinha.colorPicker.savedColors=unescape(document.cookie.substring(c,a)).split("-")}};Xinha.colorPicker.InputBinding=function(c,d){var g=c.ownerDocument;var b=g.createElement("span");b.className="buttonColor";var f=this.chooser=g.createElement("span");f.className="chooser";if(c.value){f.style.backgroundColor=c.value}f.onmouseover=function(){f.className="chooser buttonColor-hilite"};f.onmouseout=function(){f.className="chooser"};f.appendChild(g.createTextNode("\u00a0"));b.appendChild(f);var a=g.createElement("span");a.className="nocolor";a.onmouseover=function(){a.className="nocolor buttonColor-hilite";a.style.color="#f00"};a.onmouseout=function(){a.className="nocolor";a.style.color="#000"};a.onclick=function(){c.value="";f.style.backgroundColor=""};a.appendChild(g.createTextNode("\u00d7"));b.appendChild(a);c.parentNode.insertBefore(b,c.nextSibling);Xinha._addEvent(c,"change",function(){f.style.backgroundColor=this.value});d=(d)?Xinha.cloneObject(d):{cellsize:"5px"};d.callback=(d.callback)?d.callback:function(h){f.style.backgroundColor=h;c.value=h};f.onclick=function(){var h=new Xinha.colorPicker(d);h.open("",f,c.value)};Xinha.freeLater(this,"chooser")};Xinha.colorPicker.InputBinding.prototype.setColor=function(a){this.chooser.style.backgroundColor=a};