{"version":3,"sources":["c3_renderers.coffee"],"names":[],"mappings":"AAAA;AAAA,MAAA,cAAA;;AAAA,EAAA,cAAA,GAAiB,SAAC,WAAD,GAAA;AACb,IAAA,IAAG,MAAA,CAAA,OAAA,KAAkB,QAAlB,IAA+B,MAAA,CAAA,MAAA,KAAiB,QAAnD;aACI,WAAA,CAAY,OAAA,CAAQ,QAAR,CAAZ,EADJ;KAAA,MAEK,IAAG,MAAA,CAAA,MAAA,KAAiB,UAAjB,IAAgC,MAAM,CAAC,GAA1C;aACD,MAAA,CAAO,CAAC,QAAD,CAAP,EAAmB,WAAnB,EADC;KAAA,MAAA;aAID,WAAA,CAAY,MAAZ,EAJC;KAHQ;EAAA,CAAjB,CAAA;;AAAA,EASA,cAAA,CAAe,SAAC,CAAD,GAAA;AAEX,QAAA,WAAA;AAAA,IAAA,WAAA,GAAc,SAAC,SAAD,GAAA;;QAAC,YAAY;OAAO;aAAA,SAAC,SAAD,EAAY,IAAZ,GAAA;AAC9B,YAAA,+MAAA;AAAA,QAAA,QAAA,GACI;AAAA,UAAA,aAAA,EACI;AAAA,YAAA,EAAA,EAAI,IAAJ;AAAA,YACA,EAAA,EAAI,IADJ;WADJ;AAAA,UAGA,EAAA,EACI;AAAA,YAAA,KAAA,EAAO,SAAA,GAAA;qBAAG,MAAM,CAAC,UAAP,GAAoB,IAAvB;YAAA,CAAP;AAAA,YACA,MAAA,EAAQ,SAAA,GAAA;qBAAG,MAAM,CAAC,WAAP,GAAqB,IAAxB;YAAA,CADR;WAJJ;SADJ,CAAA;AAAA,QAQA,IAAA,GAAO,CAAC,CAAC,MAAF,CAAS,QAAT,EAAmB,IAAnB,CARP,CAAA;;UASA,SAAS,CAAC,OAAQ;SATlB;AAAA,QAWA,OAAA,GAAU,SAAS,CAAC,UAAV,CAAA,CAXV,CAAA;AAYA,QAAA,IAAmB,OAAO,CAAC,MAAR,KAAkB,CAArC;AAAA,UAAA,OAAO,CAAC,IAAR,CAAa,EAAb,CAAA,CAAA;SAZA;AAAA,QAaA,OAAA,GAAU,SAAS,CAAC,UAAV,CAAA,CAbV,CAAA;AAcA,QAAA,IAAmB,OAAO,CAAC,MAAR,KAAkB,CAArC;AAAA,UAAA,OAAO,CAAC,IAAR,CAAa,EAAb,CAAA,CAAA;SAdA;AAAA,QAgBA,OAAA;;AAAW;eAAA,yCAAA;2BAAA;AAAA,yBAAA,CAAC,CAAC,IAAF,CAAO,GAAP,EAAA,CAAA;AAAA;;YAhBX,CAAA;AAAA,QAkBA,WAAA,GAAc,SAAS,CAAC,cAlBxB,CAAA;AAmBA,QAAA,IAAG,SAAS,CAAC,QAAQ,CAAC,MAAtB;AACI,UAAA,WAAA,IAAe,GAAA,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAnB,CAAwB,IAAxB,CAAD,CAAH,GAAkC,GAAjD,CADJ;SAnBA;AAsBA,QAAA,IAAG,SAAS,CAAC,IAAV,KAAkB,SAArB;AACI,UAAA,SAAA,GAAY,EAAZ,CAAA;AAAA,UACA,UAAA,GAAa,SAAS,CAAC,QAAQ,CAAC,IAAnB,CAAwB,GAAxB,CADb,CAAA;AAAA,UAEA,UAAA,GAAa,SAAS,CAAC,QAAQ,CAAC,IAAnB,CAAwB,GAAxB,CAFb,CAAA;AAGA;AAAA,eAAA,QAAA;2BAAA;AACI,iBAAA,UAAA;6BAAA;AACI,cAAA,KAAA,GAAQ,EAAR,CAAA;AAAA,cACA,KAAM,CAAA,UAAA,CAAN,GAAoB,UAAA,CAAW,CAAX,CADpB,CAAA;AAAA,cAEA,KAAM,CAAA,UAAA,CAAN,GAAoB,UAAA,CAAW,CAAX,CAFpB,CAAA;AAAA,cAGA,KAAM,CAAA,SAAA,CAAN,GAAmB,GAAG,CAAC,MAAJ,CAAW,GAAG,CAAC,KAAJ,CAAA,CAAX,CAHnB,CAAA;AAAA,cAIA,SAAS,CAAC,IAAV,CAAe,KAAf,CAJA,CADJ;AAAA,aADJ;AAAA,WAJJ;SAAA,MAAA;AAYI,UAAA,OAAA,GAAU,EAAV,CAAA;AACA,eAAA,yCAAA;gCAAA;AACI,YAAA,SAAA,GAAY,MAAM,CAAC,IAAP,CAAY,GAAZ,CAAZ,CAAA;AAAA,YACA,GAAA,GAAM,CAAI,SAAA,KAAa,EAAhB,GAAwB,SAAS,CAAC,cAAlC,GAAsD,SAAvD,CADN,CAAA;AAEA,iBAAA,2CAAA;kCAAA;AACI,cAAA,GAAA,GAAM,SAAS,CAAC,aAAV,CAAwB,MAAxB,EAAgC,MAAhC,CAAN,CAAA;AACA,cAAA,IAAG,mBAAH;AACI,gBAAA,GAAA,GAAM,GAAG,CAAC,KAAJ,CAAA,CAAN,CAAA;AACA,gBAAA,IAAG,CAAC,CAAC,SAAF,CAAY,GAAZ,CAAH;AACI,kBAAA,IAAG,GAAA,GAAM,CAAT;AACI,oBAAA,GAAG,CAAC,IAAJ,CAAS,UAAA,CAAW,GAAG,CAAC,WAAJ,CAAgB,CAAhB,CAAX,CAAT,CAAA,CADJ;mBAAA,MAAA;AAGI,oBAAA,GAAG,CAAC,IAAJ,CAAS,UAAA,CAAW,GAAG,CAAC,OAAJ,CAAY,CAAZ,CAAX,CAAT,CAAA,CAHJ;mBADJ;iBAAA,MAAA;AAMI,kBAAA,GAAG,CAAC,IAAJ,CAAS,GAAT,CAAA,CANJ;iBAFJ;eAAA,MAAA;AAUK,gBAAA,GAAG,CAAC,IAAJ,CAAS,IAAT,CAAA,CAVL;eAFJ;AAAA,aAFA;AAAA,YAeA,OAAO,CAAC,IAAR,CAAa,GAAb,CAfA,CADJ;AAAA,WADA;AAAA,UAoBA,UAAA,GAAa,SAAS,CAAC,cAAV,GACT,CAAG,SAAS,CAAC,QAAQ,CAAC,MAAtB,GAAkC,GAAA,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAnB,CAAwB,IAAxB,CAAD,CAAH,GAAkC,GAApE,GAA4E,EAA5E,CArBJ,CAAA;AAAA,UAsBA,UAAA,GAAa,SAAS,CAAC,QAAQ,CAAC,IAAnB,CAAwB,GAAxB,CAtBb,CAZJ;SAtBA;AAAA,QA0DA,MAAA,GACI;AAAA,UAAA,IAAA,EACI;AAAA,YAAA,MAAA,EAAQ,IAAI,CAAC,EAAE,CAAC,MAAR,CAAA,CAAR;AAAA,YACA,KAAA,EAAO,IAAI,CAAC,EAAE,CAAC,KAAR,CAAA,CADP;WADJ;AAAA,UAGA,IAAA,EACI;AAAA,YAAA,CAAA,EAAG;AAAA,cAAA,KAAA,EAAO,UAAP;aAAH;AAAA,YACA,CAAA,EAAG;AAAA,cAAA,KAAA,EAAO,UAAP;aADH;WAJJ;AAAA,UAMA,IAAA,EACI;AAAA,YAAA,IAAA,EAAM,SAAS,CAAC,IAAhB;WAPJ;AAAA,UAQA,OAAA,EACI;AAAA,YAAA,OAAA,EAAS,KAAT;WATJ;SA3DJ,CAAA;AAsEA,QAAA,IAAG,SAAS,CAAC,IAAV,KAAkB,SAArB;AACI,UAAA,MAAM,CAAC,IAAI,CAAC,CAAZ,GAAgB,UAAhB,CAAA;AAAA,UACA,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAd,GAAqB;AAAA,YAAA,GAAA,EAAK,KAAL;WADrB,CAAA;AAAA,UAEA,MAAM,CAAC,IAAI,CAAC,IAAZ,GAAmB,SAFnB,CAAA;AAAA,UAGA,MAAM,CAAC,IAAI,CAAC,IAAZ,GAAmB;AAAA,YAAA,KAAA,EAAO,CAAC,UAAD,EAAY,UAAZ,CAAP;WAHnB,CAAA;AAAA,UAIA,MAAM,CAAC,MAAP,GAAgB;AAAA,YAAA,IAAA,EAAM,KAAN;WAJhB,CAAA;AAAA,UAKA,MAAM,CAAC,OAAO,CAAC,MAAf,GACI;AAAA,YAAA,KAAA,EAAO,SAAA,GAAA;qBAAG,YAAH;YAAA,CAAP;AAAA,YACA,IAAA,EAAM,SAAA,GAAA;qBAAG,GAAH;YAAA,CADN;AAAA,YAEA,KAAA,EAAO,SAAC,CAAD,EAAG,CAAH,EAAK,CAAL,EAAO,CAAP,GAAA;qBAAa,SAAU,CAAA,CAAA,CAAE,CAAC,QAA1B;YAAA,CAFP;WANJ,CADJ;SAAA,MAAA;AAWI,UAAA,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,IAAd,GAAoB,UAApB,CAAA;AAAA,UACA,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,UAAd,GAA2B,OAD3B,CAAA;AAAA,UAEA,MAAM,CAAC,IAAI,CAAC,OAAZ,GAAsB,OAFtB,CAXJ;SAtEA;AAsFA,QAAA,IAAG,yBAAH;AACI,UAAA,MAAM,CAAC,IAAI,CAAC,MAAZ,GAAqB;;;AAAC;mBAAA,2CAAA;+BAAA;AAAA,6BAAA,CAAC,CAAC,IAAF,CAAO,GAAP,EAAA,CAAA;AAAA;;gBAAD;WAArB,CADJ;SAtFA;AAAA,QAwFA,UAAA,GAAa,CAAA,CAAE,OAAF,EAAW;AAAA,UAAA,KAAA,EAAO,eAAP;SAAX,CAAkC,CAAC,QAAnC,CAA4C,CAAA,CAAE,MAAF,CAA5C,CAxFb,CAAA;AAAA,QAyFA,MAAA,GAAS,CAAA,CAAE,OAAF,CAAU,CAAC,QAAX,CAAoB,UAApB,CAzFT,CAAA;AAAA,QA0FA,MAAM,CAAC,MAAP,GAAgB,MAAO,CAAA,CAAA,CA1FvB,CAAA;AAAA,QA2FA,EAAE,CAAC,QAAH,CAAY,MAAZ,CA3FA,CAAA;AAAA,QA4FA,MAAM,CAAC,MAAP,CAAA,CA5FA,CAAA;AAAA,QA6FA,UAAU,CAAC,MAAX,CAAA,CA7FA,CAAA;AA8FA,eAAO,MAAP,CA/F8B;MAAA,EAApB;IAAA,CAAd,CAAA;WAiGA,CAAC,CAAC,cAAc,CAAC,YAAjB,GACI;AAAA,MAAA,YAAA,EAAc,WAAA,CAAA,CAAd;AAAA,MACA,WAAA,EAAa,WAAA,CAAY;AAAA,QAAA,IAAA,EAAM,KAAN;OAAZ,CADb;AAAA,MAEA,mBAAA,EAAqB,WAAA,CAAY;AAAA,QAAA,IAAA,EAAM,KAAN;AAAA,QAAa,OAAA,EAAS,IAAtB;OAAZ,CAFrB;AAAA,MAGA,YAAA,EAAc,WAAA,CAAY;AAAA,QAAA,IAAA,EAAM,MAAN;AAAA,QAAc,OAAA,EAAS,IAAvB;OAAZ,CAHd;AAAA,MAIA,eAAA,EAAiB,WAAA,CAAY;AAAA,QAAA,IAAA,EAAM,SAAN;OAAZ,CAJjB;MApGO;EAAA,CAAf,CATA,CAAA;AAAA","file":"c3_renderers.js","sourceRoot":"/source/","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n            c3:\n                width: -> window.innerWidth / 1.4\n                height: -> window.innerHeight / 1.4\n\n        opts = $.extend defaults, opts\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n\n        fullAggName = pivotData.aggregatorName \n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            dataArray = []\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n            vAxisTitle = pivotData.rowAttrs.join(\"-\")\n            for y, tree2 of pivotData.tree\n                for x, agg of tree2\n                    datum = {}\n                    datum[hAxisTitle] = parseFloat(x)\n                    datum[vAxisTitle] = parseFloat(y)\n                    datum[\"tooltip\"] = agg.format(agg.value())\n                    dataArray.push datum\n        else\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        val = agg.value()\n                        if $.isNumeric val\n                            if val < 1\n                                row.push parseFloat(val.toPrecision(3))\n                            else\n                                row.push parseFloat(val.toFixed(3))\n                        else\n                            row.push val\n\n                    else row.push null\n                columns.push row\n\n\n            vAxisTitle = pivotData.aggregatorName+ \n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n        params = \n            size:\n                height: opts.c3.height()\n                width: opts.c3.width()\n            axis: \n                y: label: vAxisTitle\n                x: label: hAxisTitle\n            data: \n                type: chartOpts.type\n            tooltip:\n                grouped: false\n\n        if chartOpts.type == \"scatter\"\n            params.data.x = hAxisTitle\n            params.axis.x.tick = fit: false\n            params.data.json = dataArray\n            params.data.keys = value: [hAxisTitle,vAxisTitle]\n            params.legend = show: false \n            params.tooltip.format =  \n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> dataArray[d].tooltip\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        return result\n\n    $.pivotUtilities.c3_renderers = \n        \"Line Chart\": makeC3Chart()\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\n"]}