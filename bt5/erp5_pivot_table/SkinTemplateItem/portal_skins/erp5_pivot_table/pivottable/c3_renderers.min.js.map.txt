{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","$","makeC3Chart","chartOpts","pivotData","opts","agg","colKey","colKeys","columns","dataArray","datum","defaults","fullAggName","h","hAxisTitle","headers","i","j","len","len1","params","ref","renderArea","result","row","rowHeader","rowKey","rowKeys","tree2","vAxisTitle","val","x","y","localeStrings","vs","by","c3","width","window","innerWidth","height","innerHeight","extend","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","colAttrs","rowAttrs","tree","parseFloat","format","value","getAggregator","isNumeric","toPrecision","toFixed","size","axis","label","data","tooltip","grouped","tick","fit","json","keys","legend","show","title","name","a","b","c","d","categories","stacked","groups","k","len2","style","appendTo","bindto","generate","detach","remove","pivotUtilities","c3_renderers","Line Chart","Bar Chart","Stacked Bar Chart","Area Chart","Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n            c3:\n                width: -> window.innerWidth / 1.4\n                height: -> window.innerHeight / 1.4\n\n        opts = $.extend defaults, opts\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n\n        fullAggName = pivotData.aggregatorName \n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            dataArray = []\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n            vAxisTitle = pivotData.rowAttrs.join(\"-\")\n            for y, tree2 of pivotData.tree\n                for x, agg of tree2\n                    datum = {}\n                    datum[hAxisTitle] = parseFloat(x)\n                    datum[vAxisTitle] = parseFloat(y)\n                    datum[\"tooltip\"] = agg.format(agg.value())\n                    dataArray.push datum\n        else\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    agg = pivotData.getAggregator(rowKey, colKey)\n                    if agg.value()?\n                        val = agg.value()\n                        if $.isNumeric val\n                            if val < 1\n                                row.push parseFloat(val.toPrecision(3))\n                            else\n                                row.push parseFloat(val.toFixed(3))\n                        else\n                            row.push val\n\n                    else row.push null\n                columns.push row\n\n\n            vAxisTitle = pivotData.aggregatorName+ \n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n        params = \n            size:\n                height: opts.c3.height()\n                width: opts.c3.width()\n            axis: \n                y: label: vAxisTitle\n                x: label: hAxisTitle\n            data: \n                type: chartOpts.type\n            tooltip:\n                grouped: false\n\n        if chartOpts.type == \"scatter\"\n            params.data.x = hAxisTitle\n            params.axis.x.tick = fit: false\n            params.data.json = dataArray\n            params.data.keys = value: [hAxisTitle,vAxisTitle]\n            params.legend = show: false \n            params.tooltip.format =  \n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> dataArray[d].tooltip\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        return result\n\n    $.pivotUtilities.c3_renderers = \n        \"Line Chart\": makeC3Chart()\n        \"Bar Chart\": makeC3Chart(type: \"bar\")\n        \"Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"Scatter Chart\": makeC3Chart(type: \"scatter\")\n","(function(){var t;(t=function(t){return\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"jquery\")):\"function\"==typeof define&&define.amd?define([\"jquery\"],t):t(jQuery)})(function(t){var e;return e=function(e){return null==e&&(e={}),function(r,n){var a,o,i,l,u,s,c,p,h,d,g,f,y,v,j,x,m,b,w,A,k,C,F,N,q,S,B,K;if(c={localeStrings:{vs:\"vs\",by:\"by\"},c3:{width:function(){return window.innerWidth/1.4},height:function(){return window.innerHeight/1.4}}},n=t.extend(c,n),null==e.type&&(e.type=\"line\"),F=r.getRowKeys(),0===F.length&&F.push([]),i=r.getColKeys(),0===i.length&&i.push([]),g=function(){var t,e,r;for(r=[],t=0,e=i.length;e>t;t++)h=i[t],r.push(h.join(\"-\"));return r}(),p=r.aggregatorName,r.valAttrs.length&&(p+=\"(\"+r.valAttrs.join(\", \")+\")\"),\"scatter\"===e.type){u=[],d=r.colAttrs.join(\"-\"),q=r.rowAttrs.join(\"-\"),m=r.tree;for(K in m){N=m[K];for(B in N)a=N[B],s={},s[d]=parseFloat(B),s[q]=parseFloat(K),s.tooltip=a.format(a.value()),u.push(s)}}else{for(l=[],f=0,v=F.length;v>f;f++){for(C=F[f],k=C.join(\"-\"),A=[\"\"===k?r.aggregatorName:k],y=0,j=i.length;j>y;y++)o=i[y],a=r.getAggregator(C,o),null!=a.value()?(S=a.value(),A.push(t.isNumeric(S)?1>S?parseFloat(S.toPrecision(3)):parseFloat(S.toFixed(3)):S)):A.push(null);l.push(A)}q=r.aggregatorName+(r.valAttrs.length?\"(\"+r.valAttrs.join(\", \")+\")\":\"\"),d=r.colAttrs.join(\"-\")}return x={size:{height:n.c3.height(),width:n.c3.width()},axis:{y:{label:q},x:{label:d}},data:{type:e.type},tooltip:{grouped:!1}},\"scatter\"===e.type?(x.data.x=d,x.axis.x.tick={fit:!1},x.data.json=u,x.data.keys={value:[d,q]},x.legend={show:!1},x.tooltip.format={title:function(){return p},name:function(){return\"\"},value:function(t,e,r,n){return u[n].tooltip}}):(x.axis.x.type=\"category\",x.axis.x.categories=g,x.data.columns=l),null!=e.stacked&&(x.data.groups=[function(){var t,e,r;for(r=[],t=0,e=F.length;e>t;t++)B=F[t],r.push(B.join(\"-\"));return r}()]),b=t(\"<div>\",{style:\"display:none;\"}).appendTo(t(\"body\")),w=t(\"<div>\").appendTo(b),x.bindto=w[0],c3.generate(x),w.detach(),b.remove(),w}},t.pivotUtilities.c3_renderers={\"Line Chart\":e(),\"Bar Chart\":e({type:\"bar\"}),\"Stacked Bar Chart\":e({type:\"bar\",stacked:!0}),\"Area Chart\":e({type:\"area\",stacked:!0}),\"Scatter Chart\":e({type:\"scatter\"})}})}).call(this);\n//# sourceMappingURL=c3_renderers.min.js.map"],"sourceRoot":"/source/"}