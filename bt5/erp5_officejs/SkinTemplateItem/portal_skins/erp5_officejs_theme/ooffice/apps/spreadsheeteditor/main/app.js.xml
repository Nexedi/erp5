<?xml version="1.0"?>
<ZopeData>
  <record id="1" aka="AAAAAAAAAAE=">
    <pickle>
      <global name="File" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>_EtagSupport__etag</string> </key>
            <value> <string>ts54008804.35</string> </value>
        </item>
        <item>
            <key> <string>__name__</string> </key>
            <value> <string>app.js</string> </value>
        </item>
        <item>
            <key> <string>content_type</string> </key>
            <value> <string>application/javascript</string> </value>
        </item>
        <item>
            <key> <string>data</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAI=</string> </persistent>
            </value>
        </item>
        <item>
            <key> <string>precondition</string> </key>
            <value> <string></string> </value>
        </item>
        <item>
            <key> <string>size</string> </key>
            <value> <int>2158105</int> </value>
        </item>
        <item>
            <key> <string>title</string> </key>
            <value> <string></string> </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="2" aka="AAAAAAAAAAI=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

/*\n
 * Copyright (c) Ascensio System SIA 2016. All rights reserved\n
 *\n
 * http://www.onlyoffice.com \n
 *\n
 * Version: 3.0.0 (build:866, rev:cb3d33b\n
, date:Fri Dec 18 22:30:55 2015 +0300\n
)\n
 */\n
//     Underscore.js 1.5.2\n
//     http://underscorejs.org\n
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n
//     Underscore may be freely distributed under the MIT license.\n
\n
(function() {\n
\n
  // Baseline setup\n
  // --------------\n
\n
  // Establish the root object, `window` in the browser, or `exports` on the server.\n
  var root = this;\n
\n
  // Save the previous value of the `_` variable.\n
  var previousUnderscore = root._;\n
\n
  // Establish the object that gets returned to break out of a loop iteration.\n
  var breaker = {};\n
\n
  // Save bytes in the minified (but not gzipped) version:\n
  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n
\n
  // Create quick reference variables for speed access to core prototypes.\n
  var\n
    push             = ArrayProto.push,\n
    slice            = ArrayProto.slice,\n
    concat           = ArrayProto.concat,\n
    toString         = ObjProto.toString,\n
    hasOwnProperty   = ObjProto.hasOwnProperty;\n
\n
  // All **ECMAScript 5** native function implementations that we hope to use\n
  // are declared here.\n
  var\n
    nativeForEach      = ArrayProto.forEach,\n
    nativeMap          = ArrayProto.map,\n
    nativeReduce       = ArrayProto.reduce,\n
    nativeReduceRight  = ArrayProto.reduceRight,\n
    nativeFilter       = ArrayProto.filter,\n
    nativeEvery        = ArrayProto.every,\n
    nativeSome         = ArrayProto.some,\n
    nativeIndexOf      = ArrayProto.indexOf,\n
    nativeLastIndexOf  = ArrayProto.lastIndexOf,\n
    nativeIsArray      = Array.isArray,\n
    nativeKeys         = Object.keys,\n
    nativeBind         = FuncProto.bind;\n
\n
  // Create a safe reference to the Underscore object for use below.\n
  var _ = function(obj) {\n
    if (obj instanceof _) return obj;\n
    if (!(this instanceof _)) return new _(obj);\n
    this._wrapped = obj;\n
  };\n
\n
  // Export the Underscore object for **Node.js**, with\n
  // backwards-compatibility for the old `require()` API. If we\'re in\n
  // the browser, add `_` as a global object via a string identifier,\n
  // for Closure Compiler "advanced" mode.\n
  if (typeof exports !== \'undefined\') {\n
    if (typeof module !== \'undefined\' && module.exports) {\n
      exports = module.exports = _;\n
    }\n
    exports._ = _;\n
  } else {\n
    root._ = _;\n
  }\n
\n
  // Current version.\n
  _.VERSION = \'1.5.2\';\n
\n
  // Collection Functions\n
  // --------------------\n
\n
  // The cornerstone, an `each` implementation, aka `forEach`.\n
  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n
  // Delegates to **ECMAScript 5**\'s native `forEach` if available.\n
  var each = _.each = _.forEach = function(obj, iterator, context) {\n
    if (obj == null) return;\n
    if (nativeForEach && obj.forEach === nativeForEach) {\n
      obj.forEach(iterator, context);\n
    } else if (obj.length === +obj.length) {\n
      for (var i = 0, length = obj.length; i < length; i++) {\n
        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n
      }\n
    } else {\n
      var keys = _.keys(obj);\n
      for (var i = 0, length = keys.length; i < length; i++) {\n
        if (iterator.call(context, obj[keys[i]], keys[i], obj) === breaker) return;\n
      }\n
    }\n
  };\n
\n
  // Return the results of applying the iterator to each element.\n
  // Delegates to **ECMAScript 5**\'s native `map` if available.\n
  _.map = _.collect = function(obj, iterator, context) {\n
    var results = [];\n
    if (obj == null) return results;\n
    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n
    each(obj, function(value, index, list) {\n
      results.push(iterator.call(context, value, index, list));\n
    });\n
    return results;\n
  };\n
\n
  var reduceError = \'Reduce of empty array with no initial value\';\n
\n
  // **Reduce** builds up a single result from a list of values, aka `inject`,\n
  // or `foldl`. Delegates to **ECMAScript 5**\'s native `reduce` if available.\n
  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {\n
    var initial = arguments.length > 2;\n
    if (obj == null) obj = [];\n
    if (nativeReduce && obj.reduce === nativeReduce) {\n
      if (context) iterator = _.bind(iterator, context);\n
      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);\n
    }\n
    each(obj, function(value, index, list) {\n
      if (!initial) {\n
        memo = value;\n
        initial = true;\n
      } else {\n
        memo = iterator.call(context, memo, value, index, list);\n
      }\n
    });\n
    if (!initial) throw new TypeError(reduceError);\n
    return memo;\n
  };\n
\n
  // The right-associative version of reduce, also known as `foldr`.\n
  // Delegates to **ECMAScript 5**\'s native `reduceRight` if available.\n
  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {\n
    var initial = arguments.length > 2;\n
    if (obj == null) obj = [];\n
    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {\n
      if (context) iterator = _.bind(iterator, context);\n
      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);\n
    }\n
    var length = obj.length;\n
    if (length !== +length) {\n
      var keys = _.keys(obj);\n
      length = keys.length;\n
    }\n
    each(obj, function(value, index, list) {\n
      index = keys ? keys[--length] : --length;\n
      if (!initial) {\n
        memo = obj[index];\n
        initial = true;\n
      } else {\n
        memo = iterator.call(context, memo, obj[index], index, list);\n
      }\n
    });\n
    if (!initial) throw new TypeError(reduceError);\n
    return memo;\n
  };\n
\n
  // Return the first value which passes a truth test. Aliased as `detect`.\n
  _.find = _.detect = function(obj, iterator, context) {\n
    var result;\n
    any(obj, function(value, index, list) {\n
      if (iterator.call(context, value, index, list)) {\n
        result = value;\n
        return true;\n
      }\n
    });\n
    return result;\n
  };\n
\n
  // Return all the elements that pass a truth test.\n
  // Delegates to **ECMAScript 5**\'s native `filter` if available.\n
  // Aliased as `select`.\n
  _.filter = _.select = function(obj, iterator, context) {\n
    var results = [];\n
    if (obj == null) return results;\n
    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);\n
    each(obj, function(value, index, list) {\n
      if (iterator.call(context, value, index, list)) results.push(value);\n
    });\n
    return results;\n
  };\n
\n
  // Return all the elements for which a truth test fails.\n
  _.reject = function(obj, iterator, context) {\n
    return _.filter(obj, function(value, index, list) {\n
      return !iterator.call(context, value, index, list);\n
    }, context);\n
  };\n
\n
  // Determine whether all of the elements match a truth test.\n
  // Delegates to **ECMAScript 5**\'s native `every` if available.\n
  // Aliased as `all`.\n
  _.every = _.all = function(obj, iterator, context) {\n
    iterator || (iterator = _.identity);\n
    var result = true;\n
    if (obj == null) return result;\n
    if (nativeEvery && obj.every === nativeEvery) return obj.every(iterator, context);\n
    each(obj, function(value, index, list) {\n
      if (!(result = result && iterator.call(context, value, index, list))) return breaker;\n
    });\n
    return !!result;\n
  };\n
\n
  // Determine if at least one element in the object matches a truth test.\n
  // Delegates to **ECMAScript 5**\'s native `some` if available.\n
  // Aliased as `any`.\n
  var any = _.some = _.any = function(obj, iterator, context) {\n
    iterator || (iterator = _.identity);\n
    var result = false;\n
    if (obj == null) return result;\n
    if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);\n
    each(obj, function(value, index, list) {\n
      if (result || (result = iterator.call(context, value, index, list))) return breaker;\n
    });\n
    return !!result;\n
  };\n
\n
  // Determine if the array or object contains a given value (using `===`).\n
  // Aliased as `include`.\n
  _.contains = _.include = function(obj, target) {\n
    if (obj == null) return false;\n
    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;\n
    return any(obj, function(value) {\n
      return value === target;\n
    });\n
  };\n
\n
  // Invoke a method (with arguments) on every item in a collection.\n
  _.invoke = function(obj, method) {\n
    var args = slice.call(arguments, 2);\n
    var isFunc = _.isFunction(method);\n
    return _.map(obj, function(value) {\n
      return (isFunc ? method : value[method]).apply(value, args);\n
    });\n
  };\n
\n
  // Convenience version of a common use case of `map`: fetching a property.\n
  _.pluck = function(obj, key) {\n
    return _.map(obj, function(value){ return value[key]; });\n
  };\n
\n
  // Convenience version of a common use case of `filter`: selecting only objects\n
  // containing specific `key:value` pairs.\n
  _.where = function(obj, attrs, first) {\n
    if (_.isEmpty(attrs)) return first ? void 0 : [];\n
    return _[first ? \'find\' : \'filter\'](obj, function(value) {\n
      for (var key in attrs) {\n
        if (attrs[key] !== value[key]) return false;\n
      }\n
      return true;\n
    });\n
  };\n
\n
  // Convenience version of a common use case of `find`: getting the first object\n
  // containing specific `key:value` pairs.\n
  _.findWhere = function(obj, attrs) {\n
    return _.where(obj, attrs, true);\n
  };\n
\n
  // Return the maximum element or (element-based computation).\n
  // Can\'t optimize arrays of integers longer than 65,535 elements.\n
  // See [WebKit Bug 80797](https://bugs.webkit.org/show_bug.cgi?id=80797)\n
  _.max = function(obj, iterator, context) {\n
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n
      return Math.max.apply(Math, obj);\n
    }\n
    if (!iterator && _.isEmpty(obj)) return -Infinity;\n
    var result = {computed : -Infinity, value: -Infinity};\n
    each(obj, function(value, index, list) {\n
      var computed = iterator ? iterator.call(context, value, index, list) : value;\n
      computed > result.computed && (result = {value : value, computed : computed});\n
    });\n
    return result.value;\n
  };\n
\n
  // Return the minimum element (or element-based computation).\n
  _.min = function(obj, iterator, context) {\n
    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n
      return Math.min.apply(Math, obj);\n
    }\n
    if (!iterator && _.isEmpty(obj)) return Infinity;\n
    var result = {computed : Infinity, value: Infinity};\n
    each(obj, function(value, index, list) {\n
      var computed = iterator ? iterator.call(context, value, index, list) : value;\n
      computed < result.computed && (result = {value : value, computed : computed});\n
    });\n
    return result.value;\n
  };\n
\n
  // Shuffle an array, using the modern version of the \n
  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisherâ€“Yates_shuffle).\n
  _.shuffle = function(obj) {\n
    var rand;\n
    var index = 0;\n
    var shuffled = [];\n
    each(obj, function(value) {\n
      rand = _.random(index++);\n
      shuffled[index - 1] = shuffled[rand];\n
      shuffled[rand] = value;\n
    });\n
    return shuffled;\n
  };\n
\n
  // Sample **n** random values from an array.\n
  // If **n** is not specified, returns a single random element from the array.\n
  // The internal `guard` argument allows it to work with `map`.\n
  _.sample = function(obj, n, guard) {\n
    if (arguments.length < 2 || guard) {\n
      return obj[_.random(obj.length - 1)];\n
    }\n
    return _.shuffle(obj).slice(0, Math.max(0, n));\n
  };\n
\n
  // An internal function to generate lookup iterators.\n
  var lookupIterator = function(value) {\n
    return _.isFunction(value) ? value : function(obj){ return obj[value]; };\n
  };\n
\n
  // Sort the object\'s values by a criterion produced by an iterator.\n
  _.sortBy = function(obj, value, context) {\n
    var iterator = lookupIterator(value);\n
    return _.pluck(_.map(obj, function(value, index, list) {\n
      return {\n
        value: value,\n
        index: index,\n
        criteria: iterator.call(context, value, index, list)\n
      };\n
    }).sort(function(left, right) {\n
      var a = left.criteria;\n
      var b = right.criteria;\n
      if (a !== b) {\n
        if (a > b || a === void 0) return 1;\n
        if (a < b || b === void 0) return -1;\n
      }\n
      return left.index - right.index;\n
    }), \'value\');\n
  };\n
\n
  // An internal function used for aggregate "group by" operations.\n
  var group = function(behavior) {\n
    return function(obj, value, context) {\n
      var result = {};\n
      var iterator = value == null ? _.identity : lookupIterator(value);\n
      each(obj, function(value, index) {\n
        var key = iterator.call(context, value, index, obj);\n
        behavior(result, key, value);\n
      });\n
      return result;\n
    };\n
  };\n
\n
  // Groups the object\'s values by a criterion. Pass either a string attribute\n
  // to group by, or a function that returns the criterion.\n
  _.groupBy = group(function(result, key, value) {\n
    (_.has(result, key) ? result[key] : (result[key] = [])).push(value);\n
  });\n
\n
  // Indexes the object\'s values by a criterion, similar to `groupBy`, but for\n
  // when you know that your index values will be unique.\n
  _.indexBy = group(function(result, key, value) {\n
    result[key] = value;\n
  });\n
\n
  // Counts instances of an object that group by a certain criterion. Pass\n
  // either a string attribute to count by, or a function that returns the\n
  // criterion.\n
  _.countBy = group(function(result, key) {\n
    _.has(result, key) ? result[key]++ : result[key] = 1;\n
  });\n
\n
  // Use a comparator function to figure out the smallest index at which\n
  // an object should be inserted so as to maintain order. Uses binary search.\n
  _.sortedIndex = function(array, obj, iterator, context) {\n
    iterator = iterator == null ? _.identity : lookupIterator(iterator);\n
    var value = iterator.call(context, obj);\n
    var low = 0, high = array.length;\n
    while (low < high) {\n
      var mid = (low + high) >>> 1;\n
      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;\n
    }\n
    return low;\n
  };\n
\n
  // Safely create a real, live array from anything iterable.\n
  _.toArray = function(obj) {\n
    if (!obj) return [];\n
    if (_.isArray(obj)) return slice.call(obj);\n
    if (obj.length === +obj.length) return _.map(obj, _.identity);\n
    return _.values(obj);\n
  };\n
\n
  // Return the number of elements in an object.\n
  _.size = function(obj) {\n
    if (obj == null) return 0;\n
    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;\n
  };\n
\n
  // Array Functions\n
  // ---------------\n
\n
  // Get the first element of an array. Passing **n** will return the first N\n
  // values in the array. Aliased as `head` and `take`. The **guard** check\n
  // allows it to work with `_.map`.\n
  _.first = _.head = _.take = function(array, n, guard) {\n
    if (array == null) return void 0;\n
    return (n == null) || guard ? array[0] : slice.call(array, 0, n);\n
  };\n
\n
  // Returns everything but the last entry of the array. Especially useful on\n
  // the arguments object. Passing **n** will return all the values in\n
  // the array, excluding the last N. The **guard** check allows it to work with\n
  // `_.map`.\n
  _.initial = function(array, n, guard) {\n
    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));\n
  };\n
\n
  // Get the last element of an array. Passing **n** will return the last N\n
  // values in the array. The **guard** check allows it to work with `_.map`.\n
  _.last = function(array, n, guard) {\n
    if (array == null) return void 0;\n
    if ((n == null) || guard) {\n
      return array[array.length - 1];\n
    } else {\n
      return slice.call(array, Math.max(array.length - n, 0));\n
    }\n
  };\n
\n
  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n
  // Especially useful on the arguments object. Passing an **n** will return\n
  // the rest N values in the array. The **guard**\n
  // check allows it to work with `_.map`.\n
  _.rest = _.tail = _.drop = function(array, n, guard) {\n
    return slice.call(array, (n == null) || guard ? 1 : n);\n
  };\n
\n
  // Trim out all falsy values from an array.\n
  _.compact = function(array) {\n
    return _.filter(array, _.identity);\n
  };\n
\n
  // Internal implementation of a recursive `flatten` function.\n
  var flatten = function(input, shallow, output) {\n
    if (shallow && _.every(input, _.isArray)) {\n
      return concat.apply(output, input);\n
    }\n
    each(input, function(value) {\n
      if (_.isArray(value) || _.isArguments(value)) {\n
        shallow ? push.apply(output, value) : flatten(value, shallow, output);\n
      } else {\n
        output.push(value);\n
      }\n
    });\n
    return output;\n
  };\n
\n
  // Flatten out an array, either recursively (by default), or just one level.\n
  _.flatten = function(array, shallow) {\n
    return flatten(array, shallow, []);\n
  };\n
\n
  // Return a version of the array that does not contain the specified value(s).\n
  _.without = function(array) {\n
    return _.difference(array, slice.call(arguments, 1));\n
  };\n
\n
  // Produce a duplicate-free version of the array. If the array has already\n
  // been sorted, you have the option of using a faster algorithm.\n
  // Aliased as `unique`.\n
  _.uniq = _.unique = function(array, isSorted, iterator, context) {\n
    if (_.isFunction(isSorted)) {\n
      context = iterator;\n
      iterator = isSorted;\n
      isSorted = false;\n
    }\n
    var initial = iterator ? _.map(array, iterator, context) : array;\n
    var results = [];\n
    var seen = [];\n
    each(initial, function(value, index) {\n
      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {\n
        seen.push(value);\n
        results.push(array[index]);\n
      }\n
    });\n
    return results;\n
  };\n
\n
  // Produce an array that contains the union: each distinct element from all of\n
  // the passed-in arrays.\n
  _.union = function() {\n
    return _.uniq(_.flatten(arguments, true));\n
  };\n
\n
  // Produce an array that contains every item shared between all the\n
  // passed-in arrays.\n
  _.intersection = function(array) {\n
    var rest = slice.call(arguments, 1);\n
    return _.filter(_.uniq(array), function(item) {\n
      return _.every(rest, function(other) {\n
        return _.indexOf(other, item) >= 0;\n
      });\n
    });\n
  };\n
\n
  // Take the difference between one array and a number of other arrays.\n
  // Only the elements present in just the first array will remain.\n
  _.difference = function(array) {\n
    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));\n
    return _.filter(array, function(value){ return !_.contains(rest, value); });\n
  };\n
\n
  // Zip together multiple lists into a single array -- elements that share\n
  // an index go together.\n
  _.zip = function() {\n
    var length = _.max(_.pluck(arguments, "length").concat(0));\n
    var results = new Array(length);\n
    for (var i = 0; i < length; i++) {\n
      results[i] = _.pluck(arguments, \'\' + i);\n
    }\n
    return results;\n
  };\n
\n
  // Converts lists into objects. Pass either a single array of `[key, value]`\n
  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n
  // the corresponding values.\n
  _.object = function(list, values) {\n
    if (list == null) return {};\n
    var result = {};\n
    for (var i = 0, length = list.length; i < length; i++) {\n
      if (values) {\n
        result[list[i]] = values[i];\n
      } else {\n
        result[list[i][0]] = list[i][1];\n
      }\n
    }\n
    return result;\n
  };\n
\n
  // If the browser doesn\'t supply us with indexOf (I\'m looking at you, **MSIE**),\n
  // we need this function. Return the position of the first occurrence of an\n
  // item in an array, or -1 if the item is not included in the array.\n
  // Delegates to **ECMAScript 5**\'s native `indexOf` if available.\n
  // If the array is large and already in sort order, pass `true`\n
  // for **isSorted** to use binary search.\n
  _.indexOf = function(array, item, isSorted) {\n
    if (array == null) return -1;\n
    var i = 0, length = array.length;\n
    if (isSorted) {\n
      if (typeof isSorted == \'number\') {\n
        i = (isSorted < 0 ? Math.max(0, length + isSorted) : isSorted);\n
      } else {\n
        i = _.sortedIndex(array, item);\n
        return array[i] === item ? i : -1;\n
      }\n
    }\n
    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);\n
    for (; i < length; i++) if (array[i] === item) return i;\n
    return -1;\n
  };\n
\n
  // Delegates to **ECMAScript 5**\'s native `lastIndexOf` if available.\n
  _.lastIndexOf = function(array, item, from) {\n
    if (array == null) return -1;\n
    var hasIndex = from != null;\n
    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {\n
      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);\n
    }\n
    var i = (hasIndex ? from : array.length);\n
    while (i--) if (array[i] === item) return i;\n
    return -1;\n
  };\n
\n
  // Generate an integer Array containing an arithmetic progression. A port of\n
  // the native Python `range()` function. See\n
  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n
  _.range = function(start, stop, step) {\n
    if (arguments.length <= 1) {\n
      stop = start || 0;\n
      start = 0;\n
    }\n
    step = arguments[2] || 1;\n
\n
    var length = Math.max(Math.ceil((stop - start) / step), 0);\n
    var idx = 0;\n
    var range = new Array(length);\n
\n
    while(idx < length) {\n
      range[idx++] = start;\n
      start += step;\n
    }\n
\n
    return range;\n
  };\n
\n
  // Function (ahem) Functions\n
  // ------------------\n
\n
  // Reusable constructor function for prototype setting.\n
  var ctor = function(){};\n
\n
  // Create a function bound to a given object (assigning `this`, and arguments,\n
  // optionally). Delegates to **ECMAScript 5**\'s native `Function.bind` if\n
  // available.\n
  _.bind = function(func, context) {\n
    var args, bound;\n
    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n
    if (!_.isFunction(func)) throw new TypeError;\n
    args = slice.call(arguments, 2);\n
    return bound = function() {\n
      if (!(this instanceof bound)) return func.apply(context, args.concat(slice.call(arguments)));\n
      ctor.prototype = func.prototype;\n
      var self = new ctor;\n
      ctor.prototype = null;\n
      var result = func.apply(self, args.concat(slice.call(arguments)));\n
      if (Object(result) === result) return result;\n
      return self;\n
    };\n
  };\n
\n
  // Partially apply a function by creating a version that has had some of its\n
  // arguments pre-filled, without changing its dynamic `this` context.\n
  _.partial = function(func) {\n
    var args = slice.call(arguments, 1);\n
    return function() {\n
      return func.apply(this, args.concat(slice.call(arguments)));\n
    };\n
  };\n
\n
  // Bind all of an object\'s methods to that object. Useful for ensuring that\n
  // all callbacks defined on an object belong to it.\n
  _.bindAll = function(obj) {\n
    var funcs = slice.call(arguments, 1);\n
    if (funcs.length === 0) throw new Error("bindAll must be passed function names");\n
    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });\n
    return obj;\n
  };\n
\n
  // Memoize an expensive function by storing its results.\n
  _.memoize = function(func, hasher) {\n
    var memo = {};\n
    hasher || (hasher = _.identity);\n
    return function() {\n
      var key = hasher.apply(this, arguments);\n
      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));\n
    };\n
  };\n
\n
  // Delays a function for the given number of milliseconds, and then calls\n
  // it with the arguments supplied.\n
  _.delay = function(func, wait) {\n
    var args = slice.call(arguments, 2);\n
    return setTimeout(function(){ return func.apply(null, args); }, wait);\n
  };\n
\n
  // Defers a function, scheduling it to run after the current call stack has\n
  // cleared.\n
  _.defer = function(func) {\n
    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));\n
  };\n
\n
  // Returns a function, that, when invoked, will only be triggered at most once\n
  // during a given window of time. Normally, the throttled function will run\n
  // as much as it can, without ever going more than once per `wait` duration;\n
  // but if you\'d like to disable the execution on the leading edge, pass\n
  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n
  _.throttle = function(func, wait, options) {\n
    var context, args, result;\n
    var timeout = null;\n
    var previous = 0;\n
    options || (options = {});\n
    var later = function() {\n
      previous = options.leading === false ? 0 : new Date;\n
      timeout = null;\n
      result = func.apply(context, args);\n
    };\n
    return function() {\n
      var now = new Date;\n
      if (!previous && options.leading === false) previous = now;\n
      var remaining = wait - (now - previous);\n
      context = this;\n
      args = arguments;\n
      if (remaining <= 0) {\n
        clearTimeout(timeout);\n
        timeout = null;\n
        previous = now;\n
        result = func.apply(context, args);\n
      } else if (!timeout && options.trailing !== false) {\n
        timeout = setTimeout(later, remaining);\n
      }\n
      return result;\n
    };\n
  };\n
\n
  // Returns a function, that, as long as it continues to be invoked, will not\n
  // be triggered. The function will be called after it stops being called for\n
  // N milliseconds. If `immediate` is passed, trigger the function on the\n
  // leading edge, instead of the trailing.\n
  _.debounce = function(func, wait, immediate) {\n
    var timeout, args, context, timestamp, result;\n
    return function() {\n
      context = this;\n
      args = arguments;\n
      timestamp = new Date();\n
      var later = function() {\n
        var last = (new Date()) - timestamp;\n
        if (last < wait) {\n
          timeout = setTimeout(later, wait - last);\n
        } else {\n
          timeout = null;\n
          if (!immediate) result = func.apply(context, args);\n
        }\n
      };\n
      var callNow = immediate && !timeout;\n
      if (!timeout) {\n
        timeout = setTimeout(later, wait);\n
      }\n
      if (callNow) result = func.apply(context, args);\n
      return result;\n
    };\n
  };\n
\n
  // Returns a function that will be executed at most one time, no matter how\n
  // often you call it. Useful for lazy initialization.\n
  _.once = function(func) {\n
    var ran = false, memo;\n
    return function() {\n
      if (ran) return memo;\n
      ran = true;\n
      memo = func.apply(this, arguments);\n
      func = null;\n
      return memo;\n
    };\n
  };\n
\n
  // Returns the first function passed as an argument to the second,\n
  // allowing you to adjust arguments, run code before and after, and\n
  // conditionally execute the original function.\n
  _.wrap = function(func, wrapper) {\n
    return function() {\n
      var args = [func];\n
      push.apply(args, arguments);\n
      return wrapper.apply(this, args);\n
    };\n
  };\n
\n
  // Returns a function that is the composition of a list of functions, each\n
  // consuming the return value of the function that follows.\n
  _.compose = function() {\n
    var funcs = arguments;\n
    return function() {\n
      var args = arguments;\n
      for (var i = funcs.length - 1; i >= 0; i--) {\n
        args = [funcs[i].apply(this, args)];\n
      }\n
      return args[0];\n
    };\n
  };\n
\n
  // Returns a function that will only be executed after being called N times.\n
  _.after = function(times, func) {\n
    return function() {\n
      if (--times < 1) {\n
        return func.apply(this, arguments);\n
      }\n
    };\n
  };\n
\n
  // Object Functions\n
  // ----------------\n
\n
  // Retrieve the names of an object\'s properties.\n
  // Delegates to **ECMAScript 5**\'s native `Object.keys`\n
  _.keys = nativeKeys || function(obj) {\n
    if (obj !== Object(obj)) throw new TypeError(\'Invalid object\');\n
    var keys = [];\n
    for (var key in obj) if (_.has(obj, key)) keys.push(key);\n
    return keys;\n
  };\n
\n
  // Retrieve the values of an object\'s properties.\n
  _.values = function(obj) {\n
    var keys = _.keys(obj);\n
    var length = keys.length;\n
    var values = new Array(length);\n
    for (var i = 0; i < length; i++) {\n
      values[i] = obj[keys[i]];\n
    }\n
    return values;\n
  };\n
\n
  // Convert an object into a list of `[key, value]` pairs.\n
  _.pairs = function(obj) {\n
    var keys = _.keys(obj);\n
    var length = keys.length;\n
    var pairs = new Array(length);\n
    for (var i = 0; i < length; i++) {\n
      pairs[i] = [keys[i], obj[keys[i]]];\n
    }\n
    return pairs;\n
  };\n
\n
  // Invert the keys and values of an object. The values must be serializable.\n
  _.invert = function(obj) {\n
    var result = {};\n
    var keys = _.keys(obj);\n
    for (var i = 0, length = keys.length; i < length; i++) {\n
      result[obj[keys[i]]] = keys[i];\n
    }\n
    return result;\n
  };\n
\n
  // Return a sorted list of the function names available on the object.\n
  // Aliased as `methods`\n
  _.functions = _.methods = function(obj) {\n
    var names = [];\n
    for (var key in obj) {\n
      if (_.isFunction(obj[key])) names.push(key);\n
    }\n
    return names.sort();\n
  };\n
\n
  // Extend a given object with all the properties in passed-in object(s).\n
  _.extend = function(obj) {\n
    each(slice.call(arguments, 1), function(source) {\n
      if (source) {\n
        for (var prop in source) {\n
          obj[prop] = source[prop];\n
        }\n
      }\n
    });\n
    return obj;\n
  };\n
\n
  // Return a copy of the object only containing the whitelisted properties.\n
  _.pick = function(obj) {\n
    var copy = {};\n
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n
    each(keys, function(key) {\n
      if (key in obj) copy[key] = obj[key];\n
    });\n
    return copy;\n
  };\n
\n
   // Return a copy of the object without the blacklisted properties.\n
  _.omit = function(obj) {\n
    var copy = {};\n
    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n
    for (var key in obj) {\n
      if (!_.contains(keys, key)) copy[key] = obj[key];\n
    }\n
    return copy;\n
  };\n
\n
  // Fill in a given object with default properties.\n
  _.defaults = function(obj) {\n
    each(slice.call(arguments, 1), function(source) {\n
      if (source) {\n
        for (var prop in source) {\n
          if (obj[prop] === void 0) obj[prop] = source[prop];\n
        }\n
      }\n
    });\n
    return obj;\n
  };\n
\n
  // Create a (shallow-cloned) duplicate of an object.\n
  _.clone = function(obj) {\n
    if (!_.isObject(obj)) return obj;\n
    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n
  };\n
\n
  // Invokes interceptor with the obj, and then returns obj.\n
  // The primary purpose of this method is to "tap into" a method chain, in\n
  // order to perform operations on intermediate results within the chain.\n
  _.tap = function(obj, interceptor) {\n
    interceptor(obj);\n
    return obj;\n
  };\n
\n
  // Internal recursive comparison function for `isEqual`.\n
  var eq = function(a, b, aStack, bStack) {\n
    // Identical objects are equal. `0 === -0`, but they aren\'t identical.\n
    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\n
    if (a === b) return a !== 0 || 1 / a == 1 / b;\n
    // A strict comparison is necessary because `null == undefined`.\n
    if (a == null || b == null) return a === b;\n
    // Unwrap any wrapped objects.\n
    if (a instanceof _) a = a._wrapped;\n
    if (b instanceof _) b = b._wrapped;\n
    // Compare `[[Class]]` names.\n
    var className = toString.call(a);\n
    if (className != toString.call(b)) return false;\n
    switch (className) {\n
      // Strings, numbers, dates, and booleans are compared by value.\n
      case \'[object String]\':\n
        // Primitives and their corresponding object wrappers are equivalent; thus, `"5"` is\n
        // equivalent to `new String("5")`.\n
        return a == String(b);\n
      case \'[object Number]\':\n
        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for\n
        // other numeric values.\n
        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);\n
      case \'[object Date]\':\n
      case \'[object Boolean]\':\n
        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n
        // millisecond representations. Note that invalid dates with millisecond representations\n
        // of `NaN` are not equivalent.\n
        return +a == +b;\n
      // RegExps are compared by their source patterns and flags.\n
      case \'[object RegExp]\':\n
        return a.source == b.source &&\n
               a.global == b.global &&\n
               a.multiline == b.multiline &&\n
               a.ignoreCase == b.ignoreCase;\n
    }\n
    if (typeof a != \'object\' || typeof b != \'object\') return false;\n
    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n
    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n
    var length = aStack.length;\n
    while (length--) {\n
      // Linear search. Performance is inversely proportional to the number of\n
      // unique nested structures.\n
      if (aStack[length] == a) return bStack[length] == b;\n
    }\n
    // Objects with different constructors are not equivalent, but `Object`s\n
    // from different frames are.\n
    var aCtor = a.constructor, bCtor = b.constructor;\n
    if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&\n
                             _.isFunction(bCtor) && (bCtor instanceof bCtor))) {\n
      return false;\n
    }\n
    // Add the first object to the stack of traversed objects.\n
    aStack.push(a);\n
    bStack.push(b);\n
    var size = 0, result = true;\n
    // Recursively compare objects and arrays.\n
    if (className == \'[object Array]\') {\n
      // Compare array lengths to determine if a deep comparison is necessary.\n
      size = a.length;\n
      result = size == b.length;\n
      if (result) {\n
        // Deep compare the contents, ignoring non-numeric properties.\n
        while (size--) {\n
          if (!(result = eq(a[size], b[size], aStack, bStack))) break;\n
        }\n
      }\n
    } else {\n
      // Deep compare objects.\n
      for (var key in a) {\n
        if (_.has(a, key)) {\n
          // Count the expected number of properties.\n
          size++;\n
          // Deep compare each member.\n
          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;\n
        }\n
      }\n
      // Ensure that both objects contain the same number of properties.\n
      if (result) {\n
        for (key in b) {\n
          if (_.has(b, key) && !(size--)) break;\n
        }\n
        result = !size;\n
      }\n
    }\n
    // Remove the first object from the stack of traversed objects.\n
    aStack.pop();\n
    bStack.pop();\n
    return result;\n
  };\n
\n
  // Perform a deep comparison to check if two objects are equal.\n
  _.isEqual = function(a, b) {\n
    return eq(a, b, [], []);\n
  };\n
\n
  // Is a given array, string, or object empty?\n
  // An "empty" object has no enumerable own-properties.\n
  _.isEmpty = function(obj) {\n
    if (obj == null) return true;\n
    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;\n
    for (var key in obj) if (_.has(obj, key)) return false;\n
    return true;\n
  };\n
\n
  // Is a given value a DOM element?\n
  _.isElement = function(obj) {\n
    return !!(obj && obj.nodeType === 1);\n
  };\n
\n
  // Is a given value an array?\n
  // Delegates to ECMA5\'s native Array.isArray\n
  _.isArray = nativeIsArray || function(obj) {\n
    return toString.call(obj) == \'[object Array]\';\n
  };\n
\n
  // Is a given variable an object?\n
  _.isObject = function(obj) {\n
    return obj === Object(obj);\n
  };\n
\n
  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.\n
  each([\'Arguments\', \'Function\', \'String\', \'Number\', \'Date\', \'RegExp\'], function(name) {\n
    _[\'is\' + name] = function(obj) {\n
      return toString.call(obj) == \'[object \' + name + \']\';\n
    };\n
  });\n
\n
  // Define a fallback version of the method in browsers (ahem, IE), where\n
  // there isn\'t any inspectable "Arguments" type.\n
  if (!_.isArguments(arguments)) {\n
    _.isArguments = function(obj) {\n
      return !!(obj && _.has(obj, \'callee\'));\n
    };\n
  }\n
\n
  // Optimize `isFunction` if appropriate.\n
  if (typeof (/./) !== \'function\') {\n
    _.isFunction = function(obj) {\n
      return typeof obj === \'function\';\n
    };\n
  }\n
\n
  // Is a given object a finite number?\n
  _.isFinite = function(obj) {\n
    return isFinite(obj) && !isNaN(parseFloat(obj));\n
  };\n
\n
  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n
  _.isNaN = function(obj) {\n
    return _.isNumber(obj) && obj != +obj;\n
  };\n
\n
  // Is a given value a boolean?\n
  _.isBoolean = function(obj) {\n
    return obj === true || obj === false || toString.call(obj) == \'[object Boolean]\';\n
  };\n
\n
  // Is a given value equal to null?\n
  _.isNull = function(obj) {\n
    return obj === null;\n
  };\n
\n
  // Is a given variable undefined?\n
  _.isUndefined = function(obj) {\n
    return obj === void 0;\n
  };\n
\n
  // Shortcut function for checking if an object has a given property directly\n
  // on itself (in other words, not on a prototype).\n
  _.has = function(obj, key) {\n
    return hasOwnProperty.call(obj, key);\n
  };\n
\n
  // Utility Functions\n
  // -----------------\n
\n
  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n
  // previous owner. Returns a reference to the Underscore object.\n
  _.noConflict = function() {\n
    root._ = previousUnderscore;\n
    return this;\n
  };\n
\n
  // Keep the identity function around for default iterators.\n
  _.identity = function(value) {\n
    return value;\n
  };\n
\n
  // Run a function **n** times.\n
  _.times = function(n, iterator, context) {\n
    var accum = Array(Math.max(0, n));\n
    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);\n
    return accum;\n
  };\n
\n
  // Return a random integer between min and max (inclusive).\n
  _.random = function(min, max) {\n
    if (max == null) {\n
      max = min;\n
      min = 0;\n
    }\n
    return min + Math.floor(Math.random() * (max - min + 1));\n
  };\n
\n
  // List of HTML entities for escaping.\n
  var entityMap = {\n
    escape: {\n
      \'&\': \'&amp;\',\n
      \'<\': \'&lt;\',\n
      \'>\': \'&gt;\',\n
      \'"\': \'&quot;\',\n
      "\'": \'&#x27;\'\n
    }\n
  };\n
  entityMap.unescape = _.invert(entityMap.escape);\n
\n
  // Regexes containing the keys and values listed immediately above.\n
  var entityRegexes = {\n
    escape:   new RegExp(\'[\' + _.keys(entityMap.escape).join(\'\') + \']\', \'g\'),\n
    unescape: new RegExp(\'(\' + _.keys(entityMap.unescape).join(\'|\') + \')\', \'g\')\n
  };\n
\n
  // Functions for escaping and unescaping strings to/from HTML interpolation.\n
  _.each([\'escape\', \'unescape\'], function(method) {\n
    _[method] = function(string) {\n
      if (string == null) return \'\';\n
      return (\'\' + string).replace(entityRegexes[method], function(match) {\n
        return entityMap[method][match];\n
      });\n
    };\n
  });\n
\n
  // If the value of the named `property` is a function then invoke it with the\n
  // `object` as context; otherwise, return it.\n
  _.result = function(object, property) {\n
    if (object == null) return void 0;\n
    var value = object[property];\n
    return _.isFunction(value) ? value.call(object) : value;\n
  };\n
\n
  // Add your own custom functions to the Underscore object.\n
  _.mixin = function(obj) {\n
    each(_.functions(obj), function(name) {\n
      var func = _[name] = obj[name];\n
      _.prototype[name] = function() {\n
        var args = [this._wrapped];\n
        push.apply(args, arguments);\n
        return result.call(this, func.apply(_, args));\n
      };\n
    });\n
  };\n
\n
  // Generate a unique integer id (unique within the entire client session).\n
  // Useful for temporary DOM ids.\n
  var idCounter = 0;\n
  _.uniqueId = function(prefix) {\n
    var id = ++idCounter + \'\';\n
    return prefix ? prefix + id : id;\n
  };\n
\n
  // By default, Underscore uses ERB-style template delimiters, change the\n
  // following template settings to use alternative delimiters.\n
  _.templateSettings = {\n
    evaluate    : /<%([\\s\\S]+?)%>/g,\n
    interpolate : /<%=([\\s\\S]+?)%>/g,\n
    escape      : /<%-([\\s\\S]+?)%>/g\n
  };\n
\n
  // When customizing `templateSettings`, if you don\'t want to define an\n
  // interpolation, evaluation or escaping regex, we need one that is\n
  // guaranteed not to match.\n
  var noMatch = /(.)^/;\n
\n
  // Certain characters need to be escaped so that they can be put into a\n
  // string literal.\n
  var escapes = {\n
    "\'":      "\'",\n
    \'\\\\\':     \'\\\\\',\n
    \'\\r\':     \'r\',\n
    \'\\n\':     \'n\',\n
    \'\\t\':     \'t\',\n
    \'\\u2028\': \'u2028\',\n
    \'\\u2029\': \'u2029\'\n
  };\n
\n
  var escaper = /\\\\|\'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n
\n
  // JavaScript micro-templating, similar to John Resig\'s implementation.\n
  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n
  // and correctly escapes quotes within interpolated code.\n
  _.template = function(text, data, settings) {\n
    var render;\n
    settings = _.defaults({}, settings, _.templateSettings);\n
\n
    // Combine delimiters into one regular expression via alternation.\n
    var matcher = new RegExp([\n
      (settings.escape || noMatch).source,\n
      (settings.interpolate || noMatch).source,\n
      (settings.evaluate || noMatch).source\n
    ].join(\'|\') + \'|$\', \'g\');\n
\n
    // Compile the template source, escaping string literals appropriately.\n
    var index = 0;\n
    var source = "__p+=\'";\n
    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n
      source += text.slice(index, offset)\n
        .replace(escaper, function(match) { return \'\\\\\' + escapes[match]; });\n
\n
      if (escape) {\n
        source += "\'+\\n((__t=(" + escape + "))==null?\'\':_.escape(__t))+\\n\'";\n
      }\n
      if (interpolate) {\n
        source += "\'+\\n((__t=(" + interpolate + "))==null?\'\':__t)+\\n\'";\n
      }\n
      if (evaluate) {\n
        source += "\';\\n" + evaluate + "\\n__p+=\'";\n
      }\n
      index = offset + match.length;\n
      return match;\n
    });\n
    source += "\';\\n";\n
\n
    // If a variable is not specified, place data values in local scope.\n
    if (!settings.variable) source = \'with(obj||{}){\\n\' + source + \'}\\n\';\n
\n
    source = "var __t,__p=\'\',__j=Array.prototype.join," +\n
      "print=function(){__p+=__j.call(arguments,\'\');};\\n" +\n
      source + "return __p;\\n";\n
\n
    try {\n
      render = new Function(settings.variable || \'obj\', \'_\', source);\n
    } catch (e) {\n
      e.source = source;\n
      throw e;\n
    }\n
\n
    if (data) return render(data, _);\n
    var template = function(data) {\n
      return render.call(this, data, _);\n
    };\n
\n
    // Provide the compiled function source as a convenience for precompilation.\n
    template.source = \'function(\' + (settings.variable || \'obj\') + \'){\\n\' + source + \'}\';\n
\n
    return template;\n
  };\n
\n
  // Add a "chain" function, which will delegate to the wrapper.\n
  _.chain = function(obj) {\n
    return _(obj).chain();\n
  };\n
\n
  // OOP\n
  // ---------------\n
  // If Underscore is called as a function, it returns a wrapped object that\n
  // can be used OO-style. This wrapper holds altered versions of all the\n
  // underscore functions. Wrapped objects may be chained.\n
\n
  // Helper function to continue chaining intermediate results.\n
  var result = function(obj) {\n
    return this._chain ? _(obj).chain() : obj;\n
  };\n
\n
  // Add all of the Underscore functions to the wrapper object.\n
  _.mixin(_);\n
\n
  // Add all mutator Array functions to the wrapper.\n
  each([\'pop\', \'push\', \'reverse\', \'shift\', \'sort\', \'splice\', \'unshift\'], function(name) {\n
    var method = ArrayProto[name];\n
    _.prototype[name] = function() {\n
      var obj = this._wrapped;\n
      method.apply(obj, arguments);\n
      if ((name == \'shift\' || name == \'splice\') && obj.length === 0) delete obj[0];\n
      return result.call(this, obj);\n
    };\n
  });\n
\n
  // Add all accessor Array functions to the wrapper.\n
  each([\'concat\', \'join\', \'slice\'], function(name) {\n
    var method = ArrayProto[name];\n
    _.prototype[name] = function() {\n
      return result.call(this, method.apply(this._wrapped, arguments));\n
    };\n
  });\n
\n
  _.extend(_.prototype, {\n
\n
    // Start chaining a wrapped Underscore object.\n
    chain: function() {\n
      this._chain = true;\n
      return this;\n
    },\n
\n
    // Extracts the result from a wrapped and chained object.\n
    value: function() {\n
      return this._wrapped;\n
    }\n
\n
  });\n
\n
}).call(this);\n
\n
define("underscore", (function (global) {\n
    return function () {\n
        var ret, fn;\n
        return ret || global._;\n
    };\n
}(this)));\n
\n
/*!\n
 * jQuery JavaScript Library v2.0.3\n
 * http://jquery.com/\n
 *\n
 * Includes Sizzle.js\n
 * http://sizzlejs.com/\n
 *\n
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors\n
 * Released under the MIT license\n
 * http://jquery.org/license\n
 *\n
 * Date: 2013-07-03T13:30Z\n
 */\n
(function( window, undefined ) {\n
\n
// Can\'t do this because several apps including ASP.NET trace\n
// the stack via arguments.caller.callee and Firefox dies if\n
// you try to trace through "use strict" call chains. (#13335)\n
// Support: Firefox 18+\n
//"use strict";\n
var\n
\t// A central reference to the root jQuery(document)\n
\trootjQuery,\n
\n
\t// The deferred used on DOM ready\n
\treadyList,\n
\n
\t// Support: IE9\n
\t// For `typeof xmlNode.method` instead of `xmlNode.method !== undefined`\n
\tcore_strundefined = typeof undefined,\n
\n
\t// Use the correct document accordingly with window argument (sandbox)\n
\tlocation = window.location,\n
\tdocument = window.document,\n
\tdocElem = document.documentElement,\n
\n
\t// Map over jQuery in case of overwrite\n
\t_jQuery = window.jQuery,\n
\n
\t// Map over the $ in case of overwrite\n
\t_$ = window.$,\n
\n
\t// [[Class]] -> type pairs\n
\tclass2type = {},\n
\n
\t// List of deleted data cache ids, so we can reuse them\n
\tcore_deletedIds = [],\n
\n
\tcore_version = "2.0.3",\n
\n
\t// Save a reference to some core methods\n
\tcore_concat = core_deletedIds.concat,\n
\tcore_push = core_deletedIds.push,\n
\tcore_slice = core_deletedIds.slice,\n
\tcore_indexOf = core_deletedIds.indexOf,\n
\tcore_toString = class2type.toString,\n
\tcore_hasOwn = class2type.hasOwnProperty,\n
\tcore_trim = core_version.trim,\n
\n
\t// Define a local copy of jQuery\n
\tjQuery = function( selector, context ) {\n
\t\t// The jQuery object is actually just the init constructor \'enhanced\'\n
\t\treturn new jQuery.fn.init( selector, context, rootjQuery );\n
\t},\n
\n
\t// Used for matching numbers\n
\tcore_pnum = /[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,\n
\n
\t// Used for splitting on whitespace\n
\tcore_rnotwhite = /\\S+/g,\n
\n
\t// A simple way to check for HTML strings\n
\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n
\t// Strict HTML recognition (#11290: must start with <)\n
\trquickExpr = /^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,\n
\n
\t// Match a standalone tag\n
\trsingleTag = /^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,\n
\n
\t// Matches dashed string for camelizing\n
\trmsPrefix = /^-ms-/,\n
\trdashAlpha = /-([\\da-z])/gi,\n
\n
\t// Used by jQuery.camelCase as callback to replace()\n
\tfcamelCase = function( all, letter ) {\n
\t\treturn letter.toUpperCase();\n
\t},\n
\n
\t// The ready event handler and self cleanup method\n
\tcompleted = function() {\n
\t\tdocument.removeEventListener( "DOMContentLoaded", completed, false );\n
\t\twindow.removeEventListener( "load", completed, false );\n
\t\tjQuery.ready();\n
\t};\n
\n
jQuery.fn = jQuery.prototype = {\n
\t// The current version of jQuery being used\n
\tjquery: core_version,\n
\n
\tconstructor: jQuery,\n
\tinit: function( selector, context, rootjQuery ) {\n
\t\tvar match, elem;\n
\n
\t\t// HANDLE: $(""), $(null), $(undefined), $(false)\n
\t\tif ( !selector ) {\n
\t\t\treturn this;\n
\t\t}\n
\n
\t\t// Handle HTML strings\n
\t\tif ( typeof selector === "string" ) {\n
\t\t\tif ( selector.charAt(0) === "<" && selector.charAt( selector.length - 1 ) === ">" && selector.length >= 3 ) {\n
\t\t\t\t// Assume that strings that start and end with <> are HTML and skip the regex check\n
\t\t\t\tmatch = [ null, selector, null ];\n
\n
\t\t\t} else {\n
\t\t\t\tmatch = rquickExpr.exec( selector );\n
\t\t\t}\n
\n
\t\t\t// Match html or make sure no context is specified for #id\n
\t\t\tif ( match && (match[1] || !context) ) {\n
\n
\t\t\t\t// HANDLE: $(html) -> $(array)\n
\t\t\t\tif ( match[1] ) {\n
\t\t\t\t\tcontext = context instanceof jQuery ? context[0] : context;\n
\n
\t\t\t\t\t// scripts is true for back-compat\n
\t\t\t\t\tjQuery.merge( this, jQuery.parseHTML(\n
\t\t\t\t\t\tmatch[1],\n
\t\t\t\t\t\tcontext && context.nodeType ? context.ownerDocument || context : document,\n
\t\t\t\t\t\ttrue\n
\t\t\t\t\t) );\n
\n
\t\t\t\t\t// HANDLE: $(html, props)\n
\t\t\t\t\tif ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {\n
\t\t\t\t\t\tfor ( match in context ) {\n
\t\t\t\t\t\t\t// Properties of context are called as methods if possible\n
\t\t\t\t\t\t\tif ( jQuery.isFunction( this[ match ] ) ) {\n
\t\t\t\t\t\t\t\tthis[ match ]( context[ match ] );\n
\n
\t\t\t\t\t\t\t// ...and otherwise set as attributes\n
\t\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t\tthis.attr( match, context[ match ] );\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\n
\t\t\t\t\treturn this;\n
\n
\t\t\t\t// HANDLE: $(#id)\n
\t\t\t\t} else {\n
\t\t\t\t\telem = document.getElementById( match[2] );\n
\n
\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n
\t\t\t\t\t// nodes that are no longer in the document #6963\n
\t\t\t\t\tif ( elem && elem.parentNode ) {\n
\t\t\t\t\t\t// Inject the element directly into the jQuery object\n
\t\t\t\t\t\tthis.length = 1;\n
\t\t\t\t\t\tthis[0] = elem;\n
\t\t\t\t\t}\n
\n
\t\t\t\t\tthis.context = document;\n
\t\t\t\t\tthis.selector = selector;\n
\t\t\t\t\treturn this;\n
\t\t\t\t}\n
\n
\t\t\t// HANDLE: $(expr, $(...))\n
\t\t\t} else if ( !context || context.jquery ) {\n
\t\t\t\treturn ( context || rootjQuery ).find( selector );\n
\n
\t\t\t// HANDLE: $(expr, context)\n
\t\t\t// (which is just equivalent to: $(context).find(expr)\n
\t\t\t} else {\n
\t\t\t\treturn this.constructor( context ).find( selector );\n
\t\t\t}\n
\n
\t\t// HANDLE: $(DOMElement)\n
\t\t} else if ( selector.nodeType ) {\n
\t\t\tthis.context = this[0] = selector;\n
\t\t\tthis.length = 1;\n
\t\t\treturn this;\n
\n
\t\t// HANDLE: $(function)\n
\t\t// Shortcut for document ready\n
\t\t} else if ( jQuery.isFunction( selector ) ) {\n
\t\t\treturn rootjQuery.ready( selector );\n
\t\t}\n
\n
\t\tif ( selector.selector !== undefined ) {\n
\t\t\tthis.selector = selector.selector;\n
\t\t\tthis.context = selector.context;\n
\t\t}\n
\n
\t\treturn jQuery.makeArray( selector, this );\n
\t},\n
\n
\t// Start with an empty selector\n
\tselector: "",\n
\n
\t// The default length of a jQuery object is 0\n
\tlength: 0,\n
\n
\ttoArray: function() {\n
\t\treturn core_slice.call( this );\n
\t},\n
\n
\t// Get the Nth element in the matched element set OR\n
\t// Get the whole matched element set as a clean array\n
\tget: function( num ) {\n
\t\treturn num == null ?\n
\n
\t\t\t// Return a \'clean\' array\n
\t\t\tthis.toArray() :\n
\n
\t\t\t// Return just the object\n
\t\t\t( num < 0 ? this[ this.length + num ] : this[ num ] );\n
\t},\n
\n
\t// Take an array of elements and push it onto the stack\n
\t// (returning the new matched element set)\n
\tpushStack: function( elems ) {\n
\n
\t\t// Build a new jQuery matched element set\n
\t\tvar ret = jQuery.merge( this.constructor(), elems );\n
\n
\t\t// Add the old object onto the stack (as a reference)\n
\t\tret.prevObject = this;\n
\t\tret.context = this.context;\n
\n
\t\t// Return the newly-formed element set\n
\t\treturn ret;\n
\t},\n
\n
\t// Execute a callback for every element in the matched set.\n
\t// (You can seed the arguments with an array of args, but this is\n
\t// only used internally.)\n
\teach: function( callback, args ) {\n
\t\treturn jQuery.each( this, callback, args );\n
\t},\n
\n
\tready: function( fn ) {\n
\t\t// Add the callback\n
\t\tjQuery.ready.promise().done( fn );\n
\n
\t\treturn this;\n
\t},\n
\n
\tslice: function() {\n
\t\treturn this.pushStack( core_slice.apply( this, arguments ) );\n
\t},\n
\n
\tfirst: function() {\n
\t\treturn this.eq( 0 );\n
\t},\n
\n
\tlast: function() {\n
\t\treturn this.eq( -1 );\n
\t},\n
\n
\teq: function( i ) {\n
\t\tvar len = this.length,\n
\t\t\tj = +i + ( i < 0 ? len : 0 );\n
\t\treturn this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );\n
\t},\n
\n
\tmap: function( callback ) {\n
\t\treturn this.pushStack( jQuery.map(this, function( elem, i ) {\n
\t\t\treturn callback.call( elem, i, elem );\n
\t\t}));\n
\t},\n
\n
\tend: function() {\n
\t\treturn this.prevObject || this.constructor(null);\n
\t},\n
\n
\t// For internal use only.\n
\t// Behaves like an Array\'s method, not like a jQuery method.\n
\tpush: core_push,\n
\tsort: [].sort,\n
\tsplice: [].splice\n
};\n
\n
// Give the init function the jQuery prototype for later instantiation\n
jQuery.fn.init.prototype = jQuery.fn;\n
\n
jQuery.extend = jQuery.fn.extend = function() {\n
\tvar options, name, src, copy, copyIsArray, clone,\n
\t\ttarget = arguments[0] || {},\n
\t\ti = 1,\n
\t\tlength = arguments.length,\n
\t\tdeep = false;\n
\n
\t// Handle a deep copy situation\n
\tif ( typeof target === "boolean" ) {\n
\t\tdeep = target;\n
\t\ttarget = arguments[1] || {};\n
\t\t// skip the boolean and the target\n
\t\ti = 2;\n
\t}\n
\n
\t// Handle case when target is a string or something (possible in deep copy)\n
\tif ( typeof target !== "object" && !jQuery.isFunction(target) ) {\n
\t\ttarget = {};\n
\t}\n
\n
\t// extend jQuery itself if only one argument is passed\n
\tif ( length === i ) {\n
\t\ttarget = this;\n
\t\t--i;\n
\t}\n
\n
\tfor ( ; i < length; i++ ) {\n
\t\t// Only deal with non-null/undefined values\n
\t\tif ( (options = arguments[ i ]) != null ) {\n
\t\t\t// Extend the base object\n
\t\t\tfor ( name in options ) {\n
\t\t\t\tsrc = target[ name ];\n
\t\t\t\tcopy = options[ name ];\n
\n
\t\t\t\t// Prevent never-ending loop\n
\t\t\t\tif ( target === copy ) {\n
\t\t\t\t\tcontinue;\n
\t\t\t\t}\n
\n
\t\t\t\t// Recurse if we\'re merging plain objects or arrays\n
\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {\n
\t\t\t\t\tif ( copyIsArray ) {\n
\t\t\t\t\t\tcopyIsArray = false;\n
\t\t\t\t\t\tclone = src && jQuery.isArray(src) ? src : [];\n
\n
\t\t\t\t\t} else {\n
\t\t\t\t\t\tclone = src && jQuery.isPlainObject(src) ? src : {};\n
\t\t\t\t\t}\n
\n
\t\t\t\t\t// Never move original objects, clone them\n
\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\n
\n
\t\t\t\t// Don\'t bring in undefined values\n
\t\t\t\t} else if ( copy !== undefined ) {\n
\t\t\t\t\ttarget[ name ] = copy;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\t// Return the modified object\n
\treturn target;\n
};\n
\n
jQuery.extend({\n
\t// Unique for each copy of jQuery on the page\n
\texpando: "jQuery" + ( core_version + Math.random() ).replace( /\\D/g, "" ),\n
\n
\tnoConflict: function( deep ) {\n
\t\tif ( window.$ === jQuery ) {\n
\t\t\twindow.$ = _$;\n
\t\t}\n
\n
\t\tif ( deep && window.jQuery === jQuery ) {\n
\t\t\twindow.jQuery = _jQuery;\n
\t\t}\n
\n
\t\treturn jQuery;\n
\t},\n
\n
\t// Is the DOM ready to be used? Set to true once it occurs.\n
\tisReady: false,\n
\n
\t// A counter to track how many items to wait for before\n
\t// the ready event fires. See #6781\n
\treadyWait: 1,\n
\n
\t// Hold (or release) the ready event\n
\tholdReady: function( hold ) {\n
\t\tif ( hold ) {\n
\t\t\tjQuery.readyWait++;\n
\t\t} else {\n
\t\t\tjQuery.ready( true );\n
\t\t}\n
\t},\n
\n
\t// Handle when the DOM is ready\n
\tready: function( wait ) {\n
\n
\t\t// Abort if there are pending holds or we\'re already ready\n
\t\tif ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Remember that the DOM is ready\n
\t\tjQuery.isReady = true;\n
\n
\t\t// If a normal DOM Ready event fired, decrement, and wait if need be\n
\t\tif ( wait !== true && --jQuery.readyWait > 0 ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// If there are functions bound, to execute\n
\t\treadyList.resolveWith( document, [ jQuery ] );\n
\n
\t\t// Trigger any bound ready events\n
\t\tif ( jQuery.fn.trigger ) {\n
\t\t\tjQuery( document ).trigger("ready").off("ready");\n
\t\t}\n
\t},\n
\n
\t// See test/unit/core.js for details concerning isFunction.\n
\t// Since version 1.3, DOM methods and functions like alert\n
\t// aren\'t supported. They return false on IE (#2968).\n
\tisFunction: function( obj ) {\n
\t\treturn jQuery.type(obj) === "function";\n
\t},\n
\n
\tisArray: Array.isArray,\n
\n
\tisWindow: function( obj ) {\n
\t\treturn obj != null && obj === obj.window;\n
\t},\n
\n
\tisNumeric: function( obj ) {\n
\t\treturn !isNaN( parseFloat(obj) ) && isFinite( obj );\n
\t},\n
\n
\ttype: function( obj ) {\n
\t\tif ( obj == null ) {\n
\t\t\treturn String( obj );\n
\t\t}\n
\t\t// Support: Safari <= 5.1 (functionish RegExp)\n
\t\treturn typeof obj === "object" || typeof obj === "function" ?\n
\t\t\tclass2type[ core_toString.call(obj) ] || "object" :\n
\t\t\ttypeof obj;\n
\t},\n
\n
\tisPlainObject: function( obj ) {\n
\t\t// Not plain objects:\n
\t\t// - Any object or value whose internal [[Class]] property is not "[object Object]"\n
\t\t// - DOM nodes\n
\t\t// - window\n
\t\tif ( jQuery.type( obj ) !== "object" || obj.nodeType || jQuery.isWindow( obj ) ) {\n
\t\t\treturn false;\n
\t\t}\n
\n
\t\t// Support: Firefox <20\n
\t\t// The try/catch suppresses exceptions thrown when attempting to access\n
\t\t// the "constructor" property of certain host objects, ie. |window.location|\n
\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=814622\n
\t\ttry {\n
\t\t\tif ( obj.constructor &&\n
\t\t\t\t\t!core_hasOwn.call( obj.constructor.prototype, "isPrototypeOf" ) ) {\n
\t\t\t\treturn false;\n
\t\t\t}\n
\t\t} catch ( e ) {\n
\t\t\treturn false;\n
\t\t}\n
\n
\t\t// If the function hasn\'t returned already, we\'re confident that\n
\t\t// |obj| is a plain object, created by {} or constructed with new Object\n
\t\treturn true;\n
\t},\n
\n
\tisEmptyObject: function( obj ) {\n
\t\tvar name;\n
\t\tfor ( name in obj ) {\n
\t\t\treturn false;\n
\t\t}\n
\t\treturn true;\n
\t},\n
\n
\terror: function( msg ) {\n
\t\tthrow new Error( msg );\n
\t},\n
\n
\t// data: string of html\n
\t// context (optional): If specified, the fragment will be created in this context, defaults to document\n
\t// keepScripts (optional): If true, will include scripts passed in the html string\n
\tparseHTML: function( data, context, keepScripts ) {\n
\t\tif ( !data || typeof data !== "string" ) {\n
\t\t\treturn null;\n
\t\t}\n
\t\tif ( typeof context === "boolean" ) {\n
\t\t\tkeepScripts = context;\n
\t\t\tcontext = false;\n
\t\t}\n
\t\tcontext = context || document;\n
\n
\t\tvar parsed = rsingleTag.exec( data ),\n
\t\t\tscripts = !keepScripts && [];\n
\n
\t\t// Single tag\n
\t\tif ( parsed ) {\n
\t\t\treturn [ context.createElement( parsed[1] ) ];\n
\t\t}\n
\n
\t\tparsed = jQuery.buildFragment( [ data ], context, scripts );\n
\n
\t\tif ( scripts ) {\n
\t\t\tjQuery( scripts ).remove();\n
\t\t}\n
\n
\t\treturn jQuery.merge( [], parsed.childNodes );\n
\t},\n
\n
\tparseJSON: JSON.parse,\n
\n
\t// Cross-browser xml parsing\n
\tparseXML: function( data ) {\n
\t\tvar xml, tmp;\n
\t\tif ( !data || typeof data !== "string" ) {\n
\t\t\treturn null;\n
\t\t}\n
\n
\t\t// Support: IE9\n
\t\ttry {\n
\t\t\ttmp = new DOMParser();\n
\t\t\txml = tmp.parseFromString( data , "text/xml" );\n
\t\t} catch ( e ) {\n
\t\t\txml = undefined;\n
\t\t}\n
\n
\t\tif ( !xml || xml.getElementsByTagName( "parsererror" ).length ) {\n
\t\t\tjQuery.error( "Invalid XML: " + data );\n
\t\t}\n
\t\treturn xml;\n
\t},\n
\n
\tnoop: function() {},\n
\n
\t// Evaluates a script in a global context\n
\tglobalEval: function( code ) {\n
\t\tvar script,\n
\t\t\t\tindirect = eval;\n
\n
\t\tcode = jQuery.trim( code );\n
\n
\t\tif ( code ) {\n
\t\t\t// If the code includes a valid, prologue position\n
\t\t\t// strict mode pragma, execute code by injecting a\n
\t\t\t// script tag into the document.\n
\t\t\tif ( code.indexOf("use strict") === 1 ) {\n
\t\t\t\tscript = document.createElement("script");\n
\t\t\t\tscript.text = code;\n
\t\t\t\tdocument.head.appendChild( script ).parentNode.removeChild( script );\n
\t\t\t} else {\n
\t\t\t// Otherwise, avoid the DOM node creation, insertion\n
\t\t\t// and removal by using an indirect global eval\n
\t\t\t\tindirect( code );\n
\t\t\t}\n
\t\t}\n
\t},\n
\n
\t// Convert dashed to camelCase; used by the css and data modules\n
\t// Microsoft forgot to hump their vendor prefix (#9572)\n
\tcamelCase: function( string ) {\n
\t\treturn string.replace( rmsPrefix, "ms-" ).replace( rdashAlpha, fcamelCase );\n
\t},\n
\n
\tnodeName: function( elem, name ) {\n
\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\n
\t},\n
\n
\t// args is for internal usage only\n
\teach: function( obj, callback, args ) {\n
\t\tvar value,\n
\t\t\ti = 0,\n
\t\t\tlength = obj.length,\n
\t\t\tisArray = isArraylike( obj );\n
\n
\t\tif ( args ) {\n
\t\t\tif ( isArray ) {\n
\t\t\t\tfor ( ; i < length; i++ ) {\n
\t\t\t\t\tvalue = callback.apply( obj[ i ], args );\n
\n
\t\t\t\t\tif ( value === false ) {\n
\t\t\t\t\t\tbreak;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t} else {\n
\t\t\t\tfor ( i in obj ) {\n
\t\t\t\t\tvalue = callback.apply( obj[ i ], args );\n
\n
\t\t\t\t\tif ( value === false ) {\n
\t\t\t\t\t\tbreak;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t// A special, fast, case for the most common use of each\n
\t\t} else {\n
\t\t\tif ( isArray ) {\n
\t\t\t\tfor ( ; i < length; i++ ) {\n
\t\t\t\t\tvalue = callback.call( obj[ i ], i, obj[ i ] );\n
\n
\t\t\t\t\tif ( value === false ) {\n
\t\t\t\t\t\tbreak;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t} else {\n
\t\t\t\tfor ( i in obj ) {\n
\t\t\t\t\tvalue = callback.call( obj[ i ], i, obj[ i ] );\n
\n
\t\t\t\t\tif ( value === false ) {\n
\t\t\t\t\t\tbreak;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn obj;\n
\t},\n
\n
\ttrim: function( text ) {\n
\t\treturn text == null ? "" : core_trim.call( text );\n
\t},\n
\n
\t// results is for internal usage only\n
\tmakeArray: function( arr, results ) {\n
\t\tvar ret = results || [];\n
\n
\t\tif ( arr != null ) {\n
\t\t\tif ( isArraylike( Object(arr) ) ) {\n
\t\t\t\tjQuery.merge( ret,\n
\t\t\t\t\ttypeof arr === "string" ?\n
\t\t\t\t\t[ arr ] : arr\n
\t\t\t\t);\n
\t\t\t} else {\n
\t\t\t\tcore_push.call( ret, arr );\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn ret;\n
\t},\n
\n
\tinArray: function( elem, arr, i ) {\n
\t\treturn arr == null ? -1 : core_indexOf.call( arr, elem, i );\n
\t},\n
\n
\tmerge: function( first, second ) {\n
\t\tvar l = second.length,\n
\t\t\ti = first.length,\n
\t\t\tj = 0;\n
\n
\t\tif ( typeof l === "number" ) {\n
\t\t\tfor ( ; j < l; j++ ) {\n
\t\t\t\tfirst[ i++ ] = second[ j ];\n
\t\t\t}\n
\t\t} else {\n
\t\t\twhile ( second[j] !== undefined ) {\n
\t\t\t\tfirst[ i++ ] = second[ j++ ];\n
\t\t\t}\n
\t\t}\n
\n
\t\tfirst.length = i;\n
\n
\t\treturn first;\n
\t},\n
\n
\tgrep: function( elems, callback, inv ) {\n
\t\tvar retVal,\n
\t\t\tret = [],\n
\t\t\ti = 0,\n
\t\t\tlength = elems.length;\n
\t\tinv = !!inv;\n
\n
\t\t// Go through the array, only saving the items\n
\t\t// that pass the validator function\n
\t\tfor ( ; i < length; i++ ) {\n
\t\t\tretVal = !!callback( elems[ i ], i );\n
\t\t\tif ( inv !== retVal ) {\n
\t\t\t\tret.push( elems[ i ] );\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn ret;\n
\t},\n
\n
\t// arg is for internal usage only\n
\tmap: function( elems, callback, arg ) {\n
\t\tvar value,\n
\t\t\ti = 0,\n
\t\t\tlength = elems.length,\n
\t\t\tisArray = isArraylike( elems ),\n
\t\t\tret = [];\n
\n
\t\t// Go through the array, translating each of the items to their\n
\t\tif ( isArray ) {\n
\t\t\tfor ( ; i < length; i++ ) {\n
\t\t\t\tvalue = callback( elems[ i ], i, arg );\n
\n
\t\t\t\tif ( value != null ) {\n
\t\t\t\t\tret[ ret.length ] = value;\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t// Go through every key on the object,\n
\t\t} else {\n
\t\t\tfor ( i in elems ) {\n
\t\t\t\tvalue = callback( elems[ i ], i, arg );\n
\n
\t\t\t\tif ( value != null ) {\n
\t\t\t\t\tret[ ret.length ] = value;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Flatten any nested arrays\n
\t\treturn core_concat.apply( [], ret );\n
\t},\n
\n
\t// A global GUID counter for objects\n
\tguid: 1,\n
\n
\t// Bind a function to a context, optionally partially applying any\n
\t// arguments.\n
\tproxy: function( fn, context ) {\n
\t\tvar tmp, args, proxy;\n
\n
\t\tif ( typeof context === "string" ) {\n
\t\t\ttmp = fn[ context ];\n
\t\t\tcontext = fn;\n
\t\t\tfn = tmp;\n
\t\t}\n
\n
\t\t// Quick check to determine if target is callable, in the spec\n
\t\t// this throws a TypeError, but we will just return undefined.\n
\t\tif ( !jQuery.isFunction( fn ) ) {\n
\t\t\treturn undefined;\n
\t\t}\n
\n
\t\t// Simulated bind\n
\t\targs = core_slice.call( arguments, 2 );\n
\t\tproxy = function() {\n
\t\t\treturn fn.apply( context || this, args.concat( core_slice.call( arguments ) ) );\n
\t\t};\n
\n
\t\t// Set the guid of unique handler to the same of original handler, so it can be removed\n
\t\tproxy.guid = fn.guid = fn.guid || jQuery.guid++;\n
\n
\t\treturn proxy;\n
\t},\n
\n
\t// Multifunctional method to get and set values of a collection\n
\t// The value/s can optionally be executed if it\'s a function\n
\taccess: function( elems, fn, key, value, chainable, emptyGet, raw ) {\n
\t\tvar i = 0,\n
\t\t\tlength = elems.length,\n
\t\t\tbulk = key == null;\n
\n
\t\t// Sets many values\n
\t\tif ( jQuery.type( key ) === "object" ) {\n
\t\t\tchainable = true;\n
\t\t\tfor ( i in key ) {\n
\t\t\t\tjQuery.access( elems, fn, i, key[i], true, emptyGet, raw );\n
\t\t\t}\n
\n
\t\t// Sets one value\n
\t\t} else if ( value !== undefined ) {\n
\t\t\tchainable = true;\n
\n
\t\t\tif ( !jQuery.isFunction( value ) ) {\n
\t\t\t\traw = true;\n
\t\t\t}\n
\n
\t\t\tif ( bulk ) {\n
\t\t\t\t// Bulk operations run against the entire set\n
\t\t\t\tif ( raw ) {\n
\t\t\t\t\tfn.call( elems, value );\n
\t\t\t\t\tfn = null;\n
\n
\t\t\t\t// ...except when executing function values\n
\t\t\t\t} else {\n
\t\t\t\t\tbulk = fn;\n
\t\t\t\t\tfn = function( elem, key, value ) {\n
\t\t\t\t\t\treturn bulk.call( jQuery( elem ), value );\n
\t\t\t\t\t};\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\tif ( fn ) {\n
\t\t\t\tfor ( ; i < length; i++ ) {\n
\t\t\t\t\tfn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn chainable ?\n
\t\t\telems :\n
\n
\t\t\t// Gets\n
\t\t\tbulk ?\n
\t\t\t\tfn.call( elems ) :\n
\t\t\t\tlength ? fn( elems[0], key ) : emptyGet;\n
\t},\n
\n
\tnow: Date.now,\n
\n
\t// A method for quickly swapping in/out CSS properties to get correct calculations.\n
\t// Note: this method belongs to the css module but it\'s needed here for the support module.\n
\t// If support gets modularized, this method should be moved back to the css module.\n
\tswap: function( elem, options, callback, args ) {\n
\t\tvar ret, name,\n
\t\t\told = {};\n
\n
\t\t// Remember the old values, and insert the new ones\n
\t\tfor ( name in options ) {\n
\t\t\told[ name ] = elem.style[ name ];\n
\t\t\telem.style[ name ] = options[ name ];\n
\t\t}\n
\n
\t\tret = callback.apply( elem, args || [] );\n
\n
\t\t// Revert the old values\n
\t\tfor ( name in options ) {\n
\t\t\telem.style[ name ] = old[ name ];\n
\t\t}\n
\n
\t\treturn ret;\n
\t}\n
});\n
\n
jQuery.ready.promise = function( obj ) {\n
\tif ( !readyList ) {\n
\n
\t\treadyList = jQuery.Deferred();\n
\n
\t\t// Catch cases where $(document).ready() is called after the browser event has already occurred.\n
\t\t// we once tried to use readyState "interactive" here, but it caused issues like the one\n
\t\t// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15\n
\t\tif ( document.readyState === "complete" ) {\n
\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n
\t\t\tsetTimeout( jQuery.ready );\n
\n
\t\t} else {\n
\n
\t\t\t// Use the handy event callback\n
\t\t\tdocument.addEventListener( "DOMContentLoaded", completed, false );\n
\n
\t\t\t// A fallback to window.onload, that will always work\n
\t\t\twindow.addEventListener( "load", completed, false );\n
\t\t}\n
\t}\n
\treturn readyList.promise( obj );\n
};\n
\n
// Populate the class2type map\n
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(i, name) {\n
\tclass2type[ "[object " + name + "]" ] = name.toLowerCase();\n
});\n
\n
function isArraylike( obj ) {\n
\tvar length = obj.length,\n
\t\ttype = jQuery.type( obj );\n
\n
\tif ( jQuery.isWindow( obj ) ) {\n
\t\treturn false;\n
\t}\n
\n
\tif ( obj.nodeType === 1 && length ) {\n
\t\treturn true;\n
\t}\n
\n
\treturn type === "array" || type !== "function" &&\n
\t\t( length === 0 ||\n
\t\ttypeof length === "number" && length > 0 && ( length - 1 ) in obj );\n
}\n
\n
// All jQuery objects should point back to these\n
rootjQuery = jQuery(document);\n
/*!\n
 * Sizzle CSS Selector Engine v1.9.4-pre\n
 * http://sizzlejs.com/\n
 *\n
 * Copyright 2013 jQuery Foundation, Inc. and other contributors\n
 * Released under the MIT license\n
 * http://jquery.org/license\n
 *\n
 * Date: 2013-06-03\n
 */\n
(function( window, undefined ) {\n
\n
var i,\n
\tsupport,\n
\tcachedruns,\n
\tExpr,\n
\tgetText,\n
\tisXML,\n
\tcompile,\n
\toutermostContext,\n
\tsortInput,\n
\n
\t// Local document vars\n
\tsetDocument,\n
\tdocument,\n
\tdocElem,\n
\tdocumentIsHTML,\n
\trbuggyQSA,\n
\trbuggyMatches,\n
\tmatches,\n
\tcontains,\n
\n
\t// Instance-specific data\n
\texpando = "sizzle" + -(new Date()),\n
\tpreferredDoc = window.document,\n
\tdirruns = 0,\n
\tdone = 0,\n
\tclassCache = createCache(),\n
\ttokenCache = createCache(),\n
\tcompilerCache = createCache(),\n
\thasDuplicate = false,\n
\tsortOrder = function( a, b ) {\n
\t\tif ( a === b ) {\n
\t\t\thasDuplicate = true;\n
\t\t\treturn 0;\n
\t\t}\n
\t\treturn 0;\n
\t},\n
\n
\t// General-purpose constants\n
\tstrundefined = typeof undefined,\n
\tMAX_NEGATIVE = 1 << 31,\n
\n
\t// Instance methods\n
\thasOwn = ({}).hasOwnProperty,\n
\tarr = [],\n
\tpop = arr.pop,\n
\tpush_native = arr.push,\n
\tpush = arr.push,\n
\tslice = arr.slice,\n
\t// Use a stripped-down indexOf if we can\'t use a native one\n
\tindexOf = arr.indexOf || function( elem ) {\n
\t\tvar i = 0,\n
\t\t\tlen = this.length;\n
\t\tfor ( ; i < len; i++ ) {\n
\t\t\tif ( this[i] === elem ) {\n
\t\t\t\treturn i;\n
\t\t\t}\n
\t\t}\n
\t\treturn -1;\n
\t},\n
\n
\tbooleans = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",\n
\n
\t// Regular expressions\n
\n
\t// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace\n
\twhitespace = "[\\\\x20\\\\t\\\\r\\\\n\\\\f]",\n
\t// http://www.w3.org/TR/css3-syntax/#characters\n
\tcharacterEncoding = "(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+",\n
\n
\t// Loosely modeled on CSS identifier characters\n
\t// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors\n
\t// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\n
\tidentifier = characterEncoding.replace( "w", "w#" ),\n
\n
\t// Acceptable operators http://www.w3.org/TR/selectors/#attribute-selectors\n
\tattributes = "\\\\[" + whitespace + "*(" + characterEncoding + ")" + whitespace +\n
\t\t"*(?:([*^$|!~]?=)" + whitespace + "*(?:([\'\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(" + identifier + ")|)|)" + whitespace + "*\\\\]",\n
\n
\t// Prefer arguments quoted,\n
\t//   then not containing pseudos/brackets,\n
\t//   then attribute selectors/non-parenthetical expressions,\n
\t//   then anything else\n
\t// These preferences are here to reduce the number of selectors\n
\t//   needing tokenize in the PSEUDO preFilter\n
\tpseudos = ":(" + characterEncoding + ")(?:\\\\((([\'\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|" + attributes.replace( 3, 8 ) + ")*)|.*)\\\\)|)",\n
\n
\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n
\trtrim = new RegExp( "^" + whitespace + "+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)" + whitespace + "+$", "g" ),\n
\n
\trcomma = new RegExp( "^" + whitespace + "*," + whitespace + "*" ),\n
\trcombinators = new RegExp( "^" + whitespace + "*([>+~]|" + whitespace + ")" + whitespace + "*" ),\n
\n
\trsibling = new RegExp( whitespace + "*[+~]" ),\n
\trattributeQuotes = new RegExp( "=" + whitespace + "*([^\\\\]\'\\"]*)" + whitespace + "*\\\\]", "g" ),\n
\n
\trpseudo = new RegExp( pseudos ),\n
\tridentifier = new RegExp( "^" + identifier + "$" ),\n
\n
\tmatchExpr = {\n
\t\t"ID": new RegExp( "^#(" + characterEncoding + ")" ),\n
\t\t"CLASS": new RegExp( "^\\\\.(" + characterEncoding + ")" ),\n
\t\t"TAG": new RegExp( "^(" + characterEncoding.replace( "w", "w*" ) + ")" ),\n
\t\t"ATTR": new RegExp( "^" + attributes ),\n
\t\t"PSEUDO": new RegExp( "^" + pseudos ),\n
\t\t"CHILD": new RegExp( "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(" + whitespace +\n
\t\t\t"*(even|odd|(([+-]|)(\\\\d*)n|)" + whitespace + "*(?:([+-]|)" + whitespace +\n
\t\t\t"*(\\\\d+)|))" + whitespace + "*\\\\)|)", "i" ),\n
\t\t"bool": new RegExp( "^(?:" + booleans + ")$", "i" ),\n
\t\t// For use in libraries implementing .is()\n
\t\t// We use this for POS matching in `select`\n
\t\t"needsContext": new RegExp( "^" + whitespace + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(" +\n
\t\t\twhitespace + "*((?:-\\\\d)?\\\\d*)" + whitespace + "*\\\\)|)(?=[^-]|$)", "i" )\n
\t},\n
\n
\trnative = /^[^{]+\\{\\s*\\[native \\w/,\n
\n
\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\n
\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n
\n
\trinputs = /^(?:input|select|textarea|button)$/i,\n
\trheader = /^h\\d$/i,\n
\n
\trescape = /\'|\\\\/g,\n
\n
\t// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n
\trunescape = new RegExp( "\\\\\\\\([\\\\da-f]{1,6}" + whitespace + "?|(" + whitespace + ")|.)", "ig" ),\n
\tfunescape = function( _, escaped, escapedWhitespace ) {\n
\t\tvar high = "0x" + escaped - 0x10000;\n
\t\t// NaN means non-codepoint\n
\t\t// Support: Firefox\n
\t\t// Workaround erroneous numeric interpretation of +"0x"\n
\t\treturn high !== high || escapedWhitespace ?\n
\t\t\tescaped :\n
\t\t\t// BMP codepoint\n
\t\t\thigh < 0 ?\n
\t\t\t\tString.fromCharCode( high + 0x10000 ) :\n
\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\n
\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n
\t};\n
\n
// Optimize for push.apply( _, NodeList )\n
try {\n
\tpush.apply(\n
\t\t(arr = slice.call( preferredDoc.childNodes )),\n
\t\tpreferredDoc.childNodes\n
\t);\n
\t// Support: Android<4.0\n
\t// Detect silently failing push.apply\n
\tarr[ preferredDoc.childNodes.length ].nodeType;\n
} catch ( e ) {\n
\tpush = { apply: arr.length ?\n
\n
\t\t// Leverage slice if possible\n
\t\tfunction( target, els ) {\n
\t\t\tpush_native.apply( target, slice.call(els) );\n
\t\t} :\n
\n
\t\t// Support: IE<9\n
\t\t// Otherwise append directly\n
\t\tfunction( target, els ) {\n
\t\t\tvar j = target.length,\n
\t\t\t\ti = 0;\n
\t\t\t// Can\'t trust NodeList.length\n
\t\t\twhile ( (target[j++] = els[i++]) ) {}\n
\t\t\ttarget.length = j - 1;\n
\t\t}\n
\t};\n
}\n
\n
function Sizzle( selector, context, results, seed ) {\n
\tvar match, elem, m, nodeType,\n
\t\t// QSA vars\n
\t\ti, groups, old, nid, newContext, newSelector;\n
\n
\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\n
\t\tsetDocument( context );\n
\t}\n
\n
\tcontext = context || document;\n
\tresults = results || [];\n
\n
\tif ( !selector || typeof selector !== "string" ) {\n
\t\treturn results;\n
\t}\n
\n
\tif ( (nodeType = context.nodeType) !== 1 && nodeType !== 9 ) {\n
\t\treturn [];\n
\t}\n
\n
\tif ( documentIsHTML && !seed ) {\n
\n
\t\t// Shortcuts\n
\t\tif ( (match = rquickExpr.exec( selector )) ) {\n
\t\t\t// Speed-up: Sizzle("#ID")\n
\t\t\tif ( (m = match[1]) ) {\n
\t\t\t\tif ( nodeType === 9 ) {\n
\t\t\t\t\telem = context.getElementById( m );\n
\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n
\t\t\t\t\t// nodes that are no longer in the document #6963\n
\t\t\t\t\tif ( elem && elem.parentNode ) {\n
\t\t\t\t\t\t// Handle the case where IE, Opera, and Webkit return items\n
\t\t\t\t\t\t// by name instead of ID\n
\t\t\t\t\t\tif ( elem.id === m ) {\n
\t\t\t\t\t\t\tresults.push( elem );\n
\t\t\t\t\t\t\treturn results;\n
\t\t\t\t\t\t}\n
\t\t\t\t\t} else {\n
\t\t\t\t\t\treturn results;\n
\t\t\t\t\t}\n
\t\t\t\t} else {\n
\t\t\t\t\t// Context is not a document\n
\t\t\t\t\tif ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&\n
\t\t\t\t\t\tcontains( context, elem ) && elem.id === m ) {\n
\t\t\t\t\t\tresults.push( elem );\n
\t\t\t\t\t\treturn results;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t// Speed-up: Sizzle("TAG")\n
\t\t\t} else if ( match[2] ) {\n
\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\n
\t\t\t\treturn results;\n
\n
\t\t\t// Speed-up: Sizzle(".CLASS")\n
\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName && context.getElementsByClassName ) {\n
\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\n
\t\t\t\treturn results;\n
\t\t\t}\n
\t\t}\n
\n
\t\t// QSA path\n
\t\tif ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {\n
\t\t\tnid = old = expando;\n
\t\t\tnewContext = context;\n
\t\t\tnewSelector = nodeType === 9 && selector;\n
\n
\t\t\t// qSA works strangely on Element-rooted queries\n
\t\t\t// We can work around this by specifying an extra ID on the root\n
\t\t\t// and working up from there (Thanks to Andrew Dupont for the technique)\n
\t\t\t// IE 8 doesn\'t work on object elements\n
\t\t\tif ( nodeType === 1 && context.nodeName.toLowerCase() !== "object" ) {\n
\t\t\t\tgroups = tokenize( selector );\n
\n
\t\t\t\tif ( (old = context.getAttribute("id")) ) {\n
\t\t\t\t\tnid = old.replace( rescape, "\\\\$&" );\n
\t\t\t\t} else {\n
\t\t\t\t\tcontext.setAttribute( "id", nid );\n
\t\t\t\t}\n
\t\t\t\tnid = "[id=\'" + nid + "\'] ";\n
\n
\t\t\t\ti = groups.length;\n
\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\tgroups[i] = nid + toSelector( groups[i] );\n
\t\t\t\t}\n
\t\t\t\tnewContext = rsibling.test( selector ) && context.parentNode || context;\n
\t\t\t\tnewSelector = groups.join(",");\n
\t\t\t}\n
\n
\t\t\tif ( newSelector ) {\n
\t\t\t\ttry {\n
\t\t\t\t\tpush.apply( results,\n
\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\n
\t\t\t\t\t);\n
\t\t\t\t\treturn results;\n
\t\t\t\t} catch(qsaError) {\n
\t\t\t\t} finally {\n
\t\t\t\t\tif ( !old ) {\n
\t\t\t\t\t\tcontext.removeAttribute("id");\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\t// All others\n
\treturn select( selector.replace( rtrim, "$1" ), context, results, seed );\n
}\n
\n
/**\n
 * Create key-value caches of limited size\n
 * @returns {Function(string, Object)} Returns the Object data after storing it on itself with\n
 *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n
 *\tdeleting the oldest entry\n
 */\n
function createCache() {\n
\tvar keys = [];\n
\n
\tfunction cache( key, value ) {\n
\t\t// Use (key + " ") to avoid collision with native prototype properties (see Issue #157)\n
\t\tif ( keys.push( key += " " ) > Expr.cacheLength ) {\n
\t\t\t// Only keep the most recent entries\n
\t\t\tdelete cache[ keys.shift() ];\n
\t\t}\n
\t\treturn (cache[ key ] = value);\n
\t}\n
\treturn cache;\n
}\n
\n
/**\n
 * Mark a function for special use by Sizzle\n
 * @param {Function} fn The function to mark\n
 */\n
function markFunction( fn ) {\n
\tfn[ expando ] = true;\n
\treturn fn;\n
}\n
\n
/**\n
 * Support testing using an element\n
 * @param {Function} fn Passed the created div and expects a boolean result\n
 */\n
function assert( fn ) {\n
\tvar div = document.createElement("div");\n
\n
\ttry {\n
\t\treturn !!fn( div );\n
\t} catch (e) {\n
\t\treturn false;\n
\t} finally {\n
\t\t// Remove from its parent by default\n
\t\tif ( div.parentNode ) {\n
\t\t\tdiv.parentNode.removeChild( div );\n
\t\t}\n
\t\t// release memory in IE\n
\t\tdiv = null;\n
\t}\n
}\n
\n
/**\n
 * Adds the same handler for all of the specified attrs\n
 * @param {String} attrs Pipe-separated list of attributes\n
 * @param {Function} handler The method that will be applied\n
 */\n
function addHandle( attrs, handler ) {\n
\tvar arr = attrs.split("|"),\n
\t\ti = attrs.length;\n
\n
\twhile ( i-- ) {\n
\t\tExpr.attrHandle[ arr[i] ] = handler;\n
\t}\n
}\n
\n
/**\n
 * Checks document order of two siblings\n
 * @param {Element} a\n
 * @param {Element} b\n
 * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\n
 */\n
function siblingCheck( a, b ) {\n
\tvar cur = b && a,\n
\t\tdiff = cur && a.nodeType === 1 && b.nodeType === 1 &&\n
\t\t\t( ~b.sourceIndex || MAX_NEGATIVE ) -\n
\t\t\t( ~a.sourceIndex || MAX_NEGATIVE );\n
\n
\t// Use IE sourceIndex if available on both nodes\n
\tif ( diff ) {\n
\t\treturn diff;\n
\t}\n
\n
\t// Check if b follows a\n
\tif ( cur ) {\n
\t\twhile ( (cur = cur.nextSibling) ) {\n
\t\t\tif ( cur === b ) {\n
\t\t\t\treturn -1;\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\treturn a ? 1 : -1;\n
}\n
\n
/**\n
 * Returns a function to use in pseudos for input types\n
 * @param {String} type\n
 */\n
function createInputPseudo( type ) {\n
\treturn function( elem ) {\n
\t\tvar name = elem.nodeName.toLowerCase();\n
\t\treturn name === "input" && elem.type === type;\n
\t};\n
}\n
\n
/**\n
 * Returns a function to use in pseudos for buttons\n
 * @param {String} type\n
 */\n
function createButtonPseudo( type ) {\n
\treturn function( elem ) {\n
\t\tvar name = elem.nodeName.toLowerCase();\n
\t\treturn (name === "input" || name === "button") && elem.type === type;\n
\t};\n
}\n
\n
/**\n
 * Returns a function to use in pseudos for positionals\n
 * @param {Function} fn\n
 */\n
function createPositionalPseudo( fn ) {\n
\treturn markFunction(function( argument ) {\n
\t\targument = +argument;\n
\t\treturn markFunction(function( seed, matches ) {\n
\t\t\tvar j,\n
\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\n
\t\t\t\ti = matchIndexes.length;\n
\n
\t\t\t// Match elements found at the specified indexes\n
\t\t\twhile ( i-- ) {\n
\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\n
\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\n
\t\t\t\t}\n
\t\t\t}\n
\t\t});\n
\t});\n
}\n
\n
/**\n
 * Detect xml\n
 * @param {Element|Object} elem An element or a document\n
 */\n
isXML = Sizzle.isXML = function( elem ) {\n
\t// documentElement is verified for cases where it doesn\'t yet exist\n
\t// (such as loading iframes in IE - #4833)\n
\tvar documentElement = elem && (elem.ownerDocument || elem).documentElement;\n
\treturn documentElement ? documentElement.nodeName !== "HTML" : false;\n
};\n
\n
// Expose support vars for convenience\n
support = Sizzle.support = {};\n
\n
/**\n
 * Sets document-related variables once based on the current document\n
 * @param {Element|Object} [doc] An element or document object to use to set the document\n
 * @returns {Object} Returns the current document\n
 */\n
setDocument = Sizzle.setDocument = function( node ) {\n
\tvar doc = node ? node.ownerDocument || node : preferredDoc,\n
\t\tparent = doc.defaultView;\n
\n
\t// If no document and documentElement is available, return\n
\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\n
\t\treturn document;\n
\t}\n
\n
\t// Set our document\n
\tdocument = doc;\n
\tdocElem = doc.documentElement;\n
\n
\t// Support tests\n
\tdocumentIsHTML = !isXML( doc );\n
\n
\t// Support: IE>8\n
\t// If iframe document is assigned to "document" variable and if iframe has been reloaded,\n
\t// IE will throw "permission denied" error when accessing "document" variable, see jQuery #13936\n
\t// IE6-8 do not support the defaultView property so parent will be undefined\n
\tif ( parent && parent.attachEvent && parent !== parent.top ) {\n
\t\tparent.attachEvent( "onbeforeunload", function() {\n
\t\t\tsetDocument();\n
\t\t});\n
\t}\n
\n
\t/* Attributes\n
\t---------------------------------------------------------------------- */\n
\n
\t// Support: IE<8\n
\t// Verify that getAttribute really returns attributes and not properties (excepting IE8 booleans)\n
\tsupport.attributes = assert(function( div ) {\n
\t\tdiv.className = "i";\n
\t\treturn !div.getAttribute("className");\n
\t});\n
\n
\t/* getElement(s)By*\n
\t---------------------------------------------------------------------- */\n
\n
\t// Check if getElementsByTagName("*") returns only elements\n
\tsupport.getElementsByTagName = assert(function( div ) {\n
\t\tdiv.appendChild( doc.createComment("") );\n
\t\treturn !div.getElementsByTagName("*").length;\n
\t});\n
\n
\t// Check if getElementsByClassName can be trusted\n
\tsupport.getElementsByClassName = assert(function( div ) {\n
\t\tdiv.innerHTML = "<div class=\'a\'></div><div class=\'a i\'></div>";\n
\n
\t\t// Support: Safari<4\n
\t\t// Catch class over-caching\n
\t\tdiv.firstChild.className = "i";\n
\t\t// Support: Opera<10\n
\t\t// Catch gEBCN failure to find non-leading classes\n
\t\treturn div.getElementsByClassName("i").length === 2;\n
\t});\n
\n
\t// Support: IE<10\n
\t// Check if getElementById returns elements by name\n
\t// The broken getElementById methods don\'t pick up programatically-set names,\n
\t// so use a roundabout getElementsByName test\n
\tsupport.getById = assert(function( div ) {\n
\t\tdocElem.appendChild( div ).id = expando;\n
\t\treturn !doc.getElementsByName || !doc.getElementsByName( expando ).length;\n
\t});\n
\n
\t// ID find and filter\n
\tif ( support.getById ) {\n
\t\tExpr.find["ID"] = function( id, context ) {\n
\t\t\tif ( typeof context.getElementById !== strundefined && documentIsHTML ) {\n
\t\t\t\tvar m = context.getElementById( id );\n
\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n
\t\t\t\t// nodes that are no longer in the document #6963\n
\t\t\t\treturn m && m.parentNode ? [m] : [];\n
\t\t\t}\n
\t\t};\n
\t\tExpr.filter["ID"] = function( id ) {\n
\t\t\tvar attrId = id.replace( runescape, funescape );\n
\t\t\treturn function( elem ) {\n
\t\t\t\treturn elem.getAttribute("id") === attrId;\n
\t\t\t};\n
\t\t};\n
\t} else {\n
\t\t// Support: IE6/7\n
\t\t// getElementById is not reliable as a find shortcut\n
\t\tdelete Expr.find["ID"];\n
\n
\t\tExpr.filter["ID"] =  function( id ) {\n
\t\t\tvar attrId = id.replace( runescape, funescape );\n
\t\t\treturn function( elem ) {\n
\t\t\t\tvar node = typeof elem.getAttributeNode !== strundefined && elem.getAttributeNode("id");\n
\t\t\t\treturn node && node.value === attrId;\n
\t\t\t};\n
\t\t};\n
\t}\n
\n
\t// Tag\n
\tExpr.find["TAG"] = support.getElementsByTagName ?\n
\t\tfunction( tag, context ) {\n
\t\t\tif ( typeof context.getElementsByTagName !== strundefined ) {\n
\t\t\t\treturn context.getElementsByTagName( tag );\n
\t\t\t}\n
\t\t} :\n
\t\tfunction( tag, context ) {\n
\t\t\tvar elem,\n
\t\t\t\ttmp = [],\n
\t\t\t\ti = 0,\n
\t\t\t\tresults = context.getElementsByTagName( tag );\n
\n
\t\t\t// Filter out possible comments\n
\t\t\tif ( tag === "*" ) {\n
\t\t\t\twhile ( (elem = results[i++]) ) {\n
\t\t\t\t\tif ( elem.nodeType === 1 ) {\n
\t\t\t\t\t\ttmp.push( elem );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t\treturn tmp;\n
\t\t\t}\n
\t\t\treturn results;\n
\t\t};\n
\n
\t// Class\n
\tExpr.find["CLASS"] = support.getElementsByClassName && function( className, context ) {\n
\t\tif ( typeof context.getElementsByClassName !== strundefined && documentIsHTML ) {\n
\t\t\treturn context.getElementsByClassName( className );\n
\t\t}\n
\t};\n
\n
\t/* QSA/matchesSelector\n
\t---------------------------------------------------------------------- */\n
\n
\t// QSA and matchesSelector support\n
\n
\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n
\trbuggyMatches = [];\n
\n
\t// qSa(:focus) reports false when true (Chrome 21)\n
\t// We allow this because of a bug in IE8/9 that throws an error\n
\t// whenever `document.activeElement` is accessed on an iframe\n
\t// So, we allow :focus to pass through QSA all the time to avoid the IE error\n
\t// See http://bugs.jquery.com/ticket/13378\n
\trbuggyQSA = [];\n
\n
\tif ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {\n
\t\t// Build QSA regex\n
\t\t// Regex strategy adopted from Diego Perini\n
\t\tassert(function( div ) {\n
\t\t\t// Select is set to empty string on purpose\n
\t\t\t// This is to test IE\'s treatment of not explicitly\n
\t\t\t// setting a boolean content attribute,\n
\t\t\t// since its presence should be enough\n
\t\t\t// http://bugs.jquery.com/ticket/12359\n
\t\t\tdiv.innerHTML = "<select><option selected=\'\'></option></select>";\n
\n
\t\t\t// Support: IE8\n
\t\t\t// Boolean attributes and "value" are not treated correctly\n
\t\t\tif ( !div.querySelectorAll("[selected]").length ) {\n
\t\t\t\trbuggyQSA.push( "\\\\[" + whitespace + "*(?:value|" + booleans + ")" );\n
\t\t\t}\n
\n
\t\t\t// Webkit/Opera - :checked should return selected option elements\n
\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n
\t\t\t// IE8 throws error here and will not see later tests\n
\t\t\tif ( !div.querySelectorAll(":checked").length ) {\n
\t\t\t\trbuggyQSA.push(":checked");\n
\t\t\t}\n
\t\t});\n
\n
\t\tassert(function( div ) {\n
\n
\t\t\t// Support: Opera 10-12/IE8\n
\t\t\t// ^= $= *= and empty values\n
\t\t\t// Should not select anything\n
\t\t\t// Support: Windows 8 Native Apps\n
\t\t\t// The type attribute is restricted during .innerHTML assignment\n
\t\t\tvar input = doc.createElement("input");\n
\t\t\tinput.setAttribute( "type", "hidden" );\n
\t\t\tdiv.appendChild( input ).setAttribute( "t", "" );\n
\n
\t\t\tif ( div.querySelectorAll("[t^=\'\']").length ) {\n
\t\t\t\trbuggyQSA.push( "[*^$]=" + whitespace + "*(?:\'\'|\\"\\")" );\n
\t\t\t}\n
\n
\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n
\t\t\t// IE8 throws error here and will not see later tests\n
\t\t\tif ( !div.querySelectorAll(":enabled").length ) {\n
\t\t\t\trbuggyQSA.push( ":enabled", ":disabled" );\n
\t\t\t}\n
\n
\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\n
\t\t\tdiv.querySelectorAll("*,:x");\n
\t\t\trbuggyQSA.push(",.*:");\n
\t\t});\n
\t}\n
\n
\tif ( (support.matchesSelector = rnative.test( (matches = docElem.webkitMatchesSelector ||\n
\t\tdocElem.mozMatchesSelector ||\n
\t\tdocElem.oMatchesSelector ||\n
\t\tdocElem.msMatchesSelector) )) ) {\n
\n
\t\tassert(function( div ) {\n
\t\t\t// Check to see if it\'s possible to do matchesSelector\n
\t\t\t// on a disconnected node (IE 9)\n
\t\t\tsupport.disconnectedMatch = matches.call( div, "div" );\n
\n
\t\t\t// This should fail with an exception\n
\t\t\t// Gecko does not error, returns false instead\n
\t\t\tmatches.call( div, "[s!=\'\']:x" );\n
\t\t\trbuggyMatches.push( "!=", pseudos );\n
\t\t});\n
\t}\n
\n
\trbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join("|") );\n
\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join("|") );\n
\n
\t/* Contains\n
\t---------------------------------------------------------------------- */\n
\n
\t// Element contains another\n
\t// Purposefully does not implement inclusive descendent\n
\t// As in, an element does not contain itself\n
\tcontains = rnative.test( docElem.contains ) || docElem.compareDocumentPosition ?\n
\t\tfunction( a, b ) {\n
\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\n
\t\t\t\tbup = b && b.parentNode;\n
\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\n
\t\t\t\tadown.contains ?\n
\t\t\t\t\tadown.contains( bup ) :\n
\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n
\t\t\t));\n
\t\t} :\n
\t\tfunction( a, b ) {\n
\t\t\tif ( b ) {\n
\t\t\t\twhile ( (b = b.parentNode) ) {\n
\t\t\t\t\tif ( b === a ) {\n
\t\t\t\t\t\treturn true;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\treturn false;\n
\t\t};\n
\n
\t/* Sorting\n
\t---------------------------------------------------------------------- */\n
\n
\t// Document order sorting\n
\tsortOrder = docElem.compareDocumentPosition ?\n
\tfunction( a, b ) {\n
\n
\t\t// Flag for duplicate removal\n
\t\tif ( a === b ) {\n
\t\t\thasDuplicate = true;\n
\t\t\treturn 0;\n
\t\t}\n
\n
\t\tvar compare = b.compareDocumentPosition && a.compareDocumentPosition && a.compareDocumentPosition( b );\n
\n
\t\tif ( compare ) {\n
\t\t\t// Disconnected nodes\n
\t\t\tif ( compare & 1 ||\n
\t\t\t\t(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {\n
\n
\t\t\t\t// Choose the first element that is related to our preferred document\n
\t\t\t\tif ( a === doc || contains(preferredDoc, a) ) {\n
\t\t\t\t\treturn -1;\n
\t\t\t\t}\n
\t\t\t\tif ( b === doc || contains(preferredDoc, b) ) {\n
\t\t\t\t\treturn 1;\n
\t\t\t\t}\n
\n
\t\t\t\t// Maintain original order\n
\t\t\t\treturn sortInput ?\n
\t\t\t\t\t( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :\n
\t\t\t\t\t0;\n
\t\t\t}\n
\n
\t\t\treturn compare & 4 ? -1 : 1;\n
\t\t}\n
\n
\t\t// Not directly comparable, sort on existence of method\n
\t\treturn a.compareDocumentPosition ? -1 : 1;\n
\t} :\n
\tfunction( a, b ) {\n
\t\tvar cur,\n
\t\t\ti = 0,\n
\t\t\taup = a.parentNode,\n
\t\t\tbup = b.parentNode,\n
\t\t\tap = [ a ],\n
\t\t\tbp = [ b ];\n
\n
\t\t// Exit early if the nodes are identical\n
\t\tif ( a === b ) {\n
\t\t\thasDuplicate = true;\n
\t\t\treturn 0;\n
\n
\t\t// Parentless nodes are either documents or disconnected\n
\t\t} else if ( !aup || !bup ) {\n
\t\t\treturn a === doc ? -1 :\n
\t\t\t\tb === doc ? 1 :\n
\t\t\t\taup ? -1 :\n
\t\t\t\tbup ? 1 :\n
\t\t\t\tsortInput ?\n
\t\t\t\t( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :\n
\t\t\t\t0;\n
\n
\t\t// If the nodes are siblings, we can do a quick check\n
\t\t} else if ( aup === bup ) {\n
\t\t\treturn siblingCheck( a, b );\n
\t\t}\n
\n
\t\t// Otherwise we need full lists of their ancestors for comparison\n
\t\tcur = a;\n
\t\twhile ( (cur = cur.parentNode) ) {\n
\t\t\tap.unshift( cur );\n
\t\t}\n
\t\tcur = b;\n
\t\twhile ( (cur = cur.parentNode) ) {\n
\t\t\tbp.unshift( cur );\n
\t\t}\n
\n
\t\t// Walk down the tree looking for a discrepancy\n
\t\twhile ( ap[i] === bp[i] ) {\n
\t\t\ti++;\n
\t\t}\n
\n
\t\treturn i ?\n
\t\t\t// Do a sibling check if the nodes have a common ancestor\n
\t\t\tsiblingCheck( ap[i], bp[i] ) :\n
\n
\t\t\t// Otherwise nodes in our document sort first\n
\t\t\tap[i] === preferredDoc ? -1 :\n
\t\t\tbp[i] === preferredDoc ? 1 :\n
\t\t\t0;\n
\t};\n
\n
\treturn doc;\n
};\n
\n
Sizzle.matches = function( expr, elements ) {\n
\treturn Sizzle( expr, null, null, elements );\n
};\n
\n
Sizzle.matchesSelector = function( elem, expr ) {\n
\t// Set document vars if needed\n
\tif ( ( elem.ownerDocument || elem ) !== document ) {\n
\t\tsetDocument( elem );\n
\t}\n
\n
\t// Make sure that attribute selectors are quoted\n
\texpr = expr.replace( rattributeQuotes, "=\'$1\']" );\n
\n
\tif ( support.matchesSelector && documentIsHTML &&\n
\t\t( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\n
\t\t( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\n
\n
\t\ttry {\n
\t\t\tvar ret = matches.call( elem, expr );\n
\n
\t\t\t// IE 9\'s matchesSelector returns false on disconnected nodes\n
\t\t\tif ( ret || support.disconnectedMatch ||\n
\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n
\t\t\t\t\t// fragment in IE 9\n
\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\n
\t\t\t\treturn ret;\n
\t\t\t}\n
\t\t} catch(e) {}\n
\t}\n
\n
\treturn Sizzle( expr, document, null, [elem] ).length > 0;\n
};\n
\n
Sizzle.contains = function( context, elem ) {\n
\t// Set document vars if needed\n
\tif ( ( context.ownerDocument || context ) !== document ) {\n
\t\tsetDocument( context );\n
\t}\n
\treturn contains( context, elem );\n
};\n
\n
Sizzle.attr = function( elem, name ) {\n
\t// Set document vars if needed\n
\tif ( ( elem.ownerDocument || elem ) !== document ) {\n
\t\tsetDocument( elem );\n
\t}\n
\n
\tvar fn = Expr.attrHandle[ name.toLowerCase() ],\n
\t\t// Don\'t get fooled by Object.prototype properties (jQuery #13807)\n
\t\tval = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\n
\t\t\tfn( elem, name, !documentIsHTML ) :\n
\t\t\tundefined;\n
\n
\treturn val === undefined ?\n
\t\tsupport.attributes || !documentIsHTML ?\n
\t\t\telem.getAttribute( name ) :\n
\t\t\t(val = elem.getAttributeNode(name)) && val.specified ?\n
\t\t\t\tval.value :\n
\t\t\t\tnull :\n
\t\tval;\n
};\n
\n
Sizzle.error = function( msg ) {\n
\tthrow new Error( "Syntax error, unrecognized expression: " + msg );\n
};\n
\n
/**\n
 * Document sorting and removing duplicates\n
 * @param {ArrayLike} results\n
 */\n
Sizzle.uniqueSort = function( results ) {\n
\tvar elem,\n
\t\tduplicates = [],\n
\t\tj = 0,\n
\t\ti = 0;\n
\n
\t// Unless we *know* we can detect duplicates, assume their presence\n
\thasDuplicate = !support.detectDuplicates;\n
\tsortInput = !support.sortStable && results.slice( 0 );\n
\tresults.sort( sortOrder );\n
\n
\tif ( hasDuplicate ) {\n
\t\twhile ( (elem = results[i++]) ) {\n
\t\t\tif ( elem === results[ i ] ) {\n
\t\t\t\tj = duplicates.push( i );\n
\t\t\t}\n
\t\t}\n
\t\twhile ( j-- ) {\n
\t\t\tresults.splice( duplicates[ j ], 1 );\n
\t\t}\n
\t}\n
\n
\treturn results;\n
};\n
\n
/**\n
 * Utility function for retrieving the text value of an array of DOM nodes\n
 * @param {Array|Element} elem\n
 */\n
getText = Sizzle.getText = function( elem ) {\n
\tvar node,\n
\t\tret = "",\n
\t\ti = 0,\n
\t\tnodeType = elem.nodeType;\n
\n
\tif ( !nodeType ) {\n
\t\t// If no nodeType, this is expected to be an array\n
\t\tfor ( ; (node = elem[i]); i++ ) {\n
\t\t\t// Do not traverse comment nodes\n
\t\t\tret += getText( node );\n
\t\t}\n
\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n
\t\t// Use textContent for elements\n
\t\t// innerText usage removed for consistency of new lines (see #11153)\n
\t\tif ( typeof elem.textContent === "string" ) {\n
\t\t\treturn elem.textContent;\n
\t\t} else {\n
\t\t\t// Traverse its children\n
\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n
\t\t\t\tret += getText( elem );\n
\t\t\t}\n
\t\t}\n
\t} else if ( nodeType === 3 || nodeType === 4 ) {\n
\t\treturn elem.nodeValue;\n
\t}\n
\t// Do not include comment or processing instruction nodes\n
\n
\treturn ret;\n
};\n
\n
Expr = Sizzle.selectors = {\n
\n
\t// Can be adjusted by the user\n
\tcacheLength: 50,\n
\n
\tcreatePseudo: markFunction,\n
\n
\tmatch: matchExpr,\n
\n
\tattrHandle: {},\n
\n
\tfind: {},\n
\n
\trelative: {\n
\t\t">": { dir: "parentNode", first: true },\n
\t\t" ": { dir: "parentNode" },\n
\t\t"+": { dir: "previousSibling", first: true },\n
\t\t"~": { dir: "previousSibling" }\n
\t},\n
\n
\tpreFilter: {\n
\t\t"ATTR": function( match ) {\n
\t\t\tmatch[1] = match[1].replace( runescape, funescape );\n
\n
\t\t\t// Move the given value to match[3] whether quoted or unquoted\n
\t\t\tmatch[3] = ( match[4] || match[5] || "" ).replace( runescape, funescape );\n
\n
\t\t\tif ( match[2] === "~=" ) {\n
\t\t\t\tmatch[3] = " " + match[3] + " ";\n
\t\t\t}\n
\n
\t\t\treturn match.slice( 0, 4 );\n
\t\t},\n
\n
\t\t"CHILD": function( match ) {\n
\t\t\t/* matches from matchExpr["CHILD"]\n
\t\t\t\t1 type (only|nth|...)\n
\t\t\t\t2 what (child|of-type)\n
\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n
\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n
\t\t\t\t5 sign of xn-component\n
\t\t\t\t6 x of xn-component\n
\t\t\t\t7 sign of y-component\n
\t\t\t\t8 y of y-component\n
\t\t\t*/\n
\t\t\tmatch[1] = match[1].toLowerCase();\n
\n
\t\t\tif ( match[1].slice( 0, 3 ) === "nth" ) {\n
\t\t\t\t// nth-* requires argument\n
\t\t\t\tif ( !match[3] ) {\n
\t\t\t\t\tSizzle.error( match[0] );\n
\t\t\t\t}\n
\n
\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\n
\t\t\t\t// remember that false/true cast respectively to 0/1\n
\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === "even" || match[3] === "odd" ) );\n
\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === "odd" );\n
\n
\t\t\t// other types prohibit arguments\n
\t\t\t} else if ( match[3] ) {\n
\t\t\t\tSizzle.error( match[0] );\n
\t\t\t}\n
\n
\t\t\treturn match;\n
\t\t},\n
\n
\t\t"PSEUDO": function( match ) {\n
\t\t\tvar excess,\n
\t\t\t\tunquoted = !match[5] && match[2];\n
\n
\t\t\tif ( matchExpr["CHILD"].test( match[0] ) ) {\n
\t\t\t\treturn null;\n
\t\t\t}\n
\n
\t\t\t// Accept quoted arguments as-is\n
\t\t\tif ( match[3] && match[4] !== undefined ) {\n
\t\t\t\tmatch[2] = match[4];\n
\n
\t\t\t// Strip excess characters from unquoted arguments\n
\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\n
\t\t\t\t// Get excess from tokenize (recursively)\n
\t\t\t\t(excess = tokenize( unquoted, true )) &&\n
\t\t\t\t// advance to the next closing parenthesis\n
\t\t\t\t(excess = unquoted.indexOf( ")", unquoted.length - excess ) - unquoted.length) ) {\n
\n
\t\t\t\t// excess is a negative index\n
\t\t\t\tmatch[0] = match[0].slice( 0, excess );\n
\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\n
\t\t\t}\n
\n
\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\n
\t\t\treturn match.slice( 0, 3 );\n
\t\t}\n
\t},\n
\n
\tfilter: {\n
\n
\t\t"TAG": function( nodeNameSelector ) {\n
\t\t\tvar nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\n
\t\t\treturn nodeNameSelector === "*" ?\n
\t\t\t\tfunction() { return true; } :\n
\t\t\t\tfunction( elem ) {\n
\t\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n
\t\t\t\t};\n
\t\t},\n
\n
\t\t"CLASS": function( className ) {\n
\t\t\tvar pattern = classCache[ className + " " ];\n
\n
\t\t\treturn pattern ||\n
\t\t\t\t(pattern = new RegExp( "(^|" + whitespace + ")" + className + "(" + whitespace + "|$)" )) &&\n
\t\t\t\tclassCache( className, function( elem ) {\n
\t\t\t\t\treturn pattern.test( typeof elem.className === "string" && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute("class") || "" );\n
\t\t\t\t});\n
\t\t},\n
\n
\t\t"ATTR": function( name, operator, check ) {\n
\t\t\treturn function( elem ) {\n
\t\t\t\tvar result = Sizzle.attr( elem, name );\n
\n
\t\t\t\tif ( result == null ) {\n
\t\t\t\t\treturn operator === "!=";\n
\t\t\t\t}\n
\t\t\t\tif ( !operator ) {\n
\t\t\t\t\treturn true;\n
\t\t\t\t}\n
\n
\t\t\t\tresult += "";\n
\n
\t\t\t\treturn operator === "=" ? result === check :\n
\t\t\t\t\toperator === "!=" ? result !== check :\n
\t\t\t\t\toperator === "^=" ? check && result.indexOf( check ) === 0 :\n
\t\t\t\t\toperator === "*=" ? check && result.indexOf( check ) > -1 :\n
\t\t\t\t\toperator === "$=" ? check && result.slice( -check.length ) === check :\n
\t\t\t\t\toperator === "~=" ? ( " " + result + " " ).indexOf( check ) > -1 :\n
\t\t\t\t\toperator === "|=" ? result === check || result.slice( 0, check.length + 1 ) === check + "-" :\n
\t\t\t\t\tfalse;\n
\t\t\t};\n
\t\t},\n
\n
\t\t"CHILD": function( type, what, argument, first, last ) {\n
\t\t\tvar simple = type.slice( 0, 3 ) !== "nth",\n
\t\t\t\tforward = type.slice( -4 ) !== "last",\n
\t\t\t\tofType = what === "of-type";\n
\n
\t\t\treturn first === 1 && last === 0 ?\n
\n
\t\t\t\t// Shortcut for :nth-*(n)\n
\t\t\t\tfunction( elem ) {\n
\t\t\t\t\treturn !!elem.parentNode;\n
\t\t\t\t} :\n
\n
\t\t\t\tfunction( elem, context, xml ) {\n
\t\t\t\t\tvar cache, outerCache, node, diff, nodeIndex, start,\n
\t\t\t\t\t\tdir = simple !== forward ? "nextSibling" : "previousSibling",\n
\t\t\t\t\t\tparent = elem.parentNode,\n
\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\n
\t\t\t\t\t\tuseCache = !xml && !ofType;\n
\n
\t\t\t\t\tif ( parent ) {\n
\n
\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\n
\t\t\t\t\t\tif ( simple ) {\n
\t\t\t\t\t\t\twhile ( dir ) {\n
\t\t\t\t\t\t\t\tnode = elem;\n
\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\n
\t\t\t\t\t\t\t\t\tif ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {\n
\t\t\t\t\t\t\t\t\t\treturn false;\n
\t\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven\'t yet done so)\n
\t\t\t\t\t\t\t\tstart = dir = type === "only" && !start && "nextSibling";\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\treturn true;\n
\t\t\t\t\t\t}\n
\n
\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\n
\n
\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\n
\t\t\t\t\t\tif ( forward && useCache ) {\n
\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\n
\t\t\t\t\t\t\touterCache = parent[ expando ] || (parent[ expando ] = {});\n
\t\t\t\t\t\t\tcache = outerCache[ type ] || [];\n
\t\t\t\t\t\t\tnodeIndex = cache[0] === dirruns && cache[1];\n
\t\t\t\t\t\t\tdiff = cache[0] === dirruns && cache[2];\n
\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\n
\n
\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n
\n
\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\n
\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n
\n
\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\n
\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\n
\t\t\t\t\t\t\t\t\touterCache[ type ] = [ dirruns, nodeIndex, diff ];\n
\t\t\t\t\t\t\t\t\tbreak;\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t}\n
\n
\t\t\t\t\t\t// Use previously-cached element index if available\n
\t\t\t\t\t\t} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {\n
\t\t\t\t\t\t\tdiff = cache[1];\n
\n
\t\t\t\t\t\t// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)\n
\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\n
\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n
\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n
\n
\t\t\t\t\t\t\t\tif ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {\n
\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\n
\t\t\t\t\t\t\t\t\tif ( useCache ) {\n
\t\t\t\t\t\t\t\t\t\t(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];\n
\t\t\t\t\t\t\t\t\t}\n
\n
\t\t\t\t\t\t\t\t\tif ( node === elem ) {\n
\t\t\t\t\t\t\t\t\t\tbreak;\n
\t\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\n
\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\n
\t\t\t\t\t\tdiff -= last;\n
\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\n
\t\t\t\t\t}\n
\t\t\t\t};\n
\t\t},\n
\n
\t\t"PSEUDO": function( pseudo, argument ) {\n
\t\t\t// pseudo-class names are case-insensitive\n
\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\n
\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n
\t\t\t// Remember that setFilters inherits from pseudos\n
\t\t\tvar args,\n
\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n
\t\t\t\t\tSizzle.error( "unsupported pseudo: " + pseudo );\n
\n
\t\t\t// The user may use createPseudo to indicate that\n
\t\t\t// arguments are needed to create the filter function\n
\t\t\t// just as Sizzle does\n
\t\t\tif ( fn[ expando ] ) {\n
\t\t\t\treturn fn( argument );\n
\t\t\t}\n
\n
\t\t\t// But maintain support for old signatures\n
\t\t\tif ( fn.length > 1 ) {\n
\t\t\t\targs = [ pseudo, pseudo, "", argument ];\n
\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n
\t\t\t\t\tmarkFunction(function( seed, matches ) {\n
\t\t\t\t\t\tvar idx,\n
\t\t\t\t\t\t\tmatched = fn( seed, argument ),\n
\t\t\t\t\t\t\ti = matched.length;\n
\t\t\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\t\t\tidx = indexOf.call( seed, matched[i] );\n
\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}) :\n
\t\t\t\t\tfunction( elem ) {\n
\t\t\t\t\t\treturn fn( elem, 0, args );\n
\t\t\t\t\t};\n
\t\t\t}\n
\n
\t\t\treturn fn;\n
\t\t}\n
\t},\n
\n
\tpseudos: {\n
\t\t// Potentially complex pseudos\n
\t\t"not": markFunction(function( selector ) {\n
\t\t\t// Trim the selector passed to compile\n
\t\t\t// to avoid treating leading and trailing\n
\t\t\t// spaces as combinators\n
\t\t\tvar input = [],\n
\t\t\t\tresults = [],\n
\t\t\t\tmatcher = compile( selector.replace( rtrim, "$1" ) );\n
\n
\t\t\treturn matcher[ expando ] ?\n
\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\n
\t\t\t\t\tvar elem,\n
\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\n
\t\t\t\t\t\ti = seed.length;\n
\n
\t\t\t\t\t// Match elements unmatched by `matcher`\n
\t\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\n
\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}) :\n
\t\t\t\tfunction( elem, context, xml ) {\n
\t\t\t\t\tinput[0] = elem;\n
\t\t\t\t\tmatcher( input, null, xml, results );\n
\t\t\t\t\treturn !results.pop();\n
\t\t\t\t};\n
\t\t}),\n
\n
\t\t"has": markFunction(function( selector ) {\n
\t\t\treturn function( elem ) {\n
\t\t\t\treturn Sizzle( selector, elem ).length > 0;\n
\t\t\t};\n
\t\t}),\n
\n
\t\t"contains": markFunction(function( text ) {\n
\t\t\treturn function( elem ) {\n
\t\t\t\treturn ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;\n
\t\t\t};\n
\t\t}),\n
\n
\t\t// "Whether an element is represented by a :lang() selector\n
\t\t// is based solely on the element\'s language value\n
\t\t// being equal to the identifier C,\n
\t\t// or beginning with the identifier C immediately followed by "-".\n
\t\t// The matching of C against the element\'s language value is performed case-insensitively.\n
\t\t// The identifier C does not have to be a valid language name."\n
\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\n
\t\t"lang": markFunction( function( lang ) {\n
\t\t\t// lang value must be a valid identifier\n
\t\t\tif ( !ridentifier.test(lang || "") ) {\n
\t\t\t\tSizzle.error( "unsupported lang: " + lang );\n
\t\t\t}\n
\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\n
\t\t\treturn function( elem ) {\n
\t\t\t\tvar elemLang;\n
\t\t\t\tdo {\n
\t\t\t\t\tif ( (elemLang = documentIsHTML ?\n
\t\t\t\t\t\telem.lang :\n
\t\t\t\t\t\telem.getAttribute("xml:lang") || elem.getAttribute("lang")) ) {\n
\n
\t\t\t\t\t\telemLang = elemLang.toLowerCase();\n
\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + "-" ) === 0;\n
\t\t\t\t\t}\n
\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\n
\t\t\t\treturn false;\n
\t\t\t};\n
\t\t}),\n
\n
\t\t// Miscellaneous\n
\t\t"target": function( elem ) {\n
\t\t\tvar hash = window.location && window.location.hash;\n
\t\t\treturn hash && hash.slice( 1 ) === elem.id;\n
\t\t},\n
\n
\t\t"root": function( elem ) {\n
\t\t\treturn elem === docElem;\n
\t\t},\n
\n
\t\t"focus": function( elem ) {\n
\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n
\t\t},\n
\n
\t\t// Boolean properties\n
\t\t"enabled": function( elem ) {\n
\t\t\treturn elem.disabled === false;\n
\t\t},\n
\n
\t\t"disabled": function( elem ) {\n
\t\t\treturn elem.disabled === true;\n
\t\t},\n
\n
\t\t"checked": function( elem ) {\n
\t\t\t// In CSS3, :checked should return both checked and selected elements\n
\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n
\t\t\tvar nodeName = elem.nodeName.toLowerCase();\n
\t\t\treturn (nodeName === "input" && !!elem.checked) || (nodeName === "option" && !!elem.selected);\n
\t\t},\n
\n
\t\t"selected": function( elem ) {\n
\t\t\t// Accessing this property makes selected-by-default\n
\t\t\t// options in Safari work properly\n
\t\t\tif ( elem.parentNode ) {\n
\t\t\t\telem.parentNode.selectedIndex;\n
\t\t\t}\n
\n
\t\t\treturn elem.selected === true;\n
\t\t},\n
\n
\t\t// Contents\n
\t\t"empty": function( elem ) {\n
\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\n
\t\t\t// :empty is only affected by element nodes and content nodes(including text(3), cdata(4)),\n
\t\t\t//   not comment, processing instructions, or others\n
\t\t\t// Thanks to Diego Perini for the nodeName shortcut\n
\t\t\t//   Greater than "@" means alpha characters (specifically not starting with "#" or "?")\n
\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n
\t\t\t\tif ( elem.nodeName > "@" || elem.nodeType === 3 || elem.nodeType === 4 ) {\n
\t\t\t\t\treturn false;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\treturn true;\n
\t\t},\n
\n
\t\t"parent": function( elem ) {\n
\t\t\treturn !Expr.pseudos["empty"]( elem );\n
\t\t},\n
\n
\t\t// Element/input types\n
\t\t"header": function( elem ) {\n
\t\t\treturn rheader.test( elem.nodeName );\n
\t\t},\n
\n
\t\t"input": function( elem ) {\n
\t\t\treturn rinputs.test( elem.nodeName );\n
\t\t},\n
\n
\t\t"button": function( elem ) {\n
\t\t\tvar name = elem.nodeName.toLowerCase();\n
\t\t\treturn name === "input" && elem.type === "button" || name === "button";\n
\t\t},\n
\n
\t\t"text": function( elem ) {\n
\t\t\tvar attr;\n
\t\t\t// IE6 and 7 will map elem.type to \'text\' for new HTML5 types (search, etc)\n
\t\t\t// use getAttribute instead to test this case\n
\t\t\treturn elem.nodeName.toLowerCase() === "input" &&\n
\t\t\t\telem.type === "text" &&\n
\t\t\t\t( (attr = elem.getAttribute("type")) == null || attr.toLowerCase() === elem.type );\n
\t\t},\n
\n
\t\t// Position-in-collection\n
\t\t"first": createPositionalPseudo(function() {\n
\t\t\treturn [ 0 ];\n
\t\t}),\n
\n
\t\t"last": createPositionalPseudo(function( matchIndexes, length ) {\n
\t\t\treturn [ length - 1 ];\n
\t\t}),\n
\n
\t\t"eq": createPositionalPseudo(function( matchIndexes, length, argument ) {\n
\t\t\treturn [ argument < 0 ? argument + length : argument ];\n
\t\t}),\n
\n
\t\t"even": createPositionalPseudo(function( matchIndexes, length ) {\n
\t\t\tvar i = 0;\n
\t\t\tfor ( ; i < length; i += 2 ) {\n
\t\t\t\tmatchIndexes.push( i );\n
\t\t\t}\n
\t\t\treturn matchIndexes;\n
\t\t}),\n
\n
\t\t"odd": createPositionalPseudo(function( matchIndexes, length ) {\n
\t\t\tvar i = 1;\n
\t\t\tfor ( ; i < length; i += 2 ) {\n
\t\t\t\tmatchIndexes.push( i );\n
\t\t\t}\n
\t\t\treturn matchIndexes;\n
\t\t}),\n
\n
\t\t"lt": createPositionalPseudo(function( matchIndexes, length, argument ) {\n
\t\t\tvar i = argument < 0 ? argument + length : argument;\n
\t\t\tfor ( ; --i >= 0; ) {\n
\t\t\t\tmatchIndexes.push( i );\n
\t\t\t}\n
\t\t\treturn matchIndexes;\n
\t\t}),\n
\n
\t\t"gt": createPositionalPseudo(function( matchIndexes, length, argument ) {\n
\t\t\tvar i = argument < 0 ? argument + length : argument;\n
\t\t\tfor ( ; ++i < length; ) {\n
\t\t\t\tmatchIndexes.push( i );\n
\t\t\t}\n
\t\t\treturn matchIndexes;\n
\t\t})\n
\t}\n
};\n
\n
Expr.pseudos["nth"] = Expr.pseudos["eq"];\n
\n
// Add button/input type pseudos\n
for ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n
\tExpr.pseudos[ i ] = createInputPseudo( i );\n
}\n
for ( i in { submit: true, reset: true } ) {\n
\tExpr.pseudos[ i ] = createButtonPseudo( i );\n
}\n
\n
// Easy API for creating new setFilters\n
function setFilters() {}\n
setFilters.prototype = Expr.filters = Expr.pseudos;\n
Expr.setFilters = new setFilters();\n
\n
function tokenize( selector, parseOnly ) {\n
\tvar matched, match, tokens, type,\n
\t\tsoFar, groups, preFilters,\n
\t\tcached = tokenCache[ selector + " " ];\n
\n
\tif ( cached ) {\n
\t\treturn parseOnly ? 0 : cached.slice( 0 );\n
\t}\n
\n
\tsoFar = selector;\n
\tgroups = [];\n
\tpreFilters = Expr.preFilter;\n
\n
\twhile ( soFar ) {\n
\n
\t\t// Comma and first run\n
\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\n
\t\t\tif ( match ) {\n
\t\t\t\t// Don\'t consume trailing commas as valid\n
\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\n
\t\t\t}\n
\t\t\tgroups.push( tokens = [] );\n
\t\t}\n
\n
\t\tmatched = false;\n
\n
\t\t// Combinators\n
\t\tif ( (match = rcombinators.exec( soFar )) ) {\n
\t\t\tmatched = match.shift();\n
\t\t\ttokens.push({\n
\t\t\t\tvalue: matched,\n
\t\t\t\t// Cast descendant combinators to space\n
\t\t\t\ttype: match[0].replace( rtrim, " " )\n
\t\t\t});\n
\t\t\tsoFar = soFar.slice( matched.length );\n
\t\t}\n
\n
\t\t// Filters\n
\t\tfor ( type in Expr.filter ) {\n
\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\n
\t\t\t\t(match = preFilters[ type ]( match ))) ) {\n
\t\t\t\tmatched = match.shift();\n
\t\t\t\ttokens.push({\n
\t\t\t\t\tvalue: matched,\n
\t\t\t\t\ttype: type,\n
\t\t\t\t\tmatches: match\n
\t\t\t\t});\n
\t\t\t\tsoFar = soFar.slice( matched.length );\n
\t\t\t}\n
\t\t}\n
\n
\t\tif ( !matched ) {\n
\t\t\tbreak;\n
\t\t}\n
\t}\n
\n
\t// Return the length of the invalid excess\n
\t// if we\'re just parsing\n
\t// Otherwise, throw an error or return tokens\n
\treturn parseOnly ?\n
\t\tsoFar.length :\n
\t\tsoFar ?\n
\t\t\tSizzle.error( selector ) :\n
\t\t\t// Cache the tokens\n
\t\t\ttokenCache( selector, groups ).slice( 0 );\n
}\n
\n
function toSelector( tokens ) {\n
\tvar i = 0,\n
\t\tlen = tokens.length,\n
\t\tselector = "";\n
\tfor ( ; i < len; i++ ) {\n
\t\tselector += tokens[i].value;\n
\t}\n
\treturn selector;\n
}\n
\n
function addCombinator( matcher, combinator, base ) {\n
\tvar dir = combinator.dir,\n
\t\tcheckNonElements = base && dir === "parentNode",\n
\t\tdoneName = done++;\n
\n
\treturn combinator.first ?\n
\t\t// Check against closest ancestor/preceding element\n
\t\tfunction( elem, context, xml ) {\n
\t\t\twhile ( (elem = elem[ dir ]) ) {\n
\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n
\t\t\t\t\treturn matcher( elem, context, xml );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t} :\n
\n
\t\t// Check against all ancestor/preceding elements\n
\t\tfunction( elem, context, xml ) {\n
\t\t\tvar data, cache, outerCache,\n
\t\t\t\tdirkey = dirruns + " " + doneName;\n
\n
\t\t\t// We can\'t set arbitrary data on XML nodes, so they don\'t benefit from dir caching\n
\t\t\tif ( xml ) {\n
\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n
\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n
\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n
\t\t\t\t\t\t\treturn true;\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t} else {\n
\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n
\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n
\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\n
\t\t\t\t\t\tif ( (cache = outerCache[ dir ]) && cache[0] === dirkey ) {\n
\t\t\t\t\t\t\tif ( (data = cache[1]) === true || data === cachedruns ) {\n
\t\t\t\t\t\t\t\treturn data === true;\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\tcache = outerCache[ dir ] = [ dirkey ];\n
\t\t\t\t\t\t\tcache[1] = matcher( elem, context, xml ) || cachedruns;\n
\t\t\t\t\t\t\tif ( cache[1] === true ) {\n
\t\t\t\t\t\t\t\treturn true;\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t};\n
}\n
\n
function elementMatcher( matchers ) {\n
\treturn matchers.length > 1 ?\n
\t\tfunction( elem, context, xml ) {\n
\t\t\tvar i = matchers.length;\n
\t\t\twhile ( i-- ) {\n
\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\n
\t\t\t\t\treturn false;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\treturn true;\n
\t\t} :\n
\t\tmatchers[0];\n
}\n
\n
function condense( unmatched, map, filter, context, xml ) {\n
\tvar elem,\n
\t\tnewUnmatched = [],\n
\t\ti = 0,\n
\t\tlen = unmatched.length,\n
\t\tmapped = map != null;\n
\n
\tfor ( ; i < len; i++ ) {\n
\t\tif ( (elem = unmatched[i]) ) {\n
\t\t\tif ( !filter || filter( elem, context, xml ) ) {\n
\t\t\t\tnewUnmatched.push( elem );\n
\t\t\t\tif ( mapped ) {\n
\t\t\t\t\tmap.push( i );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\treturn newUnmatched;\n
}\n
\n
function setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n
\tif ( postFilter && !postFilter[ expando ] ) {\n
\t\tpostFilter = setMatcher( postFilter );\n
\t}\n
\tif ( postFinder && !postFinder[ expando ] ) {\n
\t\tpostFinder = setMatcher( postFinder, postSelector );\n
\t}\n
\treturn markFunction(function( seed, results, context, xml ) {\n
\t\tvar temp, i, elem,\n
\t\t\tpreMap = [],\n
\t\t\tpostMap = [],\n
\t\t\tpreexisting = results.length,\n
\n
\t\t\t// Get initial elements from seed or context\n
\t\t\telems = seed || multipleContexts( selector || "*", context.nodeType ? [ context ] : context, [] ),\n
\n
\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\n
\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\n
\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\n
\t\t\t\telems,\n
\n
\t\t\tmatcherOut = matcher ?\n
\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n
\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n
\n
\t\t\t\t\t// ...intermediate processing is necessary\n
\t\t\t\t\t[] :\n
\n
\t\t\t\t\t// ...otherwise use results directly\n
\t\t\t\t\tresults :\n
\t\t\t\tmatcherIn;\n
\n
\t\t// Find primary matches\n
\t\tif ( matcher ) {\n
\t\t\tmatcher( matcherIn, matcherOut, context, xml );\n
\t\t}\n
\n
\t\t// Apply postFilter\n
\t\tif ( postFilter ) {\n
\t\t\ttemp = condense( matcherOut, postMap );\n
\t\t\tpostFilter( temp, [], context, xml );\n
\n
\t\t\t// Un-match failing elements by moving them back to matcherIn\n
\t\t\ti = temp.length;\n
\t\t\twhile ( i-- ) {\n
\t\t\t\tif ( (elem = temp[i]) ) {\n
\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\tif ( seed ) {\n
\t\t\tif ( postFinder || preFilter ) {\n
\t\t\t\tif ( postFinder ) {\n
\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\n
\t\t\t\t\ttemp = [];\n
\t\t\t\t\ti = matcherOut.length;\n
\t\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\n
\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\n
\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\n
\t\t\t\t}\n
\n
\t\t\t\t// Move matched elements from seed to results to keep them synchronized\n
\t\t\t\ti = matcherOut.length;\n
\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\tif ( (elem = matcherOut[i]) &&\n
\t\t\t\t\t\t(temp = postFinder ? indexOf.call( seed, elem ) : preMap[i]) > -1 ) {\n
\n
\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t// Add elements to results, through postFinder if defined\n
\t\t} else {\n
\t\t\tmatcherOut = condense(\n
\t\t\t\tmatcherOut === results ?\n
\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\n
\t\t\t\t\tmatcherOut\n
\t\t\t);\n
\t\t\tif ( postFinder ) {\n
\t\t\t\tpostFinder( null, results, matcherOut, xml );\n
\t\t\t} else {\n
\t\t\t\tpush.apply( results, matcherOut );\n
\t\t\t}\n
\t\t}\n
\t});\n
}\n
\n
function matcherFromTokens( tokens ) {\n
\tvar checkContext, matcher, j,\n
\t\tlen = tokens.length,\n
\t\tleadingRelative = Expr.relative[ tokens[0].type ],\n
\t\timplicitRelative = leadingRelative || Expr.relative[" "],\n
\t\ti = leadingRelative ? 1 : 0,\n
\n
\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\n
\t\tmatchContext = addCombinator( function( elem ) {\n
\t\t\treturn elem === checkContext;\n
\t\t}, implicitRelative, true ),\n
\t\tmatchAnyContext = addCombinator( function( elem ) {\n
\t\t\treturn indexOf.call( checkContext, elem ) > -1;\n
\t\t}, implicitRelative, true ),\n
\t\tmatchers = [ function( elem, context, xml ) {\n
\t\t\treturn ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n
\t\t\t\t(checkContext = context).nodeType ?\n
\t\t\t\t\tmatchContext( elem, context, xml ) :\n
\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\n
\t\t} ];\n
\n
\tfor ( ; i < len; i++ ) {\n
\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\n
\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\n
\t\t} else {\n
\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\n
\n
\t\t\t// Return special upon seeing a positional matcher\n
\t\t\tif ( matcher[ expando ] ) {\n
\t\t\t\t// Find the next relative operator (if any) for proper handling\n
\t\t\t\tj = ++i;\n
\t\t\t\tfor ( ; j < len; j++ ) {\n
\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\n
\t\t\t\t\t\tbreak;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t\treturn setMatcher(\n
\t\t\t\t\ti > 1 && elementMatcher( matchers ),\n
\t\t\t\t\ti > 1 && toSelector(\n
\t\t\t\t\t\t// If the preceding token was a descendant combinator, insert an implicit any-element `*`\n
\t\t\t\t\t\ttokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === " " ? "*" : "" })\n
\t\t\t\t\t).replace( rtrim, "$1" ),\n
\t\t\t\t\tmatcher,\n
\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\n
\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\n
\t\t\t\t\tj < len && toSelector( tokens )\n
\t\t\t\t);\n
\t\t\t}\n
\t\t\tmatchers.push( matcher );\n
\t\t}\n
\t}\n
\n
\treturn elementMatcher( matchers );\n
}\n
\n
function matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n
\t// A counter to specify which element is currently being matched\n
\tvar matcherCachedRuns = 0,\n
\t\tbySet = setMatchers.length > 0,\n
\t\tbyElement = elementMatchers.length > 0,\n
\t\tsuperMatcher = function( seed, context, xml, results, expandContext ) {\n
\t\t\tvar elem, j, matcher,\n
\t\t\t\tsetMatched = [],\n
\t\t\t\tmatchedCount = 0,\n
\t\t\t\ti = "0",\n
\t\t\t\tunmatched = seed && [],\n
\t\t\t\toutermost = expandContext != null,\n
\t\t\t\tcontextBackup = outermostContext,\n
\t\t\t\t// We must always have either seed elements or context\n
\t\t\t\telems = seed || byElement && Expr.find["TAG"]( "*", expandContext && context.parentNode || context ),\n
\t\t\t\t// Use integer dirruns iff this is the outermost matcher\n
\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1);\n
\n
\t\t\tif ( outermost ) {\n
\t\t\t\toutermostContext = context !== document && context;\n
\t\t\t\tcachedruns = matcherCachedRuns;\n
\t\t\t}\n
\n
\t\t\t// Add elements passing elementMatchers directly to results\n
\t\t\t// Keep `i` a string if there are no elements so `matchedCount` will be "00" below\n
\t\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\n
\t\t\t\tif ( byElement && elem ) {\n
\t\t\t\t\tj = 0;\n
\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\n
\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n
\t\t\t\t\t\t\tresults.push( elem );\n
\t\t\t\t\t\t\tbreak;\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\tif ( outermost ) {\n
\t\t\t\t\t\tdirruns = dirrunsUnique;\n
\t\t\t\t\t\tcachedruns = ++matcherCachedRuns;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t\t// Track unmatched elements for set filters\n
\t\t\t\tif ( bySet ) {\n
\t\t\t\t\t// They will have gone through all possible matchers\n
\t\t\t\t\tif ( (elem = !matcher && elem) ) {\n
\t\t\t\t\t\tmatchedCount--;\n
\t\t\t\t\t}\n
\n
\t\t\t\t\t// Lengthen the array for every element, matched or not\n
\t\t\t\t\tif ( seed ) {\n
\t\t\t\t\t\tunmatched.push( elem );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// Apply set filters to unmatched elements\n
\t\t\tmatchedCount += i;\n
\t\t\tif ( bySet && i !== matchedCount ) {\n
\t\t\t\tj = 0;\n
\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\n
\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\n
\t\t\t\t}\n
\n
\t\t\t\tif ( seed ) {\n
\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\n
\t\t\t\t\tif ( matchedCount > 0 ) {\n
\t\t\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\n
\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\n
\t\t\t\t\t// Discard index placeholder values to get only actual matches\n
\t\t\t\t\tsetMatched = condense( setMatched );\n
\t\t\t\t}\n
\n
\t\t\t\t// Add matches to results\n
\t\t\t\tpush.apply( results, setMatched );\n
\n
\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\n
\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\n
\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\n
\n
\t\t\t\t\tSizzle.uniqueSort( results );\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// Override manipulation of globals by nested matchers\n
\t\t\tif ( outermost ) {\n
\t\t\t\tdirruns = dirrunsUnique;\n
\t\t\t\toutermostContext = contextBackup;\n
\t\t\t}\n
\n
\t\t\treturn unmatched;\n
\t\t};\n
\n
\treturn bySet ?\n
\t\tmarkFunction( superMatcher ) :\n
\t\tsuperMatcher;\n
}\n
\n
compile = Sizzle.compile = function( selector, group /* Internal Use Only */ ) {\n
\tvar i,\n
\t\tsetMatchers = [],\n
\t\telementMatchers = [],\n
\t\tcached = compilerCache[ selector + " " ];\n
\n
\tif ( !cached ) {\n
\t\t// Generate a function of recursive functions that can be used to check each element\n
\t\tif ( !group ) {\n
\t\t\tgroup = tokenize( selector );\n
\t\t}\n
\t\ti = group.length;\n
\t\twhile ( i-- ) {\n
\t\t\tcached = matcherFromTokens( group[i] );\n
\t\t\tif ( cached[ expando ] ) {\n
\t\t\t\tsetMatchers.push( cached );\n
\t\t\t} else {\n
\t\t\t\telementMatchers.push( cached );\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Cache the compiled function\n
\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\n
\t}\n
\treturn cached;\n
};\n
\n
function multipleContexts( selector, contexts, results ) {\n
\tvar i = 0,\n
\t\tlen = contexts.length;\n
\tfor ( ; i < len; i++ ) {\n
\t\tSizzle( selector, contexts[i], results );\n
\t}\n
\treturn results;\n
}\n
\n
function select( selector, context, results, seed ) {\n
\tvar i, tokens, token, type, find,\n
\t\tmatch = tokenize( selector );\n
\n
\tif ( !seed ) {\n
\t\t// Try to minimize operations if there is only one group\n
\t\tif ( match.length === 1 ) {\n
\n
\t\t\t// Take a shortcut and set the context if the root selector is an ID\n
\t\t\ttokens = match[0] = match[0].slice( 0 );\n
\t\t\tif ( tokens.length > 2 && (token = tokens[0]).type === "ID" &&\n
\t\t\t\t\tsupport.getById && context.nodeType === 9 && documentIsHTML &&\n
\t\t\t\t\tExpr.relative[ tokens[1].type ] ) {\n
\n
\t\t\t\tcontext = ( Expr.find["ID"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\n
\t\t\t\tif ( !context ) {\n
\t\t\t\t\treturn results;\n
\t\t\t\t}\n
\t\t\t\tselector = selector.slice( tokens.shift().value.length );\n
\t\t\t}\n
\n
\t\t\t// Fetch a seed set for right-to-left matching\n
\t\t\ti = matchExpr["needsContext"].test( selector ) ? 0 : tokens.length;\n
\t\t\twhile ( i-- ) {\n
\t\t\t\ttoken = tokens[i];\n
\n
\t\t\t\t// Abort if we hit a combinator\n
\t\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\n
\t\t\t\t\tbreak;\n
\t\t\t\t}\n
\t\t\t\tif ( (find = Expr.find[ type ]) ) {\n
\t\t\t\t\t// Search, expanding context for leading sibling combinators\n
\t\t\t\t\tif ( (seed = find(\n
\t\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\n
\t\t\t\t\t\trsibling.test( tokens[0].type ) && context.parentNode || context\n
\t\t\t\t\t)) ) {\n
\n
\t\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\n
\t\t\t\t\t\ttokens.splice( i, 1 );\n
\t\t\t\t\t\tselector = seed.length && toSelector( tokens );\n
\t\t\t\t\t\tif ( !selector ) {\n
\t\t\t\t\t\t\tpush.apply( results, seed );\n
\t\t\t\t\t\t\treturn results;\n
\t\t\t\t\t\t}\n
\n
\t\t\t\t\t\tbreak;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\t// Compile and execute a filtering function\n
\t// Provide `match` to avoid retokenization if we modified the selector above\n
\tcompile( selector, match )(\n
\t\tseed,\n
\t\tcontext,\n
\t\t!documentIsHTML,\n
\t\tresults,\n
\t\trsibling.test( selector )\n
\t);\n
\treturn results;\n
}\n
\n
// One-time assignments\n
\n
// Sort stability\n
support.sortStable = expando.split("").sort( sortOrder ).join("") === expando;\n
\n
// Support: Chrome<14\n
// Always assume duplicates if they aren\'t passed to the comparison function\n
support.detectDuplicates = hasDuplicate;\n
\n
// Initialize against the default document\n
setDocument();\n
\n
// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\n
// Detached nodes confoundingly follow *each other*\n
support.sortDetached = assert(function( div1 ) {\n
\t// Should return 1, but returns 4 (following)\n
\treturn div1.compareDocumentPosition( document.createElement("div") ) & 1;\n
});\n
\n
// Support: IE<8\n
// Prevent attribute/property "interpolation"\n
// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\n
if ( !assert(function( div ) {\n
\tdiv.innerHTML = "<a href=\'#\'></a>";\n
\treturn div.firstChild.getAttribute("href") === "#" ;\n
}) ) {\n
\taddHandle( "type|href|height|width", function( elem, name, isXML ) {\n
\t\tif ( !isXML ) {\n
\t\t\treturn elem.getAttribute( name, name.toLowerCase() === "type" ? 1 : 2 );\n
\t\t}\n
\t});\n
}\n
\n
// Support: IE<9\n
// Use defaultValue in place of getAttribute("value")\n
if ( !support.attributes || !assert(function( div ) {\n
\tdiv.innerHTML = "<input/>";\n
\tdiv.firstChild.setAttribute( "value", "" );\n
\treturn div.firstChild.getAttribute( "value" ) === "";\n
}) ) {\n
\taddHandle( "value", function( elem, name, isXML ) {\n
\t\tif ( !isXML && elem.nodeName.toLowerCase() === "input" ) {\n
\t\t\treturn elem.defaultValue;\n
\t\t}\n
\t});\n
}\n
\n
// Support: IE<9\n
// Use getAttributeNode to fetch booleans when getAttribute lies\n
if ( !assert(function( div ) {\n
\treturn div.getAttribute("disabled") == null;\n
}) ) {\n
\taddHandle( booleans, function( elem, name, isXML ) {\n
\t\tvar val;\n
\t\tif ( !isXML ) {\n
\t\t\treturn (val = elem.getAttributeNode( name )) && val.specified ?\n
\t\t\t\tval.value :\n
\t\t\t\telem[ name ] === true ? name.toLowerCase() : null;\n
\t\t}\n
\t});\n
}\n
\n
jQuery.find = Sizzle;\n
jQuery.expr = Sizzle.selectors;\n
jQuery.expr[":"] = jQuery.expr.pseudos;\n
jQuery.unique = Sizzle.uniqueSort;\n
jQuery.text = Sizzle.getText;\n
jQuery.isXMLDoc = Sizzle.isXML;\n
jQuery.contains = Sizzle.contains;\n
\n
\n
})( window );\n
// String to Object options format cache\n
var optionsCache = {};\n
\n
// Convert String-formatted options into Object-formatted ones and store in cache\n
function createOptions( options ) {\n
\tvar object = optionsCache[ options ] = {};\n
\tjQuery.each( options.match( core_rnotwhite ) || [], function( _, flag ) {\n
\t\tobject[ flag ] = true;\n
\t});\n
\treturn object;\n
}\n
\n
/*\n
 * Create a callback list using the following parameters:\n
 *\n
 *\toptions: an optional list of space-separated options that will change how\n
 *\t\t\tthe callback list behaves or a more traditional option object\n
 *\n
 * By default a callback list will act like an event callback list and can be\n
 * "fired" multiple times.\n
 *\n
 * Possible options:\n
 *\n
 *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n
 *\n
 *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n
 *\t\t\t\t\tafter the list has been fired right away with the latest "memorized"\n
 *\t\t\t\t\tvalues (like a Deferred)\n
 *\n
 *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n
 *\n
 *\tstopOnFalse:\tinterrupt callings when a callback returns false\n
 *\n
 */\n
jQuery.Callbacks = function( options ) {\n
\n
\t// Convert options from String-formatted to Object-formatted if needed\n
\t// (we check in cache first)\n
\toptions = typeof options === "string" ?\n
\t\t( optionsCache[ options ] || createOptions( options ) ) :\n
\t\tjQuery.extend( {}, options );\n
\n
\tvar // Last fire value (for non-forgettable lists)\n
\t\tmemory,\n
\t\t// Flag to know if list was already fired\n
\t\tfired,\n
\t\t// Flag to know if list is currently firing\n
\t\tfiring,\n
\t\t// First callback to fire (used internally by add and fireWith)\n
\t\tfiringStart,\n
\t\t// End of the loop when firing\n
\t\tfiringLength,\n
\t\t// Index of currently firing callback (modified by remove if needed)\n
\t\tfiringIndex,\n
\t\t// Actual callback list\n
\t\tlist = [],\n
\t\t// Stack of fire calls for repeatable lists\n
\t\tstack = !options.once && [],\n
\t\t// Fire callbacks\n
\t\tfire = function( data ) {\n
\t\t\tmemory = options.memory && data;\n
\t\t\tfired = true;\n
\t\t\tfiringIndex = firingStart || 0;\n
\t\t\tfiringStart = 0;\n
\t\t\tfiringLength = list.length;\n
\t\t\tfiring = true;\n
\t\t\tfor ( ; list && firingIndex < firingLength; firingIndex++ ) {\n
\t\t\t\tif ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {\n
\t\t\t\t\tmemory = false; // To prevent further calls using add\n
\t\t\t\t\tbreak;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\tfiring = false;\n
\t\t\tif ( list ) {\n
\t\t\t\tif ( stack ) {\n
\t\t\t\t\tif ( stack.length ) {\n
\t\t\t\t\t\tfire( stack.shift() );\n
\t\t\t\t\t}\n
\t\t\t\t} else if ( memory ) {\n
\t\t\t\t\tlist = [];\n
\t\t\t\t} else {\n
\t\t\t\t\tself.disable();\n
\t\t\t\t}\n
\t\t\t}\n
\t\t},\n
\t\t// Actual Callbacks object\n
\t\tself = {\n
\t\t\t// Add a callback or a collection of callbacks to the list\n
\t\t\tadd: function() {\n
\t\t\t\tif ( list ) {\n
\t\t\t\t\t// First, we save the current length\n
\t\t\t\t\tvar start = list.length;\n
\t\t\t\t\t(function add( args ) {\n
\t\t\t\t\t\tjQuery.each( args, function( _, arg ) {\n
\t\t\t\t\t\t\tvar type = jQuery.type( arg );\n
\t\t\t\t\t\t\tif ( type === "function" ) {\n
\t\t\t\t\t\t\t\tif ( !options.unique || !self.has( arg ) ) {\n
\t\t\t\t\t\t\t\t\tlist.push( arg );\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t} else if ( arg && arg.length && type !== "string" ) {\n
\t\t\t\t\t\t\t\t// Inspect recursively\n
\t\t\t\t\t\t\t\tadd( arg );\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t});\n
\t\t\t\t\t})( arguments );\n
\t\t\t\t\t// Do we need to add the callbacks to the\n
\t\t\t\t\t// current firing batch?\n
\t\t\t\t\tif ( firing ) {\n
\t\t\t\t\t\tfiringLength = list.length;\n
\t\t\t\t\t// With memory, if we\'re not firing then\n
\t\t\t\t\t// we should call right away\n
\t\t\t\t\t} else if ( memory ) {\n
\t\t\t\t\t\tfiringStart = start;\n
\t\t\t\t\t\tfire( memory );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// Remove a callback from the list\n
\t\t\tremove: function() {\n
\t\t\t\tif ( list ) {\n
\t\t\t\t\tjQuery.each( arguments, function( _, arg ) {\n
\t\t\t\t\t\tvar index;\n
\t\t\t\t\t\twhile( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\n
\t\t\t\t\t\t\tlist.splice( index, 1 );\n
\t\t\t\t\t\t\t// Handle firing indexes\n
\t\t\t\t\t\t\tif ( firing ) {\n
\t\t\t\t\t\t\t\tif ( index <= firingLength ) {\n
\t\t\t\t\t\t\t\t\tfiringLength--;\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t\tif ( index <= firingIndex ) {\n
\t\t\t\t\t\t\t\t\tfiringIndex--;\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t});\n
\t\t\t\t}\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// Check if a given callback is in the list.\n
\t\t\t// If no argument is given, return whether or not list has callbacks attached.\n
\t\t\thas: function( fn ) {\n
\t\t\t\treturn fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );\n
\t\t\t},\n
\t\t\t// Remove all callbacks from the list\n
\t\t\tempty: function() {\n
\t\t\t\tlist = [];\n
\t\t\t\tfiringLength = 0;\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// Have the list do nothing anymore\n
\t\t\tdisable: function() {\n
\t\t\t\tlist = stack = memory = undefined;\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// Is it disabled?\n
\t\t\tdisabled: function() {\n
\t\t\t\treturn !list;\n
\t\t\t},\n
\t\t\t// Lock the list in its current state\n
\t\t\tlock: function() {\n
\t\t\t\tstack = undefined;\n
\t\t\t\tif ( !memory ) {\n
\t\t\t\t\tself.disable();\n
\t\t\t\t}\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// Is it locked?\n
\t\t\tlocked: function() {\n
\t\t\t\treturn !stack;\n
\t\t\t},\n
\t\t\t// Call all callbacks with the given context and arguments\n
\t\t\tfireWith: function( context, args ) {\n
\t\t\t\tif ( list && ( !fired || stack ) ) {\n
\t\t\t\t\targs = args || [];\n
\t\t\t\t\targs = [ context, args.slice ? args.slice() : args ];\n
\t\t\t\t\tif ( firing ) {\n
\t\t\t\t\t\tstack.push( args );\n
\t\t\t\t\t} else {\n
\t\t\t\t\t\tfire( args );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// Call all the callbacks

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAM=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="3" aka="AAAAAAAAAAM=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

 with the given arguments\n
\t\t\tfire: function() {\n
\t\t\t\tself.fireWith( this, arguments );\n
\t\t\t\treturn this;\n
\t\t\t},\n
\t\t\t// To know if the callbacks have already been called at least once\n
\t\t\tfired: function() {\n
\t\t\t\treturn !!fired;\n
\t\t\t}\n
\t\t};\n
\n
\treturn self;\n
};\n
jQuery.extend({\n
\n
\tDeferred: function( func ) {\n
\t\tvar tuples = [\n
\t\t\t\t// action, add listener, listener list, final state\n
\t\t\t\t[ "resolve", "done", jQuery.Callbacks("once memory"), "resolved" ],\n
\t\t\t\t[ "reject", "fail", jQuery.Callbacks("once memory"), "rejected" ],\n
\t\t\t\t[ "notify", "progress", jQuery.Callbacks("memory") ]\n
\t\t\t],\n
\t\t\tstate = "pending",\n
\t\t\tpromise = {\n
\t\t\t\tstate: function() {\n
\t\t\t\t\treturn state;\n
\t\t\t\t},\n
\t\t\t\talways: function() {\n
\t\t\t\t\tdeferred.done( arguments ).fail( arguments );\n
\t\t\t\t\treturn this;\n
\t\t\t\t},\n
\t\t\t\tthen: function( /* fnDone, fnFail, fnProgress */ ) {\n
\t\t\t\t\tvar fns = arguments;\n
\t\t\t\t\treturn jQuery.Deferred(function( newDefer ) {\n
\t\t\t\t\t\tjQuery.each( tuples, function( i, tuple ) {\n
\t\t\t\t\t\t\tvar action = tuple[ 0 ],\n
\t\t\t\t\t\t\t\tfn = jQuery.isFunction( fns[ i ] ) && fns[ i ];\n
\t\t\t\t\t\t\t// deferred[ done | fail | progress ] for forwarding actions to newDefer\n
\t\t\t\t\t\t\tdeferred[ tuple[1] ](function() {\n
\t\t\t\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\n
\t\t\t\t\t\t\t\tif ( returned && jQuery.isFunction( returned.promise ) ) {\n
\t\t\t\t\t\t\t\t\treturned.promise()\n
\t\t\t\t\t\t\t\t\t\t.done( newDefer.resolve )\n
\t\t\t\t\t\t\t\t\t\t.fail( newDefer.reject )\n
\t\t\t\t\t\t\t\t\t\t.progress( newDefer.notify );\n
\t\t\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t\t\tnewDefer[ action + "With" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t});\n
\t\t\t\t\t\t});\n
\t\t\t\t\t\tfns = null;\n
\t\t\t\t\t}).promise();\n
\t\t\t\t},\n
\t\t\t\t// Get a promise for this deferred\n
\t\t\t\t// If obj is provided, the promise aspect is added to the object\n
\t\t\t\tpromise: function( obj ) {\n
\t\t\t\t\treturn obj != null ? jQuery.extend( obj, promise ) : promise;\n
\t\t\t\t}\n
\t\t\t},\n
\t\t\tdeferred = {};\n
\n
\t\t// Keep pipe for back-compat\n
\t\tpromise.pipe = promise.then;\n
\n
\t\t// Add list-specific methods\n
\t\tjQuery.each( tuples, function( i, tuple ) {\n
\t\t\tvar list = tuple[ 2 ],\n
\t\t\t\tstateString = tuple[ 3 ];\n
\n
\t\t\t// promise[ done | fail | progress ] = list.add\n
\t\t\tpromise[ tuple[1] ] = list.add;\n
\n
\t\t\t// Handle state\n
\t\t\tif ( stateString ) {\n
\t\t\t\tlist.add(function() {\n
\t\t\t\t\t// state = [ resolved | rejected ]\n
\t\t\t\t\tstate = stateString;\n
\n
\t\t\t\t// [ reject_list | resolve_list ].disable; progress_list.lock\n
\t\t\t\t}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );\n
\t\t\t}\n
\n
\t\t\t// deferred[ resolve | reject | notify ]\n
\t\t\tdeferred[ tuple[0] ] = function() {\n
\t\t\t\tdeferred[ tuple[0] + "With" ]( this === deferred ? promise : this, arguments );\n
\t\t\t\treturn this;\n
\t\t\t};\n
\t\t\tdeferred[ tuple[0] + "With" ] = list.fireWith;\n
\t\t});\n
\n
\t\t// Make the deferred a promise\n
\t\tpromise.promise( deferred );\n
\n
\t\t// Call given func if any\n
\t\tif ( func ) {\n
\t\t\tfunc.call( deferred, deferred );\n
\t\t}\n
\n
\t\t// All done!\n
\t\treturn deferred;\n
\t},\n
\n
\t// Deferred helper\n
\twhen: function( subordinate /* , ..., subordinateN */ ) {\n
\t\tvar i = 0,\n
\t\t\tresolveValues = core_slice.call( arguments ),\n
\t\t\tlength = resolveValues.length,\n
\n
\t\t\t// the count of uncompleted subordinates\n
\t\t\tremaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,\n
\n
\t\t\t// the master Deferred. If resolveValues consist of only a single Deferred, just use that.\n
\t\t\tdeferred = remaining === 1 ? subordinate : jQuery.Deferred(),\n
\n
\t\t\t// Update function for both resolve and progress values\n
\t\t\tupdateFunc = function( i, contexts, values ) {\n
\t\t\t\treturn function( value ) {\n
\t\t\t\t\tcontexts[ i ] = this;\n
\t\t\t\t\tvalues[ i ] = arguments.length > 1 ? core_slice.call( arguments ) : value;\n
\t\t\t\t\tif( values === progressValues ) {\n
\t\t\t\t\t\tdeferred.notifyWith( contexts, values );\n
\t\t\t\t\t} else if ( !( --remaining ) ) {\n
\t\t\t\t\t\tdeferred.resolveWith( contexts, values );\n
\t\t\t\t\t}\n
\t\t\t\t};\n
\t\t\t},\n
\n
\t\t\tprogressValues, progressContexts, resolveContexts;\n
\n
\t\t// add listeners to Deferred subordinates; treat others as resolved\n
\t\tif ( length > 1 ) {\n
\t\t\tprogressValues = new Array( length );\n
\t\t\tprogressContexts = new Array( length );\n
\t\t\tresolveContexts = new Array( length );\n
\t\t\tfor ( ; i < length; i++ ) {\n
\t\t\t\tif ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {\n
\t\t\t\t\tresolveValues[ i ].promise()\n
\t\t\t\t\t\t.done( updateFunc( i, resolveContexts, resolveValues ) )\n
\t\t\t\t\t\t.fail( deferred.reject )\n
\t\t\t\t\t\t.progress( updateFunc( i, progressContexts, progressValues ) );\n
\t\t\t\t} else {\n
\t\t\t\t\t--remaining;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\t// if we\'re not waiting on anything, resolve the master\n
\t\tif ( !remaining ) {\n
\t\t\tdeferred.resolveWith( resolveContexts, resolveValues );\n
\t\t}\n
\n
\t\treturn deferred.promise();\n
\t}\n
});\n
jQuery.support = (function( support ) {\n
\tvar input = document.createElement("input"),\n
\t\tfragment = document.createDocumentFragment(),\n
\t\tdiv = document.createElement("div"),\n
\t\tselect = document.createElement("select"),\n
\t\topt = select.appendChild( document.createElement("option") );\n
\n
\t// Finish early in limited environments\n
\tif ( !input.type ) {\n
\t\treturn support;\n
\t}\n
\n
\tinput.type = "checkbox";\n
\n
\t// Support: Safari 5.1, iOS 5.1, Android 4.x, Android 2.3\n
\t// Check the default checkbox/radio value ("" on old WebKit; "on" elsewhere)\n
\tsupport.checkOn = input.value !== "";\n
\n
\t// Must access the parent to make an option select properly\n
\t// Support: IE9, IE10\n
\tsupport.optSelected = opt.selected;\n
\n
\t// Will be defined later\n
\tsupport.reliableMarginRight = true;\n
\tsupport.boxSizingReliable = true;\n
\tsupport.pixelPosition = false;\n
\n
\t// Make sure checked status is properly cloned\n
\t// Support: IE9, IE10\n
\tinput.checked = true;\n
\tsupport.noCloneChecked = input.cloneNode( true ).checked;\n
\n
\t// Make sure that the options inside disabled selects aren\'t marked as disabled\n
\t// (WebKit marks them as disabled)\n
\tselect.disabled = true;\n
\tsupport.optDisabled = !opt.disabled;\n
\n
\t// Check if an input maintains its value after becoming a radio\n
\t// Support: IE9, IE10\n
\tinput = document.createElement("input");\n
\tinput.value = "t";\n
\tinput.type = "radio";\n
\tsupport.radioValue = input.value === "t";\n
\n
\t// #11217 - WebKit loses check when the name is after the checked attribute\n
\tinput.setAttribute( "checked", "t" );\n
\tinput.setAttribute( "name", "t" );\n
\n
\tfragment.appendChild( input );\n
\n
\t// Support: Safari 5.1, Android 4.x, Android 2.3\n
\t// old WebKit doesn\'t clone checked state correctly in fragments\n
\tsupport.checkClone = fragment.cloneNode( true ).cloneNode( true ).lastChild.checked;\n
\n
\t// Support: Firefox, Chrome, Safari\n
\t// Beware of CSP restrictions (https://developer.mozilla.org/en/Security/CSP)\n
\tsupport.focusinBubbles = "onfocusin" in window;\n
\n
\tdiv.style.backgroundClip = "content-box";\n
\tdiv.cloneNode( true ).style.backgroundClip = "";\n
\tsupport.clearCloneStyle = div.style.backgroundClip === "content-box";\n
\n
\t// Run tests that need a body at doc ready\n
\tjQuery(function() {\n
\t\tvar container, marginDiv,\n
\t\t\t// Support: Firefox, Android 2.3 (Prefixed box-sizing versions).\n
\t\t\tdivReset = "padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",\n
\t\t\tbody = document.getElementsByTagName("body")[ 0 ];\n
\n
\t\tif ( !body ) {\n
\t\t\t// Return for frameset docs that don\'t have a body\n
\t\t\treturn;\n
\t\t}\n
\n
\t\tcontainer = document.createElement("div");\n
\t\tcontainer.style.cssText = "border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";\n
\n
\t\t// Check box-sizing and margin behavior.\n
\t\tbody.appendChild( container ).appendChild( div );\n
\t\tdiv.innerHTML = "";\n
\t\t// Support: Firefox, Android 2.3 (Prefixed box-sizing versions).\n
\t\tdiv.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%";\n
\n
\t\t// Workaround failing boxSizing test due to offsetWidth returning wrong value\n
\t\t// with some non-1 values of body zoom, ticket #13543\n
\t\tjQuery.swap( body, body.style.zoom != null ? { zoom: 1 } : {}, function() {\n
\t\t\tsupport.boxSizing = div.offsetWidth === 4;\n
\t\t});\n
\n
\t\t// Use window.getComputedStyle because jsdom on node.js will break without it.\n
\t\tif ( window.getComputedStyle ) {\n
\t\t\tsupport.pixelPosition = ( window.getComputedStyle( div, null ) || {} ).top !== "1%";\n
\t\t\tsupport.boxSizingReliable = ( window.getComputedStyle( div, null ) || { width: "4px" } ).width === "4px";\n
\n
\t\t\t// Support: Android 2.3\n
\t\t\t// Check if div with explicit width and no margin-right incorrectly\n
\t\t\t// gets computed margin-right based on width of container. (#3333)\n
\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n
\t\t\tmarginDiv = div.appendChild( document.createElement("div") );\n
\t\t\tmarginDiv.style.cssText = div.style.cssText = divReset;\n
\t\t\tmarginDiv.style.marginRight = marginDiv.style.width = "0";\n
\t\t\tdiv.style.width = "1px";\n
\n
\t\t\tsupport.reliableMarginRight =\n
\t\t\t\t!parseFloat( ( window.getComputedStyle( marginDiv, null ) || {} ).marginRight );\n
\t\t}\n
\n
\t\tbody.removeChild( container );\n
\t});\n
\n
\treturn support;\n
})( {} );\n
\n
/*\n
\tImplementation Summary\n
\n
\t1. Enforce API surface and semantic compatibility with 1.9.x branch\n
\t2. Improve the module\'s maintainability by reducing the storage\n
\t\tpaths to a single mechanism.\n
\t3. Use the same single mechanism to support "private" and "user" data.\n
\t4. _Never_ expose "private" data to user code (TODO: Drop _data, _removeData)\n
\t5. Avoid exposing implementation details on user objects (eg. expando properties)\n
\t6. Provide a clear path for implementation upgrade to WeakMap in 2014\n
*/\n
var data_user, data_priv,\n
\trbrace = /(?:\\{[\\s\\S]*\\}|\\[[\\s\\S]*\\])$/,\n
\trmultiDash = /([A-Z])/g;\n
\n
function Data() {\n
\t// Support: Android < 4,\n
\t// Old WebKit does not have Object.preventExtensions/freeze method,\n
\t// return new empty object instead with no [[set]] accessor\n
\tObject.defineProperty( this.cache = {}, 0, {\n
\t\tget: function() {\n
\t\t\treturn {};\n
\t\t}\n
\t});\n
\n
\tthis.expando = jQuery.expando + Math.random();\n
}\n
\n
Data.uid = 1;\n
\n
Data.accepts = function( owner ) {\n
\t// Accepts only:\n
\t//  - Node\n
\t//    - Node.ELEMENT_NODE\n
\t//    - Node.DOCUMENT_NODE\n
\t//  - Object\n
\t//    - Any\n
\treturn owner.nodeType ?\n
\t\towner.nodeType === 1 || owner.nodeType === 9 : true;\n
};\n
\n
Data.prototype = {\n
\tkey: function( owner ) {\n
\t\t// We can accept data for non-element nodes in modern browsers,\n
\t\t// but we should not, see #8335.\n
\t\t// Always return the key for a frozen object.\n
\t\tif ( !Data.accepts( owner ) ) {\n
\t\t\treturn 0;\n
\t\t}\n
\n
\t\tvar descriptor = {},\n
\t\t\t// Check if the owner object already has a cache key\n
\t\t\tunlock = owner[ this.expando ];\n
\n
\t\t// If not, create one\n
\t\tif ( !unlock ) {\n
\t\t\tunlock = Data.uid++;\n
\n
\t\t\t// Secure it in a non-enumerable, non-writable property\n
\t\t\ttry {\n
\t\t\t\tdescriptor[ this.expando ] = { value: unlock };\n
\t\t\t\tObject.defineProperties( owner, descriptor );\n
\n
\t\t\t// Support: Android < 4\n
\t\t\t// Fallback to a less secure definition\n
\t\t\t} catch ( e ) {\n
\t\t\t\tdescriptor[ this.expando ] = unlock;\n
\t\t\t\tjQuery.extend( owner, descriptor );\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Ensure the cache object\n
\t\tif ( !this.cache[ unlock ] ) {\n
\t\t\tthis.cache[ unlock ] = {};\n
\t\t}\n
\n
\t\treturn unlock;\n
\t},\n
\tset: function( owner, data, value ) {\n
\t\tvar prop,\n
\t\t\t// There may be an unlock assigned to this node,\n
\t\t\t// if there is no entry for this "owner", create one inline\n
\t\t\t// and set the unlock as though an owner entry had always existed\n
\t\t\tunlock = this.key( owner ),\n
\t\t\tcache = this.cache[ unlock ];\n
\n
\t\t// Handle: [ owner, key, value ] args\n
\t\tif ( typeof data === "string" ) {\n
\t\t\tcache[ data ] = value;\n
\n
\t\t// Handle: [ owner, { properties } ] args\n
\t\t} else {\n
\t\t\t// Fresh assignments by object are shallow copied\n
\t\t\tif ( jQuery.isEmptyObject( cache ) ) {\n
\t\t\t\tjQuery.extend( this.cache[ unlock ], data );\n
\t\t\t// Otherwise, copy the properties one-by-one to the cache object\n
\t\t\t} else {\n
\t\t\t\tfor ( prop in data ) {\n
\t\t\t\t\tcache[ prop ] = data[ prop ];\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t\treturn cache;\n
\t},\n
\tget: function( owner, key ) {\n
\t\t// Either a valid cache is found, or will be created.\n
\t\t// New caches will be created and the unlock returned,\n
\t\t// allowing direct access to the newly created\n
\t\t// empty data object. A valid owner object must be provided.\n
\t\tvar cache = this.cache[ this.key( owner ) ];\n
\n
\t\treturn key === undefined ?\n
\t\t\tcache : cache[ key ];\n
\t},\n
\taccess: function( owner, key, value ) {\n
\t\tvar stored;\n
\t\t// In cases where either:\n
\t\t//\n
\t\t//   1. No key was specified\n
\t\t//   2. A string key was specified, but no value provided\n
\t\t//\n
\t\t// Take the "read" path and allow the get method to determine\n
\t\t// which value to return, respectively either:\n
\t\t//\n
\t\t//   1. The entire cache object\n
\t\t//   2. The data stored at the key\n
\t\t//\n
\t\tif ( key === undefined ||\n
\t\t\t\t((key && typeof key === "string") && value === undefined) ) {\n
\n
\t\t\tstored = this.get( owner, key );\n
\n
\t\t\treturn stored !== undefined ?\n
\t\t\t\tstored : this.get( owner, jQuery.camelCase(key) );\n
\t\t}\n
\n
\t\t// [*]When the key is not a string, or both a key and value\n
\t\t// are specified, set or extend (existing objects) with either:\n
\t\t//\n
\t\t//   1. An object of properties\n
\t\t//   2. A key and value\n
\t\t//\n
\t\tthis.set( owner, key, value );\n
\n
\t\t// Since the "set" path can have two possible entry points\n
\t\t// return the expected data based on which path was taken[*]\n
\t\treturn value !== undefined ? value : key;\n
\t},\n
\tremove: function( owner, key ) {\n
\t\tvar i, name, camel,\n
\t\t\tunlock = this.key( owner ),\n
\t\t\tcache = this.cache[ unlock ];\n
\n
\t\tif ( key === undefined ) {\n
\t\t\tthis.cache[ unlock ] = {};\n
\n
\t\t} else {\n
\t\t\t// Support array or space separated string of keys\n
\t\t\tif ( jQuery.isArray( key ) ) {\n
\t\t\t\t// If "name" is an array of keys...\n
\t\t\t\t// When data is initially created, via ("key", "val") signature,\n
\t\t\t\t// keys will be converted to camelCase.\n
\t\t\t\t// Since there is no way to tell _how_ a key was added, remove\n
\t\t\t\t// both plain key and camelCase key. #12786\n
\t\t\t\t// This will only penalize the array argument path.\n
\t\t\t\tname = key.concat( key.map( jQuery.camelCase ) );\n
\t\t\t} else {\n
\t\t\t\tcamel = jQuery.camelCase( key );\n
\t\t\t\t// Try the string as a key before any manipulation\n
\t\t\t\tif ( key in cache ) {\n
\t\t\t\t\tname = [ key, camel ];\n
\t\t\t\t} else {\n
\t\t\t\t\t// If a key with the spaces exists, use it.\n
\t\t\t\t\t// Otherwise, create an array by matching non-whitespace\n
\t\t\t\t\tname = camel;\n
\t\t\t\t\tname = name in cache ?\n
\t\t\t\t\t\t[ name ] : ( name.match( core_rnotwhite ) || [] );\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\ti = name.length;\n
\t\t\twhile ( i-- ) {\n
\t\t\t\tdelete cache[ name[ i ] ];\n
\t\t\t}\n
\t\t}\n
\t},\n
\thasData: function( owner ) {\n
\t\treturn !jQuery.isEmptyObject(\n
\t\t\tthis.cache[ owner[ this.expando ] ] || {}\n
\t\t);\n
\t},\n
\tdiscard: function( owner ) {\n
\t\tif ( owner[ this.expando ] ) {\n
\t\t\tdelete this.cache[ owner[ this.expando ] ];\n
\t\t}\n
\t}\n
};\n
\n
// These may be used throughout the jQuery core codebase\n
data_user = new Data();\n
data_priv = new Data();\n
\n
\n
jQuery.extend({\n
\tacceptData: Data.accepts,\n
\n
\thasData: function( elem ) {\n
\t\treturn data_user.hasData( elem ) || data_priv.hasData( elem );\n
\t},\n
\n
\tdata: function( elem, name, data ) {\n
\t\treturn data_user.access( elem, name, data );\n
\t},\n
\n
\tremoveData: function( elem, name ) {\n
\t\tdata_user.remove( elem, name );\n
\t},\n
\n
\t// TODO: Now that all calls to _data and _removeData have been replaced\n
\t// with direct calls to data_priv methods, these can be deprecated.\n
\t_data: function( elem, name, data ) {\n
\t\treturn data_priv.access( elem, name, data );\n
\t},\n
\n
\t_removeData: function( elem, name ) {\n
\t\tdata_priv.remove( elem, name );\n
\t}\n
});\n
\n
jQuery.fn.extend({\n
\tdata: function( key, value ) {\n
\t\tvar attrs, name,\n
\t\t\telem = this[ 0 ],\n
\t\t\ti = 0,\n
\t\t\tdata = null;\n
\n
\t\t// Gets all values\n
\t\tif ( key === undefined ) {\n
\t\t\tif ( this.length ) {\n
\t\t\t\tdata = data_user.get( elem );\n
\n
\t\t\t\tif ( elem.nodeType === 1 && !data_priv.get( elem, "hasDataAttrs" ) ) {\n
\t\t\t\t\tattrs = elem.attributes;\n
\t\t\t\t\tfor ( ; i < attrs.length; i++ ) {\n
\t\t\t\t\t\tname = attrs[ i ].name;\n
\n
\t\t\t\t\t\tif ( name.indexOf( "data-" ) === 0 ) {\n
\t\t\t\t\t\t\tname = jQuery.camelCase( name.slice(5) );\n
\t\t\t\t\t\t\tdataAttr( elem, name, data[ name ] );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\tdata_priv.set( elem, "hasDataAttrs", true );\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\treturn data;\n
\t\t}\n
\n
\t\t// Sets multiple values\n
\t\tif ( typeof key === "object" ) {\n
\t\t\treturn this.each(function() {\n
\t\t\t\tdata_user.set( this, key );\n
\t\t\t});\n
\t\t}\n
\n
\t\treturn jQuery.access( this, function( value ) {\n
\t\t\tvar data,\n
\t\t\t\tcamelKey = jQuery.camelCase( key );\n
\n
\t\t\t// The calling jQuery object (element matches) is not empty\n
\t\t\t// (and therefore has an element appears at this[ 0 ]) and the\n
\t\t\t// `value` parameter was not undefined. An empty jQuery object\n
\t\t\t// will result in `undefined` for elem = this[ 0 ] which will\n
\t\t\t// throw an exception if an attempt to read a data cache is made.\n
\t\t\tif ( elem && value === undefined ) {\n
\t\t\t\t// Attempt to get data from the cache\n
\t\t\t\t// with the key as-is\n
\t\t\t\tdata = data_user.get( elem, key );\n
\t\t\t\tif ( data !== undefined ) {\n
\t\t\t\t\treturn data;\n
\t\t\t\t}\n
\n
\t\t\t\t// Attempt to get data from the cache\n
\t\t\t\t// with the key camelized\n
\t\t\t\tdata = data_user.get( elem, camelKey );\n
\t\t\t\tif ( data !== undefined ) {\n
\t\t\t\t\treturn data;\n
\t\t\t\t}\n
\n
\t\t\t\t// Attempt to "discover" the data in\n
\t\t\t\t// HTML5 custom data-* attrs\n
\t\t\t\tdata = dataAttr( elem, camelKey, undefined );\n
\t\t\t\tif ( data !== undefined ) {\n
\t\t\t\t\treturn data;\n
\t\t\t\t}\n
\n
\t\t\t\t// We tried really hard, but the data doesn\'t exist.\n
\t\t\t\treturn;\n
\t\t\t}\n
\n
\t\t\t// Set the data...\n
\t\t\tthis.each(function() {\n
\t\t\t\t// First, attempt to store a copy or reference of any\n
\t\t\t\t// data that might\'ve been store with a camelCased key.\n
\t\t\t\tvar data = data_user.get( this, camelKey );\n
\n
\t\t\t\t// For HTML5 data-* attribute interop, we have to\n
\t\t\t\t// store property names with dashes in a camelCase form.\n
\t\t\t\t// This might not apply to all properties...*\n
\t\t\t\tdata_user.set( this, camelKey, value );\n
\n
\t\t\t\t// *... In the case of properties that might _actually_\n
\t\t\t\t// have dashes, we need to also store a copy of that\n
\t\t\t\t// unchanged property.\n
\t\t\t\tif ( key.indexOf("-") !== -1 && data !== undefined ) {\n
\t\t\t\t\tdata_user.set( this, key, value );\n
\t\t\t\t}\n
\t\t\t});\n
\t\t}, null, value, arguments.length > 1, null, true );\n
\t},\n
\n
\tremoveData: function( key ) {\n
\t\treturn this.each(function() {\n
\t\t\tdata_user.remove( this, key );\n
\t\t});\n
\t}\n
});\n
\n
function dataAttr( elem, key, data ) {\n
\tvar name;\n
\n
\t// If nothing was found internally, try to fetch any\n
\t// data from the HTML5 data-* attribute\n
\tif ( data === undefined && elem.nodeType === 1 ) {\n
\t\tname = "data-" + key.replace( rmultiDash, "-$1" ).toLowerCase();\n
\t\tdata = elem.getAttribute( name );\n
\n
\t\tif ( typeof data === "string" ) {\n
\t\t\ttry {\n
\t\t\t\tdata = data === "true" ? true :\n
\t\t\t\t\tdata === "false" ? false :\n
\t\t\t\t\tdata === "null" ? null :\n
\t\t\t\t\t// Only convert to a number if it doesn\'t change the string\n
\t\t\t\t\t+data + "" === data ? +data :\n
\t\t\t\t\trbrace.test( data ) ? JSON.parse( data ) :\n
\t\t\t\t\tdata;\n
\t\t\t} catch( e ) {}\n
\n
\t\t\t// Make sure we set the data so it isn\'t changed later\n
\t\t\tdata_user.set( elem, key, data );\n
\t\t} else {\n
\t\t\tdata = undefined;\n
\t\t}\n
\t}\n
\treturn data;\n
}\n
jQuery.extend({\n
\tqueue: function( elem, type, data ) {\n
\t\tvar queue;\n
\n
\t\tif ( elem ) {\n
\t\t\ttype = ( type || "fx" ) + "queue";\n
\t\t\tqueue = data_priv.get( elem, type );\n
\n
\t\t\t// Speed up dequeue by getting out quickly if this is just a lookup\n
\t\t\tif ( data ) {\n
\t\t\t\tif ( !queue || jQuery.isArray( data ) ) {\n
\t\t\t\t\tqueue = data_priv.access( elem, type, jQuery.makeArray(data) );\n
\t\t\t\t} else {\n
\t\t\t\t\tqueue.push( data );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\treturn queue || [];\n
\t\t}\n
\t},\n
\n
\tdequeue: function( elem, type ) {\n
\t\ttype = type || "fx";\n
\n
\t\tvar queue = jQuery.queue( elem, type ),\n
\t\t\tstartLength = queue.length,\n
\t\t\tfn = queue.shift(),\n
\t\t\thooks = jQuery._queueHooks( elem, type ),\n
\t\t\tnext = function() {\n
\t\t\t\tjQuery.dequeue( elem, type );\n
\t\t\t};\n
\n
\t\t// If the fx queue is dequeued, always remove the progress sentinel\n
\t\tif ( fn === "inprogress" ) {\n
\t\t\tfn = queue.shift();\n
\t\t\tstartLength--;\n
\t\t}\n
\n
\t\tif ( fn ) {\n
\n
\t\t\t// Add a progress sentinel to prevent the fx queue from being\n
\t\t\t// automatically dequeued\n
\t\t\tif ( type === "fx" ) {\n
\t\t\t\tqueue.unshift( "inprogress" );\n
\t\t\t}\n
\n
\t\t\t// clear up the last queue stop function\n
\t\t\tdelete hooks.stop;\n
\t\t\tfn.call( elem, next, hooks );\n
\t\t}\n
\n
\t\tif ( !startLength && hooks ) {\n
\t\t\thooks.empty.fire();\n
\t\t}\n
\t},\n
\n
\t// not intended for public consumption - generates a queueHooks object, or returns the current one\n
\t_queueHooks: function( elem, type ) {\n
\t\tvar key = type + "queueHooks";\n
\t\treturn data_priv.get( elem, key ) || data_priv.access( elem, key, {\n
\t\t\tempty: jQuery.Callbacks("once memory").add(function() {\n
\t\t\t\tdata_priv.remove( elem, [ type + "queue", key ] );\n
\t\t\t})\n
\t\t});\n
\t}\n
});\n
\n
jQuery.fn.extend({\n
\tqueue: function( type, data ) {\n
\t\tvar setter = 2;\n
\n
\t\tif ( typeof type !== "string" ) {\n
\t\t\tdata = type;\n
\t\t\ttype = "fx";\n
\t\t\tsetter--;\n
\t\t}\n
\n
\t\tif ( arguments.length < setter ) {\n
\t\t\treturn jQuery.queue( this[0], type );\n
\t\t}\n
\n
\t\treturn data === undefined ?\n
\t\t\tthis :\n
\t\t\tthis.each(function() {\n
\t\t\t\tvar queue = jQuery.queue( this, type, data );\n
\n
\t\t\t\t// ensure a hooks for this queue\n
\t\t\t\tjQuery._queueHooks( this, type );\n
\n
\t\t\t\tif ( type === "fx" && queue[0] !== "inprogress" ) {\n
\t\t\t\t\tjQuery.dequeue( this, type );\n
\t\t\t\t}\n
\t\t\t});\n
\t},\n
\tdequeue: function( type ) {\n
\t\treturn this.each(function() {\n
\t\t\tjQuery.dequeue( this, type );\n
\t\t});\n
\t},\n
\t// Based off of the plugin by Clint Helfers, with permission.\n
\t// http://blindsignals.com/index.php/2009/07/jquery-delay/\n
\tdelay: function( time, type ) {\n
\t\ttime = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\n
\t\ttype = type || "fx";\n
\n
\t\treturn this.queue( type, function( next, hooks ) {\n
\t\t\tvar timeout = setTimeout( next, time );\n
\t\t\thooks.stop = function() {\n
\t\t\t\tclearTimeout( timeout );\n
\t\t\t};\n
\t\t});\n
\t},\n
\tclearQueue: function( type ) {\n
\t\treturn this.queue( type || "fx", [] );\n
\t},\n
\t// Get a promise resolved when queues of a certain type\n
\t// are emptied (fx is the type by default)\n
\tpromise: function( type, obj ) {\n
\t\tvar tmp,\n
\t\t\tcount = 1,\n
\t\t\tdefer = jQuery.Deferred(),\n
\t\t\telements = this,\n
\t\t\ti = this.length,\n
\t\t\tresolve = function() {\n
\t\t\t\tif ( !( --count ) ) {\n
\t\t\t\t\tdefer.resolveWith( elements, [ elements ] );\n
\t\t\t\t}\n
\t\t\t};\n
\n
\t\tif ( typeof type !== "string" ) {\n
\t\t\tobj = type;\n
\t\t\ttype = undefined;\n
\t\t}\n
\t\ttype = type || "fx";\n
\n
\t\twhile( i-- ) {\n
\t\t\ttmp = data_priv.get( elements[ i ], type + "queueHooks" );\n
\t\t\tif ( tmp && tmp.empty ) {\n
\t\t\t\tcount++;\n
\t\t\t\ttmp.empty.add( resolve );\n
\t\t\t}\n
\t\t}\n
\t\tresolve();\n
\t\treturn defer.promise( obj );\n
\t}\n
});\n
var nodeHook, boolHook,\n
\trclass = /[\\t\\r\\n\\f]/g,\n
\trreturn = /\\r/g,\n
\trfocusable = /^(?:input|select|textarea|button)$/i;\n
\n
jQuery.fn.extend({\n
\tattr: function( name, value ) {\n
\t\treturn jQuery.access( this, jQuery.attr, name, value, arguments.length > 1 );\n
\t},\n
\n
\tremoveAttr: function( name ) {\n
\t\treturn this.each(function() {\n
\t\t\tjQuery.removeAttr( this, name );\n
\t\t});\n
\t},\n
\n
\tprop: function( name, value ) {\n
\t\treturn jQuery.access( this, jQuery.prop, name, value, arguments.length > 1 );\n
\t},\n
\n
\tremoveProp: function( name ) {\n
\t\treturn this.each(function() {\n
\t\t\tdelete this[ jQuery.propFix[ name ] || name ];\n
\t\t});\n
\t},\n
\n
\taddClass: function( value ) {\n
\t\tvar classes, elem, cur, clazz, j,\n
\t\t\ti = 0,\n
\t\t\tlen = this.length,\n
\t\t\tproceed = typeof value === "string" && value;\n
\n
\t\tif ( jQuery.isFunction( value ) ) {\n
\t\t\treturn this.each(function( j ) {\n
\t\t\t\tjQuery( this ).addClass( value.call( this, j, this.className ) );\n
\t\t\t});\n
\t\t}\n
\n
\t\tif ( proceed ) {\n
\t\t\t// The disjunction here is for better compressibility (see removeClass)\n
\t\t\tclasses = ( value || "" ).match( core_rnotwhite ) || [];\n
\n
\t\t\tfor ( ; i < len; i++ ) {\n
\t\t\t\telem = this[ i ];\n
\t\t\t\tcur = elem.nodeType === 1 && ( elem.className ?\n
\t\t\t\t\t( " " + elem.className + " " ).replace( rclass, " " ) :\n
\t\t\t\t\t" "\n
\t\t\t\t);\n
\n
\t\t\t\tif ( cur ) {\n
\t\t\t\t\tj = 0;\n
\t\t\t\t\twhile ( (clazz = classes[j++]) ) {\n
\t\t\t\t\t\tif ( cur.indexOf( " " + clazz + " " ) < 0 ) {\n
\t\t\t\t\t\t\tcur += clazz + " ";\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\telem.className = jQuery.trim( cur );\n
\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this;\n
\t},\n
\n
\tremoveClass: function( value ) {\n
\t\tvar classes, elem, cur, clazz, j,\n
\t\t\ti = 0,\n
\t\t\tlen = this.length,\n
\t\t\tproceed = arguments.length === 0 || typeof value === "string" && value;\n
\n
\t\tif ( jQuery.isFunction( value ) ) {\n
\t\t\treturn this.each(function( j ) {\n
\t\t\t\tjQuery( this ).removeClass( value.call( this, j, this.className ) );\n
\t\t\t});\n
\t\t}\n
\t\tif ( proceed ) {\n
\t\t\tclasses = ( value || "" ).match( core_rnotwhite ) || [];\n
\n
\t\t\tfor ( ; i < len; i++ ) {\n
\t\t\t\telem = this[ i ];\n
\t\t\t\t// This expression is here for better compressibility (see addClass)\n
\t\t\t\tcur = elem.nodeType === 1 && ( elem.className ?\n
\t\t\t\t\t( " " + elem.className + " " ).replace( rclass, " " ) :\n
\t\t\t\t\t""\n
\t\t\t\t);\n
\n
\t\t\t\tif ( cur ) {\n
\t\t\t\t\tj = 0;\n
\t\t\t\t\twhile ( (clazz = classes[j++]) ) {\n
\t\t\t\t\t\t// Remove *all* instances\n
\t\t\t\t\t\twhile ( cur.indexOf( " " + clazz + " " ) >= 0 ) {\n
\t\t\t\t\t\t\tcur = cur.replace( " " + clazz + " ", " " );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\telem.className = value ? jQuery.trim( cur ) : "";\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this;\n
\t},\n
\n
\ttoggleClass: function( value, stateVal ) {\n
\t\tvar type = typeof value;\n
\n
\t\tif ( typeof stateVal === "boolean" && type === "string" ) {\n
\t\t\treturn stateVal ? this.addClass( value ) : this.removeClass( value );\n
\t\t}\n
\n
\t\tif ( jQuery.isFunction( value ) ) {\n
\t\t\treturn this.each(function( i ) {\n
\t\t\t\tjQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );\n
\t\t\t});\n
\t\t}\n
\n
\t\treturn this.each(function() {\n
\t\t\tif ( type === "string" ) {\n
\t\t\t\t// toggle individual class names\n
\t\t\t\tvar className,\n
\t\t\t\t\ti = 0,\n
\t\t\t\t\tself = jQuery( this ),\n
\t\t\t\t\tclassNames = value.match( core_rnotwhite ) || [];\n
\n
\t\t\t\twhile ( (className = classNames[ i++ ]) ) {\n
\t\t\t\t\t// check each className given, space separated list\n
\t\t\t\t\tif ( self.hasClass( className ) ) {\n
\t\t\t\t\t\tself.removeClass( className );\n
\t\t\t\t\t} else {\n
\t\t\t\t\t\tself.addClass( className );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t// Toggle whole class name\n
\t\t\t} else if ( type === core_strundefined || type === "boolean" ) {\n
\t\t\t\tif ( this.className ) {\n
\t\t\t\t\t// store className if set\n
\t\t\t\t\tdata_priv.set( this, "__className__", this.className );\n
\t\t\t\t}\n
\n
\t\t\t\t// If the element has a class name or if we\'re passed "false",\n
\t\t\t\t// then remove the whole classname (if there was one, the above saved it).\n
\t\t\t\t// Otherwise bring back whatever was previously saved (if anything),\n
\t\t\t\t// falling back to the empty string if nothing was stored.\n
\t\t\t\tthis.className = this.className || value === false ? "" : data_priv.get( this, "__className__" ) || "";\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\thasClass: function( selector ) {\n
\t\tvar className = " " + selector + " ",\n
\t\t\ti = 0,\n
\t\t\tl = this.length;\n
\t\tfor ( ; i < l; i++ ) {\n
\t\t\tif ( this[i].nodeType === 1 && (" " + this[i].className + " ").replace(rclass, " ").indexOf( className ) >= 0 ) {\n
\t\t\t\treturn true;\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn false;\n
\t},\n
\n
\tval: function( value ) {\n
\t\tvar hooks, ret, isFunction,\n
\t\t\telem = this[0];\n
\n
\t\tif ( !arguments.length ) {\n
\t\t\tif ( elem ) {\n
\t\t\t\thooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];\n
\n
\t\t\t\tif ( hooks && "get" in hooks && (ret = hooks.get( elem, "value" )) !== undefined ) {\n
\t\t\t\t\treturn ret;\n
\t\t\t\t}\n
\n
\t\t\t\tret = elem.value;\n
\n
\t\t\t\treturn typeof ret === "string" ?\n
\t\t\t\t\t// handle most common string cases\n
\t\t\t\t\tret.replace(rreturn, "") :\n
\t\t\t\t\t// handle cases where value is null/undef or number\n
\t\t\t\t\tret == null ? "" : ret;\n
\t\t\t}\n
\n
\t\t\treturn;\n
\t\t}\n
\n
\t\tisFunction = jQuery.isFunction( value );\n
\n
\t\treturn this.each(function( i ) {\n
\t\t\tvar val;\n
\n
\t\t\tif ( this.nodeType !== 1 ) {\n
\t\t\t\treturn;\n
\t\t\t}\n
\n
\t\t\tif ( isFunction ) {\n
\t\t\t\tval = value.call( this, i, jQuery( this ).val() );\n
\t\t\t} else {\n
\t\t\t\tval = value;\n
\t\t\t}\n
\n
\t\t\t// Treat null/undefined as ""; convert numbers to string\n
\t\t\tif ( val == null ) {\n
\t\t\t\tval = "";\n
\t\t\t} else if ( typeof val === "number" ) {\n
\t\t\t\tval += "";\n
\t\t\t} else if ( jQuery.isArray( val ) ) {\n
\t\t\t\tval = jQuery.map(val, function ( value ) {\n
\t\t\t\t\treturn value == null ? "" : value + "";\n
\t\t\t\t});\n
\t\t\t}\n
\n
\t\t\thooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\n
\n
\t\t\t// If set returns undefined, fall back to normal setting\n
\t\t\tif ( !hooks || !("set" in hooks) || hooks.set( this, val, "value" ) === undefined ) {\n
\t\t\t\tthis.value = val;\n
\t\t\t}\n
\t\t});\n
\t}\n
});\n
\n
jQuery.extend({\n
\tvalHooks: {\n
\t\toption: {\n
\t\t\tget: function( elem ) {\n
\t\t\t\t// attributes.value is undefined in Blackberry 4.7 but\n
\t\t\t\t// uses .value. See #6932\n
\t\t\t\tvar val = elem.attributes.value;\n
\t\t\t\treturn !val || val.specified ? elem.value : elem.text;\n
\t\t\t}\n
\t\t},\n
\t\tselect: {\n
\t\t\tget: function( elem ) {\n
\t\t\t\tvar value, option,\n
\t\t\t\t\toptions = elem.options,\n
\t\t\t\t\tindex = elem.selectedIndex,\n
\t\t\t\t\tone = elem.type === "select-one" || index < 0,\n
\t\t\t\t\tvalues = one ? null : [],\n
\t\t\t\t\tmax = one ? index + 1 : options.length,\n
\t\t\t\t\ti = index < 0 ?\n
\t\t\t\t\t\tmax :\n
\t\t\t\t\t\tone ? index : 0;\n
\n
\t\t\t\t// Loop through all the selected options\n
\t\t\t\tfor ( ; i < max; i++ ) {\n
\t\t\t\t\toption = options[ i ];\n
\n
\t\t\t\t\t// IE6-9 doesn\'t update selected after form reset (#2551)\n
\t\t\t\t\tif ( ( option.selected || i === index ) &&\n
\t\t\t\t\t\t\t// Don\'t return options that are disabled or in a disabled optgroup\n
\t\t\t\t\t\t\t( jQuery.support.optDisabled ? !option.disabled : option.getAttribute("disabled") === null ) &&\n
\t\t\t\t\t\t\t( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, "optgroup" ) ) ) {\n
\n
\t\t\t\t\t\t// Get the specific value for the option\n
\t\t\t\t\t\tvalue = jQuery( option ).val();\n
\n
\t\t\t\t\t\t// We don\'t need an array for one selects\n
\t\t\t\t\t\tif ( one ) {\n
\t\t\t\t\t\t\treturn value;\n
\t\t\t\t\t\t}\n
\n
\t\t\t\t\t\t// Multi-Selects return an array\n
\t\t\t\t\t\tvalues.push( value );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t\treturn values;\n
\t\t\t},\n
\n
\t\t\tset: function( elem, value ) {\n
\t\t\t\tvar optionSet, option,\n
\t\t\t\t\toptions = elem.options,\n
\t\t\t\t\tvalues = jQuery.makeArray( value ),\n
\t\t\t\t\ti = options.length;\n
\n
\t\t\t\twhile ( i-- ) {\n
\t\t\t\t\toption = options[ i ];\n
\t\t\t\t\tif ( (option.selected = jQuery.inArray( jQuery(option).val(), values ) >= 0) ) {\n
\t\t\t\t\t\toptionSet = true;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t\t// force browsers to behave consistently when non-matching value is set\n
\t\t\t\tif ( !optionSet ) {\n
\t\t\t\t\telem.selectedIndex = -1;\n
\t\t\t\t}\n
\t\t\t\treturn values;\n
\t\t\t}\n
\t\t}\n
\t},\n
\n
\tattr: function( elem, name, value ) {\n
\t\tvar hooks, ret,\n
\t\t\tnType = elem.nodeType;\n
\n
\t\t// don\'t get/set attributes on text, comment and attribute nodes\n
\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Fallback to prop when attributes are not supported\n
\t\tif ( typeof elem.getAttribute === core_strundefined ) {\n
\t\t\treturn jQuery.prop( elem, name, value );\n
\t\t}\n
\n
\t\t// All attributes are lowercase\n
\t\t// Grab necessary hook if one is defined\n
\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n
\t\t\tname = name.toLowerCase();\n
\t\t\thooks = jQuery.attrHooks[ name ] ||\n
\t\t\t\t( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );\n
\t\t}\n
\n
\t\tif ( value !== undefined ) {\n
\n
\t\t\tif ( value === null ) {\n
\t\t\t\tjQuery.removeAttr( elem, name );\n
\n
\t\t\t} else if ( hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {\n
\t\t\t\treturn ret;\n
\n
\t\t\t} else {\n
\t\t\t\telem.setAttribute( name, value + "" );\n
\t\t\t\treturn value;\n
\t\t\t}\n
\n
\t\t} else if ( hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ) {\n
\t\t\treturn ret;\n
\n
\t\t} else {\n
\t\t\tret = jQuery.find.attr( elem, name );\n
\n
\t\t\t// Non-existent attributes return null, we normalize to undefined\n
\t\t\treturn ret == null ?\n
\t\t\t\tundefined :\n
\t\t\t\tret;\n
\t\t}\n
\t},\n
\n
\tremoveAttr: function( elem, value ) {\n
\t\tvar name, propName,\n
\t\t\ti = 0,\n
\t\t\tattrNames = value && value.match( core_rnotwhite );\n
\n
\t\tif ( attrNames && elem.nodeType === 1 ) {\n
\t\t\twhile ( (name = attrNames[i++]) ) {\n
\t\t\t\tpropName = jQuery.propFix[ name ] || name;\n
\n
\t\t\t\t// Boolean attributes get special treatment (#10870)\n
\t\t\t\tif ( jQuery.expr.match.bool.test( name ) ) {\n
\t\t\t\t\t// Set corresponding property to false\n
\t\t\t\t\telem[ propName ] = false;\n
\t\t\t\t}\n
\n
\t\t\t\telem.removeAttribute( name );\n
\t\t\t}\n
\t\t}\n
\t},\n
\n
\tattrHooks: {\n
\t\ttype: {\n
\t\t\tset: function( elem, value ) {\n
\t\t\t\tif ( !jQuery.support.radioValue && value === "radio" && jQuery.nodeName(elem, "input") ) {\n
\t\t\t\t\t// Setting the type on a radio button after the value resets the value in IE6-9\n
\t\t\t\t\t// Reset value to default in case type is set after value during creation\n
\t\t\t\t\tvar val = elem.value;\n
\t\t\t\t\telem.setAttribute( "type", value );\n
\t\t\t\t\tif ( val ) {\n
\t\t\t\t\t\telem.value = val;\n
\t\t\t\t\t}\n
\t\t\t\t\treturn value;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t},\n
\n
\tpropFix: {\n
\t\t"for": "htmlFor",\n
\t\t"class": "className"\n
\t},\n
\n
\tprop: function( elem, name, value ) {\n
\t\tvar ret, hooks, notxml,\n
\t\t\tnType = elem.nodeType;\n
\n
\t\t// don\'t get/set properties on text, comment and attribute nodes\n
\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\tnotxml = nType !== 1 || !jQuery.isXMLDoc( elem );\n
\n
\t\tif ( notxml ) {\n
\t\t\t// Fix name and attach hooks\n
\t\t\tname = jQuery.propFix[ name ] || name;\n
\t\t\thooks = jQuery.propHooks[ name ];\n
\t\t}\n
\n
\t\tif ( value !== undefined ) {\n
\t\t\treturn hooks && "set" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?\n
\t\t\t\tret :\n
\t\t\t\t( elem[ name ] = value );\n
\n
\t\t} else {\n
\t\t\treturn hooks && "get" in hooks && (ret = hooks.get( elem, name )) !== null ?\n
\t\t\t\tret :\n
\t\t\t\telem[ name ];\n
\t\t}\n
\t},\n
\n
\tpropHooks: {\n
\t\ttabIndex: {\n
\t\t\tget: function( elem ) {\n
\t\t\t\treturn elem.hasAttribute( "tabindex" ) || rfocusable.test( elem.nodeName ) || elem.href ?\n
\t\t\t\t\telem.tabIndex :\n
\t\t\t\t\t-1;\n
\t\t\t}\n
\t\t}\n
\t}\n
});\n
\n
// Hooks for boolean attributes\n
boolHook = {\n
\tset: function( elem, value, name ) {\n
\t\tif ( value === false ) {\n
\t\t\t// Remove boolean attributes when set to false\n
\t\t\tjQuery.removeAttr( elem, name );\n
\t\t} else {\n
\t\t\telem.setAttribute( name, name );\n
\t\t}\n
\t\treturn name;\n
\t}\n
};\n
jQuery.each( jQuery.expr.match.bool.source.match( /\\w+/g ), function( i, name ) {\n
\tvar getter = jQuery.expr.attrHandle[ name ] || jQuery.find.attr;\n
\n
\tjQuery.expr.attrHandle[ name ] = function( elem, name, isXML ) {\n
\t\tvar fn = jQuery.expr.attrHandle[ name ],\n
\t\t\tret = isXML ?\n
\t\t\t\tundefined :\n
\t\t\t\t/* jshint eqeqeq: false */\n
\t\t\t\t// Temporarily disable this handler to check existence\n
\t\t\t\t(jQuery.expr.attrHandle[ name ] = undefined) !=\n
\t\t\t\t\tgetter( elem, name, isXML ) ?\n
\n
\t\t\t\t\tname.toLowerCase() :\n
\t\t\t\t\tnull;\n
\n
\t\t// Restore handler\n
\t\tjQuery.expr.attrHandle[ name ] = fn;\n
\n
\t\treturn ret;\n
\t};\n
});\n
\n
// Support: IE9+\n
// Selectedness for an option in an optgroup can be inaccurate\n
if ( !jQuery.support.optSelected ) {\n
\tjQuery.propHooks.selected = {\n
\t\tget: function( elem ) {\n
\t\t\tvar parent = elem.parentNode;\n
\t\t\tif ( parent && parent.parentNode ) {\n
\t\t\t\tparent.parentNode.selectedIndex;\n
\t\t\t}\n
\t\t\treturn null;\n
\t\t}\n
\t};\n
}\n
\n
jQuery.each([\n
\t"tabIndex",\n
\t"readOnly",\n
\t"maxLength",\n
\t"cellSpacing",\n
\t"cellPadding",\n
\t"rowSpan",\n
\t"colSpan",\n
\t"useMap",\n
\t"frameBorder",\n
\t"contentEditable"\n
], function() {\n
\tjQuery.propFix[ this.toLowerCase() ] = this;\n
});\n
\n
// Radios and checkboxes getter/setter\n
jQuery.each([ "radio", "checkbox" ], function() {\n
\tjQuery.valHooks[ this ] = {\n
\t\tset: function( elem, value ) {\n
\t\t\tif ( jQuery.isArray( value ) ) {\n
\t\t\t\treturn ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );\n
\t\t\t}\n
\t\t}\n
\t};\n
\tif ( !jQuery.support.checkOn ) {\n
\t\tjQuery.valHooks[ this ].get = function( elem ) {\n
\t\t\t// Support: Webkit\n
\t\t\t// "" is returned instead of "on" if a value isn\'t specified\n
\t\t\treturn elem.getAttribute("value") === null ? "on" : elem.value;\n
\t\t};\n
\t}\n
});\n
var rkeyEvent = /^key/,\n
\trmouseEvent = /^(?:mouse|contextmenu)|click/,\n
\trfocusMorph = /^(?:focusinfocus|focusoutblur)$/,\n
\trtypenamespace = /^([^.]*)(?:\\.(.+)|)$/;\n
\n
function returnTrue() {\n
\treturn true;\n
}\n
\n
function returnFalse() {\n
\treturn false;\n
}\n
\n
function safeActiveElement() {\n
\ttry {\n
\t\treturn document.activeElement;\n
\t} catch ( err ) { }\n
}\n
\n
/*\n
 * Helper functions for managing events -- not part of the public interface.\n
 * Props to Dean Edwards\' addEvent library for many of the ideas.\n
 */\n
jQuery.event = {\n
\n
\tglobal: {},\n
\n
\tadd: function( elem, types, handler, data, selector ) {\n
\n
\t\tvar handleObjIn, eventHandle, tmp,\n
\t\t\tevents, t, handleObj,\n
\t\t\tspecial, handlers, type, namespaces, origType,\n
\t\t\telemData = data_priv.get( elem );\n
\n
\t\t// Don\'t attach events to noData or text/comment nodes (but allow plain objects)\n
\t\tif ( !elemData ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Caller can pass in an object of custom data in lieu of the handler\n
\t\tif ( handler.handler ) {\n
\t\t\thandleObjIn = handler;\n
\t\t\thandler = handleObjIn.handler;\n
\t\t\tselector = handleObjIn.selector;\n
\t\t}\n
\n
\t\t// Make sure that the handler has a unique ID, used to find/remove it later\n
\t\tif ( !handler.guid ) {\n
\t\t\thandler.guid = jQuery.guid++;\n
\t\t}\n
\n
\t\t// Init the element\'s event structure and main handler, if this is the first\n
\t\tif ( !(events = elemData.events) ) {\n
\t\t\tevents = elemData.events = {};\n
\t\t}\n
\t\tif ( !(eventHandle = elemData.handle) ) {\n
\t\t\teventHandle = elemData.handle = function( e ) {\n
\t\t\t\t// Discard the second event of a jQuery.event.trigger() and\n
\t\t\t\t// when an event is called after a page has unloaded\n
\t\t\t\treturn typeof jQuery !== core_strundefined && (!e || jQuery.event.triggered !== e.type) ?\n
\t\t\t\t\tjQuery.event.dispatch.apply( eventHandle.elem, arguments ) :\n
\t\t\t\t\tundefined;\n
\t\t\t};\n
\t\t\t// Add elem as a property of the handle fn to prevent a memory leak with IE non-native events\n
\t\t\teventHandle.elem = elem;\n
\t\t}\n
\n
\t\t// Handle multiple events separated by a space\n
\t\ttypes = ( types || "" ).match( core_rnotwhite ) || [""];\n
\t\tt = types.length;\n
\t\twhile ( t-- ) {\n
\t\t\ttmp = rtypenamespace.exec( types[t] ) || [];\n
\t\t\ttype = origType = tmp[1];\n
\t\t\tnamespaces = ( tmp[2] || "" ).split( "." ).sort();\n
\n
\t\t\t// There *must* be a type, no attaching namespace-only handlers\n
\t\t\tif ( !type ) {\n
\t\t\t\tcontinue;\n
\t\t\t}\n
\n
\t\t\t// If event changes its type, use the special event handlers for the changed type\n
\t\t\tspecial = jQuery.event.special[ type ] || {};\n
\n
\t\t\t// If selector defined, determine special event api type, otherwise given type\n
\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n
\n
\t\t\t// Update special based on newly reset type\n
\t\t\tspecial = jQuery.event.special[ type ] || {};\n
\n
\t\t\t// handleObj is passed to all event handlers\n
\t\t\thandleObj = jQuery.extend({\n
\t\t\t\ttype: type,\n
\t\t\t\torigType: origType,\n
\t\t\t\tdata: data,\n
\t\t\t\thandler: handler,\n
\t\t\t\tguid: handler.guid,\n
\t\t\t\tselector: selector,\n
\t\t\t\tneedsContext: selector && jQuery.expr.match.needsContext.test( selector ),\n
\t\t\t\tnamespace: namespaces.join(".")\n
\t\t\t}, handleObjIn );\n
\n
\t\t\t// Init the event handler queue if we\'re the first\n
\t\t\tif ( !(handlers = events[ type ]) ) {\n
\t\t\t\thandlers = events[ type ] = [];\n
\t\t\t\thandlers.delegateCount = 0;\n
\n
\t\t\t\t// Only use addEventListener if the special events handler returns false\n
\t\t\t\tif ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {\n
\t\t\t\t\tif ( elem.addEventListener ) {\n
\t\t\t\t\t\telem.addEventListener( type, eventHandle, false );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\tif ( special.add ) {\n
\t\t\t\tspecial.add.call( elem, handleObj );\n
\n
\t\t\t\tif ( !handleObj.handler.guid ) {\n
\t\t\t\t\thandleObj.handler.guid = handler.guid;\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// Add to the element\'s handler list, delegates in front\n
\t\t\tif ( selector ) {\n
\t\t\t\thandlers.splice( handlers.delegateCount++, 0, handleObj );\n
\t\t\t} else {\n
\t\t\t\thandlers.push( handleObj );\n
\t\t\t}\n
\n
\t\t\t// Keep track of which events have ever been used, for event optimization\n
\t\t\tjQuery.event.global[ type ] = true;\n
\t\t}\n
\n
\t\t// Nullify elem to prevent memory leaks in IE\n
\t\telem = null;\n
\t},\n
\n
\t// Detach an event or set of events from an element\n
\tremove: function( elem, types, handler, selector, mappedTypes ) {\n
\n
\t\tvar j, origCount, tmp,\n
\t\t\tevents, t, handleObj,\n
\t\t\tspecial, handlers, type, namespaces, origType,\n
\t\t\telemData = data_priv.hasData( elem ) && data_priv.get( elem );\n
\n
\t\tif ( !elemData || !(events = elemData.events) ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Once for each type.namespace in types; type may be omitted\n
\t\ttypes = ( types || "" ).match( core_rnotwhite ) || [""];\n
\t\tt = types.length;\n
\t\twhile ( t-- ) {\n
\t\t\ttmp = rtypenamespace.exec( types[t] ) || [];\n
\t\t\ttype = origType = tmp[1];\n
\t\t\tnamespaces = ( tmp[2] || "" ).split( "." ).sort();\n
\n
\t\t\t// Unbind all events (on this namespace, if provided) for the element\n
\t\t\tif ( !type ) {\n
\t\t\t\tfor ( type in events ) {\n
\t\t\t\t\tjQuery.event.remove( elem, type + types[ t ], handler, selector, true );\n
\t\t\t\t}\n
\t\t\t\tcontinue;\n
\t\t\t}\n
\n
\t\t\tspecial = jQuery.event.special[ type ] || {};\n
\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n
\t\t\thandlers = events[ type ] || [];\n
\t\t\ttmp = tmp[2] && new RegExp( "(^|\\\\.)" + namespaces.join("\\\\.(?:.*\\\\.|)") + "(\\\\.|$)" );\n
\n
\t\t\t// Remove matching events\n
\t\t\torigCount = j = handlers.length;\n
\t\t\twhile ( j-- ) {\n
\t\t\t\thandleObj = handlers[ j ];\n
\n
\t\t\t\tif ( ( mappedTypes || origType === handleObj.origType ) &&\n
\t\t\t\t\t( !handler || handler.guid === handleObj.guid ) &&\n
\t\t\t\t\t( !tmp || tmp.test( handleObj.namespace ) ) &&\n
\t\t\t\t\t( !selector || selector === handleObj.selector || selector === "**" && handleObj.selector ) ) {\n
\t\t\t\t\thandlers.splice( j, 1 );\n
\n
\t\t\t\t\tif ( handleObj.selector ) {\n
\t\t\t\t\t\thandlers.delegateCount--;\n
\t\t\t\t\t}\n
\t\t\t\t\tif ( special.remove ) {\n
\t\t\t\t\t\tspecial.remove.call( elem, handleObj );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// Remove generic event handler if we removed something and no more handlers exist\n
\t\t\t// (avoids potential for endless recursion during removal of special event handlers)\n
\t\t\tif ( origCount && !handlers.length ) {\n
\t\t\t\tif ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {\n
\t\t\t\t\tjQuery.removeEvent( elem, type, elemData.handle );\n
\t\t\t\t}\n
\n
\t\t\t\tdelete events[ type ];\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Remove the expando if it\'s no longer used\n
\t\tif ( jQuery.isEmptyObject( events ) ) {\n
\t\t\tdelete elemData.handle;\n
\t\t\tdata_priv.remove( elem, "events" );\n
\t\t}\n
\t},\n
\n
\ttrigger: function( event, data, elem, onlyHandlers ) {\n
\n
\t\tvar i, cur, tmp, bubbleType, ontype, handle, special,\n
\t\t\teventPath = [ elem || document ],\n
\t\t\ttype = core_hasOwn.call( event, "type" ) ? event.type : event,\n
\t\t\tnamespaces = core_hasOwn.call( event, "namespace" ) ? event.namespace.split(".") : [];\n
\n
\t\tcur = tmp = elem = elem || document;\n
\n
\t\t// Don\'t do events on text and comment nodes\n
\t\tif ( elem.nodeType === 3 || elem.nodeType === 8 ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// focus/blur morphs to focusin/out; ensure we\'re not firing them right now\n
\t\tif ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\tif ( type.indexOf(".") >= 0 ) {\n
\t\t\t// Namespaced trigger; create a regexp to match event type in handle()\n
\t\t\tnamespaces = type.split(".");\n
\t\t\ttype = namespaces.shift();\n
\t\t\tnamespaces.sort();\n
\t\t}\n
\t\tontype = type.indexOf(":") < 0 && "on" + type;\n
\n
\t\t// Caller can pass in a jQuery.Event object, Object, or just an event type string\n
\t\tevent = event[ jQuery.expando ] ?\n
\t\t\tevent :\n
\t\t\tnew jQuery.Event( type, typeof event === "object" && event );\n
\n
\t\t// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)\n
\t\tevent.isTrigger = onlyHandlers ? 2 : 3;\n
\t\tevent.namespace = namespaces.join(".");\n
\t\tevent.namespace_re = event.namespace ?\n
\t\t\tnew RegExp( "(^|\\\\.)" + namespaces.join("\\\\.(?:.*\\\\.|)") + "(\\\\.|$)" ) :\n
\t\t\tnull;\n
\n
\t\t// Clean up the event in case it is being reused\n
\t\tevent.result = undefined;\n
\t\tif ( !event.target ) {\n
\t\t\tevent.target = elem;\n
\t\t}\n
\n
\t\t// Clone any incoming data and prepend the event, creating the handler arg list\n
\t\tdata = data == null ?\n
\t\t\t[ event ] :\n
\t\t\tjQuery.makeArray( data, [ event ] );\n
\n
\t\t// Allow special events to draw outside the lines\n
\t\tspecial = jQuery.event.special[ type ] || {};\n
\t\tif ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Determine event propagation path in advance, per W3C events spec (#9951)\n
\t\t// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\n
\t\tif ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {\n
\n
\t\t\tbubbleType = special.delegateType || type;\n
\t\t\tif ( !rfocusMorph.test( bubbleType + type ) ) {\n
\t\t\t\tcur = cur.parentNode;\n
\t\t\t}\n
\t\t\tfor ( ; cur; cur = cur.parentNode ) {\n
\t\t\t\teventPath.push( cur );\n
\t\t\t\ttmp = cur;\n
\t\t\t}\n
\n
\t\t\t// Only add window if we got to document (e.g., not plain obj or detached DOM)\n
\t\t\tif ( tmp === (elem.ownerDocument || document) ) {\n
\t\t\t\teventPath.push( tmp.defaultView || tmp.parentWindow || window );\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Fire handlers on the event path\n
\t\ti = 0;\n
\t\twhile ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {\n
\n
\t\t\tevent.type = i > 1 ?\n
\t\t\t\tbubbleType :\n
\t\t\t\tspecial.bindType || type;\n
\n
\t\t\t// jQuery handler\n
\t\t\thandle = ( data_priv.get( cur, "events" ) || {} )[ event.type ] && data_priv.get( cur, "handle" );\n
\t\t\tif ( handle ) {\n
\t\t\t\thandle.apply( cur, data );\n
\t\t\t}\n
\n
\t\t\t// Native handler\n
\t\t\thandle = ontype && cur[ ontype ];\n
\t\t\tif ( handle && jQuery.acceptData( cur ) && handle.apply && handle.apply( cur, data ) === false ) {\n
\t\t\t\tevent.preventDefault();\n
\t\t\t}\n
\t\t}\n
\t\tevent.type = type;\n
\n
\t\t// If nobody prevented the default action, do it now\n
\t\tif ( !onlyHandlers && !event.isDefaultPrevented() ) {\n
\n
\t\t\tif ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&\n
\t\t\t\tjQuery.acceptData( elem ) ) {\n
\n
\t\t\t\t// Call a native DOM method on the target with the same name name as the event.\n
\t\t\t\t// Don\'t do default actions on window, that\'s where global variables be (#6170)\n
\t\t\t\tif ( ontype && jQuery.isFunction( elem[ type ] ) && !jQuery.isWindow( elem ) ) {\n
\n
\t\t\t\t\t// Don\'t re-trigger an onFOO event when we call its FOO() method\n
\t\t\t\t\ttmp = elem[ ontype ];\n
\n
\t\t\t\t\tif ( tmp ) {\n
\t\t\t\t\t\telem[ ontype ] = null;\n
\t\t\t\t\t}\n
\n
\t\t\t\t\t// Prevent re-triggering of the same event, since we already bubbled it above\n
\t\t\t\t\tjQuery.event.triggered = type;\n
\t\t\t\t\telem[ type ]();\n
\t\t\t\t\tjQuery.event.triggered = undefined;\n
\n
\t\t\t\t\tif ( tmp ) {\n
\t\t\t\t\t\telem[ ontype ] = tmp;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn event.result;\n
\t},\n
\n
\tdispatch: function( event ) {\n
\n
\t\t// Make a writable jQuery.Event from the native event object\n
\t\tevent = jQuery.event.fix( event );\n
\n
\t\tvar i, j, ret, matched, handleObj,\n
\t\t\thandlerQueue = [],\n
\t\t\targs = core_slice.call( arguments ),\n
\t\t\thandlers = ( data_priv.get( this, "events" ) || {} )[ event.type ] || [],\n
\t\t\tspecial = jQuery.event.special[ event.type ] || {};\n
\n
\t\t// Use the fix-ed jQuery.Event rather than the (read-only) native event\n
\t\targs[0] = event;\n
\t\tevent.delegateTarget = this;\n
\n
\t\t// Call the preDispatch hook for the mapped type, and let it bail if desired\n
\t\tif ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Determine handlers\n
\t\thandlerQueue = jQuery.event.handlers.call( this, event, handlers );\n
\n
\t\t// Run delegates first; they may want to stop propagation beneath us\n
\t\ti = 0;\n
\t\twhile ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {\n
\t\t\tevent.currentTarget = matched.elem;\n
\n
\t\t\tj = 0;\n
\t\t\twhile ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {\n
\n
\t\t\t\t// Triggered event must either 1) have no namespace, or\n
\t\t\t\t// 2) have namespace(s) a subset or equal to those in the bound event (both can have no namespace).\n
\t\t\t\tif ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {\n
\n
\t\t\t\t\tevent.handleObj = handleObj;\n
\t\t\t\t\tevent.data = handleObj.data;\n
\n
\t\t\t\t\tret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )\n
\t\t\t\t\t\t\t.apply( matched.elem, args );\n
\n
\t\t\t\t\tif ( ret !== undefined ) {\n
\t\t\t\t\t\tif ( (event.result = ret) === false ) {\n
\t\t\t\t\t\t\tevent.preventDefault();\n
\t\t\t\t\t\t\tevent.stopPropagation();\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Call the postDispatch hook for the mapped type\n
\t\tif ( special.postDispatch ) {\n
\t\t\tspecial.postDispatch.call( this, event );\n
\t\t}\n
\n
\t\treturn event.result;\n
\t},\n
\n
\thandlers: function( event, handlers ) {\n
\t\tvar i, matches, sel, handleObj,\n
\t\t\thandlerQueue = [],\n
\t\t\tdelegateCount = handlers.delegateCount,\n
\t\t\tcur = event.target;\n
\n
\t\t// Find delegate handlers\n
\t\t// Black-hole SVG <use> instance trees (#13180)\n
\t\t// Avoid non-left-click bubbling in Firefox (#3861)\n
\t\tif ( delegateCount && cur.nodeType && (!event.button || event.type !== "click") ) {\n
\n
\t\t\tfor ( ; cur !== this; cur = cur.parentNode || this ) {\n
\n
\t\t\t\t// Don\'t process clicks on disabled elements (#6911, #8165, #11382, #11764)\n
\t\t\t\tif ( cur.disabled !== true || event.type !== "click" ) {\n
\t\t\t\t\tmatches = [];\n
\t\t\t\t\tfor ( i = 0; i < delegateCount; i++ ) {\n
\t\t\t\t\t\thandleObj = handlers[ i ];\n
\n
\t\t\t\t\t\t// Don\'t conflict with Object.prototype properties (#13203)\n
\t\t\t\t\t\tsel = handleObj.selector + " ";\n
\n
\t\t\t\t\t\tif ( matches[ sel ] === undefined ) {\n
\t\t\t\t\t\t\tmatches[ sel ] = handleObj.needsContext ?\n
\t\t\t\t\t\t\t\tjQuery( sel, this ).index( cur ) >= 0 :\n
\t\t\t\t\t\t\t\tjQuery.find( sel, this, null, [ cur ] ).length;\n
\t\t\t\t\t\t}\n
\t\t\t\t\t\tif ( matches[ sel ] ) {\n
\t\t\t\t\t\t\tmatches.push( handleObj );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\tif ( matches.length ) {\n
\t\t\t\t\t\thandlerQueue.push({ elem: cur, handlers: matches });\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Add the remaining (directly-bound) handlers\n
\t\tif ( delegateCount < handlers.length ) {\n
\t\t\thandlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });\n
\t\t}\n
\n
\t\treturn handlerQueue;\n
\t},\n
\n
\t// Includes some event props shared by KeyEvent and MouseEvent\n
\tprops: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),\n
\n
\tfixHooks: {},\n
\n
\tkeyHooks: {\n
\t\tprops: "char charCode key keyCode".split(" "),\n
\t\tfilter: function( event, original ) {\n
\n
\t\t\t// Add which for key events\n
\t\t\tif ( event.which == null ) {\n
\t\t\t\tevent.which = original.charCode != null ? original.charCode : original.keyCode;\n
\t\t\t}\n
\n
\t\t\treturn event;\n
\t\t}\n
\t},\n
\n
\tmouseHooks: {\n
\t\tprops: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),\n
\t\tfilter: function( event, original ) {\n
\t\t\tvar eventDoc, doc, body,\n
\t\t\t\tbutton = original.button;\n
\n
\t\t\t// Calculate pageX/Y if missing and clientX/Y available\n
\t\t\tif ( event.pageX == null && original.clientX != null ) {\n
\t\t\t\teventDoc = event.target.ownerDocument || document;\n
\t\t\t\tdoc = eventDoc.documentElement;\n
\t\t\t\tbody = eventDoc.body;\n
\n
\t\t\t\tevent.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );\n
\t\t\t\tevent.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );\n
\t\t\t}\n
\n
\t\t\t// Add which for click: 1 === left; 2 === middle; 3 === right\n
\t\t\t// Note: button is not normalized, so don\'t use it\n
\t\t\tif ( !event.which && button !== undefined ) {\n
\t\t\t\tevent.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );\n
\t\t\t}\n
\n
\t\t\treturn event;\n
\t\t}\n
\t},\n
\n
\tfix: function( event ) {\n
\t\tif ( event[ jQuery.expando ] ) {\n
\t\t\treturn event;\n
\t\t}\n
\n
\t\t// Create a writable copy of the event object and normalize some properties\n
\t\tvar i, prop, copy,\n
\t\t\ttype = event.type,\n
\t\t\toriginalEvent = event,\n
\t\t\tfixHook = this.fixHooks[ type ];\n
\n
\t\tif ( !fixHook ) {\n
\t\t\tthis.fixHooks[ type ] = fixHook =\n
\t\t\t\trmouseEvent.test( type ) ? this.mouseHooks :\n
\t\t\t\trkeyEvent.test( type ) ? this.keyHooks :\n
\t\t\t\t{};\n
\t\t}\n
\t\tcopy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;\n
\n
\t\tevent = new jQuery.Event( originalEvent );\n
\n
\t\ti = copy.length;\n
\t\twhile ( i-- ) {\n
\t\t\tprop = copy[ i ];\n
\t\t\tevent[ prop ] = originalEvent[ prop ];\n
\t\t}\n
\n
\t\t// Support: Cordova 2.5 (WebKit) (#13255)\n
\t\t// All events should have a target; Cordova deviceready doesn\'t\n
\t\tif ( !event.target ) {\n
\t\t\tevent.target = document;\n
\t\t}\n
\n
\t\t// Support: Safari 6.0+, Chrome < 28\n
\t\t// Target should not be a text node (#504, #13143)\n
\t\tif ( event.target.nodeType === 3 ) {\n
\t\t\tevent.target = event.target.parentNode;\n
\t\t}\n
\n
\t\treturn fixHook.filter? fixHook.filter( event, originalEvent ) : event;\n
\t},\n
\n
\tspecial: {\n
\t\tload: {\n
\t\t\t// Prevent triggered image.load events from bubbling to window.load\n
\t\t\tnoBubble: true\n
\t\t},\n
\t\tfocus: {\n
\t\t\t// Fire native event if possible so blur/focus sequence is correct\n
\t\t\ttrigger: function() {\n
\t\t\t\tif ( this !== safeActiveElement() && this.focus ) {\n
\t\t\t\t\tthis.focus();\n
\t\t\t\t\treturn false;\n
\t\t\t\t}\n
\t\t\t},\n
\t\t\tdelegateType: "focusin"\n
\t\t},\n
\t\tblur: {\n
\t\t\ttrigger: function() {\n
\t\t\t\tif ( this === safeActiveElement() && this.blur ) {\n
\t\t\t\t\tthis.blur();\n
\t\t\t\t\treturn false;\n
\t\t\t\t}\n
\t\t\t},\n
\t\t\tdelegateType: "focusout"\n
\t\t},\n
\t\tclick: {\n
\t\t\t// For checkbox, fire native event so checked state will be right\n
\t\t\ttrigger: function() {\n
\t\t\t\tif ( this.type === "checkbox" && this.click && jQuery.nodeName( this, "input" ) ) {\n
\t\t\t\t\tthis.click();\n
\t\t\t\t\treturn false;\n
\t\t\t\t}\n
\t\t\t},\n
\n
\t\t\t// For cross-browser consistency, don\'t fire native .click() on links\n
\t\t\t_default: function( event ) {\n
\t\t\t\treturn jQuery.nodeName( event.target, "a" );\n
\t\t\t}\n
\t\t},\n
\n
\t\tbeforeunload: {\n
\t\t\tpostDispatch: function( event ) {\n
\n
\t\t\t\t// Support: Firefox 20+\n
\t\t\t\t// Firefox doesn\'t alert if the returnValue field is not set.\n
\t\t\t\tif ( event.result !== undefined ) {\n
\t\t\t\t\tevent.originalEvent.returnValue = event.result;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t},\n
\n
\tsimulate: function( type, elem, event, bubble ) {\n
\t\t// Piggyback on a donor event to simulate a different one.\n
\t\t// Fake originalEvent to avoid donor\'s stopPropagation, but if the\n
\t\t// simulated event prevents default then we do the same on the donor.\n
\t\tvar e = jQuery.extend(\n
\t\t\tnew jQuery.Event(),\n
\t\t\tevent,\n
\t\t\t{\n
\t\t\t\ttype: type,\n
\t\t\t\tisSimulated: true,\n
\t\t\t\toriginalEvent: {}\n
\t\t\t}\n
\t\t);\n
\t\tif ( bubble ) {\n
\t\t\tjQuery.event.trigger( e, null, elem );\n
\t\t} else {\n
\t\t\tjQuery.event.dispatch.call( elem, e );\n
\t\t}\n
\t\tif ( e.isDefaultPrevented() ) {\n
\t\t\tevent.preventDefault();\n
\t\t}\n
\t}\n
};\n
\n
jQuery.removeEvent = function( elem, type, handle ) {\n
\tif ( elem.removeEventListener ) {\n
\t\telem.removeEventListener( type, handle, false );\n
\t}\n
};\n
\n
jQuery.Event = function( src, props ) {\n
\t// Allow instantiation without the \'new\' keyword\n
\tif ( !(this instanceof jQuery.Event) ) {\n
\t\treturn new jQuery.Event( src, props );\n
\t}\n
\n
\t// Event object\n
\tif ( src && src.type ) {\n
\t\tthis.originalEvent = src;\n
\t\tthis.type = src.type;\n
\n
\t\t// Events bubbling up the document may have been marked as prevented\n
\t\t// by a handler lower down the tree; reflect the correct value.\n
\t\tthis.isDefaultPrevented = ( src.defaultPrevented ||\n
\t\t\tsrc.getPreventDefault && src.getPreventDefault() ) ? returnTrue : returnFalse;\n
\n
\t// Event type\n
\t} else {\n
\t\tthis.type = src;\n
\t}\n
\n
\t// Put explicitly provided properties onto the event object\n
\tif ( props ) {\n
\t\tjQuery.extend( this, props );\n
\t}\n
\n
\t// Create a timestamp if incoming event doesn\'t have one\n
\tthis.timeStamp = src && src.timeStamp || jQuery.now();\n
\n
\t// Mark it as fixed\n
\tthis[ jQuery.expando ] = true;\n
};\n
\n
// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\n
// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\n
jQuery.Event.prototype = {\n
\tisDefaultPrevented: returnFalse,\n
\tisPropagationStopped: returnFalse,\n
\tisImmediatePropagationStopped: returnFalse,\n
\n
\tpreventDefault: function() {\n
\t\tvar e = this.originalEvent;\n
\n
\t\tthis.isDefaultPrevented = returnTrue;\n
\n
\t\tif ( e && e.preventDefault ) {\n
\t\t\te.preventDefault();\n
\t\t}\n
\t},\n
\tstopPropagation: function() {\n
\t\tvar e = this.originalEvent;\n
\n
\t\tthis.isPropagationStopped = returnTrue;\n
\n
\t\tif ( e && e.stopPropagation ) {\n
\t\t\te.stopPropagation();\n
\t\t}\n
\t},\n
\tstopImmediatePropagation: function() {\n
\t\tthis.isImmediatePropagationStopped = returnTrue;\n
\t\tthis.stopPropagation();\n
\t}\n
};\n
\n
// Create mouseenter/leave events using mouseover/out and event-time checks\n
// Support: Chrome 15+\n
jQuery.each({\n
\tmouseenter: "mouseover",\n
\tmouseleave: "mouseout"\n
}, function( orig, fix ) {\n
\tjQuery.event.special[ orig ] = {\n
\t\tdelegateType: fix,\n
\t\tbindType: fix,\n
\n
\t\thandle: function( event ) {\n
\t\t\tvar ret,\n
\t\t\t\ttarget = this,\n
\t\t\t\trelated = event.relatedTarget,\n
\t\t\t\thandleObj = event.handleObj;\n
\n
\t\t\t// For mousenter/leave call the handler if related is outside the target.\n
\t\t\t// NB: No relatedTarget if the mouse left/entered the browser window\n
\t\t\tif ( !related || (related !== target && !jQuery.contains( target, related )) ) {\n
\t\t\t\tevent.type = handleObj.origType;\n
\t\t\t\tret = handleObj.handler.apply( this, arguments );\n
\t\t\t\tevent.type = fix;\n
\t\t\t}\n
\t\t\treturn ret;\n
\t\t}\n
\t};\n
});\n
\n
// Create "bubbling" focus and blur events\n
// Support: Firefox, Chrome, Safari\n
if ( !jQuery.support.focusinBubbles ) {\n
\tjQuery.each({ focus: "focusin", blur: "focusout" }, function( orig, fix ) {\n
\n
\t\t// Attach a single capturing handler while someone wants focusin/focusout\n
\t\tvar attaches = 0,\n
\t\t\thandler = function( event ) {\n
\t\t\t\tjQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );\n
\t\t\t};\n
\n
\t\tjQuery.event.special[ fix ] = {\n
\t\t\tsetup: function() {\n
\t\t\t\tif ( attaches++ === 0 ) {\n
\t\t\t\t\tdocument.addEventListener( orig, handler, true );\n
\t\t\t\t}\n
\t\t\t},\n
\t\t\tteardown: function() {\n
\t\t\t\tif ( --attaches === 0 ) {\n
\t\t\t\t\tdocument.removeEventListener( orig, handler, true );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t};\n
\t});\n
}\n
\n
jQuery.fn.extend({\n
\n
\ton: function( types, selector, data, fn, /*INTERNAL*/ one ) {\n
\t\tvar origFn, type;\n
\n
\t\t// Types can be a map of types/handlers\n
\t\tif ( typeof types === "object" ) {\n
\t\t\t// ( types-Object, selector, data )\n
\t\t\tif ( typeof selector !== "string" ) {\n
\t\t\t\t// ( types-Object, data )\n
\t\t\t\tdata = data || selector;\n
\t\t\t\tselector = undefined;\n
\t\t\t}\n
\t\t\tfor ( type in types ) {\n
\t\t\t\tthis.on( type, selector, data, types[ type ], one );\n
\t\t\t}\n
\t\t\treturn this;\n
\t\t}\n
\n
\t\tif ( data == null && fn == null ) {\n
\t\t\t// ( types, fn )\n
\t\t\tfn = selector;\n
\t\t\tdata = selector = undefined;\n
\t\t} else if ( fn == null ) {\n
\t\t\tif ( typeof selector === "string" ) {\n
\t\t\t\t// ( types, selector, fn )\n
\t\t\t\tfn = data;\n
\t\t\t\tdata = undefined;\n
\t\t\t} else {\n
\t\t\t\t// ( types, data, fn )\n
\t\t\t\tfn = data;\n
\t\t\t\tdata = selector;\n
\t\t\t\tselector = undefined;\n
\t\t\t}\n
\t\t}\n
\t\tif ( fn === false ) {\n
\t\t\tfn = returnFalse;\n
\t\t} else if ( !fn ) {\n
\t\t\treturn this;\n
\t\t}\n
\n
\t\tif ( one === 1 ) {\n
\t\t\torigFn = fn;\n
\t\t\tfn = function( event ) {\n
\t\t\t\t// Can use an empty set, since event contains the info\n
\t\t\t\tjQuery().off( event );\n
\t\t\t\treturn origFn.apply( this, arguments );\n
\t\t\t};\n
\t\t\t// Use same guid so caller can remove using origFn\n
\t\t\tfn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\n
\t\t}\n
\t\treturn this.each( function() {\n
\t\t\tjQuery.event.add( this, types, fn, data, selector );\n
\t\t});\n
\t},\n
\tone: function( types, selector, data, fn ) {\n
\t\treturn this.on( types, selector, data, fn, 1 );\n
\t},\n
\toff: function( types, selector, fn ) {\n
\t\tvar handleObj, type;\n
\t\tif ( types && types.preventDefault && types.handleObj ) {\n
\t\t\t// ( event )  dispatched jQuery.Event\n
\t\t\thandleObj = types.handleObj;\n
\t\t\tjQuery( types.delegateTarget ).off(\n
\t\t\t\thandleObj.namespace ? handleObj.origType + "." + handleObj.namespace : handleObj.origType,\n
\t\t\t\thandleObj.selector,\n
\t\t\t\thandleObj.handler\n
\t\t\t);\n
\t\t\treturn this;\n
\t\t}\n
\t\tif ( typeof types === "object" ) {\n
\t\t\t// ( types-object [, selector] )\n
\t\t\tfor ( type in types ) {\n
\t\t\t\tthis.off( type, selector, types[ type ] );\n
\t\t\t}\n
\t\t\treturn this;\n
\t\t}\n
\t\tif ( selector === false || typeof selector === "function" ) {\n
\t\t\t// ( types [, fn] )\n
\t\t\tfn = selector;\n
\t\t\tselector = undefined;\n
\t\t}\n
\t\tif ( fn === false ) {\n
\t\t\tfn = returnFalse;\n
\t\t}\n
\t\treturn this.each(function() {\n
\t\t\tjQuery.event.remove( this, types, fn, selector );\n
\t\t});\n
\t},\n
\n
\ttrigger: function( type, data ) {\n
\t\treturn this.each(function() {\n
\t\t\tjQuery.event.trigger( type, data, this );\n
\t\t});\n
\t},\n
\ttriggerHandler: function( type, data ) {\n
\t\tvar elem = this[0];\n
\t\tif ( elem ) {\n
\t\t\treturn jQuery.event.trigger( type, data, elem, true );\n
\t\t}\n
\t}\n
});\n
var isSimple = /^.[^:#\\[\\.,]*$/,\n
\trparentsprev = /^(?:parents|prev(?:Until|All))/,\n
\trneedsContext = jQuery.expr.match.needsContext,\n
\t// methods guaranteed to produce a unique set when starting from a unique set\n
\tguaranteedUnique = {\n
\t\tchildren: true,\n
\t\tcontents: true,\n
\t\tnext: true,\n
\t\tprev: true\n
\t};\n
\n
jQuery.fn.extend({\n
\tfind: function( selector ) {\n
\t\tvar i,\n
\t\t\tret = [],\n
\t\t\tself = this,\n
\t\t\tlen = self.length;\n
\n
\t\tif ( typeof selector !== "string" ) {\n
\t\t\treturn this.pushStack( jQuery( selector ).filter(function() {\n
\t\t\t\tfor ( i = 0; i < len; i++ ) {\n
\t\t\t\t\tif ( jQuery.contains( self[ i ], this ) ) {\n
\t\t\t\t\t\treturn true;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}) );\n
\t\t}\n
\n
\t\tfor ( i = 0; i < len; i++ ) {\n
\t\t\tjQuery.find( selector, self[ i ], ret );\n
\t\t}\n
\n
\t\t// Needed because $( selector, context ) becomes $( context ).find( selector )\n
\t\tret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );\n
\t\tret.selector = this.selector ? this.selector + " " + selector : selector;\n
\t\treturn ret;\n
\t},\n
\n
\thas: function( target ) {\n
\t\tvar targets = jQuery( target, this ),\n
\t\t\tl = targets.length;\n
\n
\t\treturn this.filter(function() {\n
\t\t\tvar i = 0;\n
\t\t\tfor ( ; i < l; i++ ) {\n
\t\t\t\tif ( jQuery.contains( this, targets[i] ) ) {\n
\t\t\t\t\treturn true;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\tnot: function( selector ) {\n
\t\treturn this.pushStack( winnow(this, selector || [], true) );\n
\t},\n
\n
\tfilter: function( selector ) {\n
\t\treturn this.pushStack( winnow(this, selector || [], false) );\n
\t},\n
\n
\tis: function( selector ) {\n
\t\treturn !!winnow(\n
\t\t\tthis,\n
\n
\t\t\t// If this is a positional/relative selector, check membership in the returned set\n
\t\t\t// so $("p:first").is("p:last") won\'t return true for a doc with two "p".\n
\t\t\ttypeof selector === "string" && rneedsContext.test( selector ) ?\n
\t\t\t\tjQuery( selector ) :\n
\t\t\t\tselector || [],\n
\t\t\tfalse\n
\t\t).length;\n
\t},\n
\n
\tclosest: function( selectors, context ) {\n
\t\tvar cur,\n
\t\t\ti = 0,\n
\t\t\tl = this.length,\n
\t\t\tmatched = [],\n
\t\t\tpos = ( rneedsContext.test( selectors ) || typeof selectors !== "string" ) ?\n
\t\t\t\tjQuery( selectors, context || this.context ) :\n
\t\t\t\t0;\n
\n
\t\tfor ( ; i < l; i++ ) {\n
\t\t\tfor ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {\n
\t\t\t\t// Always skip document fragments\n
\t\t\t\tif ( cur.nodeType < 11 && (pos ?\n
\t\t\t\t\tpos.index(cur) > -1 :\n
\n
\t\t\t\t\t// Don\'t pass non-elements to Sizzle\n
\t\t\t\t\tcur.nodeType === 1 &&\n
\t\t\t\t\t\tjQuery.find.matchesSelector(cur, selectors)) ) {\n
\n
\t\t\t\t\tcur = matched.push( cur );\n
\t\t\t\t\tbreak;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );\n
\t},\n
\n
\t// Determine the position of an element within\n
\t// the matched set of elements\n
\tindex: function( elem ) {\n
\n
\t\t// No argument, return index in parent\n
\t\tif ( !elem ) {\n
\t\t\treturn ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;\n
\t\t}\n
\n
\t\t// index in selector\n
\t\tif ( typeof elem === "string" ) {\n
\t\t\treturn core_indexOf.call( jQuery( elem ), this[ 0 ] );\n
\t\t}\n
\n
\t\t// Locate the position of the desired element\n
\t\treturn core_indexOf.call( this,\n
\n
\t\t\t// If it receives a jQuery object, the first element is used\n
\t\t\telem.jquery ? elem[ 0 ] : elem\n
\t\t);\n
\t},\n
\n
\tadd: function( selector, context ) {\n
\t\tvar set = typeof selector === "string" ?\n
\t\t\t\tjQuery( selector, context ) :\n
\t\t\t\tjQuery.makeArray( selector && selector.nodeType ? [ selector ] : selector ),\n
\t\t\tall = jQuery.merge( this.get(), set );\n
\n
\t\treturn this.pushStack( jQuery.unique(all) );\n
\t},\n
\n
\taddBack: function( selector ) {\n
\t\treturn this.add( selector == null ?\n
\t\t\tthis.prevObject : this.prevObject.filter(selector)\n
\t\t);\n
\t}\n
});\n
\n
function sibling( cur, dir ) {\n
\twhile ( (cur = cur[dir]) && cur.nodeType !== 1 ) {}\n
\n
\treturn cur;\n
}\n
\n
jQuery.each({\n
\tparent: function( elem ) {\n
\t\tvar parent = elem.parentNode;\n
\t\treturn parent && parent.nodeType !== 11 ? parent : null;\n
\t},\n
\tparents: function( elem ) {\n
\t\treturn jQuery.dir( elem, "parentNode" );\n
\t},\n
\tparentsUntil: function( elem, i, until ) {\n
\t\treturn jQuery.dir( elem, "parentNode", until );\n
\t},\n
\tnext: function( elem ) {\n
\t\treturn sibling( elem, "nextSibling" );\n
\t},\n
\tprev: function( elem ) {\n
\t\treturn sibling( elem, "previousSibling" );\n
\t},\n
\tnextAll: function( elem ) {\n
\t\treturn jQuery.dir( elem, "nextSibling" );\n
\t},\n
\tprevAll: function( elem ) {\n
\t\treturn jQuery.dir( elem, "previousSibling" );\n
\t},\n
\tnextUntil: function( elem, i, until ) {\n
\t\treturn jQuery.dir( elem, "nextSibling", until );\n
\t},\n
\tprevUntil: function( elem, i, until ) {\n
\t\treturn jQuery.dir( elem, "previousSibling", until );\n
\t},\n
\tsiblings: function( elem ) {\n
\t\treturn jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );\n
\t},\n
\tchildren: function( elem ) {\n
\t\treturn jQuery.sibling( elem.firstChild );\n
\t},\n
\tcontents: function( elem ) {\n
\t\treturn elem.contentDocument || jQuery.merge( [], elem.childNodes );\n
\t}\n
}, function( name, fn ) {\n
\tjQuery.fn[ name ] = function( until, selector ) {\n
\t\tvar matched = jQuery.map( this, fn, until );\n
\n
\t\tif ( name.slice( -5 ) !== "Until" ) {\n
\t\t\tselector = until;\n
\t\t}\n
\n
\t\tif ( selector && typeof selector === "string" ) {\n
\t\t\tmatched = jQuery.filter( selector, matched );\n
\t\t}\n
\n
\t\tif ( this.length > 1 ) {\n
\t\t\t// Remove duplicates\n
\t\t\tif ( !guaranteedUnique[ name ] ) {\n
\t\t\t\tjQuery.unique( matched );\n
\t\t\t}\n
\n
\t\t\t// Reverse order for parents* and prev-derivatives\n
\t\t\tif ( rparentsprev.test( name ) ) {\n
\t\t\t\tmatched.reverse();\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this.pushStack( matched );\n
\t};\n
});\n
\n
jQuery.extend({\n
\tfilter: function( expr, elems, not ) {\n
\t\tvar elem = elems[ 0 ];\n
\n
\t\tif ( not ) {\n
\t\t\texpr = ":not(" + expr + ")";\n
\t\t}\n
\n
\t\treturn elems.length === 1 && elem.nodeType === 1 ?\n
\t\t\tjQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :\n
\t\t\tjQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {\n
\t\t\t\treturn elem.nodeType === 1;\n
\t\t\t}));\n
\t},\n
\n
\tdir: function( elem, dir, until ) {\n
\t\tvar matched = [],\n
\t\t\ttruncate = until !== undefined;\n
\n
\t\twhile ( (elem = elem[ dir ]) && elem.nodeType !== 9 ) {\n
\t\t\tif ( elem.nodeType === 1 ) {\n
\t\t\t\tif ( truncate && jQuery( elem ).is( until ) ) {\n
\t\t\t\t\tbreak;\n
\t\t\t\t}\n
\t\t\t\tmatched.push( elem );\n
\t\t\t}\n
\t\t}\n
\t\treturn matched;\n
\t},\n
\n
\tsibling: function( n, elem ) {\n
\t\tvar matched = [];\n
\n
\t\tfor ( ; n; n = n.nextSibling ) {\n
\t\t\tif ( n.nodeType === 1 && n !== elem ) {\n
\t\t\t\tmatched.push( n );\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn matched;\n
\t}\n
});\n
\n
// Implement the identical functionality for filter and not\n
function winnow( elements, qualifier, not ) {\n
\tif ( jQuery.isFunction( qualifier ) ) {\n
\t\treturn jQuery.grep( elements, function( elem, i ) {\n
\t\t\t/* jshint -W018 */\n
\t\t\treturn !!qualifier.call( elem, i, elem ) !== not;\n
\t\t});\n
\n
\t}\n
\n
\tif ( qualifier.nodeType ) {\n
\t\treturn jQuery.grep( elements, function( elem ) {\n
\t\t\treturn ( elem === qualifier ) !== not;\n
\t\t});\n
\n
\t}\n
\n
\tif ( typeof qualifier === "string" ) {\n
\t\tif ( isSimple.test( qualifier ) ) {\n
\t\t\treturn jQuery.filter( qualifier, elements, not );\n
\t\t}\n
\n
\t\tqualifier = jQuery.filter( qualifier, elements );\n
\t}\n
\n
\treturn jQuery.grep( elements, function( elem ) {\n
\t\treturn ( core_indexOf.call( qualifier, elem ) >= 0 ) !== not;\n
\t});\n
}\n
var rxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,\n
\trtagName = /<([\\w:]+)/,\n
\trhtml = /<|&#?\\w+;/,\n
\trnoInnerhtml = /<(?:script|style|link)/i,\n
\tmanip

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAQ=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="4" aka="AAAAAAAAAAQ=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

ulation_rcheckableType = /^(?:checkbox|radio)$/i,\n
\t// checked="checked" or checked\n
\trchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\n
\trscriptType = /^$|\\/(?:java|ecma)script/i,\n
\trscriptTypeMasked = /^true\\/(.*)/,\n
\trcleanScript = /^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,\n
\n
\t// We have to close these tags to support XHTML (#13200)\n
\twrapMap = {\n
\n
\t\t// Support: IE 9\n
\t\toption: [ 1, "<select multiple=\'multiple\'>", "</select>" ],\n
\n
\t\tthead: [ 1, "<table>", "</table>" ],\n
\t\tcol: [ 2, "<table><colgroup>", "</colgroup></table>" ],\n
\t\ttr: [ 2, "<table><tbody>", "</tbody></table>" ],\n
\t\ttd: [ 3, "<table><tbody><tr>", "</tr></tbody></table>" ],\n
\n
\t\t_default: [ 0, "", "" ]\n
\t};\n
\n
// Support: IE 9\n
wrapMap.optgroup = wrapMap.option;\n
\n
wrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\n
wrapMap.th = wrapMap.td;\n
\n
jQuery.fn.extend({\n
\ttext: function( value ) {\n
\t\treturn jQuery.access( this, function( value ) {\n
\t\t\treturn value === undefined ?\n
\t\t\t\tjQuery.text( this ) :\n
\t\t\t\tthis.empty().append( ( this[ 0 ] && this[ 0 ].ownerDocument || document ).createTextNode( value ) );\n
\t\t}, null, value, arguments.length );\n
\t},\n
\n
\tappend: function() {\n
\t\treturn this.domManip( arguments, function( elem ) {\n
\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n
\t\t\t\tvar target = manipulationTarget( this, elem );\n
\t\t\t\ttarget.appendChild( elem );\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\tprepend: function() {\n
\t\treturn this.domManip( arguments, function( elem ) {\n
\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n
\t\t\t\tvar target = manipulationTarget( this, elem );\n
\t\t\t\ttarget.insertBefore( elem, target.firstChild );\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\tbefore: function() {\n
\t\treturn this.domManip( arguments, function( elem ) {\n
\t\t\tif ( this.parentNode ) {\n
\t\t\t\tthis.parentNode.insertBefore( elem, this );\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\tafter: function() {\n
\t\treturn this.domManip( arguments, function( elem ) {\n
\t\t\tif ( this.parentNode ) {\n
\t\t\t\tthis.parentNode.insertBefore( elem, this.nextSibling );\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\t// keepData is for internal use only--do not document\n
\tremove: function( selector, keepData ) {\n
\t\tvar elem,\n
\t\t\telems = selector ? jQuery.filter( selector, this ) : this,\n
\t\t\ti = 0;\n
\n
\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\n
\t\t\tif ( !keepData && elem.nodeType === 1 ) {\n
\t\t\t\tjQuery.cleanData( getAll( elem ) );\n
\t\t\t}\n
\n
\t\t\tif ( elem.parentNode ) {\n
\t\t\t\tif ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {\n
\t\t\t\t\tsetGlobalEval( getAll( elem, "script" ) );\n
\t\t\t\t}\n
\t\t\t\telem.parentNode.removeChild( elem );\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this;\n
\t},\n
\n
\tempty: function() {\n
\t\tvar elem,\n
\t\t\ti = 0;\n
\n
\t\tfor ( ; (elem = this[i]) != null; i++ ) {\n
\t\t\tif ( elem.nodeType === 1 ) {\n
\n
\t\t\t\t// Prevent memory leaks\n
\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n
\n
\t\t\t\t// Remove any remaining nodes\n
\t\t\t\telem.textContent = "";\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this;\n
\t},\n
\n
\tclone: function( dataAndEvents, deepDataAndEvents ) {\n
\t\tdataAndEvents = dataAndEvents == null ? false : dataAndEvents;\n
\t\tdeepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\n
\n
\t\treturn this.map( function () {\n
\t\t\treturn jQuery.clone( this, dataAndEvents, deepDataAndEvents );\n
\t\t});\n
\t},\n
\n
\thtml: function( value ) {\n
\t\treturn jQuery.access( this, function( value ) {\n
\t\t\tvar elem = this[ 0 ] || {},\n
\t\t\t\ti = 0,\n
\t\t\t\tl = this.length;\n
\n
\t\t\tif ( value === undefined && elem.nodeType === 1 ) {\n
\t\t\t\treturn elem.innerHTML;\n
\t\t\t}\n
\n
\t\t\t// See if we can take a shortcut and just use innerHTML\n
\t\t\tif ( typeof value === "string" && !rnoInnerhtml.test( value ) &&\n
\t\t\t\t!wrapMap[ ( rtagName.exec( value ) || [ "", "" ] )[ 1 ].toLowerCase() ] ) {\n
\n
\t\t\t\tvalue = value.replace( rxhtmlTag, "<$1></$2>" );\n
\n
\t\t\t\ttry {\n
\t\t\t\t\tfor ( ; i < l; i++ ) {\n
\t\t\t\t\t\telem = this[ i ] || {};\n
\n
\t\t\t\t\t\t// Remove element nodes and prevent memory leaks\n
\t\t\t\t\t\tif ( elem.nodeType === 1 ) {\n
\t\t\t\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n
\t\t\t\t\t\t\telem.innerHTML = value;\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\n
\t\t\t\t\telem = 0;\n
\n
\t\t\t\t// If using innerHTML throws an exception, use the fallback method\n
\t\t\t\t} catch( e ) {}\n
\t\t\t}\n
\n
\t\t\tif ( elem ) {\n
\t\t\t\tthis.empty().append( value );\n
\t\t\t}\n
\t\t}, null, value, arguments.length );\n
\t},\n
\n
\treplaceWith: function() {\n
\t\tvar\n
\t\t\t// Snapshot the DOM in case .domManip sweeps something relevant into its fragment\n
\t\t\targs = jQuery.map( this, function( elem ) {\n
\t\t\t\treturn [ elem.nextSibling, elem.parentNode ];\n
\t\t\t}),\n
\t\t\ti = 0;\n
\n
\t\t// Make the changes, replacing each context element with the new content\n
\t\tthis.domManip( arguments, function( elem ) {\n
\t\t\tvar next = args[ i++ ],\n
\t\t\t\tparent = args[ i++ ];\n
\n
\t\t\tif ( parent ) {\n
\t\t\t\t// Don\'t use the snapshot next if it has moved (#13810)\n
\t\t\t\tif ( next && next.parentNode !== parent ) {\n
\t\t\t\t\tnext = this.nextSibling;\n
\t\t\t\t}\n
\t\t\t\tjQuery( this ).remove();\n
\t\t\t\tparent.insertBefore( elem, next );\n
\t\t\t}\n
\t\t// Allow new content to include elements from the context set\n
\t\t}, true );\n
\n
\t\t// Force removal if there was no new content (e.g., from empty arguments)\n
\t\treturn i ? this : this.remove();\n
\t},\n
\n
\tdetach: function( selector ) {\n
\t\treturn this.remove( selector, true );\n
\t},\n
\n
\tdomManip: function( args, callback, allowIntersection ) {\n
\n
\t\t// Flatten any nested arrays\n
\t\targs = core_concat.apply( [], args );\n
\n
\t\tvar fragment, first, scripts, hasScripts, node, doc,\n
\t\t\ti = 0,\n
\t\t\tl = this.length,\n
\t\t\tset = this,\n
\t\t\tiNoClone = l - 1,\n
\t\t\tvalue = args[ 0 ],\n
\t\t\tisFunction = jQuery.isFunction( value );\n
\n
\t\t// We can\'t cloneNode fragments that contain checked, in WebKit\n
\t\tif ( isFunction || !( l <= 1 || typeof value !== "string" || jQuery.support.checkClone || !rchecked.test( value ) ) ) {\n
\t\t\treturn this.each(function( index ) {\n
\t\t\t\tvar self = set.eq( index );\n
\t\t\t\tif ( isFunction ) {\n
\t\t\t\t\targs[ 0 ] = value.call( this, index, self.html() );\n
\t\t\t\t}\n
\t\t\t\tself.domManip( args, callback, allowIntersection );\n
\t\t\t});\n
\t\t}\n
\n
\t\tif ( l ) {\n
\t\t\tfragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, !allowIntersection && this );\n
\t\t\tfirst = fragment.firstChild;\n
\n
\t\t\tif ( fragment.childNodes.length === 1 ) {\n
\t\t\t\tfragment = first;\n
\t\t\t}\n
\n
\t\t\tif ( first ) {\n
\t\t\t\tscripts = jQuery.map( getAll( fragment, "script" ), disableScript );\n
\t\t\t\thasScripts = scripts.length;\n
\n
\t\t\t\t// Use the original fragment for the last item instead of the first because it can end up\n
\t\t\t\t// being emptied incorrectly in certain situations (#8070).\n
\t\t\t\tfor ( ; i < l; i++ ) {\n
\t\t\t\t\tnode = fragment;\n
\n
\t\t\t\t\tif ( i !== iNoClone ) {\n
\t\t\t\t\t\tnode = jQuery.clone( node, true, true );\n
\n
\t\t\t\t\t\t// Keep references to cloned scripts for later restoration\n
\t\t\t\t\t\tif ( hasScripts ) {\n
\t\t\t\t\t\t\t// Support: QtWebKit\n
\t\t\t\t\t\t\t// jQuery.merge because core_push.apply(_, arraylike) throws\n
\t\t\t\t\t\t\tjQuery.merge( scripts, getAll( node, "script" ) );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\n
\t\t\t\t\tcallback.call( this[ i ], node, i );\n
\t\t\t\t}\n
\n
\t\t\t\tif ( hasScripts ) {\n
\t\t\t\t\tdoc = scripts[ scripts.length - 1 ].ownerDocument;\n
\n
\t\t\t\t\t// Reenable scripts\n
\t\t\t\t\tjQuery.map( scripts, restoreScript );\n
\n
\t\t\t\t\t// Evaluate executable scripts on first document insertion\n
\t\t\t\t\tfor ( i = 0; i < hasScripts; i++ ) {\n
\t\t\t\t\t\tnode = scripts[ i ];\n
\t\t\t\t\t\tif ( rscriptType.test( node.type || "" ) &&\n
\t\t\t\t\t\t\t!data_priv.access( node, "globalEval" ) && jQuery.contains( doc, node ) ) {\n
\n
\t\t\t\t\t\t\tif ( node.src ) {\n
\t\t\t\t\t\t\t\t// Hope ajax is available...\n
\t\t\t\t\t\t\t\tjQuery._evalUrl( node.src );\n
\t\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t\tjQuery.globalEval( node.textContent.replace( rcleanScript, "" ) );\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn this;\n
\t}\n
});\n
\n
jQuery.each({\n
\tappendTo: "append",\n
\tprependTo: "prepend",\n
\tinsertBefore: "before",\n
\tinsertAfter: "after",\n
\treplaceAll: "replaceWith"\n
}, function( name, original ) {\n
\tjQuery.fn[ name ] = function( selector ) {\n
\t\tvar elems,\n
\t\t\tret = [],\n
\t\t\tinsert = jQuery( selector ),\n
\t\t\tlast = insert.length - 1,\n
\t\t\ti = 0;\n
\n
\t\tfor ( ; i <= last; i++ ) {\n
\t\t\telems = i === last ? this : this.clone( true );\n
\t\t\tjQuery( insert[ i ] )[ original ]( elems );\n
\n
\t\t\t// Support: QtWebKit\n
\t\t\t// .get() because core_push.apply(_, arraylike) throws\n
\t\t\tcore_push.apply( ret, elems.get() );\n
\t\t}\n
\n
\t\treturn this.pushStack( ret );\n
\t};\n
});\n
\n
jQuery.extend({\n
\tclone: function( elem, dataAndEvents, deepDataAndEvents ) {\n
\t\tvar i, l, srcElements, destElements,\n
\t\t\tclone = elem.cloneNode( true ),\n
\t\t\tinPage = jQuery.contains( elem.ownerDocument, elem );\n
\n
\t\t// Support: IE >= 9\n
\t\t// Fix Cloning issues\n
\t\tif ( !jQuery.support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) && !jQuery.isXMLDoc( elem ) ) {\n
\n
\t\t\t// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2\n
\t\t\tdestElements = getAll( clone );\n
\t\t\tsrcElements = getAll( elem );\n
\n
\t\t\tfor ( i = 0, l = srcElements.length; i < l; i++ ) {\n
\t\t\t\tfixInput( srcElements[ i ], destElements[ i ] );\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Copy the events from the original to the clone\n
\t\tif ( dataAndEvents ) {\n
\t\t\tif ( deepDataAndEvents ) {\n
\t\t\t\tsrcElements = srcElements || getAll( elem );\n
\t\t\t\tdestElements = destElements || getAll( clone );\n
\n
\t\t\t\tfor ( i = 0, l = srcElements.length; i < l; i++ ) {\n
\t\t\t\t\tcloneCopyEvent( srcElements[ i ], destElements[ i ] );\n
\t\t\t\t}\n
\t\t\t} else {\n
\t\t\t\tcloneCopyEvent( elem, clone );\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Preserve script evaluation history\n
\t\tdestElements = getAll( clone, "script" );\n
\t\tif ( destElements.length > 0 ) {\n
\t\t\tsetGlobalEval( destElements, !inPage && getAll( elem, "script" ) );\n
\t\t}\n
\n
\t\t// Return the cloned set\n
\t\treturn clone;\n
\t},\n
\n
\tbuildFragment: function( elems, context, scripts, selection ) {\n
\t\tvar elem, tmp, tag, wrap, contains, j,\n
\t\t\ti = 0,\n
\t\t\tl = elems.length,\n
\t\t\tfragment = context.createDocumentFragment(),\n
\t\t\tnodes = [];\n
\n
\t\tfor ( ; i < l; i++ ) {\n
\t\t\telem = elems[ i ];\n
\n
\t\t\tif ( elem || elem === 0 ) {\n
\n
\t\t\t\t// Add nodes directly\n
\t\t\t\tif ( jQuery.type( elem ) === "object" ) {\n
\t\t\t\t\t// Support: QtWebKit\n
\t\t\t\t\t// jQuery.merge because core_push.apply(_, arraylike) throws\n
\t\t\t\t\tjQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );\n
\n
\t\t\t\t// Convert non-html into a text node\n
\t\t\t\t} else if ( !rhtml.test( elem ) ) {\n
\t\t\t\t\tnodes.push( context.createTextNode( elem ) );\n
\n
\t\t\t\t// Convert html into DOM nodes\n
\t\t\t\t} else {\n
\t\t\t\t\ttmp = tmp || fragment.appendChild( context.createElement("div") );\n
\n
\t\t\t\t\t// Deserialize a standard representation\n
\t\t\t\t\ttag = ( rtagName.exec( elem ) || ["", ""] )[ 1 ].toLowerCase();\n
\t\t\t\t\twrap = wrapMap[ tag ] || wrapMap._default;\n
\t\t\t\t\ttmp.innerHTML = wrap[ 1 ] + elem.replace( rxhtmlTag, "<$1></$2>" ) + wrap[ 2 ];\n
\n
\t\t\t\t\t// Descend through wrappers to the right content\n
\t\t\t\t\tj = wrap[ 0 ];\n
\t\t\t\t\twhile ( j-- ) {\n
\t\t\t\t\t\ttmp = tmp.lastChild;\n
\t\t\t\t\t}\n
\n
\t\t\t\t\t// Support: QtWebKit\n
\t\t\t\t\t// jQuery.merge because core_push.apply(_, arraylike) throws\n
\t\t\t\t\tjQuery.merge( nodes, tmp.childNodes );\n
\n
\t\t\t\t\t// Remember the top-level container\n
\t\t\t\t\ttmp = fragment.firstChild;\n
\n
\t\t\t\t\t// Fixes #12346\n
\t\t\t\t\t// Support: Webkit, IE\n
\t\t\t\t\ttmp.textContent = "";\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Remove wrapper from fragment\n
\t\tfragment.textContent = "";\n
\n
\t\ti = 0;\n
\t\twhile ( (elem = nodes[ i++ ]) ) {\n
\n
\t\t\t// #4087 - If origin and destination elements are the same, and this is\n
\t\t\t// that element, do not do anything\n
\t\t\tif ( selection && jQuery.inArray( elem, selection ) !== -1 ) {\n
\t\t\t\tcontinue;\n
\t\t\t}\n
\n
\t\t\tcontains = jQuery.contains( elem.ownerDocument, elem );\n
\n
\t\t\t// Append to fragment\n
\t\t\ttmp = getAll( fragment.appendChild( elem ), "script" );\n
\n
\t\t\t// Preserve script evaluation history\n
\t\t\tif ( contains ) {\n
\t\t\t\tsetGlobalEval( tmp );\n
\t\t\t}\n
\n
\t\t\t// Capture executables\n
\t\t\tif ( scripts ) {\n
\t\t\t\tj = 0;\n
\t\t\t\twhile ( (elem = tmp[ j++ ]) ) {\n
\t\t\t\t\tif ( rscriptType.test( elem.type || "" ) ) {\n
\t\t\t\t\t\tscripts.push( elem );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn fragment;\n
\t},\n
\n
\tcleanData: function( elems ) {\n
\t\tvar data, elem, events, type, key, j,\n
\t\t\tspecial = jQuery.event.special,\n
\t\t\ti = 0;\n
\n
\t\tfor ( ; (elem = elems[ i ]) !== undefined; i++ ) {\n
\t\t\tif ( Data.accepts( elem ) ) {\n
\t\t\t\tkey = elem[ data_priv.expando ];\n
\n
\t\t\t\tif ( key && (data = data_priv.cache[ key ]) ) {\n
\t\t\t\t\tevents = Object.keys( data.events || {} );\n
\t\t\t\t\tif ( events.length ) {\n
\t\t\t\t\t\tfor ( j = 0; (type = events[j]) !== undefined; j++ ) {\n
\t\t\t\t\t\t\tif ( special[ type ] ) {\n
\t\t\t\t\t\t\t\tjQuery.event.remove( elem, type );\n
\n
\t\t\t\t\t\t\t// This is a shortcut to avoid jQuery.event.remove\'s overhead\n
\t\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t\tjQuery.removeEvent( elem, type, data.handle );\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\tif ( data_priv.cache[ key ] ) {\n
\t\t\t\t\t\t// Discard any remaining `private` data\n
\t\t\t\t\t\tdelete data_priv.cache[ key ];\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\t// Discard any remaining `user` data\n
\t\t\tdelete data_user.cache[ elem[ data_user.expando ] ];\n
\t\t}\n
\t},\n
\n
\t_evalUrl: function( url ) {\n
\t\treturn jQuery.ajax({\n
\t\t\turl: url,\n
\t\t\ttype: "GET",\n
\t\t\tdataType: "script",\n
\t\t\tasync: false,\n
\t\t\tglobal: false,\n
\t\t\t"throws": true\n
\t\t});\n
\t}\n
});\n
\n
// Support: 1.x compatibility\n
// Manipulating tables requires a tbody\n
function manipulationTarget( elem, content ) {\n
\treturn jQuery.nodeName( elem, "table" ) &&\n
\t\tjQuery.nodeName( content.nodeType === 1 ? content : content.firstChild, "tr" ) ?\n
\n
\t\telem.getElementsByTagName("tbody")[0] ||\n
\t\t\telem.appendChild( elem.ownerDocument.createElement("tbody") ) :\n
\t\telem;\n
}\n
\n
// Replace/restore the type attribute of script elements for safe DOM manipulation\n
function disableScript( elem ) {\n
\telem.type = (elem.getAttribute("type") !== null) + "/" + elem.type;\n
\treturn elem;\n
}\n
function restoreScript( elem ) {\n
\tvar match = rscriptTypeMasked.exec( elem.type );\n
\n
\tif ( match ) {\n
\t\telem.type = match[ 1 ];\n
\t} else {\n
\t\telem.removeAttribute("type");\n
\t}\n
\n
\treturn elem;\n
}\n
\n
// Mark scripts as having already been evaluated\n
function setGlobalEval( elems, refElements ) {\n
\tvar l = elems.length,\n
\t\ti = 0;\n
\n
\tfor ( ; i < l; i++ ) {\n
\t\tdata_priv.set(\n
\t\t\telems[ i ], "globalEval", !refElements || data_priv.get( refElements[ i ], "globalEval" )\n
\t\t);\n
\t}\n
}\n
\n
function cloneCopyEvent( src, dest ) {\n
\tvar i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;\n
\n
\tif ( dest.nodeType !== 1 ) {\n
\t\treturn;\n
\t}\n
\n
\t// 1. Copy private data: events, handlers, etc.\n
\tif ( data_priv.hasData( src ) ) {\n
\t\tpdataOld = data_priv.access( src );\n
\t\tpdataCur = data_priv.set( dest, pdataOld );\n
\t\tevents = pdataOld.events;\n
\n
\t\tif ( events ) {\n
\t\t\tdelete pdataCur.handle;\n
\t\t\tpdataCur.events = {};\n
\n
\t\t\tfor ( type in events ) {\n
\t\t\t\tfor ( i = 0, l = events[ type ].length; i < l; i++ ) {\n
\t\t\t\t\tjQuery.event.add( dest, type, events[ type ][ i ] );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\t// 2. Copy user data\n
\tif ( data_user.hasData( src ) ) {\n
\t\tudataOld = data_user.access( src );\n
\t\tudataCur = jQuery.extend( {}, udataOld );\n
\n
\t\tdata_user.set( dest, udataCur );\n
\t}\n
}\n
\n
\n
function getAll( context, tag ) {\n
\tvar ret = context.getElementsByTagName ? context.getElementsByTagName( tag || "*" ) :\n
\t\t\tcontext.querySelectorAll ? context.querySelectorAll( tag || "*" ) :\n
\t\t\t[];\n
\n
\treturn tag === undefined || tag && jQuery.nodeName( context, tag ) ?\n
\t\tjQuery.merge( [ context ], ret ) :\n
\t\tret;\n
}\n
\n
// Support: IE >= 9\n
function fixInput( src, dest ) {\n
\tvar nodeName = dest.nodeName.toLowerCase();\n
\n
\t// Fails to persist the checked state of a cloned checkbox or radio button.\n
\tif ( nodeName === "input" && manipulation_rcheckableType.test( src.type ) ) {\n
\t\tdest.checked = src.checked;\n
\n
\t// Fails to return the selected option to the default selected state when cloning options\n
\t} else if ( nodeName === "input" || nodeName === "textarea" ) {\n
\t\tdest.defaultValue = src.defaultValue;\n
\t}\n
}\n
jQuery.fn.extend({\n
\twrapAll: function( html ) {\n
\t\tvar wrap;\n
\n
\t\tif ( jQuery.isFunction( html ) ) {\n
\t\t\treturn this.each(function( i ) {\n
\t\t\t\tjQuery( this ).wrapAll( html.call(this, i) );\n
\t\t\t});\n
\t\t}\n
\n
\t\tif ( this[ 0 ] ) {\n
\n
\t\t\t// The elements to wrap the target around\n
\t\t\twrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );\n
\n
\t\t\tif ( this[ 0 ].parentNode ) {\n
\t\t\t\twrap.insertBefore( this[ 0 ] );\n
\t\t\t}\n
\n
\t\t\twrap.map(function() {\n
\t\t\t\tvar elem = this;\n
\n
\t\t\t\twhile ( elem.firstElementChild ) {\n
\t\t\t\t\telem = elem.firstElementChild;\n
\t\t\t\t}\n
\n
\t\t\t\treturn elem;\n
\t\t\t}).append( this );\n
\t\t}\n
\n
\t\treturn this;\n
\t},\n
\n
\twrapInner: function( html ) {\n
\t\tif ( jQuery.isFunction( html ) ) {\n
\t\t\treturn this.each(function( i ) {\n
\t\t\t\tjQuery( this ).wrapInner( html.call(this, i) );\n
\t\t\t});\n
\t\t}\n
\n
\t\treturn this.each(function() {\n
\t\t\tvar self = jQuery( this ),\n
\t\t\t\tcontents = self.contents();\n
\n
\t\t\tif ( contents.length ) {\n
\t\t\t\tcontents.wrapAll( html );\n
\n
\t\t\t} else {\n
\t\t\t\tself.append( html );\n
\t\t\t}\n
\t\t});\n
\t},\n
\n
\twrap: function( html ) {\n
\t\tvar isFunction = jQuery.isFunction( html );\n
\n
\t\treturn this.each(function( i ) {\n
\t\t\tjQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );\n
\t\t});\n
\t},\n
\n
\tunwrap: function() {\n
\t\treturn this.parent().each(function() {\n
\t\t\tif ( !jQuery.nodeName( this, "body" ) ) {\n
\t\t\t\tjQuery( this ).replaceWith( this.childNodes );\n
\t\t\t}\n
\t\t}).end();\n
\t}\n
});\n
var curCSS, iframe,\n
\t// swappable if display is none or starts with table except "table", "table-cell", or "table-caption"\n
\t// see here for display values: https://developer.mozilla.org/en-US/docs/CSS/display\n
\trdisplayswap = /^(none|table(?!-c[ea]).+)/,\n
\trmargin = /^margin/,\n
\trnumsplit = new RegExp( "^(" + core_pnum + ")(.*)$", "i" ),\n
\trnumnonpx = new RegExp( "^(" + core_pnum + ")(?!px)[a-z%]+$", "i" ),\n
\trrelNum = new RegExp( "^([+-])=(" + core_pnum + ")", "i" ),\n
\telemdisplay = { BODY: "block" },\n
\n
\tcssShow = { position: "absolute", visibility: "hidden", display: "block" },\n
\tcssNormalTransform = {\n
\t\tletterSpacing: 0,\n
\t\tfontWeight: 400\n
\t},\n
\n
\tcssExpand = [ "Top", "Right", "Bottom", "Left" ],\n
\tcssPrefixes = [ "Webkit", "O", "Moz", "ms" ];\n
\n
// return a css property mapped to a potentially vendor prefixed property\n
function vendorPropName( style, name ) {\n
\n
\t// shortcut for names that are not vendor prefixed\n
\tif ( name in style ) {\n
\t\treturn name;\n
\t}\n
\n
\t// check for vendor prefixed names\n
\tvar capName = name.charAt(0).toUpperCase() + name.slice(1),\n
\t\torigName = name,\n
\t\ti = cssPrefixes.length;\n
\n
\twhile ( i-- ) {\n
\t\tname = cssPrefixes[ i ] + capName;\n
\t\tif ( name in style ) {\n
\t\t\treturn name;\n
\t\t}\n
\t}\n
\n
\treturn origName;\n
}\n
\n
function isHidden( elem, el ) {\n
\t// isHidden might be called from jQuery#filter function;\n
\t// in that case, element will be second argument\n
\telem = el || elem;\n
\treturn jQuery.css( elem, "display" ) === "none" || !jQuery.contains( elem.ownerDocument, elem );\n
}\n
\n
// NOTE: we\'ve included the "window" in window.getComputedStyle\n
// because jsdom on node.js will break without it.\n
function getStyles( elem ) {\n
\treturn window.getComputedStyle( elem, null );\n
}\n
\n
function showHide( elements, show ) {\n
\tvar display, elem, hidden,\n
\t\tvalues = [],\n
\t\tindex = 0,\n
\t\tlength = elements.length;\n
\n
\tfor ( ; index < length; index++ ) {\n
\t\telem = elements[ index ];\n
\t\tif ( !elem.style ) {\n
\t\t\tcontinue;\n
\t\t}\n
\n
\t\tvalues[ index ] = data_priv.get( elem, "olddisplay" );\n
\t\tdisplay = elem.style.display;\n
\t\tif ( show ) {\n
\t\t\t// Reset the inline display of this element to learn if it is\n
\t\t\t// being hidden by cascaded rules or not\n
\t\t\tif ( !values[ index ] && display === "none" ) {\n
\t\t\t\telem.style.display = "";\n
\t\t\t}\n
\n
\t\t\t// Set elements which have been overridden with display: none\n
\t\t\t// in a stylesheet to whatever the default browser style is\n
\t\t\t// for such an element\n
\t\t\tif ( elem.style.display === "" && isHidden( elem ) ) {\n
\t\t\t\tvalues[ index ] = data_priv.access( elem, "olddisplay", css_defaultDisplay(elem.nodeName) );\n
\t\t\t}\n
\t\t} else {\n
\n
\t\t\tif ( !values[ index ] ) {\n
\t\t\t\thidden = isHidden( elem );\n
\n
\t\t\t\tif ( display && display !== "none" || !hidden ) {\n
\t\t\t\t\tdata_priv.set( elem, "olddisplay", hidden ? display : jQuery.css(elem, "display") );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\t// Set the display of most of the elements in a second loop\n
\t// to avoid the constant reflow\n
\tfor ( index = 0; index < length; index++ ) {\n
\t\telem = elements[ index ];\n
\t\tif ( !elem.style ) {\n
\t\t\tcontinue;\n
\t\t}\n
\t\tif ( !show || elem.style.display === "none" || elem.style.display === "" ) {\n
\t\t\telem.style.display = show ? values[ index ] || "" : "none";\n
\t\t}\n
\t}\n
\n
\treturn elements;\n
}\n
\n
jQuery.fn.extend({\n
\tcss: function( name, value ) {\n
\t\treturn jQuery.access( this, function( elem, name, value ) {\n
\t\t\tvar styles, len,\n
\t\t\t\tmap = {},\n
\t\t\t\ti = 0;\n
\n
\t\t\tif ( jQuery.isArray( name ) ) {\n
\t\t\t\tstyles = getStyles( elem );\n
\t\t\t\tlen = name.length;\n
\n
\t\t\t\tfor ( ; i < len; i++ ) {\n
\t\t\t\t\tmap[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );\n
\t\t\t\t}\n
\n
\t\t\t\treturn map;\n
\t\t\t}\n
\n
\t\t\treturn value !== undefined ?\n
\t\t\t\tjQuery.style( elem, name, value ) :\n
\t\t\t\tjQuery.css( elem, name );\n
\t\t}, name, value, arguments.length > 1 );\n
\t},\n
\tshow: function() {\n
\t\treturn showHide( this, true );\n
\t},\n
\thide: function() {\n
\t\treturn showHide( this );\n
\t},\n
\ttoggle: function( state ) {\n
\t\tif ( typeof state === "boolean" ) {\n
\t\t\treturn state ? this.show() : this.hide();\n
\t\t}\n
\n
\t\treturn this.each(function() {\n
\t\t\tif ( isHidden( this ) ) {\n
\t\t\t\tjQuery( this ).show();\n
\t\t\t} else {\n
\t\t\t\tjQuery( this ).hide();\n
\t\t\t}\n
\t\t});\n
\t}\n
});\n
\n
jQuery.extend({\n
\t// Add in style property hooks for overriding the default\n
\t// behavior of getting and setting a style property\n
\tcssHooks: {\n
\t\topacity: {\n
\t\t\tget: function( elem, computed ) {\n
\t\t\t\tif ( computed ) {\n
\t\t\t\t\t// We should always get a number back from opacity\n
\t\t\t\t\tvar ret = curCSS( elem, "opacity" );\n
\t\t\t\t\treturn ret === "" ? "1" : ret;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t},\n
\n
\t// Don\'t automatically add "px" to these possibly-unitless properties\n
\tcssNumber: {\n
\t\t"columnCount": true,\n
\t\t"fillOpacity": true,\n
\t\t"fontWeight": true,\n
\t\t"lineHeight": true,\n
\t\t"opacity": true,\n
\t\t"order": true,\n
\t\t"orphans": true,\n
\t\t"widows": true,\n
\t\t"zIndex": true,\n
\t\t"zoom": true\n
\t},\n
\n
\t// Add in properties whose names you wish to fix before\n
\t// setting or getting the value\n
\tcssProps: {\n
\t\t// normalize float css property\n
\t\t"float": "cssFloat"\n
\t},\n
\n
\t// Get and set the style property on a DOM Node\n
\tstyle: function( elem, name, value, extra ) {\n
\t\t// Don\'t set styles on text and comment nodes\n
\t\tif ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\t// Make sure that we\'re working with the right name\n
\t\tvar ret, type, hooks,\n
\t\t\torigName = jQuery.camelCase( name ),\n
\t\t\tstyle = elem.style;\n
\n
\t\tname = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );\n
\n
\t\t// gets hook for the prefixed version\n
\t\t// followed by the unprefixed version\n
\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n
\n
\t\t// Check if we\'re setting a value\n
\t\tif ( value !== undefined ) {\n
\t\t\ttype = typeof value;\n
\n
\t\t\t// convert relative number strings (+= or -=) to relative numbers. #7345\n
\t\t\tif ( type === "string" && (ret = rrelNum.exec( value )) ) {\n
\t\t\t\tvalue = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );\n
\t\t\t\t// Fixes bug #9237\n
\t\t\t\ttype = "number";\n
\t\t\t}\n
\n
\t\t\t// Make sure that NaN and null values aren\'t set. See: #7116\n
\t\t\tif ( value == null || type === "number" && isNaN( value ) ) {\n
\t\t\t\treturn;\n
\t\t\t}\n
\n
\t\t\t// If a number was passed in, add \'px\' to the (except for certain CSS properties)\n
\t\t\tif ( type === "number" && !jQuery.cssNumber[ origName ] ) {\n
\t\t\t\tvalue += "px";\n
\t\t\t}\n
\n
\t\t\t// Fixes #8908, it can be done more correctly by specifying setters in cssHooks,\n
\t\t\t// but it would mean to define eight (for every problematic property) identical functions\n
\t\t\tif ( !jQuery.support.clearCloneStyle && value === "" && name.indexOf("background") === 0 ) {\n
\t\t\t\tstyle[ name ] = "inherit";\n
\t\t\t}\n
\n
\t\t\t// If a hook was provided, use that value, otherwise just set the specified value\n
\t\t\tif ( !hooks || !("set" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {\n
\t\t\t\tstyle[ name ] = value;\n
\t\t\t}\n
\n
\t\t} else {\n
\t\t\t// If a hook was provided get the non-computed value from there\n
\t\t\tif ( hooks && "get" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {\n
\t\t\t\treturn ret;\n
\t\t\t}\n
\n
\t\t\t// Otherwise just get the value from the style object\n
\t\t\treturn style[ name ];\n
\t\t}\n
\t},\n
\n
\tcss: function( elem, name, extra, styles ) {\n
\t\tvar val, num, hooks,\n
\t\t\torigName = jQuery.camelCase( name );\n
\n
\t\t// Make sure that we\'re working with the right name\n
\t\tname = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );\n
\n
\t\t// gets hook for the prefixed version\n
\t\t// followed by the unprefixed version\n
\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n
\n
\t\t// If a hook was provided get the computed value from there\n
\t\tif ( hooks && "get" in hooks ) {\n
\t\t\tval = hooks.get( elem, true, extra );\n
\t\t}\n
\n
\t\t// Otherwise, if a way to get the computed value exists, use that\n
\t\tif ( val === undefined ) {\n
\t\t\tval = curCSS( elem, name, styles );\n
\t\t}\n
\n
\t\t//convert "normal" to computed value\n
\t\tif ( val === "normal" && name in cssNormalTransform ) {\n
\t\t\tval = cssNormalTransform[ name ];\n
\t\t}\n
\n
\t\t// Return, converting to number if forced or a qualifier was provided and val looks numeric\n
\t\tif ( extra === "" || extra ) {\n
\t\t\tnum = parseFloat( val );\n
\t\t\treturn extra === true || jQuery.isNumeric( num ) ? num || 0 : val;\n
\t\t}\n
\t\treturn val;\n
\t}\n
});\n
\n
curCSS = function( elem, name, _computed ) {\n
\tvar width, minWidth, maxWidth,\n
\t\tcomputed = _computed || getStyles( elem ),\n
\n
\t\t// Support: IE9\n
\t\t// getPropertyValue is only needed for .css(\'filter\') in IE9, see #12537\n
\t\tret = computed ? computed.getPropertyValue( name ) || computed[ name ] : undefined,\n
\t\tstyle = elem.style;\n
\n
\tif ( computed ) {\n
\n
\t\tif ( ret === "" && !jQuery.contains( elem.ownerDocument, elem ) ) {\n
\t\t\tret = jQuery.style( elem, name );\n
\t\t}\n
\n
\t\t// Support: Safari 5.1\n
\t\t// A tribute to the "awesome hack by Dean Edwards"\n
\t\t// Safari 5.1.7 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels\n
\t\t// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values\n
\t\tif ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {\n
\n
\t\t\t// Remember the original values\n
\t\t\twidth = style.width;\n
\t\t\tminWidth = style.minWidth;\n
\t\t\tmaxWidth = style.maxWidth;\n
\n
\t\t\t// Put in the new values to get a computed value out\n
\t\t\tstyle.minWidth = style.maxWidth = style.width = ret;\n
\t\t\tret = computed.width;\n
\n
\t\t\t// Revert the changed values\n
\t\t\tstyle.width = width;\n
\t\t\tstyle.minWidth = minWidth;\n
\t\t\tstyle.maxWidth = maxWidth;\n
\t\t}\n
\t}\n
\n
\treturn ret;\n
};\n
\n
\n
function setPositiveNumber( elem, value, subtract ) {\n
\tvar matches = rnumsplit.exec( value );\n
\treturn matches ?\n
\t\t// Guard against undefined "subtract", e.g., when used as in cssHooks\n
\t\tMath.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || "px" ) :\n
\t\tvalue;\n
}\n
\n
function augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {\n
\tvar i = extra === ( isBorderBox ? "border" : "content" ) ?\n
\t\t// If we already have the right measurement, avoid augmentation\n
\t\t4 :\n
\t\t// Otherwise initialize for horizontal or vertical properties\n
\t\tname === "width" ? 1 : 0,\n
\n
\t\tval = 0;\n
\n
\tfor ( ; i < 4; i += 2 ) {\n
\t\t// both box models exclude margin, so add it if we want it\n
\t\tif ( extra === "margin" ) {\n
\t\t\tval += jQuery.css( elem, extra + cssExpand[ i ], true, styles );\n
\t\t}\n
\n
\t\tif ( isBorderBox ) {\n
\t\t\t// border-box includes padding, so remove it if we want content\n
\t\t\tif ( extra === "content" ) {\n
\t\t\t\tval -= jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );\n
\t\t\t}\n
\n
\t\t\t// at this point, extra isn\'t border nor margin, so remove border\n
\t\t\tif ( extra !== "margin" ) {\n
\t\t\t\tval -= jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );\n
\t\t\t}\n
\t\t} else {\n
\t\t\t// at this point, extra isn\'t content, so add padding\n
\t\t\tval += jQuery.css( elem, "padding" + cssExpand[ i ], true, styles );\n
\n
\t\t\t// at this point, extra isn\'t content nor padding, so add border\n
\t\t\tif ( extra !== "padding" ) {\n
\t\t\t\tval += jQuery.css( elem, "border" + cssExpand[ i ] + "Width", true, styles );\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\treturn val;\n
}\n
\n
function getWidthOrHeight( elem, name, extra ) {\n
\n
\t// Start with offset property, which is equivalent to the border-box value\n
\tvar valueIsBorderBox = true,\n
\t\tval = name === "width" ? elem.offsetWidth : elem.offsetHeight,\n
\t\tstyles = getStyles( elem ),\n
\t\tisBorderBox = jQuery.support.boxSizing && jQuery.css( elem, "boxSizing", false, styles ) === "border-box";\n
\n
\t// some non-html elements return undefined for offsetWidth, so check for null/undefined\n
\t// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285\n
\t// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668\n
\tif ( val <= 0 || val == null ) {\n
\t\t// Fall back to computed then uncomputed css if necessary\n
\t\tval = curCSS( elem, name, styles );\n
\t\tif ( val < 0 || val == null ) {\n
\t\t\tval = elem.style[ name ];\n
\t\t}\n
\n
\t\t// Computed unit is not pixels. Stop here and return.\n
\t\tif ( rnumnonpx.test(val) ) {\n
\t\t\treturn val;\n
\t\t}\n
\n
\t\t// we need the check for style in case a browser which returns unreliable values\n
\t\t// for getComputedStyle silently falls back to the reliable elem.style\n
\t\tvalueIsBorderBox = isBorderBox && ( jQuery.support.boxSizingReliable || val === elem.style[ name ] );\n
\n
\t\t// Normalize "", auto, and prepare for extra\n
\t\tval = parseFloat( val ) || 0;\n
\t}\n
\n
\t// use the active box-sizing model to add/subtract irrelevant styles\n
\treturn ( val +\n
\t\taugmentWidthOrHeight(\n
\t\t\telem,\n
\t\t\tname,\n
\t\t\textra || ( isBorderBox ? "border" : "content" ),\n
\t\t\tvalueIsBorderBox,\n
\t\t\tstyles\n
\t\t)\n
\t) + "px";\n
}\n
\n
// Try to determine the default display value of an element\n
function css_defaultDisplay( nodeName ) {\n
\tvar doc = document,\n
\t\tdisplay = elemdisplay[ nodeName ];\n
\n
\tif ( !display ) {\n
\t\tdisplay = actualDisplay( nodeName, doc );\n
\n
\t\t// If the simple way fails, read from inside an iframe\n
\t\tif ( display === "none" || !display ) {\n
\t\t\t// Use the already-created iframe if possible\n
\t\t\tiframe = ( iframe ||\n
\t\t\t\tjQuery("<iframe frameborder=\'0\' width=\'0\' height=\'0\'/>")\n
\t\t\t\t.css( "cssText", "display:block !important" )\n
\t\t\t).appendTo( doc.documentElement );\n
\n
\t\t\t// Always write a new HTML skeleton so Webkit and Firefox don\'t choke on reuse\n
\t\t\tdoc = ( iframe[0].contentWindow || iframe[0].contentDocument ).document;\n
\t\t\tdoc.write("<!doctype html><html><body>");\n
\t\t\tdoc.close();\n
\n
\t\t\tdisplay = actualDisplay( nodeName, doc );\n
\t\t\tiframe.detach();\n
\t\t}\n
\n
\t\t// Store the correct default display\n
\t\telemdisplay[ nodeName ] = display;\n
\t}\n
\n
\treturn display;\n
}\n
\n
// Called ONLY from within css_defaultDisplay\n
function actualDisplay( name, doc ) {\n
\tvar elem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),\n
\t\tdisplay = jQuery.css( elem[0], "display" );\n
\telem.remove();\n
\treturn display;\n
}\n
\n
jQuery.each([ "height", "width" ], function( i, name ) {\n
\tjQuery.cssHooks[ name ] = {\n
\t\tget: function( elem, computed, extra ) {\n
\t\t\tif ( computed ) {\n
\t\t\t\t// certain elements can have dimension info if we invisibly show them\n
\t\t\t\t// however, it must have a current display style that would benefit from this\n
\t\t\t\treturn elem.offsetWidth === 0 && rdisplayswap.test( jQuery.css( elem, "display" ) ) ?\n
\t\t\t\t\tjQuery.swap( elem, cssShow, function() {\n
\t\t\t\t\t\treturn getWidthOrHeight( elem, name, extra );\n
\t\t\t\t\t}) :\n
\t\t\t\t\tgetWidthOrHeight( elem, name, extra );\n
\t\t\t}\n
\t\t},\n
\n
\t\tset: function( elem, value, extra ) {\n
\t\t\tvar styles = extra && getStyles( elem );\n
\t\t\treturn setPositiveNumber( elem, value, extra ?\n
\t\t\t\taugmentWidthOrHeight(\n
\t\t\t\t\telem,\n
\t\t\t\t\tname,\n
\t\t\t\t\textra,\n
\t\t\t\t\tjQuery.support.boxSizing && jQuery.css( elem, "boxSizing", false, styles ) === "border-box",\n
\t\t\t\t\tstyles\n
\t\t\t\t) : 0\n
\t\t\t);\n
\t\t}\n
\t};\n
});\n
\n
// These hooks cannot be added until DOM ready because the support test\n
// for it is not run until after DOM ready\n
jQuery(function() {\n
\t// Support: Android 2.3\n
\tif ( !jQuery.support.reliableMarginRight ) {\n
\t\tjQuery.cssHooks.marginRight = {\n
\t\t\tget: function( elem, computed ) {\n
\t\t\t\tif ( computed ) {\n
\t\t\t\t\t// Support: Android 2.3\n
\t\t\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n
\t\t\t\t\t// Work around by temporarily setting element display to inline-block\n
\t\t\t\t\treturn jQuery.swap( elem, { "display": "inline-block" },\n
\t\t\t\t\t\tcurCSS, [ elem, "marginRight" ] );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t};\n
\t}\n
\n
\t// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084\n
\t// getComputedStyle returns percent when specified for top/left/bottom/right\n
\t// rather than make the css module depend on the offset module, we just check for it here\n
\tif ( !jQuery.support.pixelPosition && jQuery.fn.position ) {\n
\t\tjQuery.each( [ "top", "left" ], function( i, prop ) {\n
\t\t\tjQuery.cssHooks[ prop ] = {\n
\t\t\t\tget: function( elem, computed ) {\n
\t\t\t\t\tif ( computed ) {\n
\t\t\t\t\t\tcomputed = curCSS( elem, prop );\n
\t\t\t\t\t\t// if curCSS returns percentage, fallback to offset\n
\t\t\t\t\t\treturn rnumnonpx.test( computed ) ?\n
\t\t\t\t\t\t\tjQuery( elem ).position()[ prop ] + "px" :\n
\t\t\t\t\t\t\tcomputed;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t};\n
\t\t});\n
\t}\n
\n
});\n
\n
if ( jQuery.expr && jQuery.expr.filters ) {\n
\tjQuery.expr.filters.hidden = function( elem ) {\n
\t\t// Support: Opera <= 12.12\n
\t\t// Opera reports offsetWidths and offsetHeights less than zero on some elements\n
\t\treturn elem.offsetWidth <= 0 && elem.offsetHeight <= 0;\n
\t};\n
\n
\tjQuery.expr.filters.visible = function( elem ) {\n
\t\treturn !jQuery.expr.filters.hidden( elem );\n
\t};\n
}\n
\n
// These hooks are used by animate to expand properties\n
jQuery.each({\n
\tmargin: "",\n
\tpadding: "",\n
\tborder: "Width"\n
}, function( prefix, suffix ) {\n
\tjQuery.cssHooks[ prefix + suffix ] = {\n
\t\texpand: function( value ) {\n
\t\t\tvar i = 0,\n
\t\t\t\texpanded = {},\n
\n
\t\t\t\t// assumes a single number if not a string\n
\t\t\t\tparts = typeof value === "string" ? value.split(" ") : [ value ];\n
\n
\t\t\tfor ( ; i < 4; i++ ) {\n
\t\t\t\texpanded[ prefix + cssExpand[ i ] + suffix ] =\n
\t\t\t\t\tparts[ i ] || parts[ i - 2 ] || parts[ 0 ];\n
\t\t\t}\n
\n
\t\t\treturn expanded;\n
\t\t}\n
\t};\n
\n
\tif ( !rmargin.test( prefix ) ) {\n
\t\tjQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;\n
\t}\n
});\n
var r20 = /%20/g,\n
\trbracket = /\\[\\]$/,\n
\trCRLF = /\\r?\\n/g,\n
\trsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,\n
\trsubmittable = /^(?:input|select|textarea|keygen)/i;\n
\n
jQuery.fn.extend({\n
\tserialize: function() {\n
\t\treturn jQuery.param( this.serializeArray() );\n
\t},\n
\tserializeArray: function() {\n
\t\treturn this.map(function(){\n
\t\t\t// Can add propHook for "elements" to filter or add form elements\n
\t\t\tvar elements = jQuery.prop( this, "elements" );\n
\t\t\treturn elements ? jQuery.makeArray( elements ) : this;\n
\t\t})\n
\t\t.filter(function(){\n
\t\t\tvar type = this.type;\n
\t\t\t// Use .is(":disabled") so that fieldset[disabled] works\n
\t\t\treturn this.name && !jQuery( this ).is( ":disabled" ) &&\n
\t\t\t\trsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&\n
\t\t\t\t( this.checked || !manipulation_rcheckableType.test( type ) );\n
\t\t})\n
\t\t.map(function( i, elem ){\n
\t\t\tvar val = jQuery( this ).val();\n
\n
\t\t\treturn val == null ?\n
\t\t\t\tnull :\n
\t\t\t\tjQuery.isArray( val ) ?\n
\t\t\t\t\tjQuery.map( val, function( val ){\n
\t\t\t\t\t\treturn { name: elem.name, value: val.replace( rCRLF, "\\r\\n" ) };\n
\t\t\t\t\t}) :\n
\t\t\t\t\t{ name: elem.name, value: val.replace( rCRLF, "\\r\\n" ) };\n
\t\t}).get();\n
\t}\n
});\n
\n
//Serialize an array of form elements or a set of\n
//key/values into a query string\n
jQuery.param = function( a, traditional ) {\n
\tvar prefix,\n
\t\ts = [],\n
\t\tadd = function( key, value ) {\n
\t\t\t// If value is a function, invoke it and return its value\n
\t\t\tvalue = jQuery.isFunction( value ) ? value() : ( value == null ? "" : value );\n
\t\t\ts[ s.length ] = encodeURIComponent( key ) + "=" + encodeURIComponent( value );\n
\t\t};\n
\n
\t// Set traditional to true for jQuery <= 1.3.2 behavior.\n
\tif ( traditional === undefined ) {\n
\t\ttraditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;\n
\t}\n
\n
\t// If an array was passed in, assume that it is an array of form elements.\n
\tif ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\n
\t\t// Serialize the form elements\n
\t\tjQuery.each( a, function() {\n
\t\t\tadd( this.name, this.value );\n
\t\t});\n
\n
\t} else {\n
\t\t// If traditional, encode the "old" way (the way 1.3.2 or older\n
\t\t// did it), otherwise encode params recursively.\n
\t\tfor ( prefix in a ) {\n
\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\n
\t\t}\n
\t}\n
\n
\t// Return the resulting serialization\n
\treturn s.join( "&" ).replace( r20, "+" );\n
};\n
\n
function buildParams( prefix, obj, traditional, add ) {\n
\tvar name;\n
\n
\tif ( jQuery.isArray( obj ) ) {\n
\t\t// Serialize array item.\n
\t\tjQuery.each( obj, function( i, v ) {\n
\t\t\tif ( traditional || rbracket.test( prefix ) ) {\n
\t\t\t\t// Treat each array item as a scalar.\n
\t\t\t\tadd( prefix, v );\n
\n
\t\t\t} else {\n
\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\n
\t\t\t\tbuildParams( prefix + "[" + ( typeof v === "object" ? i : "" ) + "]", v, traditional, add );\n
\t\t\t}\n
\t\t});\n
\n
\t} else if ( !traditional && jQuery.type( obj ) === "object" ) {\n
\t\t// Serialize object item.\n
\t\tfor ( name in obj ) {\n
\t\t\tbuildParams( prefix + "[" + name + "]", obj[ name ], traditional, add );\n
\t\t}\n
\n
\t} else {\n
\t\t// Serialize scalar item.\n
\t\tadd( prefix, obj );\n
\t}\n
}\n
jQuery.each( ("blur focus focusin focusout load resize scroll unload click dblclick " +\n
\t"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave " +\n
\t"change select submit keydown keypress keyup error contextmenu").split(" "), function( i, name ) {\n
\n
\t// Handle event binding\n
\tjQuery.fn[ name ] = function( data, fn ) {\n
\t\treturn arguments.length > 0 ?\n
\t\t\tthis.on( name, null, data, fn ) :\n
\t\t\tthis.trigger( name );\n
\t};\n
});\n
\n
jQuery.fn.extend({\n
\thover: function( fnOver, fnOut ) {\n
\t\treturn this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\n
\t},\n
\n
\tbind: function( types, data, fn ) {\n
\t\treturn this.on( types, null, data, fn );\n
\t},\n
\tunbind: function( types, fn ) {\n
\t\treturn this.off( types, null, fn );\n
\t},\n
\n
\tdelegate: function( selector, types, data, fn ) {\n
\t\treturn this.on( types, selector, data, fn );\n
\t},\n
\tundelegate: function( selector, types, fn ) {\n
\t\t// ( namespace ) or ( selector, types [, fn] )\n
\t\treturn arguments.length === 1 ? this.off( selector, "**" ) : this.off( types, selector || "**", fn );\n
\t}\n
});\n
var\n
\t// Document location\n
\tajaxLocParts,\n
\tajaxLocation,\n
\n
\tajax_nonce = jQuery.now(),\n
\n
\tajax_rquery = /\\?/,\n
\trhash = /#.*$/,\n
\trts = /([?&])_=[^&]*/,\n
\trheaders = /^(.*?):[ \\t]*([^\\r\\n]*)$/mg,\n
\t// #7653, #8125, #8152: local protocol detection\n
\trlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,\n
\trnoContent = /^(?:GET|HEAD)$/,\n
\trprotocol = /^\\/\\//,\n
\trurl = /^([\\w.+-]+:)(?:\\/\\/([^\\/?#:]*)(?::(\\d+)|)|)/,\n
\n
\t// Keep a copy of the old load method\n
\t_load = jQuery.fn.load,\n
\n
\t/* Prefilters\n
\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\n
\t * 2) These are called:\n
\t *    - BEFORE asking for a transport\n
\t *    - AFTER param serialization (s.data is a string if s.processData is true)\n
\t * 3) key is the dataType\n
\t * 4) the catchall symbol "*" can be used\n
\t * 5) execution will start with transport dataType and THEN continue down to "*" if needed\n
\t */\n
\tprefilters = {},\n
\n
\t/* Transports bindings\n
\t * 1) key is the dataType\n
\t * 2) the catchall symbol "*" can be used\n
\t * 3) selection will start with transport dataType and THEN go to "*" if needed\n
\t */\n
\ttransports = {},\n
\n
\t// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\n
\tallTypes = "*/".concat("*");\n
\n
// #8138, IE may throw an exception when accessing\n
// a field from window.location if document.domain has been set\n
try {\n
\tajaxLocation = location.href;\n
} catch( e ) {\n
\t// Use the href attribute of an A element\n
\t// since IE will modify it given document.location\n
\tajaxLocation = document.createElement( "a" );\n
\tajaxLocation.href = "";\n
\tajaxLocation = ajaxLocation.href;\n
}\n
\n
// Segment location into parts\n
ajaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];\n
\n
// Base "constructor" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\n
function addToPrefiltersOrTransports( structure ) {\n
\n
\t// dataTypeExpression is optional and defaults to "*"\n
\treturn function( dataTypeExpression, func ) {\n
\n
\t\tif ( typeof dataTypeExpression !== "string" ) {\n
\t\t\tfunc = dataTypeExpression;\n
\t\t\tdataTypeExpression = "*";\n
\t\t}\n
\n
\t\tvar dataType,\n
\t\t\ti = 0,\n
\t\t\tdataTypes = dataTypeExpression.toLowerCase().match( core_rnotwhite ) || [];\n
\n
\t\tif ( jQuery.isFunction( func ) ) {\n
\t\t\t// For each dataType in the dataTypeExpression\n
\t\t\twhile ( (dataType = dataTypes[i++]) ) {\n
\t\t\t\t// Prepend if requested\n
\t\t\t\tif ( dataType[0] === "+" ) {\n
\t\t\t\t\tdataType = dataType.slice( 1 ) || "*";\n
\t\t\t\t\t(structure[ dataType ] = structure[ dataType ] || []).unshift( func );\n
\n
\t\t\t\t// Otherwise append\n
\t\t\t\t} else {\n
\t\t\t\t\t(structure[ dataType ] = structure[ dataType ] || []).push( func );\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t};\n
}\n
\n
// Base inspection function for prefilters and transports\n
function inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {\n
\n
\tvar inspected = {},\n
\t\tseekingTransport = ( structure === transports );\n
\n
\tfunction inspect( dataType ) {\n
\t\tvar selected;\n
\t\tinspected[ dataType ] = true;\n
\t\tjQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {\n
\t\t\tvar dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );\n
\t\t\tif( typeof dataTypeOrTransport === "string" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {\n
\t\t\t\toptions.dataTypes.unshift( dataTypeOrTransport );\n
\t\t\t\tinspect( dataTypeOrTransport );\n
\t\t\t\treturn false;\n
\t\t\t} else if ( seekingTransport ) {\n
\t\t\t\treturn !( selected = dataTypeOrTransport );\n
\t\t\t}\n
\t\t});\n
\t\treturn selected;\n
\t}\n
\n
\treturn inspect( options.dataTypes[ 0 ] ) || !inspected[ "*" ] && inspect( "*" );\n
}\n
\n
// A special extend for ajax options\n
// that takes "flat" options (not to be deep extended)\n
// Fixes #9887\n
function ajaxExtend( target, src ) {\n
\tvar key, deep,\n
\t\tflatOptions = jQuery.ajaxSettings.flatOptions || {};\n
\n
\tfor ( key in src ) {\n
\t\tif ( src[ key ] !== undefined ) {\n
\t\t\t( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];\n
\t\t}\n
\t}\n
\tif ( deep ) {\n
\t\tjQuery.extend( true, target, deep );\n
\t}\n
\n
\treturn target;\n
}\n
\n
jQuery.fn.load = function( url, params, callback ) {\n
\tif ( typeof url !== "string" && _load ) {\n
\t\treturn _load.apply( this, arguments );\n
\t}\n
\n
\tvar selector, type, response,\n
\t\tself = this,\n
\t\toff = url.indexOf(" ");\n
\n
\tif ( off >= 0 ) {\n
\t\tselector = url.slice( off );\n
\t\turl = url.slice( 0, off );\n
\t}\n
\n
\t// If it\'s a function\n
\tif ( jQuery.isFunction( params ) ) {\n
\n
\t\t// We assume that it\'s the callback\n
\t\tcallback = params;\n
\t\tparams = undefined;\n
\n
\t// Otherwise, build a param string\n
\t} else if ( params && typeof params === "object" ) {\n
\t\ttype = "POST";\n
\t}\n
\n
\t// If we have elements to modify, make the request\n
\tif ( self.length > 0 ) {\n
\t\tjQuery.ajax({\n
\t\t\turl: url,\n
\n
\t\t\t// if "type" variable is undefined, then "GET" method will be used\n
\t\t\ttype: type,\n
\t\t\tdataType: "html",\n
\t\t\tdata: params\n
\t\t}).done(function( responseText ) {\n
\n
\t\t\t// Save response for use in complete callback\n
\t\t\tresponse = arguments;\n
\n
\t\t\tself.html( selector ?\n
\n
\t\t\t\t// If a selector was specified, locate the right elements in a dummy div\n
\t\t\t\t// Exclude scripts to avoid IE \'Permission Denied\' errors\n
\t\t\t\tjQuery("<div>").append( jQuery.parseHTML( responseText ) ).find( selector ) :\n
\n
\t\t\t\t// Otherwise use the full result\n
\t\t\t\tresponseText );\n
\n
\t\t}).complete( callback && function( jqXHR, status ) {\n
\t\t\tself.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );\n
\t\t});\n
\t}\n
\n
\treturn this;\n
};\n
\n
// Attach a bunch of functions for handling common AJAX events\n
jQuery.each( [ "ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend" ], function( i, type ){\n
\tjQuery.fn[ type ] = function( fn ){\n
\t\treturn this.on( type, fn );\n
\t};\n
});\n
\n
jQuery.extend({\n
\n
\t// Counter for holding the number of active queries\n
\tactive: 0,\n
\n
\t// Last-Modified header cache for next request\n
\tlastModified: {},\n
\tetag: {},\n
\n
\tajaxSettings: {\n
\t\turl: ajaxLocation,\n
\t\ttype: "GET",\n
\t\tisLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),\n
\t\tglobal: true,\n
\t\tprocessData: true,\n
\t\tasync: true,\n
\t\tcontentType: "application/x-www-form-urlencoded; charset=UTF-8",\n
\t\t/*\n
\t\ttimeout: 0,\n
\t\tdata: null,\n
\t\tdataType: null,\n
\t\tusername: null,\n
\t\tpassword: null,\n
\t\tcache: null,\n
\t\tthrows: false,\n
\t\ttraditional: false,\n
\t\theaders: {},\n
\t\t*/\n
\n
\t\taccepts: {\n
\t\t\t"*": allTypes,\n
\t\t\ttext: "text/plain",\n
\t\t\thtml: "text/html",\n
\t\t\txml: "application/xml, text/xml",\n
\t\t\tjson: "application/json, text/javascript"\n
\t\t},\n
\n
\t\tcontents: {\n
\t\t\txml: /xml/,\n
\t\t\thtml: /html/,\n
\t\t\tjson: /json/\n
\t\t},\n
\n
\t\tresponseFields: {\n
\t\t\txml: "responseXML",\n
\t\t\ttext: "responseText",\n
\t\t\tjson: "responseJSON"\n
\t\t},\n
\n
\t\t// Data converters\n
\t\t// Keys separate source (or catchall "*") and destination types with a single space\n
\t\tconverters: {\n
\n
\t\t\t// Convert anything to text\n
\t\t\t"* text": String,\n
\n
\t\t\t// Text to html (true = no transformation)\n
\t\t\t"text html": true,\n
\n
\t\t\t// Evaluate text as a json expression\n
\t\t\t"text json": jQuery.parseJSON,\n
\n
\t\t\t// Parse text as xml\n
\t\t\t"text xml": jQuery.parseXML\n
\t\t},\n
\n
\t\t// For options that shouldn\'t be deep extended:\n
\t\t// you can add your own custom options here if\n
\t\t// and when you create one that shouldn\'t be\n
\t\t// deep extended (see ajaxExtend)\n
\t\tflatOptions: {\n
\t\t\turl: true,\n
\t\t\tcontext: true\n
\t\t}\n
\t},\n
\n
\t// Creates a full fledged settings object into target\n
\t// with both ajaxSettings and settings fields.\n
\t// If target is omitted, writes into ajaxSettings.\n
\tajaxSetup: function( target, settings ) {\n
\t\treturn settings ?\n
\n
\t\t\t// Building a settings object\n
\t\t\tajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :\n
\n
\t\t\t// Extending ajaxSettings\n
\t\t\tajaxExtend( jQuery.ajaxSettings, target );\n
\t},\n
\n
\tajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\n
\tajaxTransport: addToPrefiltersOrTransports( transports ),\n
\n
\t// Main method\n
\tajax: function( url, options ) {\n
\n
\t\t// If url is an object, simulate pre-1.5 signature\n
\t\tif ( typeof url === "object" ) {\n
\t\t\toptions = url;\n
\t\t\turl = undefined;\n
\t\t}\n
\n
\t\t// Force options to be an object\n
\t\toptions = options || {};\n
\n
\t\tvar transport,\n
\t\t\t// URL without anti-cache param\n
\t\t\tcacheURL,\n
\t\t\t// Response headers\n
\t\t\tresponseHeadersString,\n
\t\t\tresponseHeaders,\n
\t\t\t// timeout handle\n
\t\t\ttimeoutTimer,\n
\t\t\t// Cross-domain detection vars\n
\t\t\tparts,\n
\t\t\t// To know if global events are to be dispatched\n
\t\t\tfireGlobals,\n
\t\t\t// Loop variable\n
\t\t\ti,\n
\t\t\t// Create the final options object\n
\t\t\ts = jQuery.ajaxSetup( {}, options ),\n
\t\t\t// Callbacks context\n
\t\t\tcallbackContext = s.context || s,\n
\t\t\t// Context for global events is callbackContext if it is a DOM node or jQuery collection\n
\t\t\tglobalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?\n
\t\t\t\tjQuery( callbackContext ) :\n
\t\t\t\tjQuery.event,\n
\t\t\t// Deferreds\n
\t\t\tdeferred = jQuery.Deferred(),\n
\t\t\tcompleteDeferred = jQuery.Callbacks("once memory"),\n
\t\t\t// Status-dependent callbacks\n
\t\t\tstatusCode = s.statusCode || {},\n
\t\t\t// Headers (they are sent all at once)\n
\t\t\trequestHeaders = {},\n
\t\t\trequestHeadersNames = {},\n
\t\t\t// The jqXHR state\n
\t\t\tstate = 0,\n
\t\t\t// Default abort message\n
\t\t\tstrAbort = "canceled",\n
\t\t\t// Fake xhr\n
\t\t\tjqXHR = {\n
\t\t\t\treadyState: 0,\n
\n
\t\t\t\t// Builds headers hashtable if needed\n
\t\t\t\tgetResponseHeader: function( key ) {\n
\t\t\t\t\tvar match;\n
\t\t\t\t\tif ( state === 2 ) {\n
\t\t\t\t\t\tif ( !responseHeaders ) {\n
\t\t\t\t\t\t\tresponseHeaders = {};\n
\t\t\t\t\t\t\twhile ( (match = rheaders.exec( responseHeadersString )) ) {\n
\t\t\t\t\t\t\t\tresponseHeaders[ match[1].toLowerCase() ] = match[ 2 ];\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t\tmatch = responseHeaders[ key.toLowerCase() ];\n
\t\t\t\t\t}\n
\t\t\t\t\treturn match == null ? null : match;\n
\t\t\t\t},\n
\n
\t\t\t\t// Raw string\n
\t\t\t\tgetAllResponseHeaders: function() {\n
\t\t\t\t\treturn state === 2 ? responseHeadersString : null;\n
\t\t\t\t},\n
\n
\t\t\t\t// Caches the header\n
\t\t\t\tsetRequestHeader: function( name, value ) {\n
\t\t\t\t\tvar lname = name.toLowerCase();\n
\t\t\t\t\tif ( !state ) {\n
\t\t\t\t\t\tname = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;\n
\t\t\t\t\t\trequestHeaders[ name ] = value;\n
\t\t\t\t\t}\n
\t\t\t\t\treturn this;\n
\t\t\t\t},\n
\n
\t\t\t\t// Overrides response content-type header\n
\t\t\t\toverrideMimeType: function( type ) {\n
\t\t\t\t\tif ( !state ) {\n
\t\t\t\t\t\ts.mimeType = type;\n
\t\t\t\t\t}\n
\t\t\t\t\treturn this;\n
\t\t\t\t},\n
\n
\t\t\t\t// Status-dependent callbacks\n
\t\t\t\tstatusCode: function( map ) {\n
\t\t\t\t\tvar code;\n
\t\t\t\t\tif ( map ) {\n
\t\t\t\t\t\tif ( state < 2 ) {\n
\t\t\t\t\t\t\tfor ( code in map ) {\n
\t\t\t\t\t\t\t\t// Lazy-add the new callback in a way that preserves old ones\n
\t\t\t\t\t\t\t\tstatusCode[ code ] = [ statusCode[ code ], map[ code ] ];\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t// Execute the appropriate callbacks\n
\t\t\t\t\t\t\tjqXHR.always( map[ jqXHR.status ] );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t\treturn this;\n
\t\t\t\t},\n
\n
\t\t\t\t// Cancel the request\n
\t\t\t\tabort: function( statusText ) {\n
\t\t\t\t\tvar finalText = statusText || strAbort;\n
\t\t\t\t\tif ( transport ) {\n
\t\t\t\t\t\ttransport.abort( finalText );\n
\t\t\t\t\t}\n
\t\t\t\t\tdone( 0, finalText );\n
\t\t\t\t\treturn this;\n
\t\t\t\t}\n
\t\t\t};\n
\n
\t\t// Attach deferreds\n
\t\tdeferred.promise( jqXHR ).complete = completeDeferred.add;\n
\t\tjqXHR.success = jqXHR.done;\n
\t\tjqXHR.error = jqXHR.fail;\n
\n
\t\t// Remove hash character (#7531: and string promotion)\n
\t\t// Add protocol if not provided (prefilters might expect it)\n
\t\t// Handle falsy url in the settings object (#10093: consistency with old signature)\n
\t\t// We also use the url parameter if available\n
\t\ts.url = ( ( url || s.url || ajaxLocation ) + "" ).replace( rhash, "" )\n
\t\t\t.replace( rprotocol, ajaxLocParts[ 1 ] + "//" );\n
\n
\t\t// Alias method option to type as per ticket #12004\n
\t\ts.type = options.method || options.type || s.method || s.type;\n
\n
\t\t// Extract dataTypes list\n
\t\ts.dataTypes = jQuery.trim( s.dataType || "*" ).toLowerCase().match( core_rnotwhite ) || [""];\n
\n
\t\t// A cross-domain request is in order when we have a protocol:host:port mismatch\n
\t\tif ( s.crossDomain == null ) {\n
\t\t\tparts = rurl.exec( s.url.toLowerCase() );\n
\t\t\ts.crossDomain = !!( parts &&\n
\t\t\t\t( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||\n
\t\t\t\t\t( parts[ 3 ] || ( parts[ 1 ] === "http:" ? "80" : "443" ) ) !==\n
\t\t\t\t\t\t( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === "http:" ? "80" : "443" ) ) )\n
\t\t\t);\n
\t\t}\n
\n
\t\t// Convert data if not already a string\n
\t\tif ( s.data && s.processData && typeof s.data !== "string" ) {\n
\t\t\ts.data = jQuery.param( s.data, s.traditional );\n
\t\t}\n
\n
\t\t// Apply prefilters\n
\t\tinspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\n
\n
\t\t// If request was aborted inside a prefilter, stop there\n
\t\tif ( state === 2 ) {\n
\t\t\treturn jqXHR;\n
\t\t}\n
\n
\t\t// We can fire global events as of now if asked to\n
\t\tfireGlobals = s.global;\n
\n
\t\t// Watch for a new set of requests\n
\t\tif ( fireGlobals && jQuery.active++ === 0 ) {\n
\t\t\tjQuery.event.trigger("ajaxStart");\n
\t\t}\n
\n
\t\t// Uppercase the type\n
\t\ts.type = s.type.toUpperCase();\n
\n
\t\t// Determine if request has content\n
\t\ts.hasContent = !rnoContent.test( s.type );\n
\n
\t\t// Save the URL in case we\'re toying with the If-Modified-Since\n
\t\t// and/or If-None-Match header later on\n
\t\tcacheURL = s.url;\n
\n
\t\t// More options handling for requests with no content\n
\t\tif ( !s.hasContent ) {\n
\n
\t\t\t// If data is available, append data to url\n
\t\t\tif ( s.data ) {\n
\t\t\t\tcacheURL = ( s.url += ( ajax_rquery.test( cacheURL ) ? "&" : "?" ) + s.data );\n
\t\t\t\t// #9682: remove data so that it\'s not used in an eventual retry\n
\t\t\t\tdelete s.data;\n
\t\t\t}\n
\n
\t\t\t// Add anti-cache in url if needed\n
\t\t\tif ( s.cache === false ) {\n
\t\t\t\ts.url = rts.test( cacheURL ) ?\n
\n
\t\t\t\t\t// If there is already a \'_\' parameter, set its value\n
\t\t\t\t\tcacheURL.replace( rts, "$1_=" + ajax_nonce++ ) :\n
\n
\t\t\t\t\t// Otherwise add one to the end\n
\t\t\t\t\tcacheURL + ( ajax_rquery.test( cacheURL ) ? "&" : "?" ) + "_=" + ajax_nonce++;\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n
\t\tif ( s.ifModified ) {\n
\t\t\tif ( jQuery.lastModified[ cacheURL ] ) {\n
\t\t\t\tjqXHR.setRequestHeader( "If-Modified-Since", jQuery.lastModified[ cacheURL ] );\n
\t\t\t}\n
\t\t\tif ( jQuery.etag[ cacheURL ] ) {\n
\t\t\t\tjqXHR.setRequestHeader( "If-None-Match", jQuery.etag[ cacheURL ] );\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Set the correct header, if data is being sent\n
\t\tif ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\n
\t\t\tjqXHR.setRequestHeader( "Content-Type", s.contentType );\n
\t\t}\n
\n
\t\t// Set the Accepts header for the server, depending on the dataType\n
\t\tjqXHR.setRequestHeader(\n
\t\t\t"Accept",\n
\t\t\ts.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?\n
\t\t\t\ts.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== "*" ? ", " + allTypes + "; q=0.01" : "" ) :\n
\t\t\t\ts.accepts[ "*" ]\n
\t\t);\n
\n
\t\t// Check for headers option\n
\t\tfor ( i in s.headers ) {\n
\t\t\tjqXHR.setRequestHeader( i, s.headers[ i ] );\n
\t\t}\n
\n
\t\t// Allow custom headers/mimetypes and early abort\n
\t\tif ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {\n
\t\t\t// Abort if not done already and return\n
\t\t\treturn jqXHR.abort();\n
\t\t}\n
\n
\t\t// aborting is no longer a cancellation\n
\t\tstrAbort = "abort";\n
\n
\t\t// Install callbacks on deferreds\n
\t\tfor ( i in { success: 1, error: 1, complete: 1 } ) {\n
\t\t\tjqXHR[ i ]( s[ i ] );\n
\t\t}\n
\n
\t\t// Get transport\n
\t\ttransport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\n
\n
\t\t// If no transport, we auto-abort\n
\t\tif ( !transport ) {\n
\t\t\tdone( -1, "No Transport" );\n
\t\t} else {\n
\t\t\tjqXHR.readyState = 1;\n
\n
\t\t\t// Send global event\n
\t\t\tif ( fireGlobals ) {\n
\t\t\t\tglobalEventContext.trigger( "ajaxSend", [ jqXHR, s ] );\n
\t\t\t}\n
\t\t\t// Timeout\n
\t\t\tif ( s.async && s.timeout > 0 ) {\n
\t\t\t\ttimeoutTimer = setTimeout(function() {\n
\t\t\t\t\tjqXHR.abort("timeout");\n
\t\t\t\t}, s.timeout );\n
\t\t\t}\n
\n
\t\t\ttry {\n
\t\t\t\tstate = 1;\n
\t\t\t\ttransport.send( requestHeaders, done );\n
\t\t\t} catch ( e ) {\n
\t\t\t\t// Propagate exception as error if not done\n
\t\t\t\tif ( state < 2 ) {\n
\t\t\t\t\tdone( -1, e );\n
\t\t\t\t// Simply rethrow otherwise\n
\t\t\t\t} else {\n
\t\t\t\t\tthrow e;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\t// Callback for when everything is done\n
\t\tfunction done( status, nativeStatusText, responses, headers ) {\n
\t\t\tvar isSuccess, success, error, response, modified,\n
\t\t\t\tstatusText = nativeStatusText;\n
\n
\t\t\t// Called once\n
\t\t\tif ( state === 2 ) {\n
\t\t\t\treturn;\n
\t\t\t}\n
\n
\t\t\t// State is "done" now\n
\t\t\tstate = 2;\n
\n
\t\t\t// Clear timeout if it exists\n
\t\t\tif ( timeoutTimer ) {\n
\t\t\t\tclearTimeout( timeoutTimer );\n
\t\t\t}\n
\n
\t\t\t// Dereference transport for early garbage collection\n
\t\t\t// (no matter how long the jqXHR object will be used)\n
\t\t\ttransport = undefined;\n
\n
\t\t\t// Cache response headers\n
\t\t\tresponseHeadersString = headers || "";\n
\n
\t\t\t// Set readyState\n
\t\t\tjqXHR.readyState = status > 0 ? 4 : 0;\n
\n
\t\t\t// Determine if successful\n
\t\t\tisSuccess = status >= 200 && status < 300 || status === 304;\n
\n
\t\t\t// Get response data\n
\t\t\tif ( responses ) {\n
\t\t\t\tresponse = ajaxHandleResponses( s, jqXHR, responses );\n
\t\t\t}\n
\n
\t\t\t// Convert no matter what (that way responseXXX fields are always set)\n
\t\t\tresponse = ajaxConvert( s, response, jqXHR, isSuccess );\n
\n
\t\t\t// If successful, handle type chaining\n
\t\t\tif ( isSuccess ) {\n
\n
\t\t\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n
\t\t\t\tif ( s.ifModified ) {\n
\t\t\t\t\tmodified = jqXHR.getResponseHeader("Last-Modified");\n
\t\t\t\t\tif ( modified ) {\n
\t\t\t\t\t\tjQuery.lastModified[ cacheURL ] = modified;\n
\t\t\t\t\t}\n
\t\t\t\t\tmodified = jqXHR.getResponseHeader("etag");\n
\t\t\t\t\tif ( modified ) {\n
\t\t\t\t\t\tjQuery.etag[ cacheURL ] = modified;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t\t// if no content\n
\t\t\t\tif ( status === 204 || s.type === "HEAD" ) {\n
\t\t\t\t\tstatusText = "nocontent";\n
\n
\t\t\t\t// if not modified\n
\t\t\t\t} else if ( status === 304 ) {\n
\t\t\t\t\tstatusText = "notmodified";\n
\n
\t\t\t\t// If we have data, let\'s convert it\n
\t\t\t\t} else {\n
\t\t\t\t\tstatusText = response.state;\n
\t\t\t\t\tsuccess = response.data;\n
\t\t\t\t\terror = response.error;\n
\t\t\t\t\tisSuccess = !error;\n
\t\t\t\t}\n
\t\t\t} else {\n
\t\t\t\t// We extract error from statusText\n
\t\t\t\t// then normalize statusText and status for non-aborts\n
\t\t\t\terror = statusText;\n
\t\t\t\tif ( status || !statusText ) {\n
\t\t\t\t\tstatusText = "error";\n
\t\t\t\t\tif ( status < 0 ) {\n
\t\t\t\t\t\tstatus = 0;\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// Set data for the fake xhr object\n
\t\t\tjqXHR.status = status;\n
\t\t\tjqXHR.statusText = ( nativeStatusText || statusText ) + "";\n
\n
\t\t\t// Success/Error\n
\t\t\tif ( isSuccess ) {\n
\t\t\t\tdeferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\n
\t\t\t} else {\n
\t\t\t\tdeferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\n
\t\t\t}\n
\n
\t\t\t// Status-dependent callbacks\n
\t\t\tjqXHR.statusCode( statusCode );\n
\t\t\tstatusCode = undefined;\n
\n
\t\t\tif ( fireGlobals ) {\n
\t\t\t\tglobalEventContext.trigger( isSuccess ? "ajaxSuccess" : "ajaxError",\n
\t\t\t\t\t[ jqXHR, s, isSuccess ? success : error ] );\n
\t\t\t}\n
\n
\t\t\t// Complete\n
\t\t\tcompleteDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\n
\n
\t\t\tif ( fireGlobals ) {\n
\t\t\t\tglobalEventContext.trigger( "ajaxComplete", [ jqXHR, s ] );\n
\t\t\t\t// Handle the global AJAX counter\n
\t\t\t\tif ( !( --jQuery.active ) ) {\n
\t\t\t\t\tjQuery.event.trigger("ajaxStop");\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\n
\t\treturn jqXHR;\n
\t},\n
\n
\tgetJSON: function( url, data, callback ) {\n
\t\treturn jQuery.get( url, data, callback, "json" );\n
\t},\n
\n
\tgetScript: function( url, callback ) {\n
\t\treturn jQuery.get( url, undefined, callback, "script" );\n
\t}\n
});\n
\n
jQuery.each( [ "get", "post" ], function( i, method ) {\n
\tjQuery[ method ] = function( url, data, callback, type ) {\n
\t\t// shift arguments if data argument was omitted\n
\t\tif ( jQuery.isFunction( data ) ) {\n
\t\t\ttype = type || callback;\n
\t\t\tcallback = data;\n
\t\t\tdata = undefined;\n
\t\t}\n
\n
\t\treturn jQuery.ajax({\n
\t\t\turl: url,\n
\t\t\ttype: method,\n
\t\t\tdataType: type,\n
\t\t\tdata: data,\n
\t\t\tsuccess: callback\n
\t\t});\n
\t};\n
});\n
\n
/* Handles responses to an ajax request:\n
 * - finds the right dataType (mediates between content-type and expected dataType)\n
 * - returns the corresponding response\n
 */\n
function ajaxHandleResponses( s, jqXHR, responses ) {\n
\n
\tvar ct, type, finalDataType, firstDataType,\n
\t\tcontents = s.contents,\n
\t\tdataTypes = s.dataTypes;\n
\n
\t// Remove auto dataType and get content-type in the process\n
\twhile( dataTypes[ 0 ] === "*" ) {\n
\t\tdataTypes.shift();\n
\t\tif ( ct === undefined ) {\n
\t\t\tct = s.mimeType || jqXHR.getResponseHeader("Content-Type");\n
\t\t}\n
\t}\n
\n
\t// Check if we\'re dealing with a known content-type\n
\tif ( ct ) {\n
\t\tfor ( type in contents ) {\n
\t\t\tif ( contents[ type ] && contents[ type ].test( ct ) ) {\n
\t\t\t\tdataTypes.unshift( type );\n
\t\t\t\tbreak;\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\t// Check to see if we have a response for the expected dataType\n
\tif ( dataTypes[ 0 ] in responses ) {\n
\t\tfinalDataType = dataTypes[ 0 ];\n
\t} else {\n
\t\t// Try convertible dataTypes\n
\t\tfor ( type in responses ) {\n
\t\t\tif ( !dataTypes[ 0 ] || s.converters[ type + " " + dataTypes[0] ] ) {\n
\t\t\t\tfinalDataType = type;\n
\t\t\t\tbreak;\n
\t\t\t}\n
\t\t\tif ( !firstDataType ) {\n
\t\t\t\tfirstDataType = type;\n
\t\t\t}\n
\t\t}\n
\t\t// Or just use first one\n
\t\tfinalDataType = finalDataType || firstDataType;\n
\t}\n
\n
\t// If we found a dataType\n
\t// We add the dataType to the list if needed\n
\t// and return the corresponding response\n
\tif ( finalDataType ) {\n
\t\tif ( finalDataType !== dataTypes[ 0 ] ) {\n
\t\t\tdataTypes.unshift( finalDataType );\n
\t\t}\n
\t\treturn responses[ finalDataType ];\n
\t}\n
}\n
\n
/* Chain conversions given the request and the original response\n
 * Also sets the responseXXX fields on the jqXHR instance\n
 */\n
function ajaxConvert( s, response, jqXHR, isSuccess ) {\n
\tvar conv2, current, conv, tmp, prev,\n
\t\tconverters = {},\n
\t\t// Work with a copy of dataTypes in case we need to modify it for conversion\n
\t\tdataTypes = s.dataTypes.slice();\n
\n
\t// Create converters map with lowercased keys\n
\tif ( dataTypes[ 1 ] ) {\n
\t\tfor ( conv in s.converters ) {\n
\t\t\tconverters[ conv.toLowerCase() ] = s.converters[ conv ];\n
\t\t}\n
\t}\n
\n
\tcurrent = dataTypes.shift();\n
\n
\t// Convert to each sequential dataType\n
\twhile ( current ) {\n
\n
\t\tif ( s.responseFields[ current ] ) {\n
\t\t\tjqXHR[ s.responseFields[ current ] ] = response;\n
\t\t}\n
\n
\t\t// Apply the dataFilter if provided\n
\t\tif ( !prev && isSuccess && s.dataFilter ) {\n
\t\t\tresponse = s.dataFilter( response, s.dataType );\n
\t\t}\n
\n
\t\tprev = current;\n
\t\tcurrent = dataTypes.shift();\n
\n
\t\tif ( current ) {\n
\n
\t\t// There\'s only work to do if current dataType is non-auto\n
\t\t\tif ( current === "*" ) {\n
\n
\t\t\t\tcurrent = prev;\n
\n
\t\t\t// Convert response if prev dataType is non-auto and differs from current\n
\t\t\t} else if ( prev !== "*" && prev !== current ) {\n
\n
\t\t\t\t// Seek a direct converter\n
\t\t\t\tconv = converters[ prev + " " + current ] || converters[ "* " + current ];\n
\n
\t\t\t\t// If none found, seek a pair\n
\t\t\t\tif ( !conv ) {\n
\t\t\t\t\tfor ( conv2 in converters ) {\n
\n
\t\t\t\t\t\t// If conv2 outputs current\n
\t\t\t\t\t\ttmp = conv2.split( " " );\n
\t\t\t\t\t\tif ( tmp[ 1 ] === current ) {\n
\n
\t\t\t\t\t\t\t// If prev can be converted to accepted input\n
\t\t\t\t\t\t\tconv = converters[ prev + " " + tmp[ 0 ] ] ||\n
\t\t\t\t\t\t\t\tconverters[ "* " + tmp[ 0 ] ];\n
\t\t\t\t\t\t\tif ( conv ) {\n
\t\t\t\t\t\t\t\t// Condense equivalence converters\n
\t\t\t\t\t\t\t\tif ( conv === true ) {\n
\t\t\t\t\t\t\t\t\tconv = converters[ conv2 ];\n
\n
\t\t\t\t\t\t\t\t// Otherwise, insert the intermediate dataType\n
\t\t\t\t\t\t\t\t} else if ( converters[ conv2 ] !== true ) {\n
\t\t\t\t\t\t\t\t\tcurrent = tmp[ 0 ];\n
\t\t\t\t\t\t\t\t\tdataTypes.unshift( tmp[ 1 ] );\n
\t\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t\t\tbreak;\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\n
\t\t\t\t// Apply converter (if not an equivalence)\n
\t\t\t\tif ( conv !== true ) {\n
\n
\t\t\t\t\t// Unless errors are allowed to bubble, catch and return them\n
\t\t\t\t\tif ( conv && s[ "throws" ] ) {\n
\t\t\t\t\t\tresponse = conv( response );\n
\t\t\t\t\t} else {\n
\t\t\t\t\t\ttry {\n
\t\t\t\t\t\t\tresponse = conv( response );\n
\t\t\t\t\t\t} catch ( e ) {\n
\t\t\t\t\t\t\treturn { state: "parsererror", error: conv ? e : "No conversion from " + prev + " to " + current };\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
\n
\treturn { state: "success", data: response };\n
}\n
// Install script dataType\n
jQuery.ajaxSetup({\n
\taccepts: {\n
\t\tscript: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"\n
\t},\n
\tcontents: {\n
\t\tscript: /(?:java|ecma)script/\n
\t},\n
\tconverters: {\n
\t\t"text script": function( text ) {\n
\t\t\tjQuery.globalEval( text );\n
\t\t\treturn text;\n
\t\t}\n
\t}\n
});\n
\n
// Handle cache\'s special case and crossDomain\n
jQuery.ajaxPrefilter( "script", function( s ) {\n
\tif ( s.cache === undefined ) {\n
\t\ts.cache = false;\n
\t}\n
\tif ( s.crossDomain ) {\n
\t\ts.type = "GET";\n
\t}\n
});\n
\n
// Bind script tag hack transport\n
jQuery.ajaxTransport( "script", function( s ) {\n
\t// This transport only deals with cross domain requests\n
\tif ( s.crossDomain ) {\n
\t\tvar script, callback;\n
\t\treturn {\n
\t\t\tsend: function( _, complete ) {\n
\t\t\t\tscript = jQuery("<script>").prop({\n
\t\t\t\t\tasync: true,\n
\t\t\t\t\tcharset: s.scriptCharset,\n
\t\t\t\t\tsrc: s.url\n
\t\t\t\t}).on(\n
\t\t\t\t\t"load error",\n
\t\t\t\t\tcallback = function( evt ) {\n
\t\t\t\t\t\tscript.remove();\n
\t\t\t\t\t\tcallback = null;\n
\t\t\t\t\t\tif ( evt ) {\n
\t\t\t\t\t\t\tcomplete( evt.type === "error" ? 404 : 200, evt.type );\n
\t\t\t\t\t\t}\n
\t\t\t\t\t}\n
\t\t\t\t);\n
\t\t\t\tdocument.head.appendChild( script[ 0 ] );\n
\t\t\t},\n
\t\t\tabort: function() {\n
\t\t\t\tif ( callback ) {\n
\t\t\t\t\tcallback();\n
\t\t\t\t}\n
\t\t\t}\n
\t\t};\n
\t}\n
});\n
var oldCallbacks = [],\n
\trjsonp = /(=)\\?(?=&|$)|\\?\\?/;\n
\n
// Default jsonp settings\n
jQuery.ajaxSetup({\n
\tjsonp: "callback",\n
\tjsonpCallback: function() {\n
\t\tvar callback = oldCallbacks.pop() || ( jQuery.expando + "_" + ( ajax_nonce++ ) );\n
\t\tthis[ callback ] = true;\n
\t\treturn callback;\n
\t}\n
});\n
\n
// Detect, normalize options and install callbacks for jsonp requests\n
jQuery.ajaxPrefilter( "json jsonp", function( s, originalSettings, jqXHR ) {\n
\n
\tvar callbackName, overwritten, responseContainer,\n
\t\tjsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?\n
\t\t\t"url" :\n
\t\t\ttypeof s.data === "string" && !( s.contentType || "" ).indexOf("application/x-www-form-urlencoded") && rjsonp.test( s.data ) && "data"\n
\t\t);\n
\n
\t// Handle iff the expected data type is "jsonp" or we have a parameter to set\n
\tif ( jsonProp || s.dataTypes[ 0 ] === "jsonp" ) {\n
\n
\t\t// Get callback name, remembering preexisting value associated with it\n
\t\tcallbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?\n
\t\t\ts.jsonpCallback() :\n
\t\t\ts.jsonpCallback;\n
\n
\t\t// Insert callback into url or form data\n
\t\tif ( jsonProp ) {\n
\t\t\ts[ jsonProp ] = s[ jsonProp ].replace( rjsonp, "$1" + callbackName );\n
\t\t} else if ( s.jsonp !== false ) {\n
\t\t\ts.url += ( ajax_rquery.test( s.url ) ? "&" : "?" ) + s.jsonp + "=" + callbackName;\n
\t\t}\n
\n
\t\t// Use data converter to retrieve json after script execution\n
\t\ts.converters["script json"] = function() {\n
\t\t\tif ( !responseContainer ) {\n
\t\t\t\tjQuery.error( callbackName + " was not called" );\n
\t\t\t}\n
\t\t\treturn responseContainer[ 0 ];\n
\t\t};\n
\n
\t\t// force json dataType\n
\t\ts.dataTypes[ 0 ] = "json";\n
\n
\t\t// Install callback\n
\t\toverwritten = window[ callbackName ];\n
\t\twindow[ callbackName ] = function() {\n
\t\t\tresponseContainer = arguments;\n
\t\t};\n
\n
\t\t// Clean-up function (fires after converters)\n
\t\tjqXHR.always(function() {\n
\t\t\t// Restore preexisting value\n
\t\t\twindow[ callbackName ] = overwritten;\n
\n
\t\t\t// Save back as free\n
\t\t\tif ( s[ callbackName ] ) {\n
\t\t\t\t// make sure that re-using the options doesn\'t screw things around\n
\t\t\t\ts.jsonpCallback = originalSettings.jsonpCallback;\n
\n
\t\t\t\t// save the callback name for future use\n
\t\t\t\toldCallbacks.push( callbackName );\n
\t\t\t}\n
\n
\t\t\t// Call if it was a function and we have a response\n
\t\t\tif ( responseContainer && jQuery.isFunction( overwritten ) ) {\n
\t\t\t\toverwritten( responseContainer[ 0 ] );\n
\t\t\t}\n
\n
\t\t\tresponseContainer = overwritten = undefined;\n
\t\t});\n
\n
\t\t// Delegate to script\n
\t\treturn "script";\n
\t}\n
});\n
jQuery.ajaxSettings.xhr = function() {\n
\ttry {\n
\t\treturn new XMLHttpRequest();\n
\t} catch( e ) {}\n
};\n
\n
var xhrSupported = jQuery.ajaxSettings.xhr(),\n
\txhrSuccessStatus = {\n
\t\t// file protocol always yields status code 0, assume 200\n
\t\t0: 200,\n
\t\t// Support: IE9\n
\t\t// #1450: sometimes IE returns 1223 when it should be 204\n
\t\t1223: 204\n
\t},\n
\t// Support: IE9\n
\t// We need to keep track of outbound xhr and abort them manually\n
\t// because IE is not smart enough to do it all by itself\n
\txhrId = 0,\n
\txhrCallbacks = {};\n
\n
if ( window.ActiveXObject ) {\n
\tjQuery( window ).on( "unload", function() {\n
\t\tfor( var key in xhrCallbacks ) {\n
\t\t\txhrCallbacks[ key ]();\n
\t\t}\n
\t\txhrCallbacks = undefined;\n
\t});\n
}\n
\n
jQuery.support.cors = !!xhrSupported && ( "withCredentials" in xhrSupported );\n
jQuery.support.ajax = xhrSupported = !!xhrSupported;\n
\n
jQuery.ajaxTransport(function( options ) {\n
\tvar callback;\n
\t// Cross domain only allowed if supported through XMLHttpRequest\n
\tif ( jQuery.support.cors || xhrSupported && !options.crossDomain ) {\n
\t\treturn {\n
\t\t\tsend: function( headers, complete ) {\n
\t\t\t\tvar i, id,\n
\t\t\t\t\txhr = options.xhr();\n
\t\t\t\txhr.open( options.type, options.url, options.async, options.username, options.password );\n
\t\t\t\t// Apply custom fields if provided\n
\t\t\t\tif ( options.xhrFields ) {\n
\t\t\t\t\tfor ( i in options.xhrFields ) {\n
\t\t\t\t\t\txhr[ i ] = options.xhrFields[ i ];\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t\t// Override mime type if needed\n
\t\t\t\tif ( options.mimeType && xhr.overrideMimeType ) {\n
\t\t\t\t\txhr.overrideMimeType( options.mimeType );\n
\t\t\t\t}\n
\t\t\t\t// X-Requested-With header\n
\t\t\t\t// For cross-domain requests, seeing as conditions for a preflight are\n
\t\t\t\t// akin to a jigsaw puzzle, we simply never set it to be sure.\n
\t\t\t\t// (it can always be set on a per-request basis or even using ajaxSetup)\n
\t\t\t\t// 

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAU=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="5" aka="AAAAAAAAAAU=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

For same-domain requests, won\'t change header if already provided.\n
\t\t\t\tif ( !options.crossDomain && !headers["X-Requested-With"] ) {\n
\t\t\t\t\theaders["X-Requested-With"] = "XMLHttpRequest";\n
\t\t\t\t}\n
\t\t\t\t// Set headers\n
\t\t\t\tfor ( i in headers ) {\n
\t\t\t\t\txhr.setRequestHeader( i, headers[ i ] );\n
\t\t\t\t}\n
\t\t\t\t// Callback\n
\t\t\t\tcallback = function( type ) {\n
\t\t\t\t\treturn function() {\n
\t\t\t\t\t\tif ( callback ) {\n
\t\t\t\t\t\t\tdelete xhrCallbacks[ id ];\n
\t\t\t\t\t\t\tcallback = xhr.onload = xhr.onerror = null;\n
\t\t\t\t\t\t\tif ( type === "abort" ) {\n
\t\t\t\t\t\t\t\txhr.abort();\n
\t\t\t\t\t\t\t} else if ( type === "error" ) {\n
\t\t\t\t\t\t\t\tcomplete(\n
\t\t\t\t\t\t\t\t\t// file protocol always yields status 0, assume 404\n
\t\t\t\t\t\t\t\t\txhr.status || 404,\n
\t\t\t\t\t\t\t\t\txhr.statusText\n
\t\t\t\t\t\t\t\t);\n
\t\t\t\t\t\t\t} else {\n
\t\t\t\t\t\t\t\tcomplete(\n
\t\t\t\t\t\t\t\t\txhrSuccessStatus[ xhr.status ] || xhr.status,\n
\t\t\t\t\t\t\t\t\txhr.statusText,\n
\t\t\t\t\t\t\t\t\t// Support: IE9\n
\t\t\t\t\t\t\t\t\t// #11426: When requesting binary data, IE9 will throw an exception\n
\t\t\t\t\t\t\t\t\t// on any attempt to access responseText\n
\t\t\t\t\t\t\t\t\ttypeof xhr.responseText === "string" ? {\n
\t\t\t\t\t\t\t\t\t\ttext: xhr.responseText\n
\t\t\t\t\t\t\t\t\t} : undefined,\n
\t\t\t\t\t\t\t\t\txhr.getAllResponseHeaders()\n
\t\t\t\t\t\t\t\t);\n
\t\t\t\t\t\t\t}\n
\t\t\t\t\t\t}\n
\t\t\t\t\t};\n
\t\t\t\t};\n
\t\t\t\t// Listen to events\n
\t\t\t\txhr.onload = callback();\n
\t\t\t\txhr.onerror = callback("error");\n
\t\t\t\t// Create the abort callback\n
\t\t\t\tcallback = xhrCallbacks[( id = xhrId++ )] = callback("abort");\n
\t\t\t\t// Do send the request\n
\t\t\t\t// This may raise an exception which is actually\n
\t\t\t\t// handled in jQuery.ajax (so no try/catch here)\n
\t\t\t\txhr.send( options.hasContent && options.data || null );\n
\t\t\t},\n
\t\t\tabort: function() {\n
\t\t\t\tif ( callback ) {\n
\t\t\t\t\tcallback();\n
\t\t\t\t}\n
\t\t\t}\n
\t\t};\n
\t}\n
});\n
var fxNow, timerId,\n
\trfxtypes = /^(?:toggle|show|hide)$/,\n
\trfxnum = new RegExp( "^(?:([+-])=|)(" + core_pnum + ")([a-z%]*)$", "i" ),\n
\trrun = /queueHooks$/,\n
\tanimationPrefilters = [ defaultPrefilter ],\n
\ttweeners = {\n
\t\t"*": [function( prop, value ) {\n
\t\t\tvar tween = this.createTween( prop, value ),\n
\t\t\t\ttarget = tween.cur(),\n
\t\t\t\tparts = rfxnum.exec( value ),\n
\t\t\t\tunit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? "" : "px" ),\n
\n
\t\t\t\t// Starting value computation is required for potential unit mismatches\n
\t\t\t\tstart = ( jQuery.cssNumber[ prop ] || unit !== "px" && +target ) &&\n
\t\t\t\t\trfxnum.exec( jQuery.css( tween.elem, prop ) ),\n
\t\t\t\tscale = 1,\n
\t\t\t\tmaxIterations = 20;\n
\n
\t\t\tif ( start && start[ 3 ] !== unit ) {\n
\t\t\t\t// Trust units reported by jQuery.css\n
\t\t\t\tunit = unit || start[ 3 ];\n
\n
\t\t\t\t// Make sure we update the tween properties later on\n
\t\t\t\tparts = parts || [];\n
\n
\t\t\t\t// Iteratively approximate from a nonzero starting point\n
\t\t\t\tstart = +target || 1;\n
\n
\t\t\t\tdo {\n
\t\t\t\t\t// If previous iteration zeroed out, double until we get *something*\n
\t\t\t\t\t// Use a string for doubling factor so we don\'t accidentally see scale as unchanged below\n
\t\t\t\t\tscale = scale || ".5";\n
\n
\t\t\t\t\t// Adjust and apply\n
\t\t\t\t\tstart = start / scale;\n
\t\t\t\t\tjQuery.style( tween.elem, prop, start + unit );\n
\n
\t\t\t\t// Update scale, tolerating zero or NaN from tween.cur()\n
\t\t\t\t// And breaking the loop if scale is unchanged or perfect, or if we\'ve just had enough\n
\t\t\t\t} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );\n
\t\t\t}\n
\n
\t\t\t// Update tween properties\n
\t\t\tif ( parts ) {\n
\t\t\t\tstart = tween.start = +start || +target || 0;\n
\t\t\t\ttween.unit = unit;\n
\t\t\t\t// If a +=/-= token was provided, we\'re doing a relative animation\n
\t\t\t\ttween.end = parts[ 1 ] ?\n
\t\t\t\t\tstart + ( parts[ 1 ] + 1 ) * parts[ 2 ] :\n
\t\t\t\t\t+parts[ 2 ];\n
\t\t\t}\n
\n
\t\t\treturn tween;\n
\t\t}]\n
\t};\n
\n
// Animations created synchronously will run synchronously\n
function createFxNow() {\n
\tsetTimeout(function() {\n
\t\tfxNow = undefined;\n
\t});\n
\treturn ( fxNow = jQuery.now() );\n
}\n
\n
function createTween( value, prop, animation ) {\n
\tvar tween,\n
\t\tcollection = ( tweeners[ prop ] || [] ).concat( tweeners[ "*" ] ),\n
\t\tindex = 0,\n
\t\tlength = collection.length;\n
\tfor ( ; index < length; index++ ) {\n
\t\tif ( (tween = collection[ index ].call( animation, prop, value )) ) {\n
\n
\t\t\t// we\'re done with this property\n
\t\t\treturn tween;\n
\t\t}\n
\t}\n
}\n
\n
function Animation( elem, properties, options ) {\n
\tvar result,\n
\t\tstopped,\n
\t\tindex = 0,\n
\t\tlength = animationPrefilters.length,\n
\t\tdeferred = jQuery.Deferred().always( function() {\n
\t\t\t// don\'t match elem in the :animated selector\n
\t\t\tdelete tick.elem;\n
\t\t}),\n
\t\ttick = function() {\n
\t\t\tif ( stopped ) {\n
\t\t\t\treturn false;\n
\t\t\t}\n
\t\t\tvar currentTime = fxNow || createFxNow(),\n
\t\t\t\tremaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),\n
\t\t\t\t// archaic crash bug won\'t allow us to use 1 - ( 0.5 || 0 ) (#12497)\n
\t\t\t\ttemp = remaining / animation.duration || 0,\n
\t\t\t\tpercent = 1 - temp,\n
\t\t\t\tindex = 0,\n
\t\t\t\tlength = animation.tweens.length;\n
\n
\t\t\tfor ( ; index < length ; index++ ) {\n
\t\t\t\tanimation.tweens[ index ].run( percent );\n
\t\t\t}\n
\n
\t\t\tdeferred.notifyWith( elem, [ animation, percent, remaining ]);\n
\n
\t\t\tif ( percent < 1 && length ) {\n
\t\t\t\treturn remaining;\n
\t\t\t} else {\n
\t\t\t\tdeferred.resolveWith( elem, [ animation ] );\n
\t\t\t\treturn false;\n
\t\t\t}\n
\t\t},\n
\t\tanimation = deferred.promise({\n
\t\t\telem: elem,\n
\t\t\tprops: jQuery.extend( {}, properties ),\n
\t\t\topts: jQuery.extend( true, { specialEasing: {} }, options ),\n
\t\t\toriginalProperties: properties,\n
\t\t\toriginalOptions: options,\n
\t\t\tstartTime: fxNow || createFxNow(),\n
\t\t\tduration: options.duration,\n
\t\t\ttweens: [],\n
\t\t\tcreateTween: function( prop, end ) {\n
\t\t\t\tvar tween = jQuery.Tween( elem, animation.opts, prop, end,\n
\t\t\t\t\t\tanimation.opts.specialEasing[ prop ] || animation.opts.easing );\n
\t\t\t\tanimation.tweens.push( tween );\n
\t\t\t\treturn tween;\n
\t\t\t},\n
\t\t\tstop: function( gotoEnd ) {\n
\t\t\t\tvar index = 0,\n
\t\t\t\t\t// if we are going to the end, we want to run all the tweens\n
\t\t\t\t\t// otherwise we skip this part\n
\t\t\t\t\tlength = gotoEnd ? animation.tweens.length : 0;\n
\t\t\t\tif ( stopped ) {\n
\t\t\t\t\treturn this;\n
\t\t\t\t}\n
\t\t\t\tstopped = true;\n
\t\t\t\tfor ( ; index < length ; index++ ) {\n
\t\t\t\t\tanimation.tweens[ index ].run( 1 );\n
\t\t\t\t}\n
\n
\t\t\t\t// resolve when we played the last frame\n
\t\t\t\t// otherwise, reject\n
\t\t\t\tif ( gotoEnd ) {\n
\t\t\t\t\tdeferred.resolveWith( elem, [ animation, gotoEnd ] );\n
\t\t\t\t} else {\n
\t\t\t\t\tdeferred.rejectWith( elem, [ animation, gotoEnd ] );\n
\t\t\t\t}\n
\t\t\t\treturn this;\n
\t\t\t}\n
\t\t}),\n
\t\tprops = animation.props;\n
\n
\tpropFilter( props, animation.opts.specialEasing );\n
\n
\tfor ( ; index < length ; index++ ) {\n
\t\tresult = animationPrefilters[ index ].call( animation, elem, props, animation.opts );\n
\t\tif ( result ) {\n
\t\t\treturn result;\n
\t\t}\n
\t}\n
\n
\tjQuery.map( props, createTween, animation );\n
\n
\tif ( jQuery.isFunction( animation.opts.start ) ) {\n
\t\tanimation.opts.start.call( elem, animation );\n
\t}\n
\n
\tjQuery.fx.timer(\n
\t\tjQuery.extend( tick, {\n
\t\t\telem: elem,\n
\t\t\tanim: animation,\n
\t\t\tqueue: animation.opts.queue\n
\t\t})\n
\t);\n
\n
\t// attach callbacks from options\n
\treturn animation.progress( animation.opts.progress )\n
\t\t.done( animation.opts.done, animation.opts.complete )\n
\t\t.fail( animation.opts.fail )\n
\t\t.always( animation.opts.always );\n
}\n
\n
function propFilter( props, specialEasing ) {\n
\tvar index, name, easing, value, hooks;\n
\n
\t// camelCase, specialEasing and expand cssHook pass\n
\tfor ( index in props ) {\n
\t\tname = jQuery.camelCase( index );\n
\t\teasing = specialEasing[ name ];\n
\t\tvalue = props[ index ];\n
\t\tif ( jQuery.isArray( value ) ) {\n
\t\t\teasing = value[ 1 ];\n
\t\t\tvalue = props[ index ] = value[ 0 ];\n
\t\t}\n
\n
\t\tif ( index !== name ) {\n
\t\t\tprops[ name ] = value;\n
\t\t\tdelete props[ index ];\n
\t\t}\n
\n
\t\thooks = jQuery.cssHooks[ name ];\n
\t\tif ( hooks && "expand" in hooks ) {\n
\t\t\tvalue = hooks.expand( value );\n
\t\t\tdelete props[ name ];\n
\n
\t\t\t// not quite $.extend, this wont overwrite keys already present.\n
\t\t\t// also - reusing \'index\' from above because we have the correct "name"\n
\t\t\tfor ( index in value ) {\n
\t\t\t\tif ( !( index in props ) ) {\n
\t\t\t\t\tprops[ index ] = value[ index ];\n
\t\t\t\t\tspecialEasing[ index ] = easing;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t} else {\n
\t\t\tspecialEasing[ name ] = easing;\n
\t\t}\n
\t}\n
}\n
\n
jQuery.Animation = jQuery.extend( Animation, {\n
\n
\ttweener: function( props, callback ) {\n
\t\tif ( jQuery.isFunction( props ) ) {\n
\t\t\tcallback = props;\n
\t\t\tprops = [ "*" ];\n
\t\t} else {\n
\t\t\tprops = props.split(" ");\n
\t\t}\n
\n
\t\tvar prop,\n
\t\t\tindex = 0,\n
\t\t\tlength = props.length;\n
\n
\t\tfor ( ; index < length ; index++ ) {\n
\t\t\tprop = props[ index ];\n
\t\t\ttweeners[ prop ] = tweeners[ prop ] || [];\n
\t\t\ttweeners[ prop ].unshift( callback );\n
\t\t}\n
\t},\n
\n
\tprefilter: function( callback, prepend ) {\n
\t\tif ( prepend ) {\n
\t\t\tanimationPrefilters.unshift( callback );\n
\t\t} else {\n
\t\t\tanimationPrefilters.push( callback );\n
\t\t}\n
\t}\n
});\n
\n
function defaultPrefilter( elem, props, opts ) {\n
\t/* jshint validthis: true */\n
\tvar prop, value, toggle, tween, hooks, oldfire,\n
\t\tanim = this,\n
\t\torig = {},\n
\t\tstyle = elem.style,\n
\t\thidden = elem.nodeType && isHidden( elem ),\n
\t\tdataShow = data_priv.get( elem, "fxshow" );\n
\n
\t// handle queue: false promises\n
\tif ( !opts.queue ) {\n
\t\thooks = jQuery._queueHooks( elem, "fx" );\n
\t\tif ( hooks.unqueued == null ) {\n
\t\t\thooks.unqueued = 0;\n
\t\t\toldfire = hooks.empty.fire;\n
\t\t\thooks.empty.fire = function() {\n
\t\t\t\tif ( !hooks.unqueued ) {\n
\t\t\t\t\toldfire();\n
\t\t\t\t}\n
\t\t\t};\n
\t\t}\n
\t\thooks.unqueued++;\n
\n
\t\tanim.always(function() {\n
\t\t\t// doing this makes sure that the complete handler will be called\n
\t\t\t// before this completes\n
\t\t\tanim.always(function() {\n
\t\t\t\thooks.unqueued--;\n
\t\t\t\tif ( !jQuery.queue( elem, "fx" ).length ) {\n
\t\t\t\t\thooks.empty.fire();\n
\t\t\t\t}\n
\t\t\t});\n
\t\t});\n
\t}\n
\n
\t// height/width overflow pass\n
\tif ( elem.nodeType === 1 && ( "height" in props || "width" in props ) ) {\n
\t\t// Make sure that nothing sneaks out\n
\t\t// Record all 3 overflow attributes because IE9-10 do not\n
\t\t// change the overflow attribute when overflowX and\n
\t\t// overflowY are set to the same value\n
\t\topts.overflow = [ style.overflow, style.overflowX, style.overflowY ];\n
\n
\t\t// Set display property to inline-block for height/width\n
\t\t// animations on inline elements that are having width/height animated\n
\t\tif ( jQuery.css( elem, "display" ) === "inline" &&\n
\t\t\t\tjQuery.css( elem, "float" ) === "none" ) {\n
\n
\t\t\tstyle.display = "inline-block";\n
\t\t}\n
\t}\n
\n
\tif ( opts.overflow ) {\n
\t\tstyle.overflow = "hidden";\n
\t\tanim.always(function() {\n
\t\t\tstyle.overflow = opts.overflow[ 0 ];\n
\t\t\tstyle.overflowX = opts.overflow[ 1 ];\n
\t\t\tstyle.overflowY = opts.overflow[ 2 ];\n
\t\t});\n
\t}\n
\n
\n
\t// show/hide pass\n
\tfor ( prop in props ) {\n
\t\tvalue = props[ prop ];\n
\t\tif ( rfxtypes.exec( value ) ) {\n
\t\t\tdelete props[ prop ];\n
\t\t\ttoggle = toggle || value === "toggle";\n
\t\t\tif ( value === ( hidden ? "hide" : "show" ) ) {\n
\n
\t\t\t\t// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden\n
\t\t\t\tif ( value === "show" && dataShow && dataShow[ prop ] !== undefined ) {\n
\t\t\t\t\thidden = true;\n
\t\t\t\t} else {\n
\t\t\t\t\tcontinue;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t\torig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );\n
\t\t}\n
\t}\n
\n
\tif ( !jQuery.isEmptyObject( orig ) ) {\n
\t\tif ( dataShow ) {\n
\t\t\tif ( "hidden" in dataShow ) {\n
\t\t\t\thidden = dataShow.hidden;\n
\t\t\t}\n
\t\t} else {\n
\t\t\tdataShow = data_priv.access( elem, "fxshow", {} );\n
\t\t}\n
\n
\t\t// store state if its toggle - enables .stop().toggle() to "reverse"\n
\t\tif ( toggle ) {\n
\t\t\tdataShow.hidden = !hidden;\n
\t\t}\n
\t\tif ( hidden ) {\n
\t\t\tjQuery( elem ).show();\n
\t\t} else {\n
\t\t\tanim.done(function() {\n
\t\t\t\tjQuery( elem ).hide();\n
\t\t\t});\n
\t\t}\n
\t\tanim.done(function() {\n
\t\t\tvar prop;\n
\n
\t\t\tdata_priv.remove( elem, "fxshow" );\n
\t\t\tfor ( prop in orig ) {\n
\t\t\t\tjQuery.style( elem, prop, orig[ prop ] );\n
\t\t\t}\n
\t\t});\n
\t\tfor ( prop in orig ) {\n
\t\t\ttween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );\n
\n
\t\t\tif ( !( prop in dataShow ) ) {\n
\t\t\t\tdataShow[ prop ] = tween.start;\n
\t\t\t\tif ( hidden ) {\n
\t\t\t\t\ttween.end = tween.start;\n
\t\t\t\t\ttween.start = prop === "width" || prop === "height" ? 1 : 0;\n
\t\t\t\t}\n
\t\t\t}\n
\t\t}\n
\t}\n
}\n
\n
function Tween( elem, options, prop, end, easing ) {\n
\treturn new Tween.prototype.init( elem, options, prop, end, easing );\n
}\n
jQuery.Tween = Tween;\n
\n
Tween.prototype = {\n
\tconstructor: Tween,\n
\tinit: function( elem, options, prop, end, easing, unit ) {\n
\t\tthis.elem = elem;\n
\t\tthis.prop = prop;\n
\t\tthis.easing = easing || "swing";\n
\t\tthis.options = options;\n
\t\tthis.start = this.now = this.cur();\n
\t\tthis.end = end;\n
\t\tthis.unit = unit || ( jQuery.cssNumber[ prop ] ? "" : "px" );\n
\t},\n
\tcur: function() {\n
\t\tvar hooks = Tween.propHooks[ this.prop ];\n
\n
\t\treturn hooks && hooks.get ?\n
\t\t\thooks.get( this ) :\n
\t\t\tTween.propHooks._default.get( this );\n
\t},\n
\trun: function( percent ) {\n
\t\tvar eased,\n
\t\t\thooks = Tween.propHooks[ this.prop ];\n
\n
\t\tif ( this.options.duration ) {\n
\t\t\tthis.pos = eased = jQuery.easing[ this.easing ](\n
\t\t\t\tpercent, this.options.duration * percent, 0, 1, this.options.duration\n
\t\t\t);\n
\t\t} else {\n
\t\t\tthis.pos = eased = percent;\n
\t\t}\n
\t\tthis.now = ( this.end - this.start ) * eased + this.start;\n
\n
\t\tif ( this.options.step ) {\n
\t\t\tthis.options.step.call( this.elem, this.now, this );\n
\t\t}\n
\n
\t\tif ( hooks && hooks.set ) {\n
\t\t\thooks.set( this );\n
\t\t} else {\n
\t\t\tTween.propHooks._default.set( this );\n
\t\t}\n
\t\treturn this;\n
\t}\n
};\n
\n
Tween.prototype.init.prototype = Tween.prototype;\n
\n
Tween.propHooks = {\n
\t_default: {\n
\t\tget: function( tween ) {\n
\t\t\tvar result;\n
\n
\t\t\tif ( tween.elem[ tween.prop ] != null &&\n
\t\t\t\t(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {\n
\t\t\t\treturn tween.elem[ tween.prop ];\n
\t\t\t}\n
\n
\t\t\t// passing an empty string as a 3rd parameter to .css will automatically\n
\t\t\t// attempt a parseFloat and fallback to a string if the parse fails\n
\t\t\t// so, simple values such as "10px" are parsed to Float.\n
\t\t\t// complex values such as "rotate(1rad)" are returned as is.\n
\t\t\tresult = jQuery.css( tween.elem, tween.prop, "" );\n
\t\t\t// Empty strings, null, undefined and "auto" are converted to 0.\n
\t\t\treturn !result || result === "auto" ? 0 : result;\n
\t\t},\n
\t\tset: function( tween ) {\n
\t\t\t// use step hook for back compat - use cssHook if its there - use .style if its\n
\t\t\t// available and use plain properties where available\n
\t\t\tif ( jQuery.fx.step[ tween.prop ] ) {\n
\t\t\t\tjQuery.fx.step[ tween.prop ]( tween );\n
\t\t\t} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {\n
\t\t\t\tjQuery.style( tween.elem, tween.prop, tween.now + tween.unit );\n
\t\t\t} else {\n
\t\t\t\ttween.elem[ tween.prop ] = tween.now;\n
\t\t\t}\n
\t\t}\n
\t}\n
};\n
\n
// Support: IE9\n
// Panic based approach to setting things on disconnected nodes\n
\n
Tween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {\n
\tset: function( tween ) {\n
\t\tif ( tween.elem.nodeType && tween.elem.parentNode ) {\n
\t\t\ttween.elem[ tween.prop ] = tween.now;\n
\t\t}\n
\t}\n
};\n
\n
jQuery.each([ "toggle", "show", "hide" ], function( i, name ) {\n
\tvar cssFn = jQuery.fn[ name ];\n
\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n
\t\treturn speed == null || typeof speed === "boolean" ?\n
\t\t\tcssFn.apply( this, arguments ) :\n
\t\t\tthis.animate( genFx( name, true ), speed, easing, callback );\n
\t};\n
});\n
\n
jQuery.fn.extend({\n
\tfadeTo: function( speed, to, easing, callback ) {\n
\n
\t\t// show any hidden elements after setting opacity to 0\n
\t\treturn this.filter( isHidden ).css( "opacity", 0 ).show()\n
\n
\t\t\t// animate to the value specified\n
\t\t\t.end().animate({ opacity: to }, speed, easing, callback );\n
\t},\n
\tanimate: function( prop, speed, easing, callback ) {\n
\t\tvar empty = jQuery.isEmptyObject( prop ),\n
\t\t\toptall = jQuery.speed( speed, easing, callback ),\n
\t\t\tdoAnimation = function() {\n
\t\t\t\t// Operate on a copy of prop so per-property easing won\'t be lost\n
\t\t\t\tvar anim = Animation( this, jQuery.extend( {}, prop ), optall );\n
\n
\t\t\t\t// Empty animations, or finishing resolves immediately\n
\t\t\t\tif ( empty || data_priv.get( this, "finish" ) ) {\n
\t\t\t\t\tanim.stop( true );\n
\t\t\t\t}\n
\t\t\t};\n
\t\t\tdoAnimation.finish = doAnimation;\n
\n
\t\treturn empty || optall.queue === false ?\n
\t\t\tthis.each( doAnimation ) :\n
\t\t\tthis.queue( optall.queue, doAnimation );\n
\t},\n
\tstop: function( type, clearQueue, gotoEnd ) {\n
\t\tvar stopQueue = function( hooks ) {\n
\t\t\tvar stop = hooks.stop;\n
\t\t\tdelete hooks.stop;\n
\t\t\tstop( gotoEnd );\n
\t\t};\n
\n
\t\tif ( typeof type !== "string" ) {\n
\t\t\tgotoEnd = clearQueue;\n
\t\t\tclearQueue = type;\n
\t\t\ttype = undefined;\n
\t\t}\n
\t\tif ( clearQueue && type !== false ) {\n
\t\t\tthis.queue( type || "fx", [] );\n
\t\t}\n
\n
\t\treturn this.each(function() {\n
\t\t\tvar dequeue = true,\n
\t\t\t\tindex = type != null && type + "queueHooks",\n
\t\t\t\ttimers = jQuery.timers,\n
\t\t\t\tdata = data_priv.get( this );\n
\n
\t\t\tif ( index ) {\n
\t\t\t\tif ( data[ index ] && data[ index ].stop ) {\n
\t\t\t\t\tstopQueue( data[ index ] );\n
\t\t\t\t}\n
\t\t\t} else {\n
\t\t\t\tfor ( index in data ) {\n
\t\t\t\t\tif ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {\n
\t\t\t\t\t\tstopQueue( data[ index ] );\n
\t\t\t\t\t}\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\tfor ( index = timers.length; index--; ) {\n
\t\t\t\tif ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {\n
\t\t\t\t\ttimers[ index ].anim.stop( gotoEnd );\n
\t\t\t\t\tdequeue = false;\n
\t\t\t\t\ttimers.splice( index, 1 );\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// start the next in the queue if the last step wasn\'t forced\n
\t\t\t// timers currently will call their complete callbacks, which will dequeue\n
\t\t\t// but only if they were gotoEnd\n
\t\t\tif ( dequeue || !gotoEnd ) {\n
\t\t\t\tjQuery.dequeue( this, type );\n
\t\t\t}\n
\t\t});\n
\t},\n
\tfinish: function( type ) {\n
\t\tif ( type !== false ) {\n
\t\t\ttype = type || "fx";\n
\t\t}\n
\t\treturn this.each(function() {\n
\t\t\tvar index,\n
\t\t\t\tdata = data_priv.get( this ),\n
\t\t\t\tqueue = data[ type + "queue" ],\n
\t\t\t\thooks = data[ type + "queueHooks" ],\n
\t\t\t\ttimers = jQuery.timers,\n
\t\t\t\tlength = queue ? queue.length : 0;\n
\n
\t\t\t// enable finishing flag on private data\n
\t\t\tdata.finish = true;\n
\n
\t\t\t// empty the queue first\n
\t\t\tjQuery.queue( this, type, [] );\n
\n
\t\t\tif ( hooks && hooks.stop ) {\n
\t\t\t\thooks.stop.call( this, true );\n
\t\t\t}\n
\n
\t\t\t// look for any active animations, and finish them\n
\t\t\tfor ( index = timers.length; index--; ) {\n
\t\t\t\tif ( timers[ index ].elem === this && timers[ index ].queue === type ) {\n
\t\t\t\t\ttimers[ index ].anim.stop( true );\n
\t\t\t\t\ttimers.splice( index, 1 );\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// look for any animations in the old queue and finish them\n
\t\t\tfor ( index = 0; index < length; index++ ) {\n
\t\t\t\tif ( queue[ index ] && queue[ index ].finish ) {\n
\t\t\t\t\tqueue[ index ].finish.call( this );\n
\t\t\t\t}\n
\t\t\t}\n
\n
\t\t\t// turn off finishing flag\n
\t\t\tdelete data.finish;\n
\t\t});\n
\t}\n
});\n
\n
// Generate parameters to create a standard animation\n
function genFx( type, includeWidth ) {\n
\tvar which,\n
\t\tattrs = { height: type },\n
\t\ti = 0;\n
\n
\t// if we include width, step value is 1 to do all cssExpand values,\n
\t// if we don\'t include width, step value is 2 to skip over Left and Right\n
\tincludeWidth = includeWidth? 1 : 0;\n
\tfor( ; i < 4 ; i += 2 - includeWidth ) {\n
\t\twhich = cssExpand[ i ];\n
\t\tattrs[ "margin" + which ] = attrs[ "padding" + which ] = type;\n
\t}\n
\n
\tif ( includeWidth ) {\n
\t\tattrs.opacity = attrs.width = type;\n
\t}\n
\n
\treturn attrs;\n
}\n
\n
// Generate shortcuts for custom animations\n
jQuery.each({\n
\tslideDown: genFx("show"),\n
\tslideUp: genFx("hide"),\n
\tslideToggle: genFx("toggle"),\n
\tfadeIn: { opacity: "show" },\n
\tfadeOut: { opacity: "hide" },\n
\tfadeToggle: { opacity: "toggle" }\n
}, function( name, props ) {\n
\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n
\t\treturn this.animate( props, speed, easing, callback );\n
\t};\n
});\n
\n
jQuery.speed = function( speed, easing, fn ) {\n
\tvar opt = speed && typeof speed === "object" ? jQuery.extend( {}, speed ) : {\n
\t\tcomplete: fn || !fn && easing ||\n
\t\t\tjQuery.isFunction( speed ) && speed,\n
\t\tduration: speed,\n
\t\teasing: fn && easing || easing && !jQuery.isFunction( easing ) && easing\n
\t};\n
\n
\topt.duration = jQuery.fx.off ? 0 : typeof opt.duration === "number" ? opt.duration :\n
\t\topt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;\n
\n
\t// normalize opt.queue - true/undefined/null -> "fx"\n
\tif ( opt.queue == null || opt.queue === true ) {\n
\t\topt.queue = "fx";\n
\t}\n
\n
\t// Queueing\n
\topt.old = opt.complete;\n
\n
\topt.complete = function() {\n
\t\tif ( jQuery.isFunction( opt.old ) ) {\n
\t\t\topt.old.call( this );\n
\t\t}\n
\n
\t\tif ( opt.queue ) {\n
\t\t\tjQuery.dequeue( this, opt.queue );\n
\t\t}\n
\t};\n
\n
\treturn opt;\n
};\n
\n
jQuery.easing = {\n
\tlinear: function( p ) {\n
\t\treturn p;\n
\t},\n
\tswing: function( p ) {\n
\t\treturn 0.5 - Math.cos( p*Math.PI ) / 2;\n
\t}\n
};\n
\n
jQuery.timers = [];\n
jQuery.fx = Tween.prototype.init;\n
jQuery.fx.tick = function() {\n
\tvar timer,\n
\t\ttimers = jQuery.timers,\n
\t\ti = 0;\n
\n
\tfxNow = jQuery.now();\n
\n
\tfor ( ; i < timers.length; i++ ) {\n
\t\ttimer = timers[ i ];\n
\t\t// Checks the timer has not already been removed\n
\t\tif ( !timer() && timers[ i ] === timer ) {\n
\t\t\ttimers.splice( i--, 1 );\n
\t\t}\n
\t}\n
\n
\tif ( !timers.length ) {\n
\t\tjQuery.fx.stop();\n
\t}\n
\tfxNow = undefined;\n
};\n
\n
jQuery.fx.timer = function( timer ) {\n
\tif ( timer() && jQuery.timers.push( timer ) ) {\n
\t\tjQuery.fx.start();\n
\t}\n
};\n
\n
jQuery.fx.interval = 13;\n
\n
jQuery.fx.start = function() {\n
\tif ( !timerId ) {\n
\t\ttimerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );\n
\t}\n
};\n
\n
jQuery.fx.stop = function() {\n
\tclearInterval( timerId );\n
\ttimerId = null;\n
};\n
\n
jQuery.fx.speeds = {\n
\tslow: 600,\n
\tfast: 200,\n
\t// Default speed\n
\t_default: 400\n
};\n
\n
// Back Compat <1.8 extension point\n
jQuery.fx.step = {};\n
\n
if ( jQuery.expr && jQuery.expr.filters ) {\n
\tjQuery.expr.filters.animated = function( elem ) {\n
\t\treturn jQuery.grep(jQuery.timers, function( fn ) {\n
\t\t\treturn elem === fn.elem;\n
\t\t}).length;\n
\t};\n
}\n
jQuery.fn.offset = function( options ) {\n
\tif ( arguments.length ) {\n
\t\treturn options === undefined ?\n
\t\t\tthis :\n
\t\t\tthis.each(function( i ) {\n
\t\t\t\tjQuery.offset.setOffset( this, options, i );\n
\t\t\t});\n
\t}\n
\n
\tvar docElem, win,\n
\t\telem = this[ 0 ],\n
\t\tbox = { top: 0, left: 0 },\n
\t\tdoc = elem && elem.ownerDocument;\n
\n
\tif ( !doc ) {\n
\t\treturn;\n
\t}\n
\n
\tdocElem = doc.documentElement;\n
\n
\t// Make sure it\'s not a disconnected DOM node\n
\tif ( !jQuery.contains( docElem, elem ) ) {\n
\t\treturn box;\n
\t}\n
\n
\t// If we don\'t have gBCR, just use 0,0 rather than error\n
\t// BlackBerry 5, iOS 3 (original iPhone)\n
\tif ( typeof elem.getBoundingClientRect !== core_strundefined ) {\n
\t\tbox = elem.getBoundingClientRect();\n
\t}\n
\twin = getWindow( doc );\n
\treturn {\n
\t\ttop: box.top + win.pageYOffset - docElem.clientTop,\n
\t\tleft: box.left + win.pageXOffset - docElem.clientLeft\n
\t};\n
};\n
\n
jQuery.offset = {\n
\n
\tsetOffset: function( elem, options, i ) {\n
\t\tvar curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,\n
\t\t\tposition = jQuery.css( elem, "position" ),\n
\t\t\tcurElem = jQuery( elem ),\n
\t\t\tprops = {};\n
\n
\t\t// Set position first, in-case top/left are set even on static elem\n
\t\tif ( position === "static" ) {\n
\t\t\telem.style.position = "relative";\n
\t\t}\n
\n
\t\tcurOffset = curElem.offset();\n
\t\tcurCSSTop = jQuery.css( elem, "top" );\n
\t\tcurCSSLeft = jQuery.css( elem, "left" );\n
\t\tcalculatePosition = ( position === "absolute" || position === "fixed" ) && ( curCSSTop + curCSSLeft ).indexOf("auto") > -1;\n
\n
\t\t// Need to be able to calculate position if either top or left is auto and position is either absolute or fixed\n
\t\tif ( calculatePosition ) {\n
\t\t\tcurPosition = curElem.position();\n
\t\t\tcurTop = curPosition.top;\n
\t\t\tcurLeft = curPosition.left;\n
\n
\t\t} else {\n
\t\t\tcurTop = parseFloat( curCSSTop ) || 0;\n
\t\t\tcurLeft = parseFloat( curCSSLeft ) || 0;\n
\t\t}\n
\n
\t\tif ( jQuery.isFunction( options ) ) {\n
\t\t\toptions = options.call( elem, i, curOffset );\n
\t\t}\n
\n
\t\tif ( options.top != null ) {\n
\t\t\tprops.top = ( options.top - curOffset.top ) + curTop;\n
\t\t}\n
\t\tif ( options.left != null ) {\n
\t\t\tprops.left = ( options.left - curOffset.left ) + curLeft;\n
\t\t}\n
\n
\t\tif ( "using" in options ) {\n
\t\t\toptions.using.call( elem, props );\n
\n
\t\t} else {\n
\t\t\tcurElem.css( props );\n
\t\t}\n
\t}\n
};\n
\n
\n
jQuery.fn.extend({\n
\n
\tposition: function() {\n
\t\tif ( !this[ 0 ] ) {\n
\t\t\treturn;\n
\t\t}\n
\n
\t\tvar offsetParent, offset,\n
\t\t\telem = this[ 0 ],\n
\t\t\tparentOffset = { top: 0, left: 0 };\n
\n
\t\t// Fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is it\'s only offset parent\n
\t\tif ( jQuery.css( elem, "position" ) === "fixed" ) {\n
\t\t\t// We assume that getBoundingClientRect is available when computed position is fixed\n
\t\t\toffset = elem.getBoundingClientRect();\n
\n
\t\t} else {\n
\t\t\t// Get *real* offsetParent\n
\t\t\toffsetParent = this.offsetParent();\n
\n
\t\t\t// Get correct offsets\n
\t\t\toffset = this.offset();\n
\t\t\tif ( !jQuery.nodeName( offsetParent[ 0 ], "html" ) ) {\n
\t\t\t\tparentOffset = offsetParent.offset();\n
\t\t\t}\n
\n
\t\t\t// Add offsetParent borders\n
\t\t\tparentOffset.top += jQuery.css( offsetParent[ 0 ], "borderTopWidth", true );\n
\t\t\tparentOffset.left += jQuery.css( offsetParent[ 0 ], "borderLeftWidth", true );\n
\t\t}\n
\n
\t\t// Subtract parent offsets and element margins\n
\t\treturn {\n
\t\t\ttop: offset.top - parentOffset.top - jQuery.css( elem, "marginTop", true ),\n
\t\t\tleft: offset.left - parentOffset.left - jQuery.css( elem, "marginLeft", true )\n
\t\t};\n
\t},\n
\n
\toffsetParent: function() {\n
\t\treturn this.map(function() {\n
\t\t\tvar offsetParent = this.offsetParent || docElem;\n
\n
\t\t\twhile ( offsetParent && ( !jQuery.nodeName( offsetParent, "html" ) && jQuery.css( offsetParent, "position") === "static" ) ) {\n
\t\t\t\toffsetParent = offsetParent.offsetParent;\n
\t\t\t}\n
\n
\t\t\treturn offsetParent || docElem;\n
\t\t});\n
\t}\n
});\n
\n
\n
// Create scrollLeft and scrollTop methods\n
jQuery.each( {scrollLeft: "pageXOffset", scrollTop: "pageYOffset"}, function( method, prop ) {\n
\tvar top = "pageYOffset" === prop;\n
\n
\tjQuery.fn[ method ] = function( val ) {\n
\t\treturn jQuery.access( this, function( elem, method, val ) {\n
\t\t\tvar win = getWindow( elem );\n
\n
\t\t\tif ( val === undefined ) {\n
\t\t\t\treturn win ? win[ prop ] : elem[ method ];\n
\t\t\t}\n
\n
\t\t\tif ( win ) {\n
\t\t\t\twin.scrollTo(\n
\t\t\t\t\t!top ? val : window.pageXOffset,\n
\t\t\t\t\ttop ? val : window.pageYOffset\n
\t\t\t\t);\n
\n
\t\t\t} else {\n
\t\t\t\telem[ method ] = val;\n
\t\t\t}\n
\t\t}, method, val, arguments.length, null );\n
\t};\n
});\n
\n
function getWindow( elem ) {\n
\treturn jQuery.isWindow( elem ) ? elem : elem.nodeType === 9 && elem.defaultView;\n
}\n
// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods\n
jQuery.each( { Height: "height", Width: "width" }, function( name, type ) {\n
\tjQuery.each( { padding: "inner" + name, content: type, "": "outer" + name }, function( defaultExtra, funcName ) {\n
\t\t// margin is only for outerHeight, outerWidth\n
\t\tjQuery.fn[ funcName ] = function( margin, value ) {\n
\t\t\tvar chainable = arguments.length && ( defaultExtra || typeof margin !== "boolean" ),\n
\t\t\t\textra = defaultExtra || ( margin === true || value === true ? "margin" : "border" );\n
\n
\t\t\treturn jQuery.access( this, function( elem, type, value ) {\n
\t\t\t\tvar doc;\n
\n
\t\t\t\tif ( jQuery.isWindow( elem ) ) {\n
\t\t\t\t\t// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there\n
\t\t\t\t\t// isn\'t a whole lot we can do. See pull request at this URL for discussion:\n
\t\t\t\t\t// https://github.com/jquery/jquery/pull/764\n
\t\t\t\t\treturn elem.document.documentElement[ "client" + name ];\n
\t\t\t\t}\n
\n
\t\t\t\t// Get document width or height\n
\t\t\t\tif ( elem.nodeType === 9 ) {\n
\t\t\t\t\tdoc = elem.documentElement;\n
\n
\t\t\t\t\t// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],\n
\t\t\t\t\t// whichever is greatest\n
\t\t\t\t\treturn Math.max(\n
\t\t\t\t\t\telem.body[ "scroll" + name ], doc[ "scroll" + name ],\n
\t\t\t\t\t\telem.body[ "offset" + name ], doc[ "offset" + name ],\n
\t\t\t\t\t\tdoc[ "client" + name ]\n
\t\t\t\t\t);\n
\t\t\t\t}\n
\n
\t\t\t\treturn value === undefined ?\n
\t\t\t\t\t// Get width or height on the element, requesting but not forcing parseFloat\n
\t\t\t\t\tjQuery.css( elem, type, extra ) :\n
\n
\t\t\t\t\t// Set width or height on the element\n
\t\t\t\t\tjQuery.style( elem, type, value, extra );\n
\t\t\t}, type, chainable ? margin : undefined, chainable, null );\n
\t\t};\n
\t});\n
});\n
// Limit scope pollution from any deprecated API\n
// (function() {\n
\n
// The number of elements contained in the matched element set\n
jQuery.fn.size = function() {\n
\treturn this.length;\n
};\n
\n
jQuery.fn.andSelf = jQuery.fn.addBack;\n
\n
// })();\n
if ( typeof module === "object" && module && typeof module.exports === "object" ) {\n
\t// Expose jQuery as module.exports in loaders that implement the Node\n
\t// module pattern (including browserify). Do not create the global, since\n
\t// the user will be storing it themselves locally, and globals are frowned\n
\t// upon in the Node module world.\n
\tmodule.exports = jQuery;\n
} else {\n
\t// Register as a named AMD module, since jQuery can be concatenated with other\n
\t// files that may use define, but not via a proper concatenation script that\n
\t// understands anonymous AMD modules. A named AMD is safest and most robust\n
\t// way to register. Lowercase jquery is used because AMD module names are\n
\t// derived from file names, and jQuery is normally delivered in a lowercase\n
\t// file name. Do this after creating the global so that if an AMD module wants\n
\t// to call noConflict to hide this version of jQuery, it will work.\n
\tif ( typeof define === "function" && define.amd ) {\n
\t\tdefine( "jquery", [], function () { return jQuery; } );\n
\t}\n
}\n
\n
// If there is a window object, that at least has a document property,\n
// define jQuery and $ identifiers\n
if ( typeof window === "object" && typeof window.document === "object" ) {\n
\twindow.jQuery = window.$ = jQuery;\n
}\n
\n
})( window );\n
\n
//     Backbone.js 1.1.0\n
\n
//     (c) 2010-2011 Jeremy Ashkenas, DocumentCloud Inc.\n
//     (c) 2011-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n
//     Backbone may be freely distributed under the MIT license.\n
//     For all details and documentation:\n
//     http://backbonejs.org\n
\n
(function(){\n
\n
  // Initial Setup\n
  // -------------\n
\n
  // Save a reference to the global object (`window` in the browser, `exports`\n
  // on the server).\n
  var root = this;\n
\n
  // Save the previous value of the `Backbone` variable, so that it can be\n
  // restored later on, if `noConflict` is used.\n
  var previousBackbone = root.Backbone;\n
\n
  // Create local references to array methods we\'ll want to use later.\n
  var array = [];\n
  var push = array.push;\n
  var slice = array.slice;\n
  var splice = array.splice;\n
\n
  // The top-level namespace. All public Backbone classes and modules will\n
  // be attached to this. Exported for both the browser and the server.\n
  var Backbone;\n
  if (typeof exports !== \'undefined\') {\n
    Backbone = exports;\n
  } else {\n
    Backbone = root.Backbone = {};\n
  }\n
\n
  // Current version of the library. Keep in sync with `package.json`.\n
  Backbone.VERSION = \'1.1.0\';\n
\n
  // Require Underscore, if we\'re on the server, and it\'s not already present.\n
  var _ = root._;\n
  if (!_ && (typeof require !== \'undefined\')) _ = require(\'underscore\');\n
\n
  // For Backbone\'s purposes, jQuery, Zepto, Ender, or My Library (kidding) owns\n
  // the `$` variable.\n
  Backbone.$ = root.jQuery || root.Zepto || root.ender || root.$;\n
\n
  // Runs Backbone.js in *noConflict* mode, returning the `Backbone` variable\n
  // to its previous owner. Returns a reference to this Backbone object.\n
  Backbone.noConflict = function() {\n
    root.Backbone = previousBackbone;\n
    return this;\n
  };\n
\n
  // Turn on `emulateHTTP` to support legacy HTTP servers. Setting this option\n
  // will fake `"PATCH"`, `"PUT"` and `"DELETE"` requests via the `_method` parameter and\n
  // set a `X-Http-Method-Override` header.\n
  Backbone.emulateHTTP = false;\n
\n
  // Turn on `emulateJSON` to support legacy servers that can\'t deal with direct\n
  // `application/json` requests ... will encode the body as\n
  // `application/x-www-form-urlencoded` instead and will send the model in a\n
  // form param named `model`.\n
  Backbone.emulateJSON = false;\n
\n
  // Backbone.Events\n
  // ---------------\n
\n
  // A module that can be mixed in to *any object* in order to provide it with\n
  // custom events. You may bind with `on` or remove with `off` callback\n
  // functions to an event; `trigger`-ing an event fires all callbacks in\n
  // succession.\n
  //\n
  //     var object = {};\n
  //     _.extend(object, Backbone.Events);\n
  //     object.on(\'expand\', function(){ alert(\'expanded\'); });\n
  //     object.trigger(\'expand\');\n
  //\n
  var Events = Backbone.Events = {\n
\n
    // Bind an event to a `callback` function. Passing `"all"` will bind\n
    // the callback to all events fired.\n
    on: function(name, callback, context) {\n
      if (!eventsApi(this, \'on\', name, [callback, context]) || !callback) return this;\n
      this._events || (this._events = {});\n
      var events = this._events[name] || (this._events[name] = []);\n
      events.push({callback: callback, context: context, ctx: context || this});\n
      return this;\n
    },\n
\n
    // Bind an event to only be triggered a single time. After the first time\n
    // the callback is invoked, it will be removed.\n
    once: function(name, callback, context) {\n
      if (!eventsApi(this, \'once\', name, [callback, context]) || !callback) return this;\n
      var self = this;\n
      var once = _.once(function() {\n
        self.off(name, once);\n
        callback.apply(this, arguments);\n
      });\n
      once._callback = callback;\n
      return this.on(name, once, context);\n
    },\n
\n
    // Remove one or many callbacks. If `context` is null, removes all\n
    // callbacks with that function. If `callback` is null, removes all\n
    // callbacks for the event. If `name` is null, removes all bound\n
    // callbacks for all events.\n
    off: function(name, callback, context) {\n
      var retain, ev, events, names, i, l, j, k;\n
      if (!this._events || !eventsApi(this, \'off\', name, [callback, context])) return this;\n
      if (!name && !callback && !context) {\n
        this._events = {};\n
        return this;\n
      }\n
      names = name ? [name] : _.keys(this._events);\n
      for (i = 0, l = names.length; i < l; i++) {\n
        name = names[i];\n
        if (events = this._events[name]) {\n
          this._events[name] = retain = [];\n
          if (callback || context) {\n
            for (j = 0, k = events.length; j < k; j++) {\n
              ev = events[j];\n
              if ((callback && callback !== ev.callback && callback !== ev.callback._callback) ||\n
                  (context && context !== ev.context)) {\n
                retain.push(ev);\n
              }\n
            }\n
          }\n
          if (!retain.length) delete this._events[name];\n
        }\n
      }\n
\n
      return this;\n
    },\n
\n
    // Trigger one or many events, firing all bound callbacks. Callbacks are\n
    // passed the same arguments as `trigger` is, apart from the event name\n
    // (unless you\'re listening on `"all"`, which will cause your callback to\n
    // receive the true name of the event as the first argument).\n
    trigger: function(name) {\n
      if (!this._events) return this;\n
      var args = slice.call(arguments, 1);\n
      if (!eventsApi(this, \'trigger\', name, args)) return this;\n
      var events = this._events[name];\n
      var allEvents = this._events.all;\n
      if (events) triggerEvents(events, args);\n
      if (allEvents) triggerEvents(allEvents, arguments);\n
      return this;\n
    },\n
\n
    // Tell this object to stop listening to either specific events ... or\n
    // to every object it\'s currently listening to.\n
    stopListening: function(obj, name, callback) {\n
      var listeningTo = this._listeningTo;\n
      if (!listeningTo) return this;\n
      var remove = !name && !callback;\n
      if (!callback && typeof name === \'object\') callback = this;\n
      if (obj) (listeningTo = {})[obj._listenId] = obj;\n
      for (var id in listeningTo) {\n
        obj = listeningTo[id];\n
        obj.off(name, callback, this);\n
        if (remove || _.isEmpty(obj._events)) delete this._listeningTo[id];\n
      }\n
      return this;\n
    }\n
\n
  };\n
\n
  // Regular expression used to split event strings.\n
  var eventSplitter = /\\s+/;\n
\n
  // Implement fancy features of the Events API such as multiple event\n
  // names `"change blur"` and jQuery-style event maps `{change: action}`\n
  // in terms of the existing API.\n
  var eventsApi = function(obj, action, name, rest) {\n
    if (!name) return true;\n
\n
    // Handle event maps.\n
    if (typeof name === \'object\') {\n
      for (var key in name) {\n
        obj[action].apply(obj, [key, name[key]].concat(rest));\n
      }\n
      return false;\n
    }\n
\n
    // Handle space separated event names.\n
    if (eventSplitter.test(name)) {\n
      var names = name.split(eventSplitter);\n
      for (var i = 0, l = names.length; i < l; i++) {\n
        obj[action].apply(obj, [names[i]].concat(rest));\n
      }\n
      return false;\n
    }\n
\n
    return true;\n
  };\n
\n
  // A difficult-to-believe, but optimized internal dispatch function for\n
  // triggering events. Tries to keep the usual cases speedy (most internal\n
  // Backbone events have 3 arguments).\n
  var triggerEvents = function(events, args) {\n
    var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n
    switch (args.length) {\n
      case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;\n
      case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;\n
      case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;\n
      case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;\n
      default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args);\n
    }\n
  };\n
\n
  var listenMethods = {listenTo: \'on\', listenToOnce: \'once\'};\n
\n
  // Inversion-of-control versions of `on` and `once`. Tell *this* object to\n
  // listen to an event in another object ... keeping track of what it\'s\n
  // listening to.\n
  _.each(listenMethods, function(implementation, method) {\n
    Events[method] = function(obj, name, callback) {\n
      var listeningTo = this._listeningTo || (this._listeningTo = {});\n
      var id = obj._listenId || (obj._listenId = _.uniqueId(\'l\'));\n
      listeningTo[id] = obj;\n
      if (!callback && typeof name === \'object\') callback = this;\n
      obj[implementation](name, callback, this);\n
      return this;\n
    };\n
  });\n
\n
  // Aliases for backwards compatibility.\n
  Events.bind   = Events.on;\n
  Events.unbind = Events.off;\n
\n
  // Allow the `Backbone` object to serve as a global event bus, for folks who\n
  // want global "pubsub" in a convenient place.\n
  _.extend(Backbone, Events);\n
\n
  // Backbone.Model\n
  // --------------\n
\n
  // Backbone **Models** are the basic data object in the framework --\n
  // frequently representing a row in a table in a database on your server.\n
  // A discrete chunk of data and a bunch of useful, related methods for\n
  // performing computations and transformations on that data.\n
\n
  // Create a new model with the specified attributes. A client id (`cid`)\n
  // is automatically generated and assigned for you.\n
  var Model = Backbone.Model = function(attributes, options) {\n
    var attrs = attributes || {};\n
    options || (options = {});\n
    this.cid = _.uniqueId(\'c\');\n
    this.attributes = {};\n
    if (options.collection) this.collection = options.collection;\n
    if (options.parse) attrs = this.parse(attrs, options) || {};\n
    attrs = _.defaults({}, attrs, _.result(this, \'defaults\'));\n
    this.set(attrs, options);\n
    this.changed = {};\n
    this.initialize.apply(this, arguments);\n
  };\n
\n
  // Attach all inheritable methods to the Model prototype.\n
  _.extend(Model.prototype, Events, {\n
\n
    // A hash of attributes whose current and previous value differ.\n
    changed: null,\n
\n
    // The value returned during the last failed validation.\n
    validationError: null,\n
\n
    // The default name for the JSON `id` attribute is `"id"`. MongoDB and\n
    // CouchDB users may want to set this to `"_id"`.\n
    idAttribute: \'id\',\n
\n
    // Initialize is an empty function by default. Override it with your own\n
    // initialization logic.\n
    initialize: function(){},\n
\n
    // Return a copy of the model\'s `attributes` object.\n
    toJSON: function(options) {\n
      return _.clone(this.attributes);\n
    },\n
\n
    // Proxy `Backbone.sync` by default -- but override this if you need\n
    // custom syncing semantics for *this* particular model.\n
    sync: function() {\n
      return Backbone.sync.apply(this, arguments);\n
    },\n
\n
    // Get the value of an attribute.\n
    get: function(attr) {\n
      return this.attributes[attr];\n
    },\n
\n
    // Get the HTML-escaped value of an attribute.\n
    escape: function(attr) {\n
      return _.escape(this.get(attr));\n
    },\n
\n
    // Returns `true` if the attribute contains a value that is not null\n
    // or undefined.\n
    has: function(attr) {\n
      return this.get(attr) != null;\n
    },\n
\n
    // Set a hash of model attributes on the object, firing `"change"`. This is\n
    // the core primitive operation of a model, updating the data and notifying\n
    // anyone who needs to know about the change in state. The heart of the beast.\n
    set: function(key, val, options) {\n
      var attr, attrs, unset, changes, silent, changing, prev, current;\n
      if (key == null) return this;\n
\n
      // Handle both `"key", value` and `{key: value}` -style arguments.\n
      if (typeof key === \'object\') {\n
        attrs = key;\n
        options = val;\n
      } else {\n
        (attrs = {})[key] = val;\n
      }\n
\n
      options || (options = {});\n
\n
      // Run validation.\n
      if (!this._validate(attrs, options)) return false;\n
\n
      // Extract attributes and options.\n
      unset           = options.unset;\n
      silent          = options.silent;\n
      changes         = [];\n
      changing        = this._changing;\n
      this._changing  = true;\n
\n
      if (!changing) {\n
        this._previousAttributes = _.clone(this.attributes);\n
        this.changed = {};\n
      }\n
      current = this.attributes, prev = this._previousAttributes;\n
\n
      // Check for changes of `id`.\n
      if (this.idAttribute in attrs) this.id = attrs[this.idAttribute];\n
\n
      // For each `set` attribute, update or delete the current value.\n
      for (attr in attrs) {\n
        val = attrs[attr];\n
        if (!_.isEqual(current[attr], val)) changes.push(attr);\n
        if (!_.isEqual(prev[attr], val)) {\n
          this.changed[attr] = val;\n
        } else {\n
          delete this.changed[attr];\n
        }\n
        unset ? delete current[attr] : current[attr] = val;\n
      }\n
\n
      // Trigger all relevant attribute changes.\n
      if (!silent) {\n
        if (changes.length) this._pending = true;\n
        for (var i = 0, l = changes.length; i < l; i++) {\n
          this.trigger(\'change:\' + changes[i], this, current[changes[i]], options);\n
        }\n
      }\n
\n
      // You might be wondering why there\'s a `while` loop here. Changes can\n
      // be recursively nested within `"change"` events.\n
      if (changing) return this;\n
      if (!silent) {\n
        while (this._pending) {\n
          this._pending = false;\n
          this.trigger(\'change\', this, options);\n
        }\n
      }\n
      this._pending = false;\n
      this._changing = false;\n
      return this;\n
    },\n
\n
    // Remove an attribute from the model, firing `"change"`. `unset` is a noop\n
    // if the attribute doesn\'t exist.\n
    unset: function(attr, options) {\n
      return this.set(attr, void 0, _.extend({}, options, {unset: true}));\n
    },\n
\n
    // Clear all attributes on the model, firing `"change"`.\n
    clear: function(options) {\n
      var attrs = {};\n
      for (var key in this.attributes) attrs[key] = void 0;\n
      return this.set(attrs, _.extend({}, options, {unset: true}));\n
    },\n
\n
    // Determine if the model has changed since the last `"change"` event.\n
    // If you specify an attribute name, determine if that attribute has changed.\n
    hasChanged: function(attr) {\n
      if (attr == null) return !_.isEmpty(this.changed);\n
      return _.has(this.changed, attr);\n
    },\n
\n
    // Return an object containing all the attributes that have changed, or\n
    // false if there are no changed attributes. Useful for determining what\n
    // parts of a view need to be updated and/or what attributes need to be\n
    // persisted to the server. Unset attributes will be set to undefined.\n
    // You can also pass an attributes object to diff against the model,\n
    // determining if there *would be* a change.\n
    changedAttributes: function(diff) {\n
      if (!diff) return this.hasChanged() ? _.clone(this.changed) : false;\n
      var val, changed = false;\n
      var old = this._changing ? this._previousAttributes : this.attributes;\n
      for (var attr in diff) {\n
        if (_.isEqual(old[attr], (val = diff[attr]))) continue;\n
        (changed || (changed = {}))[attr] = val;\n
      }\n
      return changed;\n
    },\n
\n
    // Get the previous value of an attribute, recorded at the time the last\n
    // `"change"` event was fired.\n
    previous: function(attr) {\n
      if (attr == null || !this._previousAttributes) return null;\n
      return this._previousAttributes[attr];\n
    },\n
\n
    // Get all of the attributes of the model at the time of the previous\n
    // `"change"` event.\n
    previousAttributes: function() {\n
      return _.clone(this._previousAttributes);\n
    },\n
\n
    // Fetch the model from the server. If the server\'s representation of the\n
    // model differs from its current attributes, they will be overridden,\n
    // triggering a `"change"` event.\n
    fetch: function(options) {\n
      options = options ? _.clone(options) : {};\n
      if (options.parse === void 0) options.parse = true;\n
      var model = this;\n
      var success = options.success;\n
      options.success = function(resp) {\n
        if (!model.set(model.parse(resp, options), options)) return false;\n
        if (success) success(model, resp, options);\n
        model.trigger(\'sync\', model, resp, options);\n
      };\n
      wrapError(this, options);\n
      return this.sync(\'read\', this, options);\n
    },\n
\n
    // Set a hash of model attributes, and sync the model to the server.\n
    // If the server returns an attributes hash that differs, the model\'s\n
    // state will be `set` again.\n
    save: function(key, val, options) {\n
      var attrs, method, xhr, attributes = this.attributes;\n
\n
      // Handle both `"key", value` and `{key: value}` -style arguments.\n
      if (key == null || typeof key === \'object\') {\n
        attrs = key;\n
        options = val;\n
      } else {\n
        (attrs = {})[key] = val;\n
      }\n
\n
      options = _.extend({validate: true}, options);\n
\n
      // If we\'re not waiting and attributes exist, save acts as\n
      // `set(attr).save(null, opts)` with validation. Otherwise, check if\n
      // the model will be valid when the attributes, if any, are set.\n
      if (attrs && !options.wait) {\n
        if (!this.set(attrs, options)) return false;\n
      } else {\n
        if (!this._validate(attrs, options)) return false;\n
      }\n
\n
      // Set temporary attributes if `{wait: true}`.\n
      if (attrs && options.wait) {\n
        this.attributes = _.extend({}, attributes, attrs);\n
      }\n
\n
      // After a successful server-side save, the client is (optionally)\n
      // updated with the server-side state.\n
      if (options.parse === void 0) options.parse = true;\n
      var model = this;\n
      var success = options.success;\n
      options.success = function(resp) {\n
        // Ensure attributes are restored during synchronous saves.\n
        model.attributes = attributes;\n
        var serverAttrs = model.parse(resp, options);\n
        if (options.wait) serverAttrs = _.extend(attrs || {}, serverAttrs);\n
        if (_.isObject(serverAttrs) && !model.set(serverAttrs, options)) {\n
          return false;\n
        }\n
        if (success) success(model, resp, options);\n
        model.trigger(\'sync\', model, resp, options);\n
      };\n
      wrapError(this, options);\n
\n
      method = this.isNew() ? \'create\' : (options.patch ? \'patch\' : \'update\');\n
      if (method === \'patch\') options.attrs = attrs;\n
      xhr = this.sync(method, this, options);\n
\n
      // Restore attributes.\n
      if (attrs && options.wait) this.attributes = attributes;\n
\n
      return xhr;\n
    },\n
\n
    // Destroy this model on the server if it was already persisted.\n
    // Optimistically removes the model from its collection, if it has one.\n
    // If `wait: true` is passed, waits for the server to respond before removal.\n
    destroy: function(options) {\n
      options = options ? _.clone(options) : {};\n
      var model = this;\n
      var success = options.success;\n
\n
      var destroy = function() {\n
        model.trigger(\'destroy\', model, model.collection, options);\n
      };\n
\n
      options.success = function(resp) {\n
        if (options.wait || model.isNew()) destroy();\n
        if (success) success(model, resp, options);\n
        if (!model.isNew()) model.trigger(\'sync\', model, resp, options);\n
      };\n
\n
      if (this.isNew()) {\n
        options.success();\n
        return false;\n
      }\n
      wrapError(this, options);\n
\n
      var xhr = this.sync(\'delete\', this, options);\n
      if (!options.wait) destroy();\n
      return xhr;\n
    },\n
\n
    // Default URL for the model\'s representation on the server -- if you\'re\n
    // using Backbone\'s restful methods, override this to change the endpoint\n
    // that will be called.\n
    url: function() {\n
      var base = _.result(this, \'urlRoot\') || _.result(this.collection, \'url\') || urlError();\n
      if (this.isNew()) return base;\n
      return base + (base.charAt(base.length - 1) === \'/\' ? \'\' : \'/\') + encodeURIComponent(this.id);\n
    },\n
\n
    // **parse** converts a response into the hash of attributes to be `set` on\n
    // the model. The default implementation is just to pass the response along.\n
    parse: function(resp, options) {\n
      return resp;\n
    },\n
\n
    // Create a new model with identical attributes to this one.\n
    clone: function() {\n
      return new this.constructor(this.attributes);\n
    },\n
\n
    // A model is new if it has never been saved to the server, and lacks an id.\n
    isNew: function() {\n
      return this.id == null;\n
    },\n
\n
    // Check if the model is currently in a valid state.\n
    isValid: function(options) {\n
      return this._validate({}, _.extend(options || {}, { validate: true }));\n
    },\n
\n
    // Run validation against the next complete set of model attributes,\n
    // returning `true` if all is well. Otherwise, fire an `"invalid"` event.\n
    _validate: function(attrs, options) {\n
      if (!options.validate || !this.validate) return true;\n
      attrs = _.extend({}, this.attributes, attrs);\n
      var error = this.validationError = this.validate(attrs, options) || null;\n
      if (!error) return true;\n
      this.trigger(\'invalid\', this, error, _.extend(options, {validationError: error}));\n
      return false;\n
    }\n
\n
  });\n
\n
  // Underscore methods that we want to implement on the Model.\n
  var modelMethods = [\'keys\', \'values\', \'pairs\', \'invert\', \'pick\', \'omit\'];\n
\n
  // Mix in each Underscore method as a proxy to `Model#attributes`.\n
  _.each(modelMethods, function(method) {\n
    Model.prototype[method] = function() {\n
      var args = slice.call(arguments);\n
      args.unshift(this.attributes);\n
      return _[method].apply(_, args);\n
    };\n
  });\n
\n
  // Backbone.Collection\n
  // -------------------\n
\n
  // If models tend to represent a single row of data, a Backbone Collection is\n
  // more analagous to a table full of data ... or a small slice or page of that\n
  // table, or a collection of rows that belong together for a particular reason\n
  // -- all of the messages in this particular folder, all of the documents\n
  // belonging to this particular author, and so on. Collections maintain\n
  // indexes of their models, both in order, and for lookup by `id`.\n
\n
  // Create a new **Collection**, perhaps to contain a specific type of `model`.\n
  // If a `comparator` is specified, the Collection will maintain\n
  // its models in sort order, as they\'re added and removed.\n
  var Collection = Backbone.Collection = function(models, options) {\n
    options || (options = {});\n
    if (options.model) this.model = options.model;\n
    if (options.comparator !== void 0) this.comparator = options.comparator;\n
    this._reset();\n
    this.initialize.apply(this, arguments);\n
    if (models) this.reset(models, _.extend({silent: true}, options));\n
  };\n
\n
  // Default options for `Collection#set`.\n
  var setOptions = {add: true, remove: true, merge: true};\n
  var addOptions = {add: true, remove: false};\n
\n
  // Define the Collection\'s inheritable methods.\n
  _.extend(Collection.prototype, Events, {\n
\n
    // The default model for a collection is just a **Backbone.Model**.\n
    // This should be overridden in most cases.\n
    model: Model,\n
\n
    // Initialize is an empty function by default. Override it with your own\n
    // initialization logic.\n
    initialize: function(){},\n
\n
    // The JSON representation of a Collection is an array of the\n
    // models\' attributes.\n
    toJSON: function(options) {\n
      return this.map(function(model){ return model.toJSON(options); });\n
    },\n
\n
    // Proxy `Backbone.sync` by default.\n
    sync: function() {\n
      return Backbone.sync.apply(this, arguments);\n
    },\n
\n
    // Add a model, or list of models to the set.\n
    add: function(models, options) {\n
      return this.set(models, _.extend({merge: false}, options, addOptions));\n
    },\n
\n
    // Remove a model, or a list of models from the set.\n
    remove: function(models, options) {\n
      var singular = !_.isArray(models);\n
      models = singular ? [models] : _.clone(models);\n
      options || (options = {});\n
      var i, l, index, model;\n
      for (i = 0, l = models.length; i < l; i++) {\n
        model = models[i] = this.get(models[i]);\n
        if (!model) continue;\n
        delete this._byId[model.id];\n
        delete this._byId[model.cid];\n
        index = this.indexOf(model);\n
        this.models.splice(index, 1);\n
        this.length--;\n
        if (!options.silent) {\n
          options.index = index;\n
          model.trigger(\'remove\', model, this, options);\n
        }\n
        this._removeReference(model);\n
      }\n
      return singular ? models[0] : models;\n
    },\n
\n
    // Update a collection by `set`-ing a new list of models, adding new ones,\n
    // removing models that are no longer present, and merging models that\n
    // already exist in the collection, as necessary. Similar to **Model#set**,\n
    // the core operation for updating the data contained by the collection.\n
    set: function(models, options) {\n
      options = _.defaults({}, options, setOptions);\n
      if (options.parse) models = this.parse(models, options);\n
      var singular = !_.isArray(models);\n
      models = singular ? (models ? [models] : []) : _.clone(models);\n
      var i, l, id, model, attrs, existing, sort;\n
      var at = options.at;\n
      var targetModel = this.model;\n
      var sortable = this.comparator && (at == null) && options.sort !== false;\n
      var sortAttr = _.isString(this.comparator) ? this.comparator : null;\n
      var toAdd = [], toRemove = [], modelMap = {};\n
      var add = options.add, merge = options.merge, remove = options.remove;\n
      var order = !sortable && add && remove ? [] : false;\n
\n
      // Turn bare objects into model references, and prevent invalid models\n
      // from being added.\n
      for (i = 0, l = models.length; i < l; i++) {\n
        attrs = models[i];\n
        if (attrs instanceof Model) {\n
          id = model = attrs;\n
        } else {\n
          id = attrs[targetModel.prototype.idAttribute];\n
        }\n
\n
        // If a duplicate is found, prevent it from being added and\n
        // optionally merge it into the existing model.\n
        if (existing = this.get(id)) {\n
          if (remove) modelMap[existing.cid] = true;\n
          if (merge) {\n
            attrs = attrs === model ? model.attributes : attrs;\n
            if (options.parse) attrs = existing.parse(attrs, options);\n
            existing.set(attrs, options);\n
            if (sortable && !sort && existing.hasChanged(sortAttr)) sort = true;\n
          }\n
          models[i] = existing;\n
\n
        // If this is a new, valid model, push it to the `toAdd` list.\n
        } else if (add) {\n
          model = models[i] = this._prepareModel(attrs, options);\n
          if (!model) continue;\n
          toAdd.push(model);\n
\n
          // Listen to added models\' events, and index models for lookup by\n
          // `id` and by `cid`.\n
          model.on(\'all\', this._onModelEvent, this);\n
          this._byId[model.cid] = model;\n
          if (model.id != null) this._byId[model.id] = model;\n
        }\n
        if (order) order.push(existing || model);\n
      }\n
\n
      // Remove nonexistent models if appropriate.\n
      if (remove) {\n
        for (i = 0, l = this.length; i < l; ++i) {\n
          if (!modelMap[(model = this.models[i]).cid]) toRemove.push(model);\n
        }\n
        if (toRemove.length) this.remove(toRemove, options);\n
      }\n
\n
      // See if sorting is needed, update `length` and splice in new models.\n
      if (toAdd.length || (order && order.length)) {\n
        if (sortable) sort = true;\n
        this.length += toAdd.length;\n
        if (at != null) {\n
          for (i = 0, l = toAdd.length; i < l; i++) {\n
            this.models.splice(at + i, 0, toAdd[i]);\n
          }\n
        } else {\n
          if (order) this.models.length = 0;\n
          var orderedModels = order || toAdd;\n
          for (i = 0, l = orderedModels.length; i < l; i++) {\n
            this.models.push(orderedModels[i]);\n
          }\n
        }\n
      }\n
\n
      // Silently sort the collection if appropriate.\n
      if (sort) this.sort({silent: true});\n
\n
      // Unless silenced, it\'s time to fire all appropriate add/sort events.\n
      if (!options.silent) {\n
        for (i = 0, l = toAdd.length; i < l; i++) {\n
          (model = toAdd[i]).trigger(\'add\', model, this, options);\n
        }\n
        if (sort || (order && order.length)) this.trigger(\'sort\', this, options);\n
      }\n
      \n
      // Return the added (or merged) model (or models).\n
      return singular ? models[0] : models;\n
    },\n
\n
    // When you have more items than you want to add or remove individually,\n
    // you can reset the entire set with a new list of models, without firing\n
    // any granular `add` or `remove` events. Fires `reset` when finished.\n
    // Useful for bulk operations and optimizations.\n
    reset: function(models, options) {\n
      options || (options = {});\n
      for (var i = 0, l = this.models.length; i < l; i++) {\n
        this._removeReference(this.models[i]);\n
      }\n
      options.previousModels = this.models;\n
      this._reset();\n
      models = this.add(models, _.extend({silent: true}, options));\n
      if (!options.silent) this.trigger(\'reset\', this, options);\n
      return models;\n
    },\n
\n
    // Add a model to the end of the collection.\n
    push: function(model, options) {\n
      return this.add(model, _.extend({at: this.length}, options));\n
    },\n
\n
    // Remove a model from the end of the collection.\n
    pop: function(options) {\n
      var model = this.at(this.length - 1);\n
      this.remove(model, options);\n
      return model;\n
    },\n
\n
    // Add a model to the beginning of the collection.\n
    unshift: function(model, options) {\n
      return this.add(model, _.extend({at: 0}, options));\n
    },\n
\n
    // Remove a model from the beginning of the collection.\n
    shift: function(options) {\n
      var model = this.at(0);\n
      this.remove(model, options);\n
      return model;\n
    },\n
\n
    // Slice out a sub-array of models from the collection.\n
    slice: function() {\n
      return slice.apply(this.models, arguments);\n
    },\n
\n
    // Get a model from the set by id.\n
    get: function(obj) {\n
      if (obj == null) return void 0;\n
      return this._byId[obj.id] || this._byId[obj.cid] || this._byId[obj];\n
    },\n
\n
    // Get the model at the given index.\n
    at: function(index) {\n
      return this.models[index];\n
    },\n
\n
    // Return models with matching attributes. Useful for simple cases of\n
    // `filter`.\n
    where: function(attrs, first) {\n
      if (_.isEmpty(attrs)) return first ? void 0 : [];\n
      return this[first ? \'find\' : \'filter\'](function(model) {\n
        for (var key in attrs) {\n
          if (attrs[key] !== model.get(key)) return false;\n
        }\n
        return true;\n
      });\n
    },\n
\n
    // Return the first model with matching attributes. Useful for simple cases\n
    // of `find`.\n
    findWhere: function(attrs) {\n
      return this.where(attrs, true);\n
    },\n
\n
    // Force the collection to re-sort itself. You don\'t need to call this under\n
    // normal circumstances, as the set will maintain sort order as each item\n
    // is added.\n
    sort: function(options) {\n
      if (!this.comparator) throw new Error(\'Cannot sort a set without a comparator\');\n
      options || (options = {});\n
\n
      // Run sort based on type of `comparator`.\n
      if (_.isString(this.comparator) || this.comparator.length === 1) {\n
        this.models = this.sortBy(this.comparator, this);\n
      } else {\n
        this.models.sort(_.bind(this.comparator, this));\n
      }\n
\n
      if (!options.silent) this.trigger(\'sort\', this, options);\n
      return this;\n
    },\n
\n
    // Pluck an attribute from each model in the collection.\n
    pluck: function(attr) {\n
      return _.invoke(this.models, \'get\', attr);\n
    },\n
\n
    // Fetch the default set of models for this collection, resetting the\n
    // collection when they arrive. If `reset: true` is passed, the response\n
    // data will be passed through the `reset` method instead of `set`.\n
    fetch: function(options) {\n
      options = options ? _.clone(options) : {};\n
      if (options.parse === void 0) options.parse = true;\n
      var success = options.success;\n
      var collection = this;\n
      options.success = function(resp) {\n
        var method = options.reset ? \'reset\' : \'set\';\n
        collection[method](resp, options);\n
        if (success) success(collection, resp, options);\n
        collection.trigger(\'sync\', collection, resp, options);\n
      };\n
      wrapError(this, options);\n
      return this.sync(\'read\', this, options);\n
    },\n
\n
    // Create a new instance of a model in this collection. Add the model to the\n
    // collection immediately, unless `wait: true` is passed, in which case we\n
    // wait for the server to agree.\n
    create: function(model, options) {\n
      options = options ? _.clone(options) : {};\n
      if (!(model = this._prepareModel(model, options))) return false;\n
      if (!options.wait) this.add(model, options);\n
      var collection = this;\n
      var success = options.success;\n
      options.success = function(model, resp, options) {\n
        if (options.wait) collection.add(model, options);\n
        if (success) success(model, resp, options);\n
      };\n
      model.save(null, options);\n
      return model;\n
    },\n
\n
    // **parse** converts a response into a list of models to be added to the\n
    // collection. The default implementation is just to pass it through.\n
    parse: function(resp, options) {\n
      return resp;\n
    },\n
\n
    // Create a new collection with an identical list of models as this one.\n
    clone: function() {\n
      return new this.constructor(this.models);\n
    },\n
\n
    // Private method to reset all internal state. Called when the collection\n
    // is first initialized or reset.\n
    _reset: function() {\n
      this.length = 0;\n
      this.models = [];\n
      this._byId  = {};\n
    },\n
\n
    // Prepare a hash of attributes (or other model) to be added to this\n
    // collection.\n
    _prepareModel: function(attrs, options) {\n
      if (attrs instanceof Model) {\n
        if (!attrs.collection) attrs.collection = this;\n
        return attrs;\n
      }\n
      options = options ? _.clone(options) : {};\n
      options.collection = this;\n
      var model = new this.model(attrs, options);\n
      if (!model.validationError) return model;\n
      this.trigger(\'invalid\', this, model.validationError, options);\n
      return false;\n
    },\n
\n
    // Internal method to sever a model\'s ties to a collection.\n
    _removeReference: function(model) {\n
      if (this === model.collection) delete model.collection;\n
      model.off(\'all\', this._onModelEvent, this);\n
    },\n
\n
    // Internal method called every time a model in the set fires an event.\n
    // Sets need to update their indexes when models change ids. All other\n
    // events simply proxy through. "add" and "remove" events that originate\n
    // in other collections are ignored.\n
    _onModelEvent: function(event, model, collection, options) {\n
      if ((event === \'add\' || event === \'remove\') && collection !== this) return;\n
      if (event === \'destroy\') this.remove(model, options);\n
      if (model && event === \'change:\' + model.idAttribute) {\n
        delete this._byId[model.previous(model.idAttribute)];\n
        if (model.id != null) this._byId[model.id] = model;\n
      }\n
      this.trigger.apply(this, arguments);\n
    }\n
\n
  });\n
\n
  // Underscore methods that we want to implement on the Collection.\n
  // 90% of the core usefulness of Backbone Collections is actually implemented\n
  // right here:\n
  var methods = [\'forEach\', \'each\', \'map\', \'collect\', \'reduce\', \'foldl\',\n
    \'inject\', \'reduceRight\', \'foldr\', \'find\', \'detect\', \'filter\', \'select\',\n
    \'reject\', \'every\', \'all\', \'some\', \'any\', \'include\', \'contains\', \'invoke\',\n
    \'max\', \'min\', \'toArray\', \'size\', \'first\', \'head\', \'take\', \'initial\', \'rest\',\n
    \'tail\', \'drop\', \'last\', \'without\', \'difference\', \'indexOf\', \'shuffle\',\n
    \'lastIndexOf\', \'isEmpty\', \'chain\'];\n
\n
  // Mix in each Underscore method as a proxy to `Collection#models`.\n
  _.each(methods, function(method) {\n
    Collection.prototype[method] = function() {\n
      var args = slice.call(arguments);\n
      args.unshift(this.models);\n
      return _[method].apply(_, args);\n
    };\n
  });\n
\n
  // Underscore methods that take a property name as an argument.\n
  var attributeMethods = [\'groupBy\', \'countBy\', \'sortBy\'];\n
\n
  // Use attributes instead of properties.\n
  _.each(attributeMethods, function(method) {\n
    Collection.prototype[method] = function(value, context) {\n
      var iterator = _.isFunction(value) ? value : function(model) {\n
        return model.get(value);\n
      };\n
      return _[method](this.models, iterator, context);\n
    };\n
  });\n
\n
  // Backbone.View\n
  // -------------\n
\n
  // Backbone Views are almost more convention than they are actual code. A View\n
  // is simply a JavaScript object that represents a logical chunk of UI in the\n
  // DOM. This might be a single item, an entire list, a sidebar or panel, or\n
  // even the surrounding frame which wraps your whole app. Defining a chunk of\n
  // UI as a **View** allows you to define your DOM events declaratively, without\n
  // having to worry about render order ... and makes it easy for the view to\n
  // react to specific changes in the state of your models.\n
\n
  // Creating a Backbone.View creates its initial element outside of the DOM,\n
  // if an existing element is not provided...\n
  var View = Backbone.View = function(options) {\n
    this.cid = _.un

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAY=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="6" aka="AAAAAAAAAAY=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

iqueId(\'view\');\n
    options || (options = {});\n
    _.extend(this, _.pick(options, viewOptions));\n
    this._ensureElement();\n
    this.initialize.apply(this, arguments);\n
    this.delegateEvents();\n
  };\n
\n
  // Cached regex to split keys for `delegate`.\n
  var delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\n
\n
  // List of view options to be merged as properties.\n
  var viewOptions = [\'model\', \'collection\', \'el\', \'id\', \'attributes\', \'className\', \'tagName\', \'events\'];\n
\n
  // Set up all inheritable **Backbone.View** properties and methods.\n
  _.extend(View.prototype, Events, {\n
\n
    // The default `tagName` of a View\'s element is `"div"`.\n
    tagName: \'div\',\n
\n
    // jQuery delegate for element lookup, scoped to DOM elements within the\n
    // current view. This should be preferred to global lookups where possible.\n
    $: function(selector) {\n
      return this.$el.find(selector);\n
    },\n
\n
    // Initialize is an empty function by default. Override it with your own\n
    // initialization logic.\n
    initialize: function(){},\n
\n
    // **render** is the core function that your view should override, in order\n
    // to populate its element (`this.el`), with the appropriate HTML. The\n
    // convention is for **render** to always return `this`.\n
    render: function() {\n
      return this;\n
    },\n
\n
    // Remove this view by taking the element out of the DOM, and removing any\n
    // applicable Backbone.Events listeners.\n
    remove: function() {\n
      this.$el.remove();\n
      this.stopListening();\n
      return this;\n
    },\n
\n
    // Change the view\'s element (`this.el` property), including event\n
    // re-delegation.\n
    setElement: function(element, delegate) {\n
      if (this.$el) this.undelegateEvents();\n
      this.$el = element instanceof Backbone.$ ? element : Backbone.$(element);\n
      this.el = this.$el[0];\n
      if (delegate !== false) this.delegateEvents();\n
      return this;\n
    },\n
\n
    // Set callbacks, where `this.events` is a hash of\n
    //\n
    // *{"event selector": "callback"}*\n
    //\n
    //     {\n
    //       \'mousedown .title\':  \'edit\',\n
    //       \'click .button\':     \'save\',\n
    //       \'click .open\':       function(e) { ... }\n
    //     }\n
    //\n
    // pairs. Callbacks will be bound to the view, with `this` set properly.\n
    // Uses event delegation for efficiency.\n
    // Omitting the selector binds the event to `this.el`.\n
    // This only works for delegate-able events: not `focus`, `blur`, and\n
    // not `change`, `submit`, and `reset` in Internet Explorer.\n
    delegateEvents: function(events) {\n
      if (!(events || (events = _.result(this, \'events\')))) return this;\n
      this.undelegateEvents();\n
      for (var key in events) {\n
        var method = events[key];\n
        if (!_.isFunction(method)) method = this[events[key]];\n
        if (!method) continue;\n
\n
        var match = key.match(delegateEventSplitter);\n
        var eventName = match[1], selector = match[2];\n
        method = _.bind(method, this);\n
        eventName += \'.delegateEvents\' + this.cid;\n
        if (selector === \'\') {\n
          this.$el.on(eventName, method);\n
        } else {\n
          this.$el.on(eventName, selector, method);\n
        }\n
      }\n
      return this;\n
    },\n
\n
    // Clears all callbacks previously bound to the view with `delegateEvents`.\n
    // You usually don\'t need to use this, but may wish to if you have multiple\n
    // Backbone views attached to the same DOM element.\n
    undelegateEvents: function() {\n
      this.$el.off(\'.delegateEvents\' + this.cid);\n
      return this;\n
    },\n
\n
    // Ensure that the View has a DOM element to render into.\n
    // If `this.el` is a string, pass it through `$()`, take the first\n
    // matching element, and re-assign it to `el`. Otherwise, create\n
    // an element from the `id`, `className` and `tagName` properties.\n
    _ensureElement: function() {\n
      if (!this.el) {\n
        var attrs = _.extend({}, _.result(this, \'attributes\'));\n
        if (this.id) attrs.id = _.result(this, \'id\');\n
        if (this.className) attrs[\'class\'] = _.result(this, \'className\');\n
        var $el = Backbone.$(\'<\' + _.result(this, \'tagName\') + \'>\').attr(attrs);\n
        this.setElement($el, false);\n
      } else {\n
        this.setElement(_.result(this, \'el\'), false);\n
      }\n
    }\n
\n
  });\n
\n
  // Backbone.sync\n
  // -------------\n
\n
  // Override this function to change the manner in which Backbone persists\n
  // models to the server. You will be passed the type of request, and the\n
  // model in question. By default, makes a RESTful Ajax request\n
  // to the model\'s `url()`. Some possible customizations could be:\n
  //\n
  // * Use `setTimeout` to batch rapid-fire updates into a single request.\n
  // * Send up the models as XML instead of JSON.\n
  // * Persist models via WebSockets instead of Ajax.\n
  //\n
  // Turn on `Backbone.emulateHTTP` in order to send `PUT` and `DELETE` requests\n
  // as `POST`, with a `_method` parameter containing the true HTTP method,\n
  // as well as all requests with the body as `application/x-www-form-urlencoded`\n
  // instead of `application/json` with the model in a param named `model`.\n
  // Useful when interfacing with server-side languages like **PHP** that make\n
  // it difficult to read the body of `PUT` requests.\n
  Backbone.sync = function(method, model, options) {\n
    var type = methodMap[method];\n
\n
    // Default options, unless specified.\n
    _.defaults(options || (options = {}), {\n
      emulateHTTP: Backbone.emulateHTTP,\n
      emulateJSON: Backbone.emulateJSON\n
    });\n
\n
    // Default JSON-request options.\n
    var params = {type: type, dataType: \'json\'};\n
\n
    // Ensure that we have a URL.\n
    if (!options.url) {\n
      params.url = _.result(model, \'url\') || urlError();\n
    }\n
\n
    // Ensure that we have the appropriate request data.\n
    if (options.data == null && model && (method === \'create\' || method === \'update\' || method === \'patch\')) {\n
      params.contentType = \'application/json\';\n
      params.data = JSON.stringify(options.attrs || model.toJSON(options));\n
    }\n
\n
    // For older servers, emulate JSON by encoding the request into an HTML-form.\n
    if (options.emulateJSON) {\n
      params.contentType = \'application/x-www-form-urlencoded\';\n
      params.data = params.data ? {model: params.data} : {};\n
    }\n
\n
    // For older servers, emulate HTTP by mimicking the HTTP method with `_method`\n
    // And an `X-HTTP-Method-Override` header.\n
    if (options.emulateHTTP && (type === \'PUT\' || type === \'DELETE\' || type === \'PATCH\')) {\n
      params.type = \'POST\';\n
      if (options.emulateJSON) params.data._method = type;\n
      var beforeSend = options.beforeSend;\n
      options.beforeSend = function(xhr) {\n
        xhr.setRequestHeader(\'X-HTTP-Method-Override\', type);\n
        if (beforeSend) return beforeSend.apply(this, arguments);\n
      };\n
    }\n
\n
    // Don\'t process data on a non-GET request.\n
    if (params.type !== \'GET\' && !options.emulateJSON) {\n
      params.processData = false;\n
    }\n
\n
    // If we\'re sending a `PATCH` request, and we\'re in an old Internet Explorer\n
    // that still has ActiveX enabled by default, override jQuery to use that\n
    // for XHR instead. Remove this line when jQuery supports `PATCH` on IE8.\n
    if (params.type === \'PATCH\' && noXhrPatch) {\n
      params.xhr = function() {\n
        return new ActiveXObject("Microsoft.XMLHTTP");\n
      };\n
    }\n
\n
    // Make the request, allowing the user to override any Ajax options.\n
    var xhr = options.xhr = Backbone.ajax(_.extend(params, options));\n
    model.trigger(\'request\', model, xhr, options);\n
    return xhr;\n
  };\n
\n
  var noXhrPatch = typeof window !== \'undefined\' && !!window.ActiveXObject && !(window.XMLHttpRequest && (new XMLHttpRequest).dispatchEvent);\n
\n
  // Map from CRUD to HTTP for our default `Backbone.sync` implementation.\n
  var methodMap = {\n
    \'create\': \'POST\',\n
    \'update\': \'PUT\',\n
    \'patch\':  \'PATCH\',\n
    \'delete\': \'DELETE\',\n
    \'read\':   \'GET\'\n
  };\n
\n
  // Set the default implementation of `Backbone.ajax` to proxy through to `$`.\n
  // Override this if you\'d like to use a different library.\n
  Backbone.ajax = function() {\n
    return Backbone.$.ajax.apply(Backbone.$, arguments);\n
  };\n
\n
  // Backbone.Router\n
  // ---------------\n
\n
  // Routers map faux-URLs to actions, and fire events when routes are\n
  // matched. Creating a new one sets its `routes` hash, if not set statically.\n
  var Router = Backbone.Router = function(options) {\n
    options || (options = {});\n
    if (options.routes) this.routes = options.routes;\n
    this._bindRoutes();\n
    this.initialize.apply(this, arguments);\n
  };\n
\n
  // Cached regular expressions for matching named param parts and splatted\n
  // parts of route strings.\n
  var optionalParam = /\\((.*?)\\)/g;\n
  var namedParam    = /(\\(\\?)?:\\w+/g;\n
  var splatParam    = /\\*\\w+/g;\n
  var escapeRegExp  = /[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;\n
\n
  // Set up all inheritable **Backbone.Router** properties and methods.\n
  _.extend(Router.prototype, Events, {\n
\n
    // Initialize is an empty function by default. Override it with your own\n
    // initialization logic.\n
    initialize: function(){},\n
\n
    // Manually bind a single named route to a callback. For example:\n
    //\n
    //     this.route(\'search/:query/p:num\', \'search\', function(query, num) {\n
    //       ...\n
    //     });\n
    //\n
    route: function(route, name, callback) {\n
      if (!_.isRegExp(route)) route = this._routeToRegExp(route);\n
      if (_.isFunction(name)) {\n
        callback = name;\n
        name = \'\';\n
      }\n
      if (!callback) callback = this[name];\n
      var router = this;\n
      Backbone.history.route(route, function(fragment) {\n
        var args = router._extractParameters(route, fragment);\n
        callback && callback.apply(router, args);\n
        router.trigger.apply(router, [\'route:\' + name].concat(args));\n
        router.trigger(\'route\', name, args);\n
        Backbone.history.trigger(\'route\', router, name, args);\n
      });\n
      return this;\n
    },\n
\n
    // Simple proxy to `Backbone.history` to save a fragment into the history.\n
    navigate: function(fragment, options) {\n
      Backbone.history.navigate(fragment, options);\n
      return this;\n
    },\n
\n
    // Bind all defined routes to `Backbone.history`. We have to reverse the\n
    // order of the routes here to support behavior where the most general\n
    // routes can be defined at the bottom of the route map.\n
    _bindRoutes: function() {\n
      if (!this.routes) return;\n
      this.routes = _.result(this, \'routes\');\n
      var route, routes = _.keys(this.routes);\n
      while ((route = routes.pop()) != null) {\n
        this.route(route, this.routes[route]);\n
      }\n
    },\n
\n
    // Convert a route string into a regular expression, suitable for matching\n
    // against the current location hash.\n
    _routeToRegExp: function(route) {\n
      route = route.replace(escapeRegExp, \'\\\\$&\')\n
                   .replace(optionalParam, \'(?:$1)?\')\n
                   .replace(namedParam, function(match, optional) {\n
                     return optional ? match : \'([^\\/]+)\';\n
                   })\n
                   .replace(splatParam, \'(.*?)\');\n
      return new RegExp(\'^\' + route + \'$\');\n
    },\n
\n
    // Given a route, and a URL fragment that it matches, return the array of\n
    // extracted decoded parameters. Empty or unmatched parameters will be\n
    // treated as `null` to normalize cross-browser behavior.\n
    _extractParameters: function(route, fragment) {\n
      var params = route.exec(fragment).slice(1);\n
      return _.map(params, function(param) {\n
        return param ? decodeURIComponent(param) : null;\n
      });\n
    }\n
\n
  });\n
\n
  // Backbone.History\n
  // ----------------\n
\n
  // Handles cross-browser history management, based on either\n
  // [pushState](http://diveintohtml5.info/history.html) and real URLs, or\n
  // [onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)\n
  // and URL fragments. If the browser supports neither (old IE, natch),\n
  // falls back to polling.\n
  var History = Backbone.History = function() {\n
    this.handlers = [];\n
    _.bindAll(this, \'checkUrl\');\n
\n
    // Ensure that `History` can be used outside of the browser.\n
    if (typeof window !== \'undefined\') {\n
      this.location = window.location;\n
      this.history = window.history;\n
    }\n
  };\n
\n
  // Cached regex for stripping a leading hash/slash and trailing space.\n
  var routeStripper = /^[#\\/]|\\s+$/g;\n
\n
  // Cached regex for stripping leading and trailing slashes.\n
  var rootStripper = /^\\/+|\\/+$/g;\n
\n
  // Cached regex for detecting MSIE.\n
  var isExplorer = /msie [\\w.]+/;\n
\n
  // Cached regex for removing a trailing slash.\n
  var trailingSlash = /\\/$/;\n
\n
  // Cached regex for stripping urls of hash and query.\n
  var pathStripper = /[?#].*$/;\n
\n
  // Has the history handling already been started?\n
  History.started = false;\n
\n
  // Set up all inheritable **Backbone.History** properties and methods.\n
  _.extend(History.prototype, Events, {\n
\n
    // The default interval to poll for hash changes, if necessary, is\n
    // twenty times a second.\n
    interval: 50,\n
\n
    // Gets the true hash value. Cannot use location.hash directly due to bug\n
    // in Firefox where location.hash will always be decoded.\n
    getHash: function(window) {\n
      var match = (window || this).location.href.match(/#(.*)$/);\n
      return match ? match[1] : \'\';\n
    },\n
\n
    // Get the cross-browser normalized URL fragment, either from the URL,\n
    // the hash, or the override.\n
    getFragment: function(fragment, forcePushState) {\n
      if (fragment == null) {\n
        if (this._hasPushState || !this._wantsHashChange || forcePushState) {\n
          fragment = this.location.pathname;\n
          var root = this.root.replace(trailingSlash, \'\');\n
          if (!fragment.indexOf(root)) fragment = fragment.slice(root.length);\n
        } else {\n
          fragment = this.getHash();\n
        }\n
      }\n
      return fragment.replace(routeStripper, \'\');\n
    },\n
\n
    // Start the hash change handling, returning `true` if the current URL matches\n
    // an existing route, and `false` otherwise.\n
    start: function(options) {\n
      if (History.started) throw new Error("Backbone.history has already been started");\n
      History.started = true;\n
\n
      // Figure out the initial configuration. Do we need an iframe?\n
      // Is pushState desired ... is it available?\n
      this.options          = _.extend({root: \'/\'}, this.options, options);\n
      this.root             = this.options.root;\n
      this._wantsHashChange = this.options.hashChange !== false;\n
      this._wantsPushState  = !!this.options.pushState;\n
      this._hasPushState    = !!(this.options.pushState && this.history && this.history.pushState);\n
      var fragment          = this.getFragment();\n
      var docMode           = document.documentMode;\n
      var oldIE             = (isExplorer.exec(navigator.userAgent.toLowerCase()) && (!docMode || docMode <= 7));\n
\n
      // Normalize root to always include a leading and trailing slash.\n
      this.root = (\'/\' + this.root + \'/\').replace(rootStripper, \'/\');\n
\n
      if (oldIE && this._wantsHashChange) {\n
        this.iframe = Backbone.$(\'<iframe src="javascript:0" tabindex="-1" />\').hide().appendTo(\'body\')[0].contentWindow;\n
        this.navigate(fragment);\n
      }\n
\n
      // Depending on whether we\'re using pushState or hashes, and whether\n
      // \'onhashchange\' is supported, determine how we check the URL state.\n
      if (this._hasPushState) {\n
        Backbone.$(window).on(\'popstate\', this.checkUrl);\n
      } else if (this._wantsHashChange && (\'onhashchange\' in window) && !oldIE) {\n
        Backbone.$(window).on(\'hashchange\', this.checkUrl);\n
      } else if (this._wantsHashChange) {\n
        this._checkUrlInterval = setInterval(this.checkUrl, this.interval);\n
      }\n
\n
      // Determine if we need to change the base url, for a pushState link\n
      // opened by a non-pushState browser.\n
      this.fragment = fragment;\n
      var loc = this.location;\n
      var atRoot = loc.pathname.replace(/[^\\/]$/, \'$&/\') === this.root;\n
\n
      // Transition from hashChange to pushState or vice versa if both are\n
      // requested.\n
      if (this._wantsHashChange && this._wantsPushState) {\n
\n
        // If we\'ve started off with a route from a `pushState`-enabled\n
        // browser, but we\'re currently in a browser that doesn\'t support it...\n
        if (!this._hasPushState && !atRoot) {\n
          this.fragment = this.getFragment(null, true);\n
          this.location.replace(this.root + this.location.search + \'#\' + this.fragment);\n
          // Return immediately as browser will do redirect to new url\n
          return true;\n
\n
        // Or if we\'ve started out with a hash-based route, but we\'re currently\n
        // in a browser where it could be `pushState`-based instead...\n
        } else if (this._hasPushState && atRoot && loc.hash) {\n
          this.fragment = this.getHash().replace(routeStripper, \'\');\n
          this.history.replaceState({}, document.title, this.root + this.fragment + loc.search);\n
        }\n
\n
      }\n
\n
      if (!this.options.silent) return this.loadUrl();\n
    },\n
\n
    // Disable Backbone.history, perhaps temporarily. Not useful in a real app,\n
    // but possibly useful for unit testing Routers.\n
    stop: function() {\n
      Backbone.$(window).off(\'popstate\', this.checkUrl).off(\'hashchange\', this.checkUrl);\n
      clearInterval(this._checkUrlInterval);\n
      History.started = false;\n
    },\n
\n
    // Add a route to be tested when the fragment changes. Routes added later\n
    // may override previous routes.\n
    route: function(route, callback) {\n
      this.handlers.unshift({route: route, callback: callback});\n
    },\n
\n
    // Checks the current URL to see if it has changed, and if it has,\n
    // calls `loadUrl`, normalizing across the hidden iframe.\n
    checkUrl: function(e) {\n
      var current = this.getFragment();\n
      if (current === this.fragment && this.iframe) {\n
        current = this.getFragment(this.getHash(this.iframe));\n
      }\n
      if (current === this.fragment) return false;\n
      if (this.iframe) this.navigate(current);\n
      this.loadUrl();\n
    },\n
\n
    // Attempt to load the current URL fragment. If a route succeeds with a\n
    // match, returns `true`. If no defined routes matches the fragment,\n
    // returns `false`.\n
    loadUrl: function(fragment) {\n
      fragment = this.fragment = this.getFragment(fragment);\n
      return _.any(this.handlers, function(handler) {\n
        if (handler.route.test(fragment)) {\n
          handler.callback(fragment);\n
          return true;\n
        }\n
      });\n
    },\n
\n
    // Save a fragment into the hash history, or replace the URL state if the\n
    // \'replace\' option is passed. You are responsible for properly URL-encoding\n
    // the fragment in advance.\n
    //\n
    // The options object can contain `trigger: true` if you wish to have the\n
    // route callback be fired (not usually desirable), or `replace: true`, if\n
    // you wish to modify the current URL without adding an entry to the history.\n
    navigate: function(fragment, options) {\n
      if (!History.started) return false;\n
      if (!options || options === true) options = {trigger: !!options};\n
\n
      var url = this.root + (fragment = this.getFragment(fragment || \'\'));\n
\n
      // Strip the fragment of the query and hash for matching.\n
      fragment = fragment.replace(pathStripper, \'\');\n
\n
      if (this.fragment === fragment) return;\n
      this.fragment = fragment;\n
\n
      // Don\'t include a trailing slash on the root.\n
      if (fragment === \'\' && url !== \'/\') url = url.slice(0, -1);\n
\n
      // If pushState is available, we use it to set the fragment as a real URL.\n
      if (this._hasPushState) {\n
        this.history[options.replace ? \'replaceState\' : \'pushState\']({}, document.title, url);\n
\n
      // If hash changes haven\'t been explicitly disabled, update the hash\n
      // fragment to store history.\n
      } else if (this._wantsHashChange) {\n
        this._updateHash(this.location, fragment, options.replace);\n
        if (this.iframe && (fragment !== this.getFragment(this.getHash(this.iframe)))) {\n
          // Opening and closing the iframe tricks IE7 and earlier to push a\n
          // history entry on hash-tag change.  When replace is true, we don\'t\n
          // want this.\n
          if(!options.replace) this.iframe.document.open().close();\n
          this._updateHash(this.iframe.location, fragment, options.replace);\n
        }\n
\n
      // If you\'ve told us that you explicitly don\'t want fallback hashchange-\n
      // based history, then `navigate` becomes a page refresh.\n
      } else {\n
        return this.location.assign(url);\n
      }\n
      if (options.trigger) return this.loadUrl(fragment);\n
    },\n
\n
    // Update the hash location, either replacing the current entry, or adding\n
    // a new one to the browser history.\n
    _updateHash: function(location, fragment, replace) {\n
      if (replace) {\n
        var href = location.href.replace(/(javascript:|#).*$/, \'\');\n
        location.replace(href + \'#\' + fragment);\n
      } else {\n
        // Some browsers require that `hash` contains a leading #.\n
        location.hash = \'#\' + fragment;\n
      }\n
    }\n
\n
  });\n
\n
  // Create the default Backbone.history.\n
  Backbone.history = new History;\n
\n
  // Helpers\n
  // -------\n
\n
  // Helper function to correctly set up the prototype chain, for subclasses.\n
  // Similar to `goog.inherits`, but uses a hash of prototype properties and\n
  // class properties to be extended.\n
  var extend = function(protoProps, staticProps) {\n
    var parent = this;\n
    var child;\n
\n
    // The constructor function for the new subclass is either defined by you\n
    // (the "constructor" property in your `extend` definition), or defaulted\n
    // by us to simply call the parent\'s constructor.\n
    if (protoProps && _.has(protoProps, \'constructor\')) {\n
      child = protoProps.constructor;\n
    } else {\n
      child = function(){ return parent.apply(this, arguments); };\n
    }\n
\n
    // Add static properties to the constructor function, if supplied.\n
    _.extend(child, parent, staticProps);\n
\n
    // Set the prototype chain to inherit from `parent`, without calling\n
    // `parent`\'s constructor function.\n
    var Surrogate = function(){ this.constructor = child; };\n
    Surrogate.prototype = parent.prototype;\n
    child.prototype = new Surrogate;\n
\n
    // Add prototype properties (instance properties) to the subclass,\n
    // if supplied.\n
    if (protoProps) _.extend(child.prototype, protoProps);\n
\n
    // Set a convenience property in case the parent\'s prototype is needed\n
    // later.\n
    child.__super__ = parent.prototype;\n
\n
    return child;\n
  };\n
\n
  // Set up inheritance for the model, collection, router, view and history.\n
  Model.extend = Collection.extend = Router.extend = View.extend = History.extend = extend;\n
\n
  // Throw an error when a URL is needed, and none is supplied.\n
  var urlError = function() {\n
    throw new Error(\'A "url" property or function must be specified\');\n
  };\n
\n
  // Wrap an optional error callback with a fallback error event.\n
  var wrapError = function(model, options) {\n
    var error = options.error;\n
    options.error = function(resp) {\n
      if (error) error(model, resp, options);\n
      model.trigger(\'error\', model, resp, options);\n
    };\n
  };\n
\n
}).call(this);\n
\n
define("backbone", ["underscore","jquery"], (function (global) {\n
    return function () {\n
        var ret, fn;\n
        return ret || global.Backbone;\n
    };\n
}(this)));\n
\n
/*!\n
 * Bootstrap v3.0.3 (http://getbootstrap.com)\n
 * Copyright 2013 Twitter, Inc.\n
 * Licensed under http://www.apache.org/licenses/LICENSE-2.0\n
 */\n
\n
if (typeof jQuery === "undefined") { throw new Error("Bootstrap requires jQuery") }\n
\n
/* ========================================================================\n
 * Bootstrap: transition.js v3.0.3\n
 * http://getbootstrap.com/javascript/#transitions\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)\n
  // ============================================================\n
\n
  function transitionEnd() {\n
    var el = document.createElement(\'bootstrap\')\n
\n
    var transEndEventNames = {\n
      \'WebkitTransition\' : \'webkitTransitionEnd\'\n
    , \'MozTransition\'    : \'transitionend\'\n
    , \'OTransition\'      : \'oTransitionEnd otransitionend\'\n
    , \'transition\'       : \'transitionend\'\n
    }\n
\n
    for (var name in transEndEventNames) {\n
      if (el.style[name] !== undefined) {\n
        return { end: transEndEventNames[name] }\n
      }\n
    }\n
  }\n
\n
  // http://blog.alexmaccaw.com/css-transitions\n
  $.fn.emulateTransitionEnd = function (duration) {\n
    var called = false, $el = this\n
    $(this).one($.support.transition.end, function () { called = true })\n
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }\n
    setTimeout(callback, duration)\n
    return this\n
  }\n
\n
  $(function () {\n
    $.support.transition = transitionEnd()\n
  })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: alert.js v3.0.3\n
 * http://getbootstrap.com/javascript/#alerts\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // ALERT CLASS DEFINITION\n
  // ======================\n
\n
  var dismiss = \'[data-dismiss="alert"]\'\n
  var Alert   = function (el) {\n
    $(el).on(\'click\', dismiss, this.close)\n
  }\n
\n
  Alert.prototype.close = function (e) {\n
    var $this    = $(this)\n
    var selector = $this.attr(\'data-target\')\n
\n
    if (!selector) {\n
      selector = $this.attr(\'href\')\n
      selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, \'\') // strip for ie7\n
    }\n
\n
    var $parent = $(selector)\n
\n
    if (e) e.preventDefault()\n
\n
    if (!$parent.length) {\n
      $parent = $this.hasClass(\'alert\') ? $this : $this.parent()\n
    }\n
\n
    $parent.trigger(e = $.Event(\'close.bs.alert\'))\n
\n
    if (e.isDefaultPrevented()) return\n
\n
    $parent.removeClass(\'in\')\n
\n
    function removeElement() {\n
      $parent.trigger(\'closed.bs.alert\').remove()\n
    }\n
\n
    $.support.transition && $parent.hasClass(\'fade\') ?\n
      $parent\n
        .one($.support.transition.end, removeElement)\n
        .emulateTransitionEnd(150) :\n
      removeElement()\n
  }\n
\n
\n
  // ALERT PLUGIN DEFINITION\n
  // =======================\n
\n
  var old = $.fn.alert\n
\n
  $.fn.alert = function (option) {\n
    return this.each(function () {\n
      var $this = $(this)\n
      var data  = $this.data(\'bs.alert\')\n
\n
      if (!data) $this.data(\'bs.alert\', (data = new Alert(this)))\n
      if (typeof option == \'string\') data[option].call($this)\n
    })\n
  }\n
\n
  $.fn.alert.Constructor = Alert\n
\n
\n
  // ALERT NO CONFLICT\n
  // =================\n
\n
  $.fn.alert.noConflict = function () {\n
    $.fn.alert = old\n
    return this\n
  }\n
\n
\n
  // ALERT DATA-API\n
  // ==============\n
\n
  $(document).on(\'click.bs.alert.data-api\', dismiss, Alert.prototype.close)\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: button.js v3.0.3\n
 * http://getbootstrap.com/javascript/#buttons\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // BUTTON PUBLIC CLASS DEFINITION\n
  // ==============================\n
\n
  var Button = function (element, options) {\n
    this.$element = $(element)\n
    this.options  = $.extend({}, Button.DEFAULTS, options)\n
  }\n
\n
  Button.DEFAULTS = {\n
    loadingText: \'loading...\'\n
  }\n
\n
  Button.prototype.setState = function (state) {\n
    var d    = \'disabled\'\n
    var $el  = this.$element\n
    var val  = $el.is(\'input\') ? \'val\' : \'html\'\n
    var data = $el.data()\n
\n
    state = state + \'Text\'\n
\n
    if (!data.resetText) $el.data(\'resetText\', $el[val]())\n
\n
    $el[val](data[state] || this.options[state])\n
\n
    // push to event loop to allow forms to submit\n
    setTimeout(function () {\n
      state == \'loadingText\' ?\n
        $el.addClass(d).attr(d, d) :\n
        $el.removeClass(d).removeAttr(d);\n
    }, 0)\n
  }\n
\n
  Button.prototype.toggle = function () {\n
    var $parent = this.$element.closest(\'[data-toggle="buttons"]\')\n
    var changed = true\n
\n
    if ($parent.length) {\n
      var $input = this.$element.find(\'input\')\n
      if ($input.prop(\'type\') === \'radio\') {\n
        // see if clicking on current one\n
        if ($input.prop(\'checked\') && this.$element.hasClass(\'active\'))\n
          changed = false\n
        else\n
          $parent.find(\'.active\').removeClass(\'active\')\n
      }\n
      if (changed) $input.prop(\'checked\', !this.$element.hasClass(\'active\')).trigger(\'change\')\n
    }\n
\n
    if (changed) this.$element.toggleClass(\'active\')\n
  }\n
\n
\n
  // BUTTON PLUGIN DEFINITION\n
  // ========================\n
\n
  var old = $.fn.button\n
\n
  $.fn.button = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.button\')\n
      var options = typeof option == \'object\' && option\n
\n
      if (!data) $this.data(\'bs.button\', (data = new Button(this, options)))\n
\n
      if (option == \'toggle\') data.toggle()\n
      else if (option) data.setState(option)\n
    })\n
  }\n
\n
  $.fn.button.Constructor = Button\n
\n
\n
  // BUTTON NO CONFLICT\n
  // ==================\n
\n
  $.fn.button.noConflict = function () {\n
    $.fn.button = old\n
    return this\n
  }\n
\n
\n
  // BUTTON DATA-API\n
  // ===============\n
\n
  $(document).on(\'click.bs.button.data-api\', \'[data-toggle^=button]\', function (e) {\n
    var $btn = $(e.target)\n
    if (!$btn.hasClass(\'btn\')) $btn = $btn.closest(\'.btn\')\n
    $btn.button(\'toggle\')\n
    e.preventDefault()\n
  })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: carousel.js v3.0.3\n
 * http://getbootstrap.com/javascript/#carousel\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // CAROUSEL CLASS DEFINITION\n
  // =========================\n
\n
  var Carousel = function (element, options) {\n
    this.$element    = $(element)\n
    this.$indicators = this.$element.find(\'.carousel-indicators\')\n
    this.options     = options\n
    this.paused      =\n
    this.sliding     =\n
    this.interval    =\n
    this.$active     =\n
    this.$items      = null\n
\n
    this.options.pause == \'hover\' && this.$element\n
      .on(\'mouseenter\', $.proxy(this.pause, this))\n
      .on(\'mouseleave\', $.proxy(this.cycle, this))\n
  }\n
\n
  Carousel.DEFAULTS = {\n
    interval: 5000\n
  , pause: \'hover\'\n
  , wrap: true\n
  }\n
\n
  Carousel.prototype.cycle =  function (e) {\n
    e || (this.paused = false)\n
\n
    this.interval && clearInterval(this.interval)\n
\n
    this.options.interval\n
      && !this.paused\n
      && (this.interval = setInterval($.proxy(this.next, this), this.options.interval))\n
\n
    return this\n
  }\n
\n
  Carousel.prototype.getActiveIndex = function () {\n
    this.$active = this.$element.find(\'.item.active\')\n
    this.$items  = this.$active.parent().children()\n
\n
    return this.$items.index(this.$active)\n
  }\n
\n
  Carousel.prototype.to = function (pos) {\n
    var that        = this\n
    var activeIndex = this.getActiveIndex()\n
\n
    if (pos > (this.$items.length - 1) || pos < 0) return\n
\n
    if (this.sliding)       return this.$element.one(\'slid.bs.carousel\', function () { that.to(pos) })\n
    if (activeIndex == pos) return this.pause().cycle()\n
\n
    return this.slide(pos > activeIndex ? \'next\' : \'prev\', $(this.$items[pos]))\n
  }\n
\n
  Carousel.prototype.pause = function (e) {\n
    e || (this.paused = true)\n
\n
    if (this.$element.find(\'.next, .prev\').length && $.support.transition.end) {\n
      this.$element.trigger($.support.transition.end)\n
      this.cycle(true)\n
    }\n
\n
    this.interval = clearInterval(this.interval)\n
\n
    return this\n
  }\n
\n
  Carousel.prototype.next = function () {\n
    if (this.sliding) return\n
    return this.slide(\'next\')\n
  }\n
\n
  Carousel.prototype.prev = function () {\n
    if (this.sliding) return\n
    return this.slide(\'prev\')\n
  }\n
\n
  Carousel.prototype.slide = function (type, next) {\n
    var $active   = this.$element.find(\'.item.active\')\n
    var $next     = next || $active[type]()\n
    var isCycling = this.interval\n
    var direction = type == \'next\' ? \'left\' : \'right\'\n
    var fallback  = type == \'next\' ? \'first\' : \'last\'\n
    var that      = this\n
\n
    if (!$next.length) {\n
      if (!this.options.wrap) return\n
      $next = this.$element.find(\'.item\')[fallback]()\n
    }\n
\n
    this.sliding = true\n
\n
    isCycling && this.pause()\n
\n
    var e = $.Event(\'slide.bs.carousel\', { relatedTarget: $next[0], direction: direction })\n
\n
    if ($next.hasClass(\'active\')) return\n
\n
    if (this.$indicators.length) {\n
      this.$indicators.find(\'.active\').removeClass(\'active\')\n
      this.$element.one(\'slid.bs.carousel\', function () {\n
        var $nextIndicator = $(that.$indicators.children()[that.getActiveIndex()])\n
        $nextIndicator && $nextIndicator.addClass(\'active\')\n
      })\n
    }\n
\n
    if ($.support.transition && this.$element.hasClass(\'slide\')) {\n
      this.$element.trigger(e)\n
      if (e.isDefaultPrevented()) return\n
      $next.addClass(type)\n
      $next[0].offsetWidth // force reflow\n
      $active.addClass(direction)\n
      $next.addClass(direction)\n
      $active\n
        .one($.support.transition.end, function () {\n
          $next.removeClass([type, direction].join(\' \')).addClass(\'active\')\n
          $active.removeClass([\'active\', direction].join(\' \'))\n
          that.sliding = false\n
          setTimeout(function () { that.$element.trigger(\'slid.bs.carousel\') }, 0)\n
        })\n
        .emulateTransitionEnd(600)\n
    } else {\n
      this.$element.trigger(e)\n
      if (e.isDefaultPrevented()) return\n
      $active.removeClass(\'active\')\n
      $next.addClass(\'active\')\n
      this.sliding = false\n
      this.$element.trigger(\'slid.bs.carousel\')\n
    }\n
\n
    isCycling && this.cycle()\n
\n
    return this\n
  }\n
\n
\n
  // CAROUSEL PLUGIN DEFINITION\n
  // ==========================\n
\n
  var old = $.fn.carousel\n
\n
  $.fn.carousel = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.carousel\')\n
      var options = $.extend({}, Carousel.DEFAULTS, $this.data(), typeof option == \'object\' && option)\n
      var action  = typeof option == \'string\' ? option : options.slide\n
\n
      if (!data) $this.data(\'bs.carousel\', (data = new Carousel(this, options)))\n
      if (typeof option == \'number\') data.to(option)\n
      else if (action) data[action]()\n
      else if (options.interval) data.pause().cycle()\n
    })\n
  }\n
\n
  $.fn.carousel.Constructor = Carousel\n
\n
\n
  // CAROUSEL NO CONFLICT\n
  // ====================\n
\n
  $.fn.carousel.noConflict = function () {\n
    $.fn.carousel = old\n
    return this\n
  }\n
\n
\n
  // CAROUSEL DATA-API\n
  // =================\n
\n
  $(document).on(\'click.bs.carousel.data-api\', \'[data-slide], [data-slide-to]\', function (e) {\n
    var $this   = $(this), href\n
    var $target = $($this.attr(\'data-target\') || (href = $this.attr(\'href\')) && href.replace(/.*(?=#[^\\s]+$)/, \'\')) //strip for ie7\n
    var options = $.extend({}, $target.data(), $this.data())\n
    var slideIndex = $this.attr(\'data-slide-to\')\n
    if (slideIndex) options.interval = false\n
\n
    $target.carousel(options)\n
\n
    if (slideIndex = $this.attr(\'data-slide-to\')) {\n
      $target.data(\'bs.carousel\').to(slideIndex)\n
    }\n
\n
    e.preventDefault()\n
  })\n
\n
  $(window).on(\'load\', function () {\n
    $(\'[data-ride="carousel"]\').each(function () {\n
      var $carousel = $(this)\n
      $carousel.carousel($carousel.data())\n
    })\n
  })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: collapse.js v3.0.3\n
 * http://getbootstrap.com/javascript/#collapse\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // COLLAPSE PUBLIC CLASS DEFINITION\n
  // ================================\n
\n
  var Collapse = function (element, options) {\n
    this.$element      = $(element)\n
    this.options       = $.extend({}, Collapse.DEFAULTS, options)\n
    this.transitioning = null\n
\n
    if (this.options.parent) this.$parent = $(this.options.parent)\n
    if (this.options.toggle) this.toggle()\n
  }\n
\n
  Collapse.DEFAULTS = {\n
    toggle: true\n
  }\n
\n
  Collapse.prototype.dimension = function () {\n
    var hasWidth = this.$element.hasClass(\'width\')\n
    return hasWidth ? \'width\' : \'height\'\n
  }\n
\n
  Collapse.prototype.show = function () {\n
    if (this.transitioning || this.$element.hasClass(\'in\')) return\n
\n
    var startEvent = $.Event(\'show.bs.collapse\')\n
    this.$element.trigger(startEvent)\n
    if (startEvent.isDefaultPrevented()) return\n
\n
    var actives = this.$parent && this.$parent.find(\'> .panel > .in\')\n
\n
    if (actives && actives.length) {\n
      var hasData = actives.data(\'bs.collapse\')\n
      if (hasData && hasData.transitioning) return\n
      actives.collapse(\'hide\')\n
      hasData || actives.data(\'bs.collapse\', null)\n
    }\n
\n
    var dimension = this.dimension()\n
\n
    this.$element\n
      .removeClass(\'collapse\')\n
      .addClass(\'collapsing\')\n
      [dimension](0)\n
\n
    this.transitioning = 1\n
\n
    var complete = function () {\n
      this.$element\n
        .removeClass(\'collapsing\')\n
        .addClass(\'in\')\n
        [dimension](\'auto\')\n
      this.transitioning = 0\n
      this.$element.trigger(\'shown.bs.collapse\')\n
    }\n
\n
    if (!$.support.transition) return complete.call(this)\n
\n
    var scrollSize = $.camelCase([\'scroll\', dimension].join(\'-\'))\n
\n
    this.$element\n
      .one($.support.transition.end, $.proxy(complete, this))\n
      .emulateTransitionEnd(350)\n
      [dimension](this.$element[0][scrollSize])\n
  }\n
\n
  Collapse.prototype.hide = function () {\n
    if (this.transitioning || !this.$element.hasClass(\'in\')) return\n
\n
    var startEvent = $.Event(\'hide.bs.collapse\')\n
    this.$element.trigger(startEvent)\n
    if (startEvent.isDefaultPrevented()) return\n
\n
    var dimension = this.dimension()\n
\n
    this.$element\n
      [dimension](this.$element[dimension]())\n
      [0].offsetHeight\n
\n
    this.$element\n
      .addClass(\'collapsing\')\n
      .removeClass(\'collapse\')\n
      .removeClass(\'in\')\n
\n
    this.transitioning = 1\n
\n
    var complete = function () {\n
      this.transitioning = 0\n
      this.$element\n
        .trigger(\'hidden.bs.collapse\')\n
        .removeClass(\'collapsing\')\n
        .addClass(\'collapse\')\n
    }\n
\n
    if (!$.support.transition) return complete.call(this)\n
\n
    this.$element\n
      [dimension](0)\n
      .one($.support.transition.end, $.proxy(complete, this))\n
      .emulateTransitionEnd(350)\n
  }\n
\n
  Collapse.prototype.toggle = function () {\n
    this[this.$element.hasClass(\'in\') ? \'hide\' : \'show\']()\n
  }\n
\n
\n
  // COLLAPSE PLUGIN DEFINITION\n
  // ==========================\n
\n
  var old = $.fn.collapse\n
\n
  $.fn.collapse = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.collapse\')\n
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == \'object\' && option)\n
\n
      if (!data) $this.data(\'bs.collapse\', (data = new Collapse(this, options)))\n
      if (typeof option == \'string\') data[option]()\n
    })\n
  }\n
\n
  $.fn.collapse.Constructor = Collapse\n
\n
\n
  // COLLAPSE NO CONFLICT\n
  // ====================\n
\n
  $.fn.collapse.noConflict = function () {\n
    $.fn.collapse = old\n
    return this\n
  }\n
\n
\n
  // COLLAPSE DATA-API\n
  // =================\n
\n
  $(document).on(\'click.bs.collapse.data-api\', \'[data-toggle=collapse]\', function (e) {\n
    var $this   = $(this), href\n
    var target  = $this.attr(\'data-target\')\n
        || e.preventDefault()\n
        || (href = $this.attr(\'href\')) && href.replace(/.*(?=#[^\\s]+$)/, \'\') //strip for ie7\n
    var $target = $(target)\n
    var data    = $target.data(\'bs.collapse\')\n
    var option  = data ? \'toggle\' : $this.data()\n
    var parent  = $this.attr(\'data-parent\')\n
    var $parent = parent && $(parent)\n
\n
    if (!data || !data.transitioning) {\n
      if ($parent) $parent.find(\'[data-toggle=collapse][data-parent="\' + parent + \'"]\').not($this).addClass(\'collapsed\')\n
      $this[$target.hasClass(\'in\') ? \'addClass\' : \'removeClass\'](\'collapsed\')\n
    }\n
\n
    $target.collapse(option)\n
  })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: dropdown.js v3.0.3\n
 * http://getbootstrap.com/javascript/#dropdowns\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // DROPDOWN CLASS DEFINITION\n
  // =========================\n
\n
  var backdrop = \'.dropdown-backdrop\'\n
  var toggle   = \'[data-toggle=dropdown]\'\n
  var Dropdown = function (element) {\n
    $(element).on(\'click.bs.dropdown\', this.toggle)\n
  }\n
\n
  Dropdown.prototype.toggle = function (e) {\n
    var $this = $(this)\n
\n
    if ($this.is(\'.disabled, :disabled\')) return\n
\n
    var $parent  = getParent($this)\n
    var isActive = $parent.hasClass(\'open\')\n
\n
    clearMenus()\n
\n
    if (!isActive) {\n
      if (\'ontouchstart\' in document.documentElement && !$parent.closest(\'.navbar-nav\').length) {\n
        // if mobile we use a backdrop because click events don\'t delegate\n
        $(\'<div class="dropdown-backdrop"/>\').insertAfter($(this)).on(\'click\', clearMenus)\n
      }\n
\n
      $parent.trigger(e = $.Event(\'show.bs.dropdown\'))\n
\n
      if (e.isDefaultPrevented()) return\n
\n
      $parent\n
        .toggleClass(\'open\')\n
        .trigger(\'shown.bs.dropdown\')\n
\n
      $this.focus()\n
    }\n
\n
    return false\n
  }\n
\n
  Dropdown.prototype.keydown = function (e) {\n
    if (!/(38|40|27)/.test(e.keyCode)) return\n
\n
    var $this = $(this)\n
\n
    e.preventDefault()\n
    e.stopPropagation()\n
\n
    if ($this.is(\'.disabled, :disabled\')) return\n
\n
    var $parent  = getParent($this)\n
    var isActive = $parent.hasClass(\'open\')\n
\n
    if (!isActive || (isActive && e.keyCode == 27)) {\n
      if (e.which == 27) $parent.find(toggle).focus()\n
      return $this.click()\n
    }\n
\n
    var $items = $(\'[role=menu] li:not(.divider):visible a\', $parent)\n
\n
    if (!$items.length) return\n
\n
    var index = $items.index($items.filter(\':focus\'))\n
\n
    if (e.keyCode == 38 && index > 0)                 index--                        // up\n
    if (e.keyCode == 40 && index < $items.length - 1) index++                        // down\n
    if (!~index)                                      index=0\n
\n
    $items.eq(index).focus()\n
  }\n
\n
  function clearMenus() {\n
    $(backdrop).remove()\n
    $(toggle).each(function (e) {\n
      var $parent = getParent($(this))\n
      if (!$parent.hasClass(\'open\')) return\n
      $parent.trigger(e = $.Event(\'hide.bs.dropdown\'))\n
      if (e.isDefaultPrevented()) return\n
      $parent.removeClass(\'open\').trigger(\'hidden.bs.dropdown\')\n
    })\n
  }\n
\n
  function getParent($this) {\n
    var selector = $this.attr(\'data-target\')\n
\n
    if (!selector) {\n
      selector = $this.attr(\'href\')\n
      selector = selector && /#/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, \'\') //strip for ie7\n
    }\n
\n
    var $parent = selector && $(selector)\n
\n
    return $parent && $parent.length ? $parent : $this.parent()\n
  }\n
\n
\n
  // DROPDOWN PLUGIN DEFINITION\n
  // ==========================\n
\n
  var old = $.fn.dropdown\n
\n
  $.fn.dropdown = function (option) {\n
    return this.each(function () {\n
      var $this = $(this)\n
      var data  = $this.data(\'bs.dropdown\')\n
\n
      if (!data) $this.data(\'bs.dropdown\', (data = new Dropdown(this)))\n
      if (typeof option == \'string\') data[option].call($this)\n
    })\n
  }\n
\n
  $.fn.dropdown.Constructor = Dropdown\n
\n
\n
  // DROPDOWN NO CONFLICT\n
  // ====================\n
\n
  $.fn.dropdown.noConflict = function () {\n
    $.fn.dropdown = old\n
    return this\n
  }\n
\n
\n
  // APPLY TO STANDARD DROPDOWN ELEMENTS\n
  // ===================================\n
\n
  $(document)\n
    .on(\'click.bs.dropdown.data-api\', clearMenus)\n
    .on(\'click.bs.dropdown.data-api\', \'.dropdown form\', function (e) { e.stopPropagation() })\n
    .on(\'click.bs.dropdown.data-api\'  , toggle, Dropdown.prototype.toggle)\n
    .on(\'keydown.bs.dropdown.data-api\', toggle + \', [role=menu]\' , Dropdown.prototype.keydown)\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: modal.js v3.0.3\n
 * http://getbootstrap.com/javascript/#modals\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // MODAL CLASS DEFINITION\n
  // ======================\n
\n
  var Modal = function (element, options) {\n
    this.options   = options\n
    this.$element  = $(element)\n
    this.$backdrop =\n
    this.isShown   = null\n
\n
    if (this.options.remote) this.$element.load(this.options.remote)\n
  }\n
\n
  Modal.DEFAULTS = {\n
      backdrop: true\n
    , keyboard: true\n
    , show: true\n
  }\n
\n
  Modal.prototype.toggle = function (_relatedTarget) {\n
    return this[!this.isShown ? \'show\' : \'hide\'](_relatedTarget)\n
  }\n
\n
  Modal.prototype.show = function (_relatedTarget) {\n
    var that = this\n
    var e    = $.Event(\'show.bs.modal\', { relatedTarget: _relatedTarget })\n
\n
    this.$element.trigger(e)\n
\n
    if (this.isShown || e.isDefaultPrevented()) return\n
\n
    this.isShown = true\n
\n
    this.escape()\n
\n
    this.$element.on(\'click.dismiss.modal\', \'[data-dismiss="modal"]\', $.proxy(this.hide, this))\n
\n
    this.backdrop(function () {\n
      var transition = $.support.transition && that.$element.hasClass(\'fade\')\n
\n
      if (!that.$element.parent().length) {\n
        that.$element.appendTo(document.body) // don\'t move modals dom position\n
      }\n
\n
      that.$element.show()\n
\n
      if (transition) {\n
        that.$element[0].offsetWidth // force reflow\n
      }\n
\n
      that.$element\n
        .addClass(\'in\')\n
        .attr(\'aria-hidden\', false)\n
\n
      that.enforceFocus()\n
\n
      var e = $.Event(\'shown.bs.modal\', { relatedTarget: _relatedTarget })\n
\n
      transition ?\n
        that.$element.find(\'.modal-dialog\') // wait for modal to slide in\n
          .one($.support.transition.end, function () {\n
            that.$element.focus().trigger(e)\n
          })\n
          .emulateTransitionEnd(300) :\n
        that.$element.focus().trigger(e)\n
    })\n
  }\n
\n
  Modal.prototype.hide = function (e) {\n
    if (e) e.preventDefault()\n
\n
    e = $.Event(\'hide.bs.modal\')\n
\n
    this.$element.trigger(e)\n
\n
    if (!this.isShown || e.isDefaultPrevented()) return\n
\n
    this.isShown = false\n
\n
    this.escape()\n
\n
    $(document).off(\'focusin.bs.modal\')\n
\n
    this.$element\n
      .removeClass(\'in\')\n
      .attr(\'aria-hidden\', true)\n
      .off(\'click.dismiss.modal\')\n
\n
    $.support.transition && this.$element.hasClass(\'fade\') ?\n
      this.$element\n
        .one($.support.transition.end, $.proxy(this.hideModal, this))\n
        .emulateTransitionEnd(300) :\n
      this.hideModal()\n
  }\n
\n
  Modal.prototype.enforceFocus = function () {\n
    $(document)\n
      .off(\'focusin.bs.modal\') // guard against infinite focus loop\n
      .on(\'focusin.bs.modal\', $.proxy(function (e) {\n
        if (this.$element[0] !== e.target && !this.$element.has(e.target).length) {\n
          this.$element.focus()\n
        }\n
      }, this))\n
  }\n
\n
  Modal.prototype.escape = function () {\n
    if (this.isShown && this.options.keyboard) {\n
      this.$element.on(\'keyup.dismiss.bs.modal\', $.proxy(function (e) {\n
        e.which == 27 && this.hide()\n
      }, this))\n
    } else if (!this.isShown) {\n
      this.$element.off(\'keyup.dismiss.bs.modal\')\n
    }\n
  }\n
\n
  Modal.prototype.hideModal = function () {\n
    var that = this\n
    this.$element.hide()\n
    this.backdrop(function () {\n
      that.removeBackdrop()\n
      that.$element.trigger(\'hidden.bs.modal\')\n
    })\n
  }\n
\n
  Modal.prototype.removeBackdrop = function () {\n
    this.$backdrop && this.$backdrop.remove()\n
    this.$backdrop = null\n
  }\n
\n
  Modal.prototype.backdrop = function (callback) {\n
    var that    = this\n
    var animate = this.$element.hasClass(\'fade\') ? \'fade\' : \'\'\n
\n
    if (this.isShown && this.options.backdrop) {\n
      var doAnimate = $.support.transition && animate\n
\n
      this.$backdrop = $(\'<div class="modal-backdrop \' + animate + \'" />\')\n
        .appendTo(document.body)\n
\n
      this.$element.on(\'click.dismiss.modal\', $.proxy(function (e) {\n
        if (e.target !== e.currentTarget) return\n
        this.options.backdrop == \'static\'\n
          ? this.$element[0].focus.call(this.$element[0])\n
          : this.hide.call(this)\n
      }, this))\n
\n
      if (doAnimate) this.$backdrop[0].offsetWidth // force reflow\n
\n
      this.$backdrop.addClass(\'in\')\n
\n
      if (!callback) return\n
\n
      doAnimate ?\n
        this.$backdrop\n
          .one($.support.transition.end, callback)\n
          .emulateTransitionEnd(150) :\n
        callback()\n
\n
    } else if (!this.isShown && this.$backdrop) {\n
      this.$backdrop.removeClass(\'in\')\n
\n
      $.support.transition && this.$element.hasClass(\'fade\')?\n
        this.$backdrop\n
          .one($.support.transition.end, callback)\n
          .emulateTransitionEnd(150) :\n
        callback()\n
\n
    } else if (callback) {\n
      callback()\n
    }\n
  }\n
\n
\n
  // MODAL PLUGIN DEFINITION\n
  // =======================\n
\n
  var old = $.fn.modal\n
\n
  $.fn.modal = function (option, _relatedTarget) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.modal\')\n
      var options = $.extend({}, Modal.DEFAULTS, $this.data(), typeof option == \'object\' && option)\n
\n
      if (!data) $this.data(\'bs.modal\', (data = new Modal(this, options)))\n
      if (typeof option == \'string\') data[option](_relatedTarget)\n
      else if (options.show) data.show(_relatedTarget)\n
    })\n
  }\n
\n
  $.fn.modal.Constructor = Modal\n
\n
\n
  // MODAL NO CONFLICT\n
  // =================\n
\n
  $.fn.modal.noConflict = function () {\n
    $.fn.modal = old\n
    return this\n
  }\n
\n
\n
  // MODAL DATA-API\n
  // ==============\n
\n
  $(document).on(\'click.bs.modal.data-api\', \'[data-toggle="modal"]\', function (e) {\n
    var $this   = $(this)\n
    var href    = $this.attr(\'href\')\n
    var $target = $($this.attr(\'data-target\') || (href && href.replace(/.*(?=#[^\\s]+$)/, \'\'))) //strip for ie7\n
    var option  = $target.data(\'modal\') ? \'toggle\' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data())\n
\n
    e.preventDefault()\n
\n
    $target\n
      .modal(option, this)\n
      .one(\'hide\', function () {\n
        $this.is(\':visible\') && $this.focus()\n
      })\n
  })\n
\n
  $(document)\n
    .on(\'show.bs.modal\',  \'.modal\', function () { $(document.body).addClass(\'modal-open\') })\n
    .on(\'hidden.bs.modal\', \'.modal\', function () { $(document.body).removeClass(\'modal-open\') })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: tooltip.js v3.0.3\n
 * http://getbootstrap.com/javascript/#tooltip\n
 * Inspired by the original jQuery.tipsy by Jason Frame\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // TOOLTIP PUBLIC CLASS DEFINITION\n
  // ===============================\n
\n
  var Tooltip = function (element, options) {\n
    this.type       =\n
    this.options    =\n
    this.enabled    =\n
    this.timeout    =\n
    this.hoverState =\n
    this.$element   = null\n
\n
    this.init(\'tooltip\', element, options)\n
  }\n
\n
  Tooltip.DEFAULTS = {\n
    animation: true\n
  , placement: \'top\'\n
  , selector: false\n
  , template: \'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>\'\n
  , trigger: \'hover focus\'\n
  , title: \'\'\n
  , delay: 0\n
  , html: false\n
  , container: false\n
  }\n
\n
  Tooltip.prototype.init = function (type, element, options) {\n
    this.enabled  = true\n
    this.type     = type\n
    this.$element = $(element)\n
    this.options  = this.getOptions(options)\n
\n
    var triggers = this.options.trigger.split(\' \')\n
\n
    for (var i = triggers.length; i--;) {\n
      var trigger = triggers[i]\n
\n
      if (trigger == \'click\') {\n
        this.$element.on(\'click.\' + this.type, this.options.selector, $.proxy(this.toggle, this))\n
      } else if (trigger != \'manual\') {\n
        var eventIn  = trigger == \'hover\' ? \'mouseenter\' : \'focus\'\n
        var eventOut = trigger == \'hover\' ? \'mouseleave\' : \'blur\'\n
\n
        this.$element.on(eventIn  + \'.\' + this.type, this.options.selector, $.proxy(this.enter, this))\n
        this.$element.on(eventOut + \'.\' + this.type, this.options.selector, $.proxy(this.leave, this))\n
      }\n
    }\n
\n
    this.options.selector ?\n
      (this._options = $.extend({}, this.options, { trigger: \'manual\', selector: \'\' })) :\n
      this.fixTitle()\n
  }\n
\n
  Tooltip.prototype.getDefaults = function () {\n
    return Tooltip.DEFAULTS\n
  }\n
\n
  Tooltip.prototype.getOptions = function (options) {\n
    options = $.extend({}, this.getDefaults(), this.$element.data(), options)\n
\n
    if (options.delay && typeof options.delay == \'number\') {\n
      options.delay = {\n
        show: options.delay\n
      , hide: options.delay\n
      }\n
    }\n
\n
    return options\n
  }\n
\n
  Tooltip.prototype.getDelegateOptions = function () {\n
    var options  = {}\n
    var defaults = this.getDefaults()\n
\n
    this._options && $.each(this._options, function (key, value) {\n
      if (defaults[key] != value) options[key] = value\n
    })\n
\n
    return options\n
  }\n
\n
  Tooltip.prototype.enter = function (obj) {\n
    var self = obj instanceof this.constructor ?\n
      obj : $(obj.currentTarget)[this.type](this.getDelegateOptions()).data(\'bs.\' + this.type)\n
\n
    clearTimeout(self.timeout)\n
\n
    self.hoverState = \'in\'\n
\n
    if (!self.options.delay || !self.options.delay.show) return self.show()\n
\n
    self.timeout = setTimeout(function () {\n
      if (self.hoverState == \'in\') self.show()\n
    }, self.options.delay.show)\n
  }\n
\n
  Tooltip.prototype.leave = function (obj) {\n
    var self = obj instanceof this.constructor ?\n
      obj : $(obj.currentTarget)[this.type](this.getDelegateOptions()).data(\'bs.\' + this.type)\n
\n
    clearTimeout(self.timeout)\n
\n
    self.hoverState = \'out\'\n
\n
    if (!self.options.delay || !self.options.delay.hide) return self.hide()\n
\n
    self.timeout = setTimeout(function () {\n
      if (self.hoverState == \'out\') self.hide()\n
    }, self.options.delay.hide)\n
  }\n
\n
  Tooltip.prototype.show = function () {\n
    var e = $.Event(\'show.bs.\'+ this.type)\n
\n
    if (this.hasContent() && this.enabled) {\n
      this.$element.trigger(e)\n
\n
      if (e.isDefaultPrevented()) return\n
\n
      var $tip = this.tip()\n
\n
      this.setContent()\n
\n
      if (this.options.animation) $tip.addClass(\'fade\')\n
\n
      var placement = typeof this.options.placement == \'function\' ?\n
        this.options.placement.call(this, $tip[0], this.$element[0]) :\n
        this.options.placement\n
\n
      var autoToken = /\\s?auto?\\s?/i\n
      var autoPlace = autoToken.test(placement)\n
      if (autoPlace) placement = placement.replace(autoToken, \'\') || \'top\'\n
\n
      $tip\n
        .detach()\n
        .css({ top: 0, left: 0, display: \'block\' })\n
        .addClass(placement)\n
\n
      this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element)\n
\n
      var pos          = this.getPosition()\n
      var actualWidth  = $tip[0].offsetWidth\n
      var actualHeight = $tip[0].offsetHeight\n
\n
      if (autoPlace) {\n
        var $parent = this.$element.parent()\n
\n
        var orgPlacement = placement\n
        var docScroll    = document.documentElement.scrollTop || document.body.scrollTop\n
        var parentWidth  = this.options.container == \'body\' ? window.innerWidth  : $parent.outerWidth()\n
        var parentHeight = this.options.container == \'body\' ? window.innerHeight : $parent.outerHeight()\n
        var parentLeft   = this.options.container == \'body\' ? 0 : $parent.offset().left\n
\n
        placement = placement == \'bottom\' && pos.top   + pos.height  + actualHeight - docScroll > parentHeight  ? \'top\'    :\n
                    placement == \'top\'    && pos.top   - docScroll   - actualHeight < 0                         ? \'bottom\' :\n
                    placement == \'right\'  && pos.right + actualWidth > parentWidth                              ? \'left\'   :\n
                    placement == \'left\'   && pos.left  - actualWidth < parentLeft                               ? \'right\'  :\n
                    placement\n
\n
        $tip\n
          .removeClass(orgPlacement)\n
          .addClass(placement)\n
      }\n
\n
      var calculatedOffset = this.getCalculatedOffset(placement, pos, actualWidth, actualHeight)\n
\n
      this.applyPlacement(calculatedOffset, placement)\n
      this.$element.trigger(\'shown.bs.\' + this.type)\n
    }\n
  }\n
\n
  Tooltip.prototype.applyPlacement = function(offset, placement) {\n
    var replace\n
    var $tip   = this.tip()\n
    var width  = $tip[0].offsetWidth\n
    var height = $tip[0].offsetHeight\n
\n
    // manually read margins because getBoundingClientRect includes difference\n
    var marginTop = parseInt($tip.css(\'margin-top\'), 10)\n
    var marginLeft = parseInt($tip.css(\'margin-left\'), 10)\n
\n
    // we must check for NaN for ie 8/9\n
    if (isNaN(marginTop))  marginTop  = 0\n
    if (isNaN(marginLeft)) marginLeft = 0\n
\n
    offset.top  = offset.top  + marginTop\n
    offset.left = offset.left + marginLeft\n
\n
    $tip\n
      .offset(offset)\n
      .addClass(\'in\')\n
\n
    // check to see if placing tip in new offset caused the tip to resize itself\n
    var actualWidth  = $tip[0].offsetWidth\n
    var actualHeight = $tip[0].offsetHeight\n
\n
    if (placement == \'top\' && actualHeight != height) {\n
      replace = true\n
      offset.top = offset.top + height - actualHeight\n
    }\n
\n
    if (/bottom|top/.test(placement)) {\n
      var delta = 0\n
\n
      if (offset.left < 0) {\n
        delta       = offset.left * -2\n
        offset.left = 0\n
\n
        $tip.offset(offset)\n
\n
        actualWidth  = $tip[0].offsetWidth\n
        actualHeight = $tip[0].offsetHeight\n
      }\n
\n
      this.replaceArrow(delta - width + actualWidth, actualWidth, \'left\')\n
    } else {\n
      this.replaceArrow(actualHeight - height, actualHeight, \'top\')\n
    }\n
\n
    if (replace) $tip.offset(offset)\n
  }\n
\n
  Tooltip.prototype.replaceArrow = function(delta, dimension, position) {\n
    this.arrow().css(position, delta ? (50 * (1 - delta / dimension) + "%") : \'\')\n
  }\n
\n
  Tooltip.prototype.setContent = function () {\n
    var $tip  = this.tip()\n
    var title = this.getTitle()\n
\n
    $tip.find(\'.tooltip-inner\')[this.options.html ? \'html\' : \'text\'](title)\n
    $tip.removeClass(\'fade in top bottom left right\')\n
  }\n
\n
  Tooltip.prototype.hide = function () {\n
    var that = this\n
    var $tip = this.tip()\n
    var e    = $.Event(\'hide.bs.\' + this.type)\n
\n
    function complete() {\n
      if (that.hoverState != \'in\') $tip.detach()\n
    }\n
\n
    this.$element.trigger(e)\n
\n
    if (e.isDefaultPrevented()) return\n
\n
    $tip.removeClass(\'in\')\n
\n
    $.support.transition && this.$tip.hasClass(\'fade\') ?\n
      $tip\n
        .one($.support.transition.end, complete)\n
        .emulateTransitionEnd(150) :\n
      complete()\n
\n
    this.$element.trigger(\'hidden.bs.\' + this.type)\n
\n
    return this\n
  }\n
\n
  Tooltip.prototype.fixTitle = function () {\n
    var $e = this.$element\n
    if ($e.attr(\'title\') || typeof($e.attr(\'data-original-title\')) != \'string\') {\n
      $e.attr(\'data-original-title\', $e.attr(\'title\') || \'\').attr(\'title\', \'\')\n
    }\n
  }\n
\n
  Tooltip.prototype.hasContent = function () {\n
    return this.getTitle()\n
  }\n
\n
  Tooltip.prototype.getPosition = function () {\n
    var el = this.$element[0]\n
    return $.extend({}, (typeof el.getBoundingClientRect == \'function\') ? el.getBoundingClientRect() : {\n
      width: el.offsetWidth\n
    , height: el.offsetHeight\n
    }, this.$element.offset())\n
  }\n
\n
  Tooltip.prototype.getCalculatedOffset = function (placement, pos, actualWidth, actualHeight) {\n
    return placement == \'bottom\' ? { top: pos.top + pos.height,   left: pos.left + pos.width / 2 - actualWidth / 2  } :\n
           placement == \'top\'    ? { top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2  } :\n
           placement == \'left\'   ? { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth } :\n
        /* placement == \'right\' */ { top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width   }\n
  }\n
\n
  Tooltip.prototype.getTitle = function () {\n
    var title\n
    var $e = this.$element\n
    var o  = this.options\n
\n
    title = $e.attr(\'data-original-title\')\n
      || (typeof o.title == \'function\' ? o.title.call($e[0]) :  o.title)\n
\n
    return title\n
  }\n
\n
  Tooltip.prototype.tip = function () {\n
    return this.$tip = this.$tip || $(this.options.template)\n
  }\n
\n
  Tooltip.prototype.arrow = function () {\n
    return this.$arrow = this.$arrow || this.tip().find(\'.tooltip-arrow\')\n
  }\n
\n
  Tooltip.prototype.validate = function () {\n
    if (!this.$element[0].parentNode) {\n
      this.hide()\n
      this.$element = null\n
      this.options  = null\n
    }\n
  }\n
\n
  Tooltip.prototype.enable = function () {\n
    this.enabled = true\n
  }\n
\n
  Tooltip.prototype.disable = function () {\n
    this.enabled = false\n
  }\n
\n
  Tooltip.prototype.toggleEnabled = function () {\n
    this.enabled = !this.enabled\n
  }\n
\n
  Tooltip.prototype.toggle = function (e) {\n
    var self = e ? $(e.currentTarget)[this.type](this.getDelegateOptions()).data(\'bs.\' + thi

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAc=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="7" aka="AAAAAAAAAAc=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

s.type) : this\n
    self.tip().hasClass(\'in\') ? self.leave(self) : self.enter(self)\n
  }\n
\n
  Tooltip.prototype.destroy = function () {\n
    this.hide().$element.off(\'.\' + this.type).removeData(\'bs.\' + this.type)\n
  }\n
\n
\n
  // TOOLTIP PLUGIN DEFINITION\n
  // =========================\n
\n
  var old = $.fn.tooltip\n
\n
  $.fn.tooltip = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.tooltip\')\n
      var options = typeof option == \'object\' && option\n
\n
      if (!data) $this.data(\'bs.tooltip\', (data = new Tooltip(this, options)))\n
      if (typeof option == \'string\') data[option]()\n
    })\n
  }\n
\n
  $.fn.tooltip.Constructor = Tooltip\n
\n
\n
  // TOOLTIP NO CONFLICT\n
  // ===================\n
\n
  $.fn.tooltip.noConflict = function () {\n
    $.fn.tooltip = old\n
    return this\n
  }\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: popover.js v3.0.3\n
 * http://getbootstrap.com/javascript/#popovers\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // POPOVER PUBLIC CLASS DEFINITION\n
  // ===============================\n
\n
  var Popover = function (element, options) {\n
    this.init(\'popover\', element, options)\n
  }\n
\n
  if (!$.fn.tooltip) throw new Error(\'Popover requires tooltip.js\')\n
\n
  Popover.DEFAULTS = $.extend({} , $.fn.tooltip.Constructor.DEFAULTS, {\n
    placement: \'right\'\n
  , trigger: \'click\'\n
  , content: \'\'\n
  , template: \'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>\'\n
  })\n
\n
\n
  // NOTE: POPOVER EXTENDS tooltip.js\n
  // ================================\n
\n
  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype)\n
\n
  Popover.prototype.constructor = Popover\n
\n
  Popover.prototype.getDefaults = function () {\n
    return Popover.DEFAULTS\n
  }\n
\n
  Popover.prototype.setContent = function () {\n
    var $tip    = this.tip()\n
    var title   = this.getTitle()\n
    var content = this.getContent()\n
\n
    $tip.find(\'.popover-title\')[this.options.html ? \'html\' : \'text\'](title)\n
    $tip.find(\'.popover-content\')[this.options.html ? \'html\' : \'text\'](content)\n
\n
    $tip.removeClass(\'fade top bottom left right in\')\n
\n
    // IE8 doesn\'t accept hiding via the `:empty` pseudo selector, we have to do\n
    // this manually by checking the contents.\n
    if (!$tip.find(\'.popover-title\').html()) $tip.find(\'.popover-title\').hide()\n
  }\n
\n
  Popover.prototype.hasContent = function () {\n
    return this.getTitle() || this.getContent()\n
  }\n
\n
  Popover.prototype.getContent = function () {\n
    var $e = this.$element\n
    var o  = this.options\n
\n
    return $e.attr(\'data-content\')\n
      || (typeof o.content == \'function\' ?\n
            o.content.call($e[0]) :\n
            o.content)\n
  }\n
\n
  Popover.prototype.arrow = function () {\n
    return this.$arrow = this.$arrow || this.tip().find(\'.arrow\')\n
  }\n
\n
  Popover.prototype.tip = function () {\n
    if (!this.$tip) this.$tip = $(this.options.template)\n
    return this.$tip\n
  }\n
\n
\n
  // POPOVER PLUGIN DEFINITION\n
  // =========================\n
\n
  var old = $.fn.popover\n
\n
  $.fn.popover = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.popover\')\n
      var options = typeof option == \'object\' && option\n
\n
      if (!data) $this.data(\'bs.popover\', (data = new Popover(this, options)))\n
      if (typeof option == \'string\') data[option]()\n
    })\n
  }\n
\n
  $.fn.popover.Constructor = Popover\n
\n
\n
  // POPOVER NO CONFLICT\n
  // ===================\n
\n
  $.fn.popover.noConflict = function () {\n
    $.fn.popover = old\n
    return this\n
  }\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: scrollspy.js v3.0.3\n
 * http://getbootstrap.com/javascript/#scrollspy\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // SCROLLSPY CLASS DEFINITION\n
  // ==========================\n
\n
  function ScrollSpy(element, options) {\n
    var href\n
    var process  = $.proxy(this.process, this)\n
\n
    this.$element       = $(element).is(\'body\') ? $(window) : $(element)\n
    this.$body          = $(\'body\')\n
    this.$scrollElement = this.$element.on(\'scroll.bs.scroll-spy.data-api\', process)\n
    this.options        = $.extend({}, ScrollSpy.DEFAULTS, options)\n
    this.selector       = (this.options.target\n
      || ((href = $(element).attr(\'href\')) && href.replace(/.*(?=#[^\\s]+$)/, \'\')) //strip for ie7\n
      || \'\') + \' .nav li > a\'\n
    this.offsets        = $([])\n
    this.targets        = $([])\n
    this.activeTarget   = null\n
\n
    this.refresh()\n
    this.process()\n
  }\n
\n
  ScrollSpy.DEFAULTS = {\n
    offset: 10\n
  }\n
\n
  ScrollSpy.prototype.refresh = function () {\n
    var offsetMethod = this.$element[0] == window ? \'offset\' : \'position\'\n
\n
    this.offsets = $([])\n
    this.targets = $([])\n
\n
    var self     = this\n
    var $targets = this.$body\n
      .find(this.selector)\n
      .map(function () {\n
        var $el   = $(this)\n
        var href  = $el.data(\'target\') || $el.attr(\'href\')\n
        var $href = /^#\\w/.test(href) && $(href)\n
\n
        return ($href\n
          && $href.length\n
          && [[ $href[offsetMethod]().top + (!$.isWindow(self.$scrollElement.get(0)) && self.$scrollElement.scrollTop()), href ]]) || null\n
      })\n
      .sort(function (a, b) { return a[0] - b[0] })\n
      .each(function () {\n
        self.offsets.push(this[0])\n
        self.targets.push(this[1])\n
      })\n
  }\n
\n
  ScrollSpy.prototype.process = function () {\n
    var scrollTop    = this.$scrollElement.scrollTop() + this.options.offset\n
    var scrollHeight = this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight\n
    var maxScroll    = scrollHeight - this.$scrollElement.height()\n
    var offsets      = this.offsets\n
    var targets      = this.targets\n
    var activeTarget = this.activeTarget\n
    var i\n
\n
    if (scrollTop >= maxScroll) {\n
      return activeTarget != (i = targets.last()[0]) && this.activate(i)\n
    }\n
\n
    for (i = offsets.length; i--;) {\n
      activeTarget != targets[i]\n
        && scrollTop >= offsets[i]\n
        && (!offsets[i + 1] || scrollTop <= offsets[i + 1])\n
        && this.activate( targets[i] )\n
    }\n
  }\n
\n
  ScrollSpy.prototype.activate = function (target) {\n
    this.activeTarget = target\n
\n
    $(this.selector)\n
      .parents(\'.active\')\n
      .removeClass(\'active\')\n
\n
    var selector = this.selector\n
      + \'[data-target="\' + target + \'"],\'\n
      + this.selector + \'[href="\' + target + \'"]\'\n
\n
    var active = $(selector)\n
      .parents(\'li\')\n
      .addClass(\'active\')\n
\n
    if (active.parent(\'.dropdown-menu\').length)  {\n
      active = active\n
        .closest(\'li.dropdown\')\n
        .addClass(\'active\')\n
    }\n
\n
    active.trigger(\'activate.bs.scrollspy\')\n
  }\n
\n
\n
  // SCROLLSPY PLUGIN DEFINITION\n
  // ===========================\n
\n
  var old = $.fn.scrollspy\n
\n
  $.fn.scrollspy = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.scrollspy\')\n
      var options = typeof option == \'object\' && option\n
\n
      if (!data) $this.data(\'bs.scrollspy\', (data = new ScrollSpy(this, options)))\n
      if (typeof option == \'string\') data[option]()\n
    })\n
  }\n
\n
  $.fn.scrollspy.Constructor = ScrollSpy\n
\n
\n
  // SCROLLSPY NO CONFLICT\n
  // =====================\n
\n
  $.fn.scrollspy.noConflict = function () {\n
    $.fn.scrollspy = old\n
    return this\n
  }\n
\n
\n
  // SCROLLSPY DATA-API\n
  // ==================\n
\n
  $(window).on(\'load\', function () {\n
    $(\'[data-spy="scroll"]\').each(function () {\n
      var $spy = $(this)\n
      $spy.scrollspy($spy.data())\n
    })\n
  })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: tab.js v3.0.3\n
 * http://getbootstrap.com/javascript/#tabs\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // TAB CLASS DEFINITION\n
  // ====================\n
\n
  var Tab = function (element) {\n
    this.element = $(element)\n
  }\n
\n
  Tab.prototype.show = function () {\n
    var $this    = this.element\n
    var $ul      = $this.closest(\'ul:not(.dropdown-menu)\')\n
    var selector = $this.data(\'target\')\n
\n
    if (!selector) {\n
      selector = $this.attr(\'href\')\n
      selector = selector && selector.replace(/.*(?=#[^\\s]*$)/, \'\') //strip for ie7\n
    }\n
\n
    if ($this.parent(\'li\').hasClass(\'active\')) return\n
\n
    var previous = $ul.find(\'.active:last a\')[0]\n
    var e        = $.Event(\'show.bs.tab\', {\n
      relatedTarget: previous\n
    })\n
\n
    $this.trigger(e)\n
\n
    if (e.isDefaultPrevented()) return\n
\n
    var $target = $(selector)\n
\n
    this.activate($this.parent(\'li\'), $ul)\n
    this.activate($target, $target.parent(), function () {\n
      $this.trigger({\n
        type: \'shown.bs.tab\'\n
      , relatedTarget: previous\n
      })\n
    })\n
  }\n
\n
  Tab.prototype.activate = function (element, container, callback) {\n
    var $active    = container.find(\'> .active\')\n
    var transition = callback\n
      && $.support.transition\n
      && $active.hasClass(\'fade\')\n
\n
    function next() {\n
      $active\n
        .removeClass(\'active\')\n
        .find(\'> .dropdown-menu > .active\')\n
        .removeClass(\'active\')\n
\n
      element.addClass(\'active\')\n
\n
      if (transition) {\n
        element[0].offsetWidth // reflow for transition\n
        element.addClass(\'in\')\n
      } else {\n
        element.removeClass(\'fade\')\n
      }\n
\n
      if (element.parent(\'.dropdown-menu\')) {\n
        element.closest(\'li.dropdown\').addClass(\'active\')\n
      }\n
\n
      callback && callback()\n
    }\n
\n
    transition ?\n
      $active\n
        .one($.support.transition.end, next)\n
        .emulateTransitionEnd(150) :\n
      next()\n
\n
    $active.removeClass(\'in\')\n
  }\n
\n
\n
  // TAB PLUGIN DEFINITION\n
  // =====================\n
\n
  var old = $.fn.tab\n
\n
  $.fn.tab = function ( option ) {\n
    return this.each(function () {\n
      var $this = $(this)\n
      var data  = $this.data(\'bs.tab\')\n
\n
      if (!data) $this.data(\'bs.tab\', (data = new Tab(this)))\n
      if (typeof option == \'string\') data[option]()\n
    })\n
  }\n
\n
  $.fn.tab.Constructor = Tab\n
\n
\n
  // TAB NO CONFLICT\n
  // ===============\n
\n
  $.fn.tab.noConflict = function () {\n
    $.fn.tab = old\n
    return this\n
  }\n
\n
\n
  // TAB DATA-API\n
  // ============\n
\n
  $(document).on(\'click.bs.tab.data-api\', \'[data-toggle="tab"], [data-toggle="pill"]\', function (e) {\n
    e.preventDefault()\n
    $(this).tab(\'show\')\n
  })\n
\n
}(jQuery);\n
\n
/* ========================================================================\n
 * Bootstrap: affix.js v3.0.3\n
 * http://getbootstrap.com/javascript/#affix\n
 * ========================================================================\n
 * Copyright 2013 Twitter, Inc.\n
 *\n
 * Licensed under the Apache License, Version 2.0 (the "License");\n
 * you may not use this file except in compliance with the License.\n
 * You may obtain a copy of the License at\n
 *\n
 * http://www.apache.org/licenses/LICENSE-2.0\n
 *\n
 * Unless required by applicable law or agreed to in writing, software\n
 * distributed under the License is distributed on an "AS IS" BASIS,\n
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n
 * See the License for the specific language governing permissions and\n
 * limitations under the License.\n
 * ======================================================================== */\n
\n
\n
+function ($) { "use strict";\n
\n
  // AFFIX CLASS DEFINITION\n
  // ======================\n
\n
  var Affix = function (element, options) {\n
    this.options = $.extend({}, Affix.DEFAULTS, options)\n
    this.$window = $(window)\n
      .on(\'scroll.bs.affix.data-api\', $.proxy(this.checkPosition, this))\n
      .on(\'click.bs.affix.data-api\',  $.proxy(this.checkPositionWithEventLoop, this))\n
\n
    this.$element = $(element)\n
    this.affixed  =\n
    this.unpin    = null\n
\n
    this.checkPosition()\n
  }\n
\n
  Affix.RESET = \'affix affix-top affix-bottom\'\n
\n
  Affix.DEFAULTS = {\n
    offset: 0\n
  }\n
\n
  Affix.prototype.checkPositionWithEventLoop = function () {\n
    setTimeout($.proxy(this.checkPosition, this), 1)\n
  }\n
\n
  Affix.prototype.checkPosition = function () {\n
    if (!this.$element.is(\':visible\')) return\n
\n
    var scrollHeight = $(document).height()\n
    var scrollTop    = this.$window.scrollTop()\n
    var position     = this.$element.offset()\n
    var offset       = this.options.offset\n
    var offsetTop    = offset.top\n
    var offsetBottom = offset.bottom\n
\n
    if (typeof offset != \'object\')         offsetBottom = offsetTop = offset\n
    if (typeof offsetTop == \'function\')    offsetTop    = offset.top()\n
    if (typeof offsetBottom == \'function\') offsetBottom = offset.bottom()\n
\n
    var affix = this.unpin   != null && (scrollTop + this.unpin <= position.top) ? false :\n
                offsetBottom != null && (position.top + this.$element.height() >= scrollHeight - offsetBottom) ? \'bottom\' :\n
                offsetTop    != null && (scrollTop <= offsetTop) ? \'top\' : false\n
\n
    if (this.affixed === affix) return\n
    if (this.unpin) this.$element.css(\'top\', \'\')\n
\n
    this.affixed = affix\n
    this.unpin   = affix == \'bottom\' ? position.top - scrollTop : null\n
\n
    this.$element.removeClass(Affix.RESET).addClass(\'affix\' + (affix ? \'-\' + affix : \'\'))\n
\n
    if (affix == \'bottom\') {\n
      this.$element.offset({ top: document.body.offsetHeight - offsetBottom - this.$element.height() })\n
    }\n
  }\n
\n
\n
  // AFFIX PLUGIN DEFINITION\n
  // =======================\n
\n
  var old = $.fn.affix\n
\n
  $.fn.affix = function (option) {\n
    return this.each(function () {\n
      var $this   = $(this)\n
      var data    = $this.data(\'bs.affix\')\n
      var options = typeof option == \'object\' && option\n
\n
      if (!data) $this.data(\'bs.affix\', (data = new Affix(this, options)))\n
      if (typeof option == \'string\') data[option]()\n
    })\n
  }\n
\n
  $.fn.affix.Constructor = Affix\n
\n
\n
  // AFFIX NO CONFLICT\n
  // =================\n
\n
  $.fn.affix.noConflict = function () {\n
    $.fn.affix = old\n
    return this\n
  }\n
\n
\n
  // AFFIX DATA-API\n
  // ==============\n
\n
  $(window).on(\'load\', function () {\n
    $(\'[data-spy="affix"]\').each(function () {\n
      var $spy = $(this)\n
      var data = $spy.data()\n
\n
      data.offset = data.offset || {}\n
\n
      if (data.offsetBottom) data.offset.bottom = data.offsetBottom\n
      if (data.offsetTop)    data.offset.top    = data.offsetTop\n
\n
      $spy.affix(data)\n
    })\n
  })\n
\n
}(jQuery);\n
\n
define("bootstrap", ["jquery"], function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'notification\',["backbone"], function (Backbone) {\r\n
    var NotificationCenter = function () {};\r\n
    _.extend(NotificationCenter.prototype, Backbone.Events);\r\n
    if (typeof Common.NotificationCenter == "undefined") {\r\n
        NotificationCenter.extend = Backbone.Model.extend;\r\n
        Common.NotificationCenter = new NotificationCenter();\r\n
    } else {\r\n
        throw ("Native Common.NotificationCenter instance already defined.");\r\n
    }\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 (function () {\r\n
    var resolveNamespace = function (className, root) {\r\n
        var parts = className.split("."),\r\n
        current = root || window;\r\n
        for (var a = 0, b = parts.length; a < b; a++) {\r\n
            current = current[parts[a]] || {};\r\n
        }\r\n
        return current;\r\n
    };\r\n
    var Application = function (options) {\r\n
        _.extend(this, options || {});\r\n
        this.eventbus = new EventBus({\r\n
            application: this\r\n
        });\r\n
        this.createApplicationNamespace();\r\n
        this.initialize.apply(this, arguments);\r\n
        if (this.autoCreate !== false) {\r\n
            $($.proxy(this.onReady, this));\r\n
        }\r\n
    };\r\n
    _.extend(Application.prototype, {\r\n
        nameSpace: "Application",\r\n
        models: {},\r\n
        collections: {},\r\n
        controllers: {},\r\n
        allocationMap: {\r\n
            model: "Models",\r\n
            collection: "Collections",\r\n
            controller: "Controllers",\r\n
            view: "Views"\r\n
        },\r\n
        createApplicationNamespace: function () {\r\n
            var nameSpace = window;\r\n
            if (this.nameSpace) {\r\n
                if (typeof nameSpace[this.nameSpace] == "undefined") {\r\n
                    nameSpace[this.nameSpace] = {};\r\n
                }\r\n
            }\r\n
            nameSpace[this.nameSpace] = this;\r\n
            _.each(this.allocationMap, function (name, key) {\r\n
                this[name] = this[name] || {};\r\n
            },\r\n
            this);\r\n
        },\r\n
        initialize: function () {},\r\n
        onReady: function () {\r\n
            this.start();\r\n
        },\r\n
        start: function () {\r\n
            this.initializeControllers(this.controllers || {});\r\n
            this.launchControllers();\r\n
            this.launch.call(this);\r\n
        },\r\n
        getClasseRefs: function (type, classes) {\r\n
            var hashMap = {},\r\n
            allocationMap = this.allocationMap[type],\r\n
            root = this[allocationMap];\r\n
            _.each(classes, function (cls) {\r\n
                hashMap[cls] = resolveNamespace(cls, (cls.indexOf(".") > -1) ? window : root);\r\n
            },\r\n
            this);\r\n
            return hashMap;\r\n
        },\r\n
        initializeControllers: function (controllers) {\r\n
            this.controllers = {};\r\n
            _.each(controllers, function (ctrl) {\r\n
                var root = (ctrl.indexOf(".") > -1) ? window : this[this.allocationMap.controller],\r\n
                classReference = resolveNamespace(ctrl, root),\r\n
                id = ctrl.split(".").pop();\r\n
                var controller = new classReference({\r\n
                    id: ctrl,\r\n
                    application: this\r\n
                });\r\n
                controller.views = this.getClasseRefs("view", controller.views || []);\r\n
                _.extend(this.models, this.getClasseRefs("model", controller.models || []));\r\n
                _.extend(this.collections, this.getClasseRefs("collection", controller.collections || {}));\r\n
                this.buildCollections();\r\n
                this.controllers[ctrl] = controller;\r\n
            },\r\n
            this);\r\n
        },\r\n
        launchControllers: function () {\r\n
            _.each(this.controllers, function (ctrl, id) {\r\n
                ctrl.onLaunch(this);\r\n
            },\r\n
            this);\r\n
        },\r\n
        launch: function () {},\r\n
        addListeners: function (listeners, controller) {\r\n
            this.eventbus.addListeners(listeners, controller);\r\n
        },\r\n
        getController: function (name) {\r\n
            return this.controllers[name];\r\n
        },\r\n
        getModel: function (name) {\r\n
            this._modelsCache = this._modelsCache || {};\r\n
            var model = this._modelsCache[name],\r\n
            modelClass = this.getModelConstructor(name);\r\n
            if (!model && modelClass) {\r\n
                model = this.createModel(name);\r\n
                this._modelsCache[name] = model;\r\n
            }\r\n
            return model || null;\r\n
        },\r\n
        getModelConstructor: function (name) {\r\n
            return this.models[name];\r\n
        },\r\n
        createModel: function (name, options) {\r\n
            var modelClass = this.getModelConstructor(name),\r\n
            model = null;\r\n
            if (modelClass) {\r\n
                model = new modelClass(_.extend(options || {}));\r\n
            }\r\n
            return model;\r\n
        },\r\n
        getCollection: function (name) {\r\n
            this._collectionsCache = this._collectionsCache || {};\r\n
            var collection = this._collectionsCache[name],\r\n
            collectionClass = this.getCollectionConstructor(name);\r\n
            if (!collection && collectionClass) {\r\n
                collection = this.createCollection(name);\r\n
                this._collectionsCache[name] = collection;\r\n
            }\r\n
            return collection || null;\r\n
        },\r\n
        getCollectionConstructor: function (name) {\r\n
            return this.collections[name];\r\n
        },\r\n
        createCollection: function (name) {\r\n
            var collectionClass = this.getCollectionConstructor(name),\r\n
            collection = null;\r\n
            if (collectionClass) {\r\n
                collection = new collectionClass();\r\n
            }\r\n
            return collection;\r\n
        },\r\n
        buildCollections: function () {\r\n
            _.each(this.collections, function (collection, alias) {\r\n
                this.getCollection(alias);\r\n
            },\r\n
            this);\r\n
        }\r\n
    });\r\n
    if (typeof Backbone.Application == "undefined") {\r\n
        Backbone.Application = Application;\r\n
        Backbone.Application.extend = Backbone.Model.extend;\r\n
    } else {\r\n
        throw ("Native Backbone.Application instance already defined.");\r\n
    }\r\n
    var Controller = function (options) {\r\n
        _.extend(this, options || {});\r\n
        this.initialize.apply(this, arguments);\r\n
    };\r\n
    _.extend(Controller.prototype, {\r\n
        name: null,\r\n
        views: {},\r\n
        models: {},\r\n
        collections: {},\r\n
        initialize: function (options) {},\r\n
        addListeners: function (listeners) {\r\n
            this.getApplication().addListeners(listeners, this);\r\n
        },\r\n
        onLaunch: function (application) {},\r\n
        getApplication: function () {\r\n
            return this.application;\r\n
        },\r\n
        getView: function (name) {\r\n
            return this._viewsCache[name];\r\n
        },\r\n
        getViewConstructor: function (name) {\r\n
            return this.views[name];\r\n
        },\r\n
        createView: function (name, options) {\r\n
            var view = this.getViewConstructor(name),\r\n
            viewOptions = _.extend(options || {},\r\n
            {\r\n
                alias: name\r\n
            });\r\n
            this._viewsCache = this._viewsCache || {};\r\n
            this._viewsCache[name] = new view(viewOptions);\r\n
            this._viewsCache[name].options = _.extend({},\r\n
            viewOptions);\r\n
            return this._viewsCache[name];\r\n
        },\r\n
        getModel: function (name) {\r\n
            return this.application.getModel(name);\r\n
        },\r\n
        getModelConstructor: function (name) {\r\n
            return this.application.getModelConstructor(name);\r\n
        },\r\n
        createModel: function (name, options) {\r\n
            return this.application.createModel(name);\r\n
        },\r\n
        getCollection: function (name) {\r\n
            return this.application.getCollection(name);\r\n
        },\r\n
        getCollectionConstructor: function (name) {\r\n
            return this.application.getCollectionConstructor(name);\r\n
        },\r\n
        createCollection: function (name) {\r\n
            return this.application.createCollection(name);\r\n
        },\r\n
        fireEvent: function (selector, event, args) {\r\n
            this.application.eventbus.fireEvent(selector, event, args);\r\n
        },\r\n
        bindViewEvents: function (view, events) {\r\n
            this.unbindViewEvents(view);\r\n
            events = _.isFunction(events) ? events.call(this) : events;\r\n
            for (var key in events) {\r\n
                var method = events[key];\r\n
                if (!_.isFunction(method)) {\r\n
                    method = this[events[key]];\r\n
                }\r\n
                var match = key.match(/^(\\S+)\\s*(.*)$/);\r\n
                var eventName = match[1],\r\n
                selector = match[2];\r\n
                method = _.bind(method, this);\r\n
                eventName += ".bindViewEvents" + view.cid;\r\n
                view.$el.on(eventName, selector, method);\r\n
            }\r\n
            return this;\r\n
        },\r\n
        unbindViewEvents: function (view) {\r\n
            view.$el.off(".bindViewEvents" + view.cid);\r\n
            return this;\r\n
        }\r\n
    });\r\n
    if (typeof Backbone.Controller == "undefined") {\r\n
        Backbone.Controller = Controller;\r\n
        Backbone.Controller.extend = Backbone.Model.extend;\r\n
    } else {\r\n
        throw ("Native Backbone.Controller instance already defined.");\r\n
    }\r\n
    var EventBus = function (options) {\r\n
        var me = this;\r\n
        _.extend(this, options || {});\r\n
        _.extend(Backbone.View.prototype, {\r\n
            alias: null,\r\n
            hidden: false,\r\n
            getAlias: function () {\r\n
                return this.options.alias;\r\n
            },\r\n
            fireEvent: function (event, args) {\r\n
                this.trigger.apply(this, arguments);\r\n
                me.fireEvent(this.getAlias(), event, args);\r\n
            },\r\n
            hide: function () {\r\n
                this.$el.hide();\r\n
                this.hidden = true;\r\n
            },\r\n
            show: function () {\r\n
                this.$el.show();\r\n
                this.hidden = false;\r\n
            }\r\n
        });\r\n
    };\r\n
    _.extend(EventBus.prototype, {\r\n
        pool: {},\r\n
        addListeners: function (selectors, controller) {\r\n
            this.pool[controller.id] = this.pool[controller.id] || {};\r\n
            var pool = this.pool[controller.id];\r\n
            if (_.isArray(selectors)) {\r\n
                _.each(selectors, function (selector) {\r\n
                    this.addListeners(selector, controller);\r\n
                },\r\n
                this);\r\n
            } else {\r\n
                if (_.isObject(selectors)) {\r\n
                    _.each(selectors, function (listeners, selector) {\r\n
                        _.each(listeners, function (listener, event) {\r\n
                            pool[selector] = pool[selector] || {};\r\n
                            pool[selector][event] = pool[selector][event] || [];\r\n
                            pool[selector][event].push(listener);\r\n
                        },\r\n
                        this);\r\n
                    },\r\n
                    this);\r\n
                }\r\n
            }\r\n
        },\r\n
        fireEvent: function (selector, event, args) {\r\n
            var application = this.getApplication();\r\n
            _.each(this.pool, function (eventsPoolByAlias, controllerId) {\r\n
                var events = eventsPoolByAlias[selector];\r\n
                if (events) {\r\n
                    var listeners = events[event],\r\n
                    controller = application.getController(controllerId);\r\n
                    _.each(listeners, function (fn) {\r\n
                        fn.apply(controller, args);\r\n
                    });\r\n
                }\r\n
            },\r\n
            this);\r\n
        },\r\n
        getApplication: function () {\r\n
            return this.application;\r\n
        }\r\n
    });\r\n
    if (typeof Backbone.EventBus == "undefined") {\r\n
        Backbone.EventBus = EventBus;\r\n
    } else {\r\n
        throw ("Native Backbone.Application instance already defined.");\r\n
    }\r\n
})();\n
define("core", ["backbone","notification"], function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.component = Common.component || {};\r\n
Common.Analytics = Common.component.Analytics = new(function () {\r\n
    var _category;\r\n
    return {\r\n
        initialize: function (id, category) {\r\n
            if (typeof id === "undefined") {\r\n
                throw "Analytics: invalid id.";\r\n
            }\r\n
            if (typeof category === "undefined" || Object.prototype.toString.apply(category) !== "[object String]") {\r\n
                throw "Analytics: invalid category type.";\r\n
            }\r\n
            _category = category;\r\n
            $("head").append(\'<script type="text/javascript">\' + "var _gaq = _gaq || [];" + \'_gaq.push(["_setAccount", "\' + id + \'"]);\' + \'_gaq.push(["_trackPageview"]);\' + "(function() {" + \'var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;\' + \'ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";\' + \'var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);\' + "})();" + "</script>");\r\n
        },\r\n
        trackEvent: function (action, label, value) {\r\n
            if (typeof action !== "undefined" && Object.prototype.toString.apply(action) !== "[object String]") {\r\n
                throw "Analytics: invalid action type.";\r\n
            }\r\n
            if (typeof label !== "undefined" && Object.prototype.toString.apply(label) !== "[object String]") {\r\n
                throw "Analytics: invalid label type.";\r\n
            }\r\n
            if (typeof value !== "undefined" && !(Object.prototype.toString.apply(value) === "[object Number]" && isFinite(value))) {\r\n
                throw "Analytics: invalid value type.";\r\n
            }\r\n
            if (typeof _gaq === "undefined") {\r\n
                return;\r\n
            }\r\n
            if (_category === "undefined") {\r\n
                throw "Analytics is not initialized.";\r\n
            }\r\n
            _gaq.push(["_trackEvent", _category, action, label, value]);\r\n
        }\r\n
    };\r\n
})();\n
define("analytics", ["jquery"], function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Gateway = new(function () {\r\n
    var me = this,\r\n
    $me = $(me);\r\n
    var commandMap = {\r\n
        "init": function (data) {\r\n
            $me.trigger("init", data);\r\n
        },\r\n
        "openDocument": function (data) {\r\n
            $me.trigger("opendocument", data);\r\n
        },\r\n
        "showMessage": function (data) {\r\n
            $me.trigger("showmessage", data);\r\n
        },\r\n
        "applyEditRights": function (data) {\r\n
            $me.trigger("applyeditrights", data);\r\n
        },\r\n
        "save": function (data) {\r\n
            $me.trigger("save", data);\r\n
        },\r\n
        "processSaveResult": function (data) {\r\n
            $me.trigger("processsaveresult", data);\r\n
        },\r\n
        "processRightsChange": function (data) {\r\n
            $me.trigger("processrightschange", data);\r\n
        },\r\n
        "refreshHistory": function (data) {\r\n
            $me.trigger("refreshhistory", data);\r\n
        },\r\n
        "setHistoryData": function (data) {\r\n
            $me.trigger("sethistorydata", data);\r\n
        },\r\n
        "processMouse": function (data) {\r\n
            $me.trigger("processmouse", data);\r\n
        },\r\n
        "internalCommand": function (data) {\r\n
            $me.trigger("internalcommand", data);\r\n
        },\r\n
        "resetFocus": function (data) {\r\n
            $me.trigger("resetfocus", data);\r\n
        }\r\n
    };\r\n
    var _postMessage = function (msg) {\r\n
        if (window.parent && window.JSON) {\r\n
            window.parent.postMessage(window.JSON.stringify(msg), "*");\r\n
        }\r\n
    };\r\n
    var _onMessage = function (msg) {\r\n
        var data = msg.data;\r\n
        if (Object.prototype.toString.apply(data) !== "[object String]" || !window.JSON) {\r\n
            return;\r\n
        }\r\n
        var cmd, handler;\r\n
        try {\r\n
            cmd = window.JSON.parse(data);\r\n
        } catch(e) {\r\n
            cmd = "";\r\n
        }\r\n
        if (cmd) {\r\n
            handler = commandMap[cmd.command];\r\n
            if (handler) {\r\n
                handler.call(this, cmd.data);\r\n
            }\r\n
        }\r\n
    };\r\n
    var fn = function (e) {\r\n
        _onMessage(e);\r\n
    };\r\n
    if (window.attachEvent) {\r\n
        window.attachEvent("onmessage", fn);\r\n
    } else {\r\n
        window.addEventListener("message", fn, false);\r\n
    }\r\n
    return {\r\n
        ready: function () {\r\n
            _postMessage({\r\n
                event: "onReady"\r\n
            });\r\n
        },\r\n
        goBack: function (new_window) {\r\n
            _postMessage({\r\n
                event: "onBack",\r\n
                data: (new_window == true)\r\n
            });\r\n
        },\r\n
        save: function (url) {\r\n
            _postMessage({\r\n
                event: "onSave",\r\n
                data: url\r\n
            });\r\n
        },\r\n
        requestEditRights: function () {\r\n
            _postMessage({\r\n
                event: "onRequestEditRights"\r\n
            });\r\n
        },\r\n
        requestHistory: function () {\r\n
            _postMessage({\r\n
                event: "onRequestHistory"\r\n
            });\r\n
        },\r\n
        requestHistoryData: function (revision) {\r\n
            _postMessage({\r\n
                event: "onRequestHistoryData",\r\n
                data: revision\r\n
            });\r\n
        },\r\n
        requestHistoryClose: function (revision) {\r\n
            _postMessage({\r\n
                event: "onRequestHistoryClose"\r\n
            });\r\n
        },\r\n
        reportError: function (code, description) {\r\n
            _postMessage({\r\n
                event: "onError",\r\n
                data: {\r\n
                    errorCode: code,\r\n
                    errorDescription: description\r\n
                }\r\n
            });\r\n
        },\r\n
        setDocumentModified: function (modified) {\r\n
            _postMessage({\r\n
                event: "onDocumentStateChange",\r\n
                data: modified\r\n
            });\r\n
        },\r\n
        internalMessage: function (type, data) {\r\n
            _postMessage({\r\n
                event: "onInternalMessage",\r\n
                data: {\r\n
                    type: type,\r\n
                    data: data\r\n
                }\r\n
            });\r\n
        },\r\n
        updateVersion: function () {\r\n
            _postMessage({\r\n
                event: "onOutdatedVersion"\r\n
            });\r\n
        },\r\n
        on: function (event, handler) {\r\n
            var localHandler = function (event, data) {\r\n
                handler.call(me, data);\r\n
            };\r\n
            $me.on(event, localHandler);\r\n
        }\r\n
    };\r\n
})();\n
define("gateway", ["jquery"], function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Locale = new(function () {\r\n
    var l10n = {};\r\n
    var _createXMLHTTPObject = function () {\r\n
        var xmlhttp;\r\n
        try {\r\n
            xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");\r\n
        } catch(e) {\r\n
            try {\r\n
                xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");\r\n
            } catch(E) {\r\n
                xmlhttp = false;\r\n
            }\r\n
        }\r\n
        if (!xmlhttp && typeof XMLHttpRequest != "undefined") {\r\n
            xmlhttp = new XMLHttpRequest();\r\n
        }\r\n
        return xmlhttp;\r\n
    };\r\n
    var _applyLocalization = function () {\r\n
        try {\r\n
            for (var prop in l10n) {\r\n
                var p = prop.split(".");\r\n
                if (p && p.length > 2) {\r\n
                    var obj = window;\r\n
                    for (var i = 0; i < p.length - 1; ++i) {\r\n
                        if (obj[p[i]] === undefined) {\r\n
                            obj[p[i]] = new Object();\r\n
                        }\r\n
                        obj = obj[p[i]];\r\n
                    }\r\n
                    if (obj) {\r\n
                        obj[p[p.length - 1]] = l10n[prop];\r\n
                    }\r\n
                }\r\n
            }\r\n
        } catch(e) {}\r\n
    };\r\n
    var _get = function (prop, scope) {\r\n
        var res = "";\r\n
        if (scope && scope.name) {\r\n
            res = l10n[scope.name + "." + prop];\r\n
        }\r\n
        return res || (scope ? eval(scope.name).prototype[prop] : "");\r\n
    };\r\n
    var _getUrlParameterByName = function (name) {\r\n
        name = name.replace(/[\\[]/, "\\\\[").replace(/[\\]]/, "\\\\]");\r\n
        var regex = new RegExp("[\\\\?&]" + name + "=([^&#]*)"),\r\n
        results = regex.exec(location.search);\r\n
        return results == null ? "" : decodeURIComponent(results[1].replace(/\\+/g, " "));\r\n
    };\r\n
    try {\r\n
        var langParam = _getUrlParameterByName("lang");\r\n
        var xhrObj = _createXMLHTTPObject();\r\n
        if (xhrObj && langParam) {\r\n
            var lang = langParam.split("-")[0];\r\n
            xhrObj.open("GET", "locale/" + lang + ".json", false);\r\n
            xhrObj.send("");\r\n
            l10n = eval("(" + xhrObj.responseText + ")");\r\n
        }\r\n
    } catch(e) {}\r\n
    return {\r\n
        apply: _applyLocalization,\r\n
        get: _get\r\n
    };\r\n
})();\n
define("locale", function(){});\n
\n
/**\n
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.\n
 * Available via the MIT or new BSD license.\n
 * see: http://github.com/requirejs/text for details\n
 */\n
/*jslint regexp: true */\n
/*global require, XMLHttpRequest, ActiveXObject,\n
  define, window, process, Packages,\n
  java, location, Components, FileUtils */\n
\n
define(\'text\',[\'module\'], function (module) {\n
    \'use strict\';\n
\n
    var text, fs, Cc, Ci, xpcIsWindows,\n
        progIds = [\'Msxml2.XMLHTTP\', \'Microsoft.XMLHTTP\', \'Msxml2.XMLHTTP.4.0\'],\n
        xmlRegExp = /^\\s*<\\?xml(\\s)+version=[\\\'\\"](\\d)*.(\\d)*[\\\'\\"](\\s)*\\?>/im,\n
        bodyRegExp = /<body[^>]*>\\s*([\\s\\S]+)\\s*<\\/body>/im,\n
        hasLocation = typeof location !== \'undefined\' && location.href,\n
        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\\:/, \'\'),\n
        defaultHostName = hasLocation && location.hostname,\n
        defaultPort = hasLocation && (location.port || undefined),\n
        buildMap = {},\n
        masterConfig = (module.config && module.config()) || {};\n
\n
    text = {\n
        version: \'2.0.10\',\n
\n
        strip: function (content) {\n
            //Strips <?xml ...?> declarations so that external SVG and XML\n
            //documents can be added to a document without worry. Also, if the string\n
            //is an HTML document, only the part inside the body tag is returned.\n
            if (content) {\n
                content = content.replace(xmlRegExp, "");\n
                var matches = content.match(bodyRegExp);\n
                if (matches) {\n
                    content = matches[1];\n
                }\n
            } else {\n
                content = "";\n
            }\n
            return content;\n
        },\n
\n
        jsEscape: function (content) {\n
            return content.replace(/([\'\\\\])/g, \'\\\\$1\')\n
                .replace(/[\\f]/g, "\\\\f")\n
                .replace(/[\\b]/g, "\\\\b")\n
                .replace(/[\\n]/g, "\\\\n")\n
                .replace(/[\\t]/g, "\\\\t")\n
                .replace(/[\\r]/g, "\\\\r")\n
                .replace(/[\\u2028]/g, "\\\\u2028")\n
                .replace(/[\\u2029]/g, "\\\\u2029");\n
        },\n
\n
        createXhr: masterConfig.createXhr || function () {\n
            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.\n
            var xhr, i, progId;\n
            if (typeof XMLHttpRequest !== "undefined") {\n
                return new XMLHttpRequest();\n
            } else if (typeof ActiveXObject !== "undefined") {\n
                for (i = 0; i < 3; i += 1) {\n
                    progId = progIds[i];\n
                    try {\n
                        xhr = new ActiveXObject(progId);\n
                    } catch (e) {}\n
\n
                    if (xhr) {\n
                        progIds = [progId];  // so faster next time\n
                        break;\n
                    }\n
                }\n
            }\n
\n
            return xhr;\n
        },\n
\n
        /**\n
         * Parses a resource name into its component parts. Resource names\n
         * look like: module/name.ext!strip, where the !strip part is\n
         * optional.\n
         * @param {String} name the resource name\n
         * @returns {Object} with properties "moduleName", "ext" and "strip"\n
         * where strip is a boolean.\n
         */\n
        parseName: function (name) {\n
            var modName, ext, temp,\n
                strip = false,\n
                index = name.indexOf("."),\n
                isRelative = name.indexOf(\'./\') === 0 ||\n
                             name.indexOf(\'../\') === 0;\n
\n
            if (index !== -1 && (!isRelative || index > 1)) {\n
                modName = name.substring(0, index);\n
                ext = name.substring(index + 1, name.length);\n
            } else {\n
                modName = name;\n
            }\n
\n
            temp = ext || modName;\n
            index = temp.indexOf("!");\n
            if (index !== -1) {\n
                //Pull off the strip arg.\n
                strip = temp.substring(index + 1) === "strip";\n
                temp = temp.substring(0, index);\n
                if (ext) {\n
                    ext = temp;\n
                } else {\n
                    modName = temp;\n
                }\n
            }\n
\n
            return {\n
                moduleName: modName,\n
                ext: ext,\n
                strip: strip\n
            };\n
        },\n
\n
        xdRegExp: /^((\\w+)\\:)?\\/\\/([^\\/\\\\]+)/,\n
\n
        /**\n
         * Is an URL on another domain. Only works for browser use, returns\n
         * false in non-browser environments. Only used to know if an\n
         * optimized .js version of a text resource should be loaded\n
         * instead.\n
         * @param {String} url\n
         * @returns Boolean\n
         */\n
        useXhr: function (url, protocol, hostname, port) {\n
            var uProtocol, uHostName, uPort,\n
                match = text.xdRegExp.exec(url);\n
            if (!match) {\n
                return true;\n
            }\n
            uProtocol = match[2];\n
            uHostName = match[3];\n
\n
            uHostName = uHostName.split(\':\');\n
            uPort = uHostName[1];\n
            uHostName = uHostName[0];\n
\n
            return (!uProtocol || uProtocol === protocol) &&\n
                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&\n
                   ((!uPort && !uHostName) || uPort === port);\n
        },\n
\n
        finishLoad: function (name, strip, content, onLoad) {\n
            content = strip ? text.strip(content) : content;\n
            if (masterConfig.isBuild) {\n
                buildMap[name] = content;\n
            }\n
            onLoad(content);\n
        },\n
\n
        load: function (name, req, onLoad, config) {\n
            //Name has format: some.module.filext!strip\n
            //The strip part is optional.\n
            //if strip is present, then that means only get the string contents\n
            //inside a body tag in an HTML string. For XML/SVG content it means\n
            //removing the <?xml ...?> declarations so the content can be inserted\n
            //into the current doc without problems.\n
\n
            // Do not bother with the work if a build and text will\n
            // not be inlined.\n
            if (config.isBuild && !config.inlineText) {\n
                onLoad();\n
                return;\n
            }\n
\n
            masterConfig.isBuild = config.isBuild;\n
\n
            var parsed = text.parseName(name),\n
                nonStripName = parsed.moduleName +\n
                    (parsed.ext ? \'.\' + parsed.ext : \'\'),\n
                url = req.toUrl(nonStripName),\n
                useXhr = (masterConfig.useXhr) ||\n
                         text.useXhr;\n
\n
            // Do not load if it is an empty: url\n
            if (url.indexOf(\'empty:\') === 0) {\n
                onLoad();\n
                return;\n
            }\n
\n
            //Load the text. Use XHR if possible and in a browser.\n
            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {\n
                text.get(url, function (content) {\n
                    text.finishLoad(name, parsed.strip, content, onLoad);\n
                }, function (err) {\n
                    if (onLoad.error) {\n
                        onLoad.error(err);\n
                    }\n
                });\n
            } else {\n
                //Need to fetch the resource across domains. Assume\n
                //the resource has been optimized into a JS module. Fetch\n
                //by the module name + extension, but do not include the\n
                //!strip part to avoid file system issues.\n
                req([nonStripName], function (content) {\n
                    text.finishLoad(parsed.moduleName + \'.\' + parsed.ext,\n
                                    parsed.strip, content, onLoad);\n
                });\n
            }\n
        },\n
\n
        write: function (pluginName, moduleName, write, config) {\n
            if (buildMap.hasOwnProperty(moduleName)) {\n
                var content = text.jsEscape(buildMap[moduleName]);\n
                write.asModule(pluginName + "!" + moduleName,\n
                               "define(function () { return \'" +\n
                                   content +\n
                               "\';});\\n");\n
            }\n
        },\n
\n
        writeFile: function (pluginName, moduleName, req, write, config) {\n
            var parsed = text.parseName(moduleName),\n
                extPart = parsed.ext ? \'.\' + parsed.ext : \'\',\n
                nonStripName = parsed.moduleName + extPart,\n
                //Use a \'.js\' file name so that it indicates it is a\n
                //script that can be loaded across domains.\n
                fileName = req.toUrl(parsed.moduleName + extPart) + \'.js\';\n
\n
            //Leverage own load() method to load plugin value, but only\n
            //write out values that do not have the strip argument,\n
            //to avoid any potential issues with ! in file names.\n
            text.load(nonStripName, req, function (value) {\n
                //Use own write() method to construct full module value.\n
                //But need to create shell that translates writeFile\'s\n
                //write() to the right interface.\n
                var textWrite = function (contents) {\n
                    return write(fileName, contents);\n
                };\n
                textWrite.asModule = function (moduleName, contents) {\n
                    return write.asModule(moduleName, fileName, contents);\n
                };\n
\n
                text.write(pluginName, nonStripName, textWrite, config);\n
            }, config);\n
        }\n
    };\n
\n
    if (masterConfig.env === \'node\' || (!masterConfig.env &&\n
            typeof process !== "undefined" &&\n
            process.versions &&\n
            !!process.versions.node &&\n
            !process.versions[\'node-webkit\'])) {\n
        //Using special require.nodeRequire, something added by r.js.\n
        fs = require.nodeRequire(\'fs\');\n
\n
        text.get = function (url, callback, errback) {\n
            try {\n
                var file = fs.readFileSync(url, \'utf8\');\n
                //Remove BOM (Byte Mark Order) from utf8 files if it is there.\n
                if (file.indexOf(\'\\uFEFF\') === 0) {\n
                    file = file.substring(1);\n
                }\n
                callback(file);\n
            } catch (e) {\n
                errback(e);\n
            }\n
        };\n
    } else if (masterConfig.env === \'xhr\' || (!masterConfig.env &&\n
            text.createXhr())) {\n
        text.get = function (url, callback, errback, headers) {\n
            var xhr = text.createXhr(), header;\n
            xhr.open(\'GET\', url, true);\n
\n
            //Allow plugins direct access to xhr headers\n
            if (headers) {\n
                for (header in headers) {\n
                    if (headers.hasOwnProperty(header)) {\n
                        xhr.setRequestHeader(header.toLowerCase(), headers[header]);\n
                    }\n
                }\n
            }\n
\n
            //Allow overrides specified in config\n
            if (masterConfig.onXhr) {\n
                masterConfig.onXhr(xhr, url);\n
            }\n
\n
            xhr.onreadystatechange = function (evt) {\n
                var status, err;\n
                //Do not explicitly handle errors, those should be\n
                //visible via console output in the browser.\n
                if (xhr.readyState === 4) {\n
                    status = xhr.status;\n
                    if (status > 399 && status < 600) {\n
                        //An http 4xx or 5xx error. Signal an error.\n
                        err = new Error(url + \' HTTP status: \' + status);\n
                        err.xhr = xhr;\n
                        errback(err);\n
                    } else {\n
                        callback(xhr.responseText);\n
                    }\n
\n
                    if (masterConfig.onXhrComplete) {\n
                        masterConfig.onXhrComplete(xhr, url);\n
                    }\n
                }\n
            };\n
            xhr.send(null);\n
        };\n
    } else if (masterConfig.env === \'rhino\' || (!masterConfig.env &&\n
            typeof Packages !== \'undefined\' && typeof java !== \'undefined\')) {\n
        //Why Java, why is this so awkward?\n
        text.get = function (url, callback) {\n
            var stringBuffer, line,\n
                encoding = "utf-8",\n
                file = new java.io.File(url),\n
                lineSeparator = java.lang.System.getProperty("line.separator"),\n
                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),\n
                content = \'\';\n
            try {\n
                stringBuffer = new java.lang.StringBuffer();\n
                line = input.readLine();\n
\n
                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324\n
                // http://www.unicode.org/faq/utf_bom.html\n
\n
                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn\'t due to this bug in the JDK:\n
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058\n
                if (line && line.length() && line.charAt(0) === 0xfeff) {\n
                    // Eat the BOM, since we\'ve already found the encoding on this file,\n
                    // and we plan to concatenating this buffer with others; the BOM should\n
                    // only appear at the top of a file.\n
                    line = line.substring(1);\n
                }\n
\n
                if (line !== null) {\n
                    stringBuffer.append(line);\n
                }\n
\n
                while ((line = input.readLine()) !== null) {\n
                    stringBuffer.append(lineSeparator);\n
                    stringBuffer.append(line);\n
                }\n
                //Make sure we return a JavaScript string and not a Java string.\n
                content = String(stringBuffer.toString()); //String\n
            } finally {\n
                input.close();\n
            }\n
            callback(content);\n
        };\n
    } else if (masterConfig.env === \'xpconnect\' || (!masterConfig.env &&\n
            typeof Components !== \'undefined\' && Components.classes &&\n
            Components.interfaces)) {\n
        //Avert your gaze!\n
        Cc = Components.classes,\n
        Ci = Components.interfaces;\n
        Components.utils[\'import\'](\'resource://gre/modules/FileUtils.jsm\');\n
        xpcIsWindows = (\'@mozilla.org/windows-registry-key;1\' in Cc);\n
\n
        text.get = function (url, callback) {\n
            var inStream, convertStream, fileObj,\n
                readData = {};\n
\n
            if (xpcIsWindows) {\n
                url = url.replace(/\\//g, \'\\\\\');\n
            }\n
\n
            fileObj = new FileUtils.File(url);\n
\n
            //XPCOM, you so crazy\n
            try {\n
                inStream = Cc[\'@mozilla.org/network/file-input-stream;1\']\n
                           .createInstance(Ci.nsIFileInputStream);\n
                inStream.init(fileObj, 1, 0, false);\n
\n
                convertStream = Cc[\'@mozilla.org/intl/converter-input-stream;1\']\n
                                .createInstance(Ci.nsIConverterInputStream);\n
                convertStream.init(inStream, "utf-8", inStream.available(),\n
                Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);\n
\n
                convertStream.readString(inStream.available(), readData);\n
                convertStream.close();\n
                inStream.close();\n
                callback(readData.value);\n
            } catch (e) {\n
                throw new Error((fileObj && fileObj.path || \'\') + \': \' + e);\n
            }\n
        };\n
    }\n
    return text;\n
});\n
\n
\n
define(\'text!common/main/lib/template/Header.template\',[],function () { return \'<div id="header-container">\\n    <div id="header-logo"></div>\\n    <div id="header-caption"><div><%= headerCaption %></div></div>\\n    <div id="header-documentcaption"><%= documentCaption %></div>\\n    <div id="header-back" style="display: <%= canBack ? \\\'table-cell\\\' : \\\'none\\\' %>;"><div><%= textBack %></div></div>\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Views = Common.Views || {};\r\n
define(\'common/main/lib/view/Header\',["backbone", "text!common/main/lib/template/Header.template", "core"], function (Backbone, headerTemplate) {\r\n
    Common.Views.Header = Backbone.View.extend(_.extend({\r\n
        options: {\r\n
            branding: {},\r\n
            headerCaption: "Default Caption",\r\n
            documentCaption: "",\r\n
            canBack: false\r\n
        },\r\n
        el: "#header",\r\n
        template: _.template(headerTemplate),\r\n
        events: {\r\n
            "click #header-logo": function (e) {\r\n
                var _url = !!this.branding && !!this.branding.logo && !!this.branding.logo.url ? this.branding.logo.url : "http://www.onlyoffice.com";\r\n
                var newDocumentPage = window.open(_url);\r\n
                newDocumentPage && newDocumentPage.focus();\r\n
            }\r\n
        },\r\n
        initialize: function (options) {\r\n
            this.options = this.options ? _({}).extend(this.options, options) : options;\r\n
            this.headerCaption = this.options.headerCaption;\r\n
            this.documentCaption = this.options.documentCaption;\r\n
            this.canBack = this.options.canBack;\r\n
            this.branding = this.options.customization;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template({\r\n
                headerCaption: this.headerCaption,\r\n
                documentCaption: Common.Utils.String.htmlEncode(this.documentCaption),\r\n
                canBack: this.canBack,\r\n
                textBack: this.textBack\r\n
            }));\r\n
        },\r\n
        setVisible: function (visible) {\r\n
            visible ? this.show() : this.hide();\r\n
        },\r\n
        setBranding: function (value) {\r\n
            var element;\r\n
            this.branding = value;\r\n
            if (value && value.logo && value.logo.image) {\r\n
                element = $("#header-logo");\r\n
                if (element) {\r\n
                    element.css("background-image", \'url("\' + value.logo.image + \'")\');\r\n
                }\r\n
            }\r\n
        },\r\n
        setHeaderCaption: function (value) {\r\n
            this.headerCaption = value;\r\n
            var caption = $("#header-caption > div");\r\n
            if (caption) {\r\n
                caption.html(value);\r\n
            }\r\n
            return value;\r\n
        },\r\n
        getHeaderCaption: function () {\r\n
            return this.headerCaption;\r\n
        },\r\n
        setDocumentCaption: function (value, applyOnly) {\r\n
            if (_.isUndefined(applyOnly)) {\r\n
                this.documentCaption = value;\r\n
            }\r\n
            if (!value) {\r\n
                value = "";\r\n
            }\r\n
            var dc = $("#header-documentcaption");\r\n
            if (dc) {\r\n
                dc.html(Common.Utils.String.htmlEncode(value));\r\n
            }\r\n
      

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAg=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="8" aka="AAAAAAAAAAg=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

      return value;\r\n
        },\r\n
        getDocumentCaption: function () {\r\n
            return this.documentCaption;\r\n
        },\r\n
        setCanBack: function (value) {\r\n
            this.canBack = value;\r\n
            var back = $("#header-back");\r\n
            if (back) {\r\n
                back.off("click");\r\n
                back.css("display", value ? "table-cell" : "none");\r\n
                if (value) {\r\n
                    back.on("click", _.bind(this.onBackClick, this));\r\n
                }\r\n
            }\r\n
        },\r\n
        getCanBack: function () {\r\n
            return this.canBack;\r\n
        },\r\n
        onBackClick: function (e) {\r\n
            Common.Gateway.goBack(e.which == 2);\r\n
            Common.component.Analytics.trackEvent("Back to Folder");\r\n
        },\r\n
        textBack: "==="\r\n
    },\r\n
    Common.Views.Header || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/Viewport.template\',[],function () { return \'<div class="layout-region">\\n    <div id="viewport-vbox-layout" class="layout-ct vbox">\\n        <div id="header" class="layout-item"></div>\\n        <div id="toolbar" class="layout-item"></div>\\n        <div class="layout-item">\\n            <div id="viewport-hbox-layout" class="layout-ct hbox">\\n                <div id="left-menu" class="layout-item" style="width: 40px;"></div>\\n                <div id="file-menu-panel" class="left-menu-full-ct" style="display:none;"></div>\\n                <div id="about-menu-panel" class="left-menu-full-ct" style="display:none;"></div>\\n                <div class="layout-item">\\n                    <div class="layout-ct vbox">\\n                        <div id="cell-editing-box" class="layout-item" style="height:18px;"></div>\\n                        <div id="editor_sdk" class="layout-item" style="min-height: 100px;"></div>\\n                    </div>\\n                </div>\\n                <div id="right-menu" class="layout-item"></div>\\n            </div>\\n        </div>\\n        <div id="statusbar" class="layout-item"></div>\\n    </div>\\n</div>\\n\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/BaseView\',["backbone"], function (Backbone) {\r\n
    Common.UI = _.extend(Common.UI || {},\r\n
    {\r\n
        Keys: {\r\n
            BACKSPACE: 8,\r\n
            TAB: 9,\r\n
            RETURN: 13,\r\n
            SHIFT: 16,\r\n
            CTRL: 17,\r\n
            ALT: 18,\r\n
            ESC: 27,\r\n
            LEFT: 37,\r\n
            UP: 38,\r\n
            RIGHT: 39,\r\n
            DOWN: 40,\r\n
            DELETE: 46,\r\n
            HOME: 36,\r\n
            END: 35,\r\n
            SPACE: 32,\r\n
            PAGEUP: 33,\r\n
            PAGEDOWN: 34,\r\n
            INSERT: 45,\r\n
            NUM_PLUS: 107,\r\n
            NUM_MINUS: 109,\r\n
            F1: 112,\r\n
            F2: 113,\r\n
            F3: 114,\r\n
            F4: 115,\r\n
            F5: 116,\r\n
            F6: 117,\r\n
            F7: 118,\r\n
            F8: 119,\r\n
            F9: 120,\r\n
            F10: 121,\r\n
            F11: 122,\r\n
            F12: 123,\r\n
            EQUALITY: 187,\r\n
            MINUS: 189\r\n
        },\r\n
        BaseView: Backbone.View.extend({\r\n
            isSuspendEvents: false,\r\n
            initialize: function (options) {\r\n
                this.options = this.options ? _({}).extend(this.options, options) : options;\r\n
            },\r\n
            setVisible: function (visible) {\r\n
                return this[visible ? "show" : "hide"]();\r\n
            },\r\n
            isVisible: function () {\r\n
                return $(this.el).is(":visible");\r\n
            },\r\n
            suspendEvents: function () {\r\n
                this.isSuspendEvents = true;\r\n
            },\r\n
            resumeEvents: function () {\r\n
                this.isSuspendEvents = false;\r\n
            }\r\n
        }),\r\n
        getId: function (prefix) {\r\n
            return _.uniqueId(prefix || "asc-gen");\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Layout\',["backbone"], function () {\r\n
    var BaseLayout = function (options) {\r\n
        this.box = null;\r\n
        this.panels = [];\r\n
        _.extend(this, options || {});\r\n
    };\r\n
    var LayoutPanel = function () {\r\n
        return {\r\n
            width: null,\r\n
            height: null,\r\n
            resize: false,\r\n
            stretch: false,\r\n
            rely: false\r\n
        };\r\n
    };\r\n
    _.extend(BaseLayout.prototype, Backbone.Events, {\r\n
        initialize: function (options) {\r\n
            this.$parent = this.box.parent();\r\n
            this.resize = {\r\n
                eventMove: _.bind(this.resizeMove, this),\r\n
                eventStop: _.bind(this.resizeStop, this)\r\n
            };\r\n
            var panel, resizer, stretch = false;\r\n
            options.items.forEach(function (item) {\r\n
                item.el instanceof HTMLElement && (item.el = $(item.el));\r\n
                panel = _.extend(new LayoutPanel(), item);\r\n
                if (panel.stretch) {\r\n
                    stretch = true;\r\n
                    panel.rely = false;\r\n
                    panel.resize = false;\r\n
                }\r\n
                this.panels.push(panel);\r\n
                if (panel.resize) {\r\n
                    resizer = {\r\n
                        isresizer: true,\r\n
                        minpos: panel.resize.min || 0,\r\n
                        maxpos: panel.resize.max || 0\r\n
                    };\r\n
                    if (!stretch) {\r\n
                        panel.resize.el = resizer.el = panel.el.after(\'<div class="layout-resizer after"></div>\').next();\r\n
                        this.panels.push(resizer);\r\n
                    } else {\r\n
                        panel.resize.el = resizer.el = panel.el.before(\'<div class="layout-resizer before"></div>\').prev();\r\n
                        this.panels.splice(this.panels.length - 1, 0, resizer);\r\n
                    }\r\n
                    panel.resize.hidden && resizer.el.hide();\r\n
                }\r\n
            },\r\n
            this);\r\n
        },\r\n
        doLayout: function () {},\r\n
        getElementHeight: function (el) {\r\n
            return parseInt(el.css("height"));\r\n
        },\r\n
        getElementWidth: function (el) {\r\n
            return parseInt(el.css("width"));\r\n
        },\r\n
        onSelectStart: function (e) {\r\n
            if (e.preventDefault) {\r\n
                e.preventDefault();\r\n
            }\r\n
            return false;\r\n
        },\r\n
        addHandler: function (elem, type, handler) {\r\n
            if (elem.addEventListener) {\r\n
                elem.addEventListener(type, handler);\r\n
            } else {\r\n
                if (elem.attachEvent) {\r\n
                    elem.attachEvent("on" + type, handler);\r\n
                } else {\r\n
                    elem["on" + type] = handler;\r\n
                }\r\n
            }\r\n
        },\r\n
        removeHandler: function (elem, type, handler) {\r\n
            if (elem.removeEventListener) {\r\n
                elem.removeEventListener(type, handler);\r\n
            } else {\r\n
                if (elem.detachEvent) {\r\n
                    elem.detachEvent("on" + type, handler);\r\n
                } else {\r\n
                    elem["on" + type] = null;\r\n
                }\r\n
            }\r\n
        },\r\n
        clearSelection: function () {\r\n
            if (window.getSelection) {\r\n
                var selection = window.getSelection();\r\n
                if (selection.empty) {\r\n
                    selection.empty();\r\n
                } else {\r\n
                    if (selection.removeAllRanges) {\r\n
                        selection.removeAllRanges();\r\n
                    }\r\n
                }\r\n
            } else {\r\n
                if (document.selection) {\r\n
                    document.selection.empty();\r\n
                }\r\n
            }\r\n
        },\r\n
        resizeStart: function (e) {\r\n
            this.clearSelection();\r\n
            this.addHandler(window.document, "selectstart", this.onSelectStart);\r\n
            $(document).on({\r\n
                mousemove: this.resize.eventMove,\r\n
                mouseup: this.resize.eventStop\r\n
            });\r\n
            var panel = e.data.panel;\r\n
            this.resize.type = e.data.type;\r\n
            this.resize.$el = panel.el;\r\n
            this.resize.min = panel.minpos;\r\n
            this.resize.$el.addClass("move");\r\n
            if (e.data.type == "vertical") {\r\n
                this.resize.height = parseInt(this.resize.$el.css("height"));\r\n
                this.resize.max = (panel.maxpos > 0 ? panel.maxpos : this.resize.$el.parent().height() + panel.maxpos) - this.resize.height;\r\n
                this.resize.inity = e.pageY - parseInt(e.currentTarget.style.top);\r\n
            } else {\r\n
                if (e.data.type == "horizontal") {\r\n
                    this.resize.width = parseInt(this.resize.$el.css("width"));\r\n
                    this.resize.max = (panel.maxpos > 0 ? panel.maxpos : this.resize.$el.parent().height() + panel.maxpos) - this.resize.width;\r\n
                    this.resize.initx = e.pageX - parseInt(e.currentTarget.style.left);\r\n
                }\r\n
            }\r\n
        },\r\n
        resizeMove: function (e) {\r\n
            if (this.resize.type == "vertical") {\r\n
                var prop = "top",\r\n
                value = e.pageY - this.resize.inity;\r\n
            } else {\r\n
                if (this.resize.type == "horizontal") {\r\n
                    prop = "left";\r\n
                    value = e.pageX - this.resize.initx;\r\n
                }\r\n
            }\r\n
            if (! (value < this.resize.min) && !(value > this.resize.max)) {\r\n
                this.resize.$el[0].style[prop] = value + "px";\r\n
            }\r\n
        },\r\n
        resizeStop: function (e) {\r\n
            this.removeHandler(window.document, "selectstart", this.onSelectStart);\r\n
            $(document).off({\r\n
                mousemove: this.resize.eventMove,\r\n
                mouseup: this.resize.eventStop\r\n
            });\r\n
            if (this.resize.type == "vertical") {\r\n
                var prop = "height";\r\n
                var value = e.pageY - this.resize.inity;\r\n
            } else {\r\n
                if (this.resize.type == "horizontal") {\r\n
                    prop = "width";\r\n
                    value = e.pageX - this.resize.initx;\r\n
                }\r\n
            }\r\n
            value < this.resize.min && (value = this.resize.min);\r\n
            value > this.resize.max && (value = this.resize.max);\r\n
            if (this.resize.$el.hasClass("after")) {\r\n
                var panel = this.resize.$el.prev();\r\n
            } else {\r\n
                panel = this.resize.$el.next();\r\n
                value = panel.parent()[prop]() - (value + this.resize[prop]);\r\n
            }\r\n
            panel.css(prop, value + "px");\r\n
            this.resize.$el.removeClass("move");\r\n
            delete this.resize.$el;\r\n
            if (this.resize.value != value) {\r\n
                this.doLayout();\r\n
                this.trigger("layout:resizedrag", this);\r\n
            }\r\n
        }\r\n
    }); ! Common.UI && (Common.UI = {});\r\n
    Common.UI.VBoxLayout = function (options) {\r\n
        BaseLayout.apply(this, arguments);\r\n
        this.initialize.apply(this, arguments);\r\n
    };\r\n
    Common.UI.VBoxLayout.prototype = _.extend(new BaseLayout(), {\r\n
        initialize: function (options) {\r\n
            BaseLayout.prototype.initialize.call(this, options);\r\n
            this.panels.forEach(function (panel) { ! panel.stretch && !panel.height && (panel.height = this.getElementHeight(panel.el));\r\n
                if (panel.isresizer) {\r\n
                    panel.el.on("mousedown", {\r\n
                        type: "vertical",\r\n
                        panel: panel\r\n
                    },\r\n
                    _.bind(this.resizeStart, this));\r\n
                }\r\n
            },\r\n
            this);\r\n
            this.doLayout.call(this);\r\n
        },\r\n
        doLayout: function () {\r\n
            var height = 0,\r\n
            stretchable, style;\r\n
            this.panels.forEach(function (panel) {\r\n
                if (!panel.stretch) {\r\n
                    style = panel.el.is(":visible");\r\n
                    if (style) {\r\n
                        height += (panel.rely !== true ? panel.height : this.getElementHeight(panel.el));\r\n
                    }\r\n
                    if (panel.resize && panel.resize.autohide !== false && panel.resize.el) {\r\n
                        if (style) {\r\n
                            panel.resize.el.show();\r\n
                            stretchable && (height += panel.resize.height);\r\n
                        } else {\r\n
                            panel.resize.el.hide();\r\n
                            stretchable && (height -= panel.resize.height);\r\n
                        }\r\n
                    }\r\n
                } else {\r\n
                    stretchable = panel;\r\n
                }\r\n
            },\r\n
            this);\r\n
            stretchable && (stretchable.height = this.$parent.height() - height);\r\n
            height = 0;\r\n
            this.panels.forEach(function (panel) {\r\n
                if (panel.el.is(":visible")) {\r\n
                    style = {\r\n
                        top: height\r\n
                    };\r\n
                    panel.rely !== true && (style.height = panel.height);\r\n
                    panel.el.css(style);\r\n
                    height += this.getElementHeight(panel.el);\r\n
                }\r\n
            },\r\n
            this);\r\n
        }\r\n
    });\r\n
    Common.UI.HBoxLayout = function (options) {\r\n
        BaseLayout.apply(this, arguments);\r\n
        this.initialize.apply(this, arguments);\r\n
    };\r\n
    Common.UI.HBoxLayout.prototype = _.extend(new BaseLayout(), {\r\n
        initialize: function (options) {\r\n
            BaseLayout.prototype.initialize.call(this, options);\r\n
            this.panels.forEach(function (panel) { ! panel.stretch && !panel.width && (panel.width = this.getElementWidth(panel.el));\r\n
                if (panel.isresizer) {\r\n
                    panel.el.on("mousedown", {\r\n
                        type: "horizontal",\r\n
                        panel: panel\r\n
                    },\r\n
                    _.bind(this.resizeStart, this));\r\n
                }\r\n
            },\r\n
            this);\r\n
            this.doLayout.call(this);\r\n
        },\r\n
        doLayout: function (event) {\r\n
            var width = 0,\r\n
            stretchable, style;\r\n
            this.panels.forEach(function (panel) {\r\n
                if (!panel.stretch) {\r\n
                    style = panel.el.is(":visible");\r\n
                    if (style) {\r\n
                        width += (panel.rely !== true ? panel.width : this.getElementWidth(panel.el));\r\n
                    }\r\n
                    if (panel.resize && panel.resize.autohide !== false && panel.resize.el) {\r\n
                        if (style) {\r\n
                            panel.resize.el.show();\r\n
                            stretchable && (width -= panel.resize.width);\r\n
                        } else {\r\n
                            panel.resize.el.hide();\r\n
                            stretchable && (width -= panel.resize.width);\r\n
                        }\r\n
                    }\r\n
                } else {\r\n
                    stretchable = panel;\r\n
                }\r\n
            },\r\n
            this);\r\n
            stretchable && (stretchable.width = this.$parent.width() - width);\r\n
            width = 0;\r\n
            this.panels.forEach(function (panel) {\r\n
                if (panel.el.is(":visible")) {\r\n
                    style = {\r\n
                        left: width\r\n
                    };\r\n
                    panel.rely !== true && (style.width = panel.width);\r\n
                    panel.el.css(style);\r\n
                    width += this.getElementWidth(panel.el);\r\n
                }\r\n
            },\r\n
            this);\r\n
        }\r\n
    });\r\n
    Common.UI.VBoxLayout.prototype.constructor = Common.UI.VBoxLayout;\r\n
    Common.UI.HBoxLayout.prototype.constructor = Common.UI.HBoxLayout;\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/Viewport\',["text!spreadsheeteditor/main/app/template/Viewport.template", "jquery", "underscore", "backbone", "common/main/lib/component/BaseView", "common/main/lib/component/Layout"], function (viewportTemplate, $, _, Backbone) {\r\n
    SSE.Views.Viewport = Backbone.View.extend({\r\n
        el: "#viewport",\r\n
        template: _.template(viewportTemplate),\r\n
        events: {},\r\n
        initialize: function () {},\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({}));\r\n
            if (Common.Utils.isSafari) {\r\n
                $("body").addClass("safari");\r\n
                $("body").mousewheel(function (e) {\r\n
                    e.preventDefault();\r\n
                    e.stopPropagation();\r\n
                });\r\n
            } else {\r\n
                if (Common.Utils.isChrome) {\r\n
                    $("body").addClass("chrome");\r\n
                }\r\n
            }\r\n
            var $container = $("#viewport-vbox-layout", el);\r\n
            var items = $container.find(" > .layout-item");\r\n
            this.vlayout = new Common.UI.VBoxLayout({\r\n
                box: $container,\r\n
                items: [{\r\n
                    el: items[0],\r\n
                    rely: true\r\n
                },\r\n
                {\r\n
                    el: items[1],\r\n
                    rely: true\r\n
                },\r\n
                {\r\n
                    el: items[2],\r\n
                    stretch: true\r\n
                },\r\n
                {\r\n
                    el: items[3],\r\n
                    height: 25\r\n
                }]\r\n
            });\r\n
            $container = $("#viewport-hbox-layout", el);\r\n
            items = $container.find(" > .layout-item");\r\n
            this.hlayout = new Common.UI.HBoxLayout({\r\n
                box: $container,\r\n
                items: [{\r\n
                    el: items[0],\r\n
                    rely: true,\r\n
                    resize: {\r\n
                        hidden: true,\r\n
                        autohide: false,\r\n
                        min: 300,\r\n
                        max: 600\r\n
                    }\r\n
                },\r\n
                {\r\n
                    el: items[1],\r\n
                    stretch: true\r\n
                },\r\n
                {\r\n
                    el: $(items[2]).hide(),\r\n
                    rely: true\r\n
                }]\r\n
            });\r\n
            $container = $container.find(".layout-ct.vbox");\r\n
            items = $container.find(" > .layout-item");\r\n
            this.celayout = new Common.UI.VBoxLayout({\r\n
                box: $container,\r\n
                items: [{\r\n
                    el: items[0],\r\n
                    rely: true,\r\n
                    resize: {\r\n
                        min: 19,\r\n
                        max: -100\r\n
                    }\r\n
                },\r\n
                {\r\n
                    el: items[1],\r\n
                    stretch: true\r\n
                }]\r\n
            });\r\n
            return this;\r\n
        },\r\n
        applyEditorMode: function () {\r\n
            var me = this,\r\n
            toolbarView = SSE.getController("Toolbar").getView("Toolbar"),\r\n
            rightMenuView = SSE.getController("RightMenu").getView("RightMenu");\r\n
            me._toolbar = toolbarView.render(this.mode.isEditDiagram);\r\n
            me._rightMenu = rightMenuView.render();\r\n
        },\r\n
        setMode: function (mode, delay) {\r\n
            if (mode.isDisconnected) {\r\n
                if (_.isUndefined(this.mode)) {\r\n
                    this.mode = {};\r\n
                }\r\n
                this.mode.canCoAuthoring = false;\r\n
            } else {\r\n
                this.mode = mode;\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/Viewport\',["core", "common/main/lib/view/Header", "spreadsheeteditor/main/app/view/Viewport"], function (Viewport) {\r\n
    SSE.Controllers.Viewport = Backbone.Controller.extend({\r\n
        models: [],\r\n
        collections: [],\r\n
        views: ["Viewport", "Common.Views.Header"],\r\n
        initialize: function () {\r\n
            this.addListeners({\r\n
                "Viewport": {}\r\n
            });\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.viewport = this.createView("Viewport").render();\r\n
            this.header = this.createView("Common.Views.Header", {\r\n
                headerCaption: "Spreadsheet Editor"\r\n
            }).render();\r\n
            Common.NotificationCenter.on("layout:changed", _.bind(this.onLayoutChanged, this));\r\n
            $(window).on("resize", _.bind(this.onWindowResize, this));\r\n
            this.viewport.celayout.on("layout:resizedrag", function () {\r\n
                this.viewport.fireEvent("layout:resizedrag", [this, "cell:edit"]);\r\n
                this.api.asc_Resize();\r\n
            },\r\n
            this);\r\n
            this.viewport.hlayout.on("layout:resizedrag", function () {\r\n
                this.api.asc_Resize();\r\n
            },\r\n
            this);\r\n
            this.boxSdk = $("#editor_sdk");\r\n
            this.boxFormula = $("#cell-editing-box");\r\n
            this.boxSdk.css("border-left", "none");\r\n
            this.boxFormula.css("border-left", "none");\r\n
        },\r\n
        onLayoutChanged: function (area) {\r\n
            switch (area) {\r\n
            default:\r\n
                this.viewport.vlayout.doLayout();\r\n
                this.viewport.celayout.doLayout();\r\n
            case "rightmenu":\r\n
                this.viewport.hlayout.doLayout();\r\n
                break;\r\n
            case "leftmenu":\r\n
                var panel = this.viewport.hlayout.items[0];\r\n
                if (panel.resize.el) {\r\n
                    if (panel.el.width() > 40) {\r\n
                        this.boxSdk.css("border-left", "");\r\n
                        this.boxFormula.css("border-left", "");\r\n
                        panel.resize.el.show();\r\n
                    } else {\r\n
                        panel.resize.el.hide();\r\n
                        this.boxSdk.css("border-left", "none");\r\n
                        this.boxFormula.css("border-left", "none");\r\n
                    }\r\n
                }\r\n
                this.viewport.hlayout.doLayout();\r\n
                break;\r\n
            case "header":\r\n
                case "toolbar":\r\n
                case "status":\r\n
                this.viewport.vlayout.doLayout();\r\n
                this.viewport.celayout.doLayout();\r\n
                break;\r\n
            case "celleditor":\r\n
                if (arguments[1]) {\r\n
                    this.boxSdk.css("border-top", arguments[1] == "hidden" ? "none" : "");\r\n
                }\r\n
                this.viewport.celayout.doLayout();\r\n
                break;\r\n
            }\r\n
            this.api.asc_Resize();\r\n
        },\r\n
        onWindowResize: function (e) {\r\n
            this.onLayoutChanged("window");\r\n
            Common.NotificationCenter.trigger("window:resize");\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
if (Common.Utils === undefined) {\r\n
    Common.Utils = {};\r\n
}\r\n
Common.Utils = new(function () {\r\n
    var userAgent = navigator.userAgent.toLowerCase(),\r\n
    check = function (regex) {\r\n
        return regex.test(userAgent);\r\n
    },\r\n
    isStrict = document.compatMode == "CSS1Compat",\r\n
    version = function (is, regex) {\r\n
        var m;\r\n
        return (is && (m = regex.exec(userAgent))) ? parseFloat(m[1]) : 0;\r\n
    },\r\n
    docMode = document.documentMode,\r\n
    isOpera = check(/opera/),\r\n
    isOpera10_5 = isOpera && check(/version\\/10\\.5/),\r\n
    isChrome = check(/\\bchrome\\b/),\r\n
    isWebKit = check(/webkit/),\r\n
    isSafari = !isChrome && check(/safari/),\r\n
    isSafari2 = isSafari && check(/applewebkit\\/4/),\r\n
    isSafari3 = isSafari && check(/version\\/3/),\r\n
    isSafari4 = isSafari && check(/version\\/4/),\r\n
    isSafari5_0 = isSafari && check(/version\\/5\\.0/),\r\n
    isSafari5 = isSafari && check(/version\\/5/),\r\n
    isIE = !isOpera && (check(/msie/) || check(/trident/)),\r\n
    isIE7 = isIE && ((check(/msie 7/) && docMode != 8 && docMode != 9 && docMode != 10) || docMode == 7),\r\n
    isIE8 = isIE && ((check(/msie 8/) && docMode != 7 && docMode != 9 && docMode != 10) || docMode == 8),\r\n
    isIE9 = isIE && ((check(/msie 9/) && docMode != 7 && docMode != 8 && docMode != 10) || docMode == 9),\r\n
    isIE10 = isIE && ((check(/msie 10/) && docMode != 7 && docMode != 8 && docMode != 9) || docMode == 10),\r\n
    isIE11 = isIE && ((check(/trident\\/7\\.0/) && docMode != 7 && docMode != 8 && docMode != 9 && docMode != 10) || docMode == 11),\r\n
    isIE6 = isIE && check(/msie 6/),\r\n
    isGecko = !isWebKit && !isIE && check(/gecko/),\r\n
    isGecko3 = isGecko && check(/rv:1\\.9/),\r\n
    isGecko4 = isGecko && check(/rv:2\\.0/),\r\n
    isGecko5 = isGecko && check(/rv:5\\./),\r\n
    isGecko10 = isGecko && check(/rv:10\\./),\r\n
    isFF3_0 = isGecko3 && check(/rv:1\\.9\\.0/),\r\n
    isFF3_5 = isGecko3 && check(/rv:1\\.9\\.1/),\r\n
    isFF3_6 = isGecko3 && check(/rv:1\\.9\\.2/),\r\n
    isWindows = check(/windows|win32/),\r\n
    isMac = check(/macintosh|mac os x/),\r\n
    isLinux = check(/linux/),\r\n
    chromeVersion = version(true, /\\bchrome\\/(\\d+\\.\\d+)/),\r\n
    firefoxVersion = version(true, /\\bfirefox\\/(\\d+\\.\\d+)/),\r\n
    ieVersion = version(isIE, /msie (\\d+\\.\\d+)/),\r\n
    operaVersion = version(isOpera, /version\\/(\\d+\\.\\d+)/),\r\n
    safariVersion = version(isSafari, /version\\/(\\d+\\.\\d+)/),\r\n
    webKitVersion = version(isWebKit, /webkit\\/(\\d+\\.\\d+)/),\r\n
    isSecure = /^https/i.test(window.location.protocol),\r\n
    emailRe = /^(mailto:)?([a-z0-9\\._-]+@[a-z0-9\\.-]+\\.[a-z]{2,4})([a-ÑÑ‘0-9\\._%+-=\\? :&]*)/i,\r\n
    ipRe = /^(((https?)|(ftps?)):\\/\\/)?([\\-\\wÐ°-ÑÑ‘]*:?[\\-\\wÐ°-ÑÑ‘]*@)?(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\\d+)?(\\/[%\\-\\wÐ°-ÑÑ‘]*(\\.[\\wÐ°-ÑÑ‘]{2,})?(([\\wÐ°-ÑÑ‘\\-\\.\\?\\\\\\/+@&#;`~=%!,]*)(\\.[\\wÐ°-ÑÑ‘]{2,})?)*)*\\/?/i,\r\n
    hostnameRe = /^(((https?)|(ftps?)):\\/\\/)?([\\-\\wÐ°-ÑÑ‘]*:?[\\-\\wÐ°-ÑÑ‘]*@)?(([\\-\\wÐ°-ÑÑ‘]+\\.)+[\\wÐ°-ÑÑ‘\\-]{2,}(:\\d+)?(\\/[%\\-\\wÐ°-ÑÑ‘]*(\\.[\\wÐ°-ÑÑ‘]{2,})?(([\\wÐ°-ÑÑ‘\\-\\.\\?\\\\\\/+@&#;`~=%!,]*)(\\.[\\wÐ°-ÑÑ‘]{2,})?)*)*\\/?)/i,\r\n
    localRe = /^(((https?)|(ftps?)):\\/\\/)([\\-\\wÐ°-ÑÑ‘]*:?[\\-\\wÐ°-ÑÑ‘]*@)?(([\\-\\wÐ°-ÑÑ‘]+)(:\\d+)?(\\/[%\\-\\wÐ°-ÑÑ‘]*(\\.[\\wÐ°-ÑÑ‘]{2,})?(([\\wÐ°-ÑÑ‘\\-\\.\\?\\\\\\/+@&#;`~=%!,]*)(\\.[\\wÐ°-ÑÑ‘]{2,})?)*)*\\/?)/i,\r\n
    emailStrongRe = /(mailto:)([a-z0-9\\._-]+@[a-z0-9\\.-]+\\.[a-z]{2,4})([a-ÑÑ‘0-9\\._%+-=\\? :&]*)/ig,\r\n
    ipStrongRe = /(((https?)|(ftps?)):\\/\\/([\\-\\wÐ°-ÑÑ‘]*:?[\\-\\wÐ°-ÑÑ‘]*@)?)(((1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9])\\.){3}(1[0-9]{2}|2[0-4][0-9]|25[0-5]|[1-9][0-9]|[0-9]))(:\\d+)?(\\/[%\\-\\wÐ°-ÑÑ‘]*(\\.[\\wÐ°-ÑÑ‘]{2,})?(([\\wÐ°-ÑÑ‘\\-\\.\\?\\\\\\/+@&#;`~=%!,]*)(\\.[\\wÐ°-ÑÑ‘]{2,})?)*)*\\/?/ig,\r\n
    hostnameStrongRe = /((((https?)|(ftps?)):\\/\\/([\\-\\wÐ°-ÑÑ‘]*:?[\\-\\wÐ°-ÑÑ‘]*@)?)|(([\\-\\wÐ°-ÑÑ‘]*:?[\\-\\wÐ°-ÑÑ‘]*@)?www\\.))((([\\-\\wÐ°-ÑÑ‘]+\\.)+[\\wÐ°-ÑÑ‘\\-]{2,}|([\\-\\wÐ°-ÑÑ‘]+))(:\\d+)?(\\/[%\\-\\wÐ°-ÑÑ‘]*(\\.[\\wÐ°-ÑÑ‘]{2,})?(([\\wÐ°-ÑÑ‘\\-\\.\\?\\\\\\/+@&#;`~=%!,]*)(\\.[\\wÐ°-ÑÑ‘]{2,})?)*)*\\/?)/ig;\r\n
    return {\r\n
        userAgent: userAgent,\r\n
        isStrict: isStrict,\r\n
        isIEQuirks: isIE && (!isStrict && (isIE6 || isIE7 || isIE8 || isIE9)),\r\n
        isOpera: isOpera,\r\n
        isOpera10_5: isOpera10_5,\r\n
        isWebKit: isWebKit,\r\n
        isChrome: isChrome,\r\n
        isSafari: isSafari,\r\n
        isSafari3: isSafari3,\r\n
        isSafari4: isSafari4,\r\n
        isSafari5: isSafari5,\r\n
        isSafari5_0: isSafari5_0,\r\n
        isSafari2: isSafari2,\r\n
        isIE: isIE,\r\n
        isIE6: isIE6,\r\n
        isIE7: isIE7,\r\n
        isIE7m: isIE6 || isIE7,\r\n
        isIE7p: isIE && !isIE6,\r\n
        isIE8: isIE8,\r\n
        isIE8m: isIE6 || isIE7 || isIE8,\r\n
        isIE8p: isIE && !(isIE6 || isIE7),\r\n
        isIE9: isIE9,\r\n
        isIE9m: isIE6 || isIE7 || isIE8 || isIE9,\r\n
        isIE9p: isIE && !(isIE6 || isIE7 || isIE8),\r\n
        isIE10: isIE10,\r\n
        isIE10m: isIE6 || isIE7 || isIE8 || isIE9 || isIE10,\r\n
        isIE10p: isIE && !(isIE6 || isIE7 || isIE8 || isIE9),\r\n
        isIE11: isIE11,\r\n
        isIE11m: isIE6 || isIE7 || isIE8 || isIE9 || isIE10 || isIE11,\r\n
        isIE11p: isIE && !(isIE6 || isIE7 || isIE8 || isIE9 || isIE10),\r\n
        isGecko: isGecko,\r\n
        isGecko3: isGecko3,\r\n
        isGecko4: isGecko4,\r\n
        isGecko5: isGecko5,\r\n
        isGecko10: isGecko10,\r\n
        isFF3_0: isFF3_0,\r\n
        isFF3_5: isFF3_5,\r\n
        isFF3_6: isFF3_6,\r\n
        isFF4: 4 <= firefoxVersion && firefoxVersion < 5,\r\n
        isFF5: 5 <= firefoxVersion && firefoxVersion < 6,\r\n
        isFF10: 10 <= firefoxVersion && firefoxVersion < 11,\r\n
        isLinux: isLinux,\r\n
        isWindows: isWindows,\r\n
        isMac: isMac,\r\n
        chromeVersion: chromeVersion,\r\n
        firefoxVersion: firefoxVersion,\r\n
        ieVersion: ieVersion,\r\n
        operaVersion: operaVersion,\r\n
        safariVersion: safariVersion,\r\n
        webKitVersion: webKitVersion,\r\n
        isSecure: isSecure,\r\n
        emailRe: emailRe,\r\n
        ipRe: ipRe,\r\n
        hostnameRe: hostnameRe,\r\n
        localRe: localRe,\r\n
        emailStrongRe: emailStrongRe,\r\n
        ipStrongRe: ipStrongRe,\r\n
        hostnameStrongRe: hostnameStrongRe\r\n
    };\r\n
})();\r\n
Common.Utils.ThemeColor = new(function () {\r\n
    return {\r\n
        ThemeValues: [6, 15, 7, 16, 0, 1, 2, 3, 4, 5],\r\n
        setColors: function (colors, standart_colors) {\r\n
            var i, j, item;\r\n
            if (standart_colors && standart_colors.length > 0) {\r\n
                var standartcolors = [];\r\n
                for (i = 0; i < standart_colors.length; i++) {\r\n
                    item = this.getHexColor(standart_colors[i].get_r(), standart_colors[i].get_g(), standart_colors[i].get_b());\r\n
                    standartcolors.push(item);\r\n
                }\r\n
                this.standartcolors = standartcolors;\r\n
            }\r\n
            var effectÐ¡olors = [];\r\n
            for (i = 0; i < 6; i++) {\r\n
                for (j = 0; j < 10; j++) {\r\n
                    var idx = i + j * 6;\r\n
                    item = {\r\n
                        color: this.getHexColor(colors[idx].get_r(), colors[idx].get_g(), colors[idx].get_b()),\r\n
                        effectId: idx,\r\n
                        effectValue: this.ThemeValues[j]\r\n
                    };\r\n
                    effectÐ¡olors.push(item);\r\n
                }\r\n
            }\r\n
            this.effectcolors = effectÐ¡olors;\r\n
        },\r\n
        getEffectColors: function () {\r\n
            return this.effectcolors;\r\n
        },\r\n
        getStandartColors: function () {\r\n
            return this.standartcolors;\r\n
        },\r\n
        getHexColor: function (r, g, b) {\r\n
            r = r.toString(16);\r\n
            g = g.toString(16);\r\n
            b = b.toString(16);\r\n
            if (r.length == 1) {\r\n
                r = "0" + r;\r\n
            }\r\n
            if (g.length == 1) {\r\n
                g = "0" + g;\r\n
            }\r\n
            if (b.length == 1) {\r\n
                b = "0" + b;\r\n
            }\r\n
            return r + g + b;\r\n
        },\r\n
        getRgbColor: function (clr) {\r\n
            var color = (typeof(clr) == "object") ? clr.color : clr;\r\n
            color = color.replace(/#/, "");\r\n
            if (color.length == 3) {\r\n
                color = color.replace(/(.)/g, "$1$1");\r\n
            }\r\n
            color = parseInt(color, 16);\r\n
            var c = new CAscColor();\r\n
            c.put_type((typeof(clr) == "object" && clr.effectId !== undefined) ? c_oAscColor.COLOR_TYPE_SCHEME : c_oAscColor.COLOR_TYPE_SRGB);\r\n
            c.put_r(color >> 16);\r\n
            c.put_g((color & 65280) >> 8);\r\n
            c.put_b(color & 255);\r\n
            c.put_a(255);\r\n
            if (clr.effectId !== undefined) {\r\n
                c.put_value(clr.effectId);\r\n
            }\r\n
            return c;\r\n
        },\r\n
        colorValue2EffectId: function (clr) {\r\n
            if (typeof(clr) == "object" && clr.effectValue !== undefined && this.effectcolors) {\r\n
                for (var i = 0; i < this.effectcolors.length; i++) {\r\n
                    if (this.effectcolors[i].effectValue === clr.effectValue && clr.color.toUpperCase() === this.effectcolors[i].color.toUpperCase()) {\r\n
                        clr.effectId = this.effectcolors[i].effectId;\r\n
                        break;\r\n
                    }\r\n
                }\r\n
            }\r\n
            return clr;\r\n
        }\r\n
    };\r\n
})();\r\n
Common.Utils.Metric = new(function () {\r\n
    var me = this;\r\n
    me.c_MetricUnits = {\r\n
        cm: 0,\r\n
        pt: 1\r\n
    };\r\n
    me.currentMetric = me.c_MetricUnits.pt;\r\n
    me.metricName = ["cm", "pt"];\r\n
    return {\r\n
        c_MetricUnits: me.c_MetricUnits,\r\n
        metricName: me.metricName,\r\n
        setCurrentMetric: function (value) {\r\n
            me.currentMetric = value;\r\n
        },\r\n
        getCurrentMetric: function () {\r\n
            return me.currentMetric;\r\n
        },\r\n
        fnRecalcToMM: function (value) {\r\n
            if (value !== null && value !== undefined) {\r\n
                switch (me.currentMetric) {\r\n
                case me.c_MetricUnits.cm:\r\n
                    return value * 10;\r\n
                case me.c_MetricUnits.pt:\r\n
                    return value * 25.4 / 72;\r\n
                }\r\n
            }\r\n
            return value;\r\n
        },\r\n
        fnRecalcFromMM: function (value) {\r\n
            switch (me.currentMetric) {\r\n
            case me.c_MetricUnits.cm:\r\n
                return parseFloat((value / 10).toFixed(4));\r\n
            case me.c_MetricUnits.pt:\r\n
                return parseFloat((value * 72 / 25.4).toFixed(3));\r\n
            }\r\n
            return value;\r\n
        }\r\n
    };\r\n
})();\r\n
Common.Utils.RGBColor = function (colorString) {\r\n
    var r, g, b;\r\n
    if (colorString.charAt(0) == "#") {\r\n
        colorString = colorString.substr(1, 6);\r\n
    }\r\n
    colorString = colorString.replace(/ /g, "");\r\n
    colorString = colorString.toLowerCase();\r\n
    var colorDefinitions = [{\r\n
        re: /^rgb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\r\n
        process: function (bits) {\r\n
            return [parseInt(bits[1]), parseInt(bits[2]), parseInt(bits[3])];\r\n
        }\r\n
    },\r\n
    {\r\n
        re: /^hsb\\((\\d{1,3}),\\s*(\\d{1,3}),\\s*(\\d{1,3})\\)$/,\r\n
        process: function (bits) {\r\n
            var rgb = {};\r\n
            var h = Math.round(bits[1]);\r\n
            var s = Math.round(bits[2] * 255 / 100);\r\n
            var v = Math.round(bits[3] * 255 / 100);\r\n
            if (s == 0) {\r\n
                rgb.r = rgb.g = rgb.b = v;\r\n
            } else {\r\n
                var t1 = v;\r\n
                var t2 = (255 - s) * v / 255;\r\n
                var t3 = (t1 - t2) * (h % 60) / 60;\r\n
                if (h == 360) {\r\n
                    h = 0;\r\n
                }\r\n
                if (h < 60) {\r\n
                    rgb.r = t1;\r\n
                    rgb.b = t2;\r\n
                    rgb.g = t2 + t3;\r\n
                } else {\r\n
                    if (h < 120) {\r\n
                        rgb.g = t1;\r\n
                        rgb.b = t2;\r\n
                        rgb.r = t1 - t3;\r\n
                    } else {\r\n
                        if (h < 180) {\r\n
                            rgb.g = t1;\r\n
                            rgb.r = t2;\r\n
                            rgb.b = t2 + t3;\r\n
                        } else {\r\n
                            if (h < 240) {\r\n
                                rgb.b = t1;\r\n
                                rgb.r = t2;\r\n
                                rgb.g = t1 - t3;\r\n
                            } else {\r\n
                                if (h < 300) {\r\n
                                    rgb.b = t1;\r\n
                                    rgb.g = t2;\r\n
                                    rgb.r = t2 + t3;\r\n
                                } else {\r\n
                                    if (h < 360) {\r\n
                                        rgb.r = t1;\r\n
                                        rgb.g = t2;\r\n
                                        rgb.b = t1 - t3;\r\n
                                    } else {\r\n
                                        rgb.r = 0;\r\n
                                        rgb.g = 0;\r\n
                                        rgb.b = 0;\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            return [Math.round(rgb.r), Math.round(rgb.g), Math.round(rgb.b)];\r\n
        }\r\n
    },\r\n
    {\r\n
        re: /^(\\w{2})(\\w{2})(\\w{2})$/,\r\n
        process: function (bits) {\r\n
            return [parseInt(bits[1], 16), parseInt(bits[2], 16), parseInt(bits[3], 16)];\r\n
        }\r\n
    },\r\n
    {\r\n
        re: /^(\\w{1})(\\w{1})(\\w{1})$/,\r\n
        process: function (bits) {\r\n
            return [parseInt(bits[1] + bits[1], 16), parseInt(bits[2] + bits[2], 16), parseInt(bits[3] + bits[3], 16)];\r\n
        }\r\n
    }];\r\n
    for (var i = 0; i < colorDefinitions.length; i++) {\r\n
        var re = colorDefinitions[i].re;\r\n
        var processor = colorDefinitions[i].process;\r\n
        var bits = re.exec(colorString);\r\n
        if (bits) {\r\n
            var channels = processor(bits);\r\n
            r = channels[0];\r\n
            g = channels[1];\r\n
            b = channels[2];\r\n
        }\r\n
    }\r\n
    r = (r < 0 || isNaN(r)) ? 0 : ((r > 255) ? 255 : r);\r\n
    g = (g < 0 || isNaN(g)) ? 0 : ((g > 255) ? 255 : g);\r\n
    b = (b < 0 || isNaN(b)) ? 0 : ((b > 255) ? 255 : b);\r\n
    var isEqual = function (color) {\r\n
        return ((r == color.r) && (g == color.g) && (b == color.b));\r\n
    };\r\n
    var toRGB = function () {\r\n
        return "rgb(" + r + ", " + g + ", " + b + ")";\r\n
    };\r\n
    var toRGBA = function (alfa) {\r\n
        if (alfa === undefined) {\r\n
            alfa = 1;\r\n
        }\r\n
        return "rgba(" + r + ", " + g + ", " + b + ", " + alfa + ")";\r\n
    };\r\n
    var toHex = function () {\r\n
        var _r = r.toString(16);\r\n
        var _g = g.toString(16);\r\n
        var _b = b.toString(16);\r\n
        if (_r.length == 1) {\r\n
            _r = "0" + _r;\r\n
        }\r\n
        if (_g.length == 1) {\r\n
            _g = "0" + _g;\r\n
        }\r\n
        if (_b.length == 1) {\r\n
            _b = "0" + _b;\r\n
        }\r\n
        return "#" + _r + _g + _b;\r\n
    };\r\n
    var toHSB = function () {\r\n
        var hsb = {\r\n
            h: 0,\r\n
            s: 0,\r\n
            b: 0\r\n
        };\r\n
        var min = Math.min(r, g, b);\r\n
        var max = Math.max(r, g, b);\r\n
        var delta = max - min;\r\n
        hsb.b = max;\r\n
        hsb.s = max != 0 ? 255 * delta / max : 0;\r\n
        if (hsb.s != 0) {\r\n
            if (r == max) {\r\n
                hsb.h = 0 + (g - b) / delta;\r\n
            } else {\r\n
                if (g == max) {\r\n
                    hsb.h = 2 + (b - r) / delta;\r\n
                } else {\r\n
                    hsb.h = 4 + (r - g) / delta;\r\n
                }\r\n
            }\r\n
        } else {\r\n
            hsb.h = 0;\r\n
        }\r\n
        hsb.h *= 60;\r\n
        if (hsb.h < 0) {\r\n
            hsb.h += 360;\r\n
        }\r\n
        hsb.s *= 100 / 255;\r\n
        hsb.b *= 100 / 255;\r\n
        hsb.h = parseInt(hsb.h);\r\n
        hsb.s = parseInt(hsb.s);\r\n
        hsb.b = parseInt(hsb.b);\r\n
        return hsb;\r\n
    };\r\n
    return {\r\n
        r: r,\r\n
        g: g,\r\n
        b: b,\r\n
        isEqual: isEqual,\r\n
        toRGB: toRGB,\r\n
        toRGBA: toRGBA,\r\n
        toHex: toHex,\r\n
        toHSB: toHSB\r\n
    };\r\n
};\r\n
Common.Utils.String = new(function () {\r\n
    return {\r\n
        format: function (format) {\r\n
            var args = _.toArray(arguments).slice(1);\r\n
            return format.replace(/\\{(\\d+)\\}/g, function (s, i) {\r\n
                return args[i];\r\n
            });\r\n
        },\r\n
        htmlEncode: function (string) {\r\n
            return _.escape(string);\r\n
        },\r\n
        htmlDecode: function (string) {\r\n
            return _.unescape(string);\r\n
        },\r\n
        ellipsis: function (value, len, word) {\r\n
            if (value && value.length > len) {\r\n
                if (word) {\r\n
                    var vs = value.substr(0, len - 2),\r\n
                    index = Math.max(vs.lastIndexOf(" "), vs.lastIndexOf("."), vs.lastIndexOf("!"), vs.lastIndexOf("?"));\r\n
                    if (index !== -1 && index >= (len - 15)) {\r\n
                        return vs.substr(0, index) + "...";\r\n
                    }\r\n
                }\r\n
                return value.substr(0, len - 3) + "...";\r\n
            }\r\n
            return value;\r\n
        },\r\n
        platformKey: function (string, template, hookFn) {\r\n
            if (_.isEmpty(template)) {\r\n
                template = " ({0})";\r\n
            }\r\n
            if (Common.Utils.isMac) {\r\n
                if (_.isFunction(hookFn)) {\r\n
                    string = hookFn.call(this, string);\r\n
                }\r\n
                return Common.Utils.String.format(template, string.replace(/\\+(?=\\S)/g, "").replace(/Ctrl|ctrl/g, "âŒ˜").replace(/Alt|alt/g, "âŒ¥").replace(/Shift|shift/g, "â‡§"));\r\n
            }\r\n
            return Common.Utils.String.format(template, string);\r\n
        }\r\n
    };\r\n
})();\r\n
Common.Utils.isBrowserSupported = function () {\r\n
    return ! ((Common.Utils.ieVersion != 0 && Common.Utils.ieVersion < 9) || (Common.Utils.safariVersion != 0 && Common.Utils.safariVersion < 5) || (Common.Utils.firefoxVersion != 0 && Common.Utils.firefoxVersion < 4) || (Common.Utils.chromeVersion != 0 && Common.Utils.chromeVersion < 7) || (Common.Utils.operaVersion != 0 && Common.Utils.operaVersion < 10.5));\r\n
};\r\n
Common.Utils.showBrowserRestriction = function () {\r\n
    var editor = (window.DE ? "Document" : window.SSE ? "Spreadsheet" : window.PE ? "Presentation" : "that");\r\n
    var newDiv = document.createElement("div");\r\n
    newDiv.innerHTML = \'<div class="application-error-panel">\' + \'<div class="application-error-message-block">\' + \'<div class="application-error-message-inner">\' + \'<div class="application-error-message-title">Your browser is not supported.</div>\' + \'<div class="application-error-message-text">Sorry, \' + editor + " Editor is currently only supported in the latest versions of the Chrome, Firefox, Safari or Internet Explorer web browsers.</div>" + "</div>" + "</div>" + \'<div class="application-error-message-auxiliary"></div>\' + "</div>";\r\n
    document.body.appendChild(newDiv);\r\n
    $("#loading-mask").hide().remove();\r\n
    $("#viewport").hide().remove();\r\n
};\r\n
Common.Utils.applyCustomization = function (config, elmap) {\r\n
    for (var name in config) {\r\n
        var $el;\r\n
        if ( !! elmap[name]) {\r\n
            $el = $(elmap[name]);\r\n
            if ($el.length) {\r\n
                var item = config[name];\r\n
                if (item === false || item.visible === false) {\r\n
                    $el.hide();\r\n
                } else {\r\n
                    if ( !! item.text) {\r\n
                        $el.text(item.text);\r\n
                    }\r\n
                    if (item.visible === false) {\r\n
                        $el.hide();\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
};\r\n
String.prototype.strongMatch = function (regExp) {\r\n
    if (regExp && regExp instanceof RegExp) {\r\n
        var arr = this.toString().match(regExp);\r\n
        return !! (arr && arr.length > 0 && arr[0].length == this.length);\r\n
    }\r\n
    return false;\r\n
};\n
define("common/main/lib/util/utils", function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Window\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.Window = Common.UI.BaseView.extend(_.extend((function () {\r\n
        var config = {\r\n
            closable: true,\r\n
            header: true,\r\n
            modal: true,\r\n
            width: 300,\r\n
            height: "auto",\r\n
            title: "Title",\r\n
            alias: "Window",\r\n
            cls: "",\r\n
            toolclose: "close"\r\n
        };\r\n
        var template = \'<div class="asc-window<%= modal?" modal":"" %><%= cls?" "+cls:"" %>" id="<%= id %>" style="width:<%= width %>px;">\' + "<% if (header==true) { %>" + \'<div class="header">\' + "<% if (closable!==false) %>" + \'<div class="tool close"></div>\' + "<% %>" + \'<span class="title"><%= title %></span> \' + "</div>" + "<% } %>" + \'<div class="body"><%= tpl %></div>\' + "</div>";\r\n
        function _getMask() {\r\n
            var mask = $(".modals-mask");\r\n
            if (mask.length == 0) {\r\n
                mask = $("<div class=\'modals-mask\'>").appendTo(document.body).hide();\r\n
            }\r\n
            return mask;\r\n
        }\r\n
        function _keydown(event) {\r\n
            if (!this.isLocked() && this.isVisible()) {\r\n
                switch (event.keyCode) {\r\n
                case Common.UI.Keys.ESC:\r\n
                    event.preventDefault();\r\n
                    event.stopPropagation();\r\n
                    if (this.initConfig.closable !== false) {\r\n
                        this.initConfig.toolclose == "hide" ? this.hide() : this.close();\r\n
                    }\r\n
                    return false;\r\n
                    break;\r\n
                case Common.UI.Keys.RETURN:\r\n
                    if (this.$window.find(".btn.primary").length) {\r\n
                        if ((this.initConfig.onprimary || this.onPrimary).call(this) === false) {\r\n
                            event.preventDefault();\r\n
                            return false;\r\n
                        }\r\n
                    }\r\n
                    break;\r\n
                }\r\n
            }\r\n
        }\r\n
        function _centre() {\r\n
            if (window.innerHeight == undefined) {\r\n
                var main_width = document.documentElement.offsetWidth;\r\n
                var main_height = document.documentElement.offsetHeight;\r\n
            } else {\r\n
                main_width = window.innerWidth;\r\n
                main_height = window.innerHeight;\r\n
            }\r\n
            if (this.initConfig.height == "auto") {\r\n
                var win_height = parseInt(this.$window.find(".body").css("height"));\r\n
                this.initConfig.header && (win_height += parseInt(this.$window.find(".header").css("height")));\r\n
            } else {\r\n
                win_height = this.initConfig.height;\r\n
            }\r\n
            var top = Math.floor(((parseInt(main_height) - parseInt(win_height)) / 2) * 0.9);\r\n
            var left = Math.floor((parseInt(main_width) - parseInt(this.initConfig.width)) / 2);\r\n
            this.$window.css("left", left);\r\n
            this.$window.css("top", top);\r\n
        }\r\n
        function _getTransformation(end) {\r\n
            return {\r\n
                "-webkit-transition": "0.3s opacity",\r\n
                "-moz-transition": "0.3s opacity",\r\n
                "-ms-transition": "0.3s opacity",\r\n
                "-o-transition": "0.3s opacity",\r\n
                "opacity": end\r\n
            };\r\n
        }\r\n
        function _dragstart(event) {\r\n
            if ($(event.target).hasClass("close")) {\r\n
                return;\r\n
            }\r\n
            Common.UI.Menu.Manager.hideAll();\r\n
            this.dragging.enabled = true;\r\n
            this.dragging.initx = event.pageX - parseInt(this.$window.css("left"));\r\n
            this.dragging.inity = event.pageY - parseInt(this.$window.css("top"));\r\n
            if (window.innerHeight == undefined) {\r\n
                var main_width = document.documentElement.offsetWidth;\r\n
                var main_height = document.documentElement.offsetHeight;\r\n
            } else {\r\n
                main_width = window.innerWidth;\r\n
                main_height = window.innerHeight;\r\n
            }\r\n
            this.dragging.maxx = main_width - parseInt(this.$window.css("width"));\r\n
            this.dragging.maxy = main_height - parseInt(this.$window.css("height"));\r\n
            $(document).on("mousemove", this.binding.drag);\r\n
            $(document).on("mouseup", this.binding.dragStop);\r\n
            this.fireEvent("drag", [this, "start"]);\r\n
        }\r\n
        function _mouseup() {\r\n
            $(document).off("mousemove", this.binding.drag);\r\n
            $(document).off("mouseup", this.binding.dragStop);\r\n
            this.dragging.enabled = false;\r\n
            this.fireEvent("drag", [this, "end"]);\r\n
        }\r\n
        function _mousemove(event) {\r\n
            if (this.dragging.enabled) {\r\n
                var left = event.pageX - this.dragging.initx,\r\n
                top = event.pageY - this.dragging.inity;\r\n
                left < 0 ? (left = 0) : left > this.dragging.maxx && (left = this.dragging.maxx);\r\n
                top < 0 ? (top = 0) : top > this.dragging.maxy && (top = this.dragging.maxy);\r\n
                this.$window.css({\r\n
                    left: left,\r\n
                    top: top\r\n
                });\r\n
            }\r\n
        }\r\n
        Common.UI.alert = function (options) {\r\n
            var me = this.Window.prototype;\r\n
            var arrBtns = {\r\n
                ok: me.okButtonText,\r\n
                cancel: me.cancelButtonText,\r\n
                yes: me.yesButtonText,\r\n
                no: me.noButtonText,\r\n
                close: me.closeButtonText\r\n
            };\r\n
            if (!options.buttons) {\r\n
                options.buttons = {};\r\n
                options.buttons["ok"] = arrBtns["ok"];\r\n
            } else {\r\n
                if (_.isArray(options.buttons)) {\r\n
                    var newBtns = {};\r\n
                    _.each(options.buttons, function (b) {\r\n
                        newBtns[b] = arrBtns[b];\r\n
                    });\r\n
                    options.buttons = newBtns;\r\n
                }\r\n
            }\r\n
            var template = \'<div class="info-box">\' + \'<div class="icon <%= iconCls %>" />\' + \'<div class="text"><span><%= msg %></span></div>\' + "</div>" + \'<div class="footer">\' + \'<button class="btn normal dlg-btn primary" result="ok">OK</button>\' + "<% if (_.size(buttons) > 1) %>" + \'<button class="btn normal dlg-btn" result="cancel">Cancel</button>\' + "<% %>" + "</div>";\r\n
            var win = new Common.UI.Window({\r\n
                cls: "alert",\r\n
                title: options.title,\r\n
                onprimary: onKeyDown,\r\n
                tpl: _.template(template, options)\r\n
            });\r\n
            function autoSize(window) {\r\n
                var text_cnt = window.getChild(".info-box");\r\n
                var text = window.getChild(".info-box span");\r\n
                var footer = window.getChild(".footer");\r\n
                var header = window.getChild(".header");\r\n
                var body = window.getChild(".body");\r\n
                var icon = window.getChild(".icon");\r\n
                body.css("padding-bottom", "10px");\r\n
                text_cnt.height(Math.max(text.height(), icon.height()));\r\n
                body.height(parseInt(text_cnt.css("height")) + parseInt(footer.css("height")));\r\n
                window.setSize(text.position().left + text.width() + parseInt(text_cnt.css("padding-right")), parseInt(body.css("height")) + parseInt(header.css("height")));\r\n
            }\r\n
            function onBtnClick(event) {\r\n
                if (options.callback) {\r\n
                    options.callback.call(win, event.currentTarget.attributes["result"].value);\r\n
                }\r\n
                win.close(true);\r\n
            }\r\n
            function onKeyDown(event) {\r\n
                onBtnClick({\r\n
                    currentTarget: win.getChild(".footer .dlg-btn")[0]\r\n
                });\r\n
                return false;\r\n
            }\r\n
            win.on({\r\n
                "render:after": function (obj) {\r\n
                    autoSize(obj);\r\n
                },\r\n
                show: function (obj) {\r\n
                    obj.getChild(".footer .dlg-btn").focus();\r\n
                    obj.getChild(".footer .dlg-btn").on("click", onBtnClick);\r\n
                },\r\n
                close: function () {\r\n
                    options.callback && options.callback.call(win, "close");\r\n
                }\r\n
            });\r\n
            win.show();\r\n
        };\r\n
        Common.UI.warning = function (options) {\r\n
            options = options || {}; ! options.title && (options.title = this.Window.prototype.textWarning);\r\n
            Common.UI.alert(_.extend(options, {\r\n
                iconCls: "warn"\r\n
            }));\r\n
        };\r\n
        Common.UI.error = function (options) {\r\n
            options = options || {}; ! options.title && (options.title = this.Window.prototype.textError);\r\n
            Common.UI.alert(_.extend(options, {\r\n
                iconCls: "error"\r\n
            }));\r\n
        };\r\n
        Common.UI.confirm = function (options) {\r\n
            options = options || {}; ! options.title && (options.title = this.Window.prototype.textConfirmation);\r\n
            Common.UI.alert(_.extend(options, {\r\n
                iconCls: "confirm"\r\n
            }));\r\n
        };\r\n
        Common.UI.info = function (options) {\r\n
            options = options || {}; ! options.title && (options.title = this.Window.prototype.textInformation);\r\n
            Common.UI.alert(_.extend(options, {\r\n
                iconCls: "info"\r\n
            }));\r\n
        };\r\n
        return {\r\n
            $window: undefined,\r\n
            $lastmodal: undefined,\r\n
            dragging: {\r\n
                enabled: false\r\n
            },\r\n
            initialize: function (options) {\r\n
                this.initConfig = {};\r\n
                this.binding = {};\r\n
                _.extend(this.initConfig, config, options || {}); ! this.initConfig.id && (this.initConfig.id = "window-" + this.cid); ! this.initConfig.tpl && (this.initConfig.tpl = "");\r\n
                Common.UI.BaseView.prototype.initialize.call(this, this.initConfig);\r\n
            },\r\n
            render: function () {\r\n
                var renderto = this.initConfig.renderTo || document.body;\r\n
                $(renderto).append(_.template(template, this.initConfig));\r\n
                this.$window = $("#" + this.initConfig.id);\r\n
                this.binding.keydown = _.bind(_keydown, this);\r\n
                if (this.initConfig.header) {\r\n
                    this.binding.drag = _.bind(_mousemove, this);\r\n
                    this.binding.dragStop = _.bind(_mouseup, this);\r\n
                    this.binding.dragStart = _.bind(_dragstart, this);\r\n
                    var doclose = function () {\r\n
                        if (this.$window.find(".tool.close").hasClass("disabled")) {\r\n
                            return;\r\n
                        }\r\n
                        if (this.initConfig.toolcallback) {\r\n
                            this.initConfig.toolcallback.call(this);\r\n
                        } else {\r\n
                            (this.initConfig.toolclose == "hide") ? this.hide() : this.close();\r\n
                        }\r\n
                    };\r\n
                    this.$window.find(".header").on("mousedown", this.binding.dragStart);\r\n
                    this.$window.find(".tool.close").on("click", _.bind(doclose, this));\r\n
                } else {\r\n
                    this.$window.find(".body").css({\r\n
                        top: 0,\r\n
                        "border-radius": "5px"\r\n
                    });\r\n
                }\r\n
                if (this.initConfig.height == "auto") {\r\n
                    var height = parseInt(this.$window.find("> .body").css("height"));\r\n
                    this.initConfig.header && (height += parseInt(this.$window.find("> .header").css("height")));\r\n
                    this.$window.height(height);\r\n
                } else {\r\n
                    this.$window.css("height", this.initConfig.height);\r\n
                }\r\n
                this.fireEvent("render:after", this);\r\n
                return this;\r\n
            },\r\n
            show: function (x, y) {\r\n
                if (this.initConfig.modal) {\r\n
                    var mask = _getMask();\r\n
                    if (this.options.animate !== false) {\r\n
                        var opacity = mask.css("opacity");\r\n
                        mask.css("opacity", 0);\r\n
                        mask.show();\r\n
                        setTimeout(function () {\r\n
                            mask.css(_getTransformation(opacity));\r\n
                        },\r\n
                        1);\r\n
                    } else {\r\n
                        mask.show();\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("modal:show", this);\r\n
                    this.$lastmodal = $(".asc-window.modal:not(.dethrone):visible").first().addClass("dethrone");\r\n
                }\r\n
                if (!this.$window) {\r\n
                    this.render();\r\n
                    if (_.isNumber(x) && _.isNumber(y)) {\r\n
                        this.$window.css("left", Math.floor(x));\r\n
  

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAk=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="9" aka="AAAAAAAAAAk=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

                      this.$window.css("top", Math.floor(y));\r\n
                    } else {\r\n
                        _centre.call(this);\r\n
                    }\r\n
                } else {\r\n
                    if (!this.$window.is(":visible")) {\r\n
                        this.$window.show();\r\n
                    }\r\n
                }\r\n
                $(document).on("keydown." + this.cid, this.binding.keydown);\r\n
                var me = this;\r\n
                if (this.options.animate !== false) {\r\n
                    this.$window.css({\r\n
                        "-webkit-transform": "scale(0.8)",\r\n
                        "-moz-transform": "scale(0.8)",\r\n
                        "-ms-transform": "scale(0.8)",\r\n
                        "-o-transform": "scale(0.8)",\r\n
                        opacity: 0\r\n
                    });\r\n
                    setTimeout(function () {\r\n
                        me.$window.css({\r\n
                            "-webkit-transition": "0.3s opacity, 0.3s -webkit-transform",\r\n
                            "-webkit-transform": "scale(1)",\r\n
                            "-moz-transition": "0.3s opacity, 0.3s -moz-transform",\r\n
                            "-moz-transform": "scale(1)",\r\n
                            "-ms-transition": "0.3s opacity, 0.3s -ms-transform",\r\n
                            "-ms-transform": "scale(1)",\r\n
                            "-o-transition": "0.3s opacity, 0.3s -o-transform",\r\n
                            "-o-transform": "scale(1)",\r\n
                            "opacity": "1"\r\n
                        });\r\n
                    },\r\n
                    1);\r\n
                    setTimeout(function () {\r\n
                        me.$window.css({\r\n
                            "-webkit-transform": "",\r\n
                            "-moz-transform": "",\r\n
                            "-ms-transition": "",\r\n
                            "-ms-transform": "",\r\n
                            "-o-transform": ""\r\n
                        });\r\n
                        me.fireEvent("show", me);\r\n
                    },\r\n
                    350);\r\n
                } else {\r\n
                    this.fireEvent("show", this);\r\n
                }\r\n
                Common.NotificationCenter.trigger("window:show");\r\n
            },\r\n
            close: function (suppressevent) {\r\n
                $(document).off("keydown." + this.cid);\r\n
                if (this.initConfig.header) {\r\n
                    this.$window.find(".header").off("mousedown", this.binding.dragStart);\r\n
                }\r\n
                if (this.initConfig.modal) {\r\n
                    var hide_mask = true;\r\n
                    if (this.$lastmodal.size() > 0) {\r\n
                        this.$lastmodal.removeClass("dethrone");\r\n
                        hide_mask = !this.$lastmodal.hasClass("modal");\r\n
                    }\r\n
                    if (hide_mask) {\r\n
                        var mask = $(".modals-mask");\r\n
                        if (this.options.animate !== false) {\r\n
                            var opacity = mask.css("opacity");\r\n
                            mask.css(_getTransformation(0));\r\n
                            setTimeout(function () {\r\n
                                mask.css("opacity", opacity);\r\n
                                mask.hide();\r\n
                            },\r\n
                            300);\r\n
                        } else {\r\n
                            mask.hide();\r\n
                        }\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("modal:close", this);\r\n
                }\r\n
                this.$window.remove();\r\n
                suppressevent !== true && this.fireEvent("close", this);\r\n
            },\r\n
            hide: function () {\r\n
                $(document).off("keydown." + this.cid);\r\n
                if (this.$window) {\r\n
                    if (this.initConfig.modal) {\r\n
                        var hide_mask = true;\r\n
                        if (this.$lastmodal.size() > 0) {\r\n
                            this.$lastmodal.removeClass("dethrone");\r\n
                            hide_mask = !this.$lastmodal.hasClass("modal");\r\n
                        }\r\n
                        if (hide_mask) {\r\n
                            var mask = $(".modals-mask");\r\n
                            if (this.options.animate !== false) {\r\n
                                var opacity = mask.css("opacity");\r\n
                                mask.css(_getTransformation(0));\r\n
                                setTimeout(function () {\r\n
                                    mask.css("opacity", opacity);\r\n
                                    mask.hide();\r\n
                                },\r\n
                                300);\r\n
                            } else {\r\n
                                mask.hide();\r\n
                            }\r\n
                        }\r\n
                        Common.NotificationCenter.trigger("modal:hide", this);\r\n
                    }\r\n
                    this.$window.hide();\r\n
                    this.fireEvent("hide", this);\r\n
                }\r\n
            },\r\n
            isLocked: function () {\r\n
                return this.$window.hasClass("dethrone") || (!this.options.modal && this.$window.parent().find(".asc-window.modal:visible").length);\r\n
            },\r\n
            getChild: function (selector) {\r\n
                return selector ? this.$window.find(selector) : this.$window;\r\n
            },\r\n
            setWidth: function (width) {\r\n
                if (width >= 0) {\r\n
                    var min = parseInt(this.$window.css("min-width"));\r\n
                    width < min && (width = min);\r\n
                    this.$window.width(width);\r\n
                }\r\n
            },\r\n
            getWidth: function () {\r\n
                return parseInt(this.$window.css("width"));\r\n
            },\r\n
            setHeight: function (height) {\r\n
                if (height >= 0) {\r\n
                    var min = parseInt(this.$window.css("min-height"));\r\n
                    height < min && (height = min);\r\n
                    this.$window.height(height);\r\n
                    if (this.initConfig.header) {\r\n
                        height -= parseInt(this.$window.find("> .header").css("height"));\r\n
                    }\r\n
                    this.$window.find("> .body").css("height", height);\r\n
                }\r\n
            },\r\n
            getHeight: function () {\r\n
                return parseInt(this.$window.css("height"));\r\n
            },\r\n
            setSize: function (w, h) {\r\n
                this.setWidth(w);\r\n
                this.setHeight(h);\r\n
            },\r\n
            getSize: function () {\r\n
                return [this.getWidth(), this.getHeight()];\r\n
            },\r\n
            setTitle: function (title) {\r\n
                this.$window.find("> .header > .title").text(title);\r\n
            },\r\n
            getTitle: function () {\r\n
                return this.$window.find("> .header > .title").text();\r\n
            },\r\n
            isVisible: function () {\r\n
                return this.$window && this.$window.is(":visible");\r\n
            },\r\n
            onPrimary: function () {},\r\n
            cancelButtonText: "Cancel",\r\n
            okButtonText: "OK",\r\n
            yesButtonText: "Yes",\r\n
            noButtonText: "No",\r\n
            closeButtonText: "Close",\r\n
            textWarning: "Warning",\r\n
            textError: "Error",\r\n
            textConfirmation: "Confirmation",\r\n
            textInformation: "Information"\r\n
        };\r\n
    })(), Common.UI.Window || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/view/CopyWarningDialog\',["common/main/lib/component/Window"], function () {\r\n
    Common.Views.CopyWarningDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 500,\r\n
            height: 325,\r\n
            cls: "modal-dlg copy-warning"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle\r\n
            },\r\n
            options || {});\r\n
            this.template = [\'<div class="box">\', \'<p class="message">\' + this.textMsg + "</p>", \'<div class="hotkeys">\', "<div>", \'<p class="hotkey">\' + Common.Utils.String.platformKey("Ctrl+C", "{0}") + "</p>", \'<p class="message">\' + this.textToCopy + "</p>", "</div>", "<div>", \'<p class="hotkey">\' + Common.Utils.String.platformKey("Ctrl+X", "{0}") + "</p>", \'<p class="message">\' + this.textToCut + "</p>", "</div>", "<div>", \'<p class="hotkey">\' + Common.Utils.String.platformKey("Ctrl+V", "{0}") + "</p>", \'<p class="message">\' + this.textToPaste + "</p>", "</div>", "</div>", \'<div id="copy-warning-checkbox" style="margin-top: 20px; text-align: left;"></div>\', "</div>", \'<div class="separator horizontal"/>\', \'<div class="footer center">\', \'<button class="btn normal dlg-btn primary">\' + this.okButtonText + "</button>", "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.chDontShow = new Common.UI.CheckBox({\r\n
                el: $("#copy-warning-checkbox"),\r\n
                labelText: this.textDontShow\r\n
            });\r\n
            this.getChild().find(".btn").on("click", _.bind(this.onBtnClick, this));\r\n
            this.autoSize();\r\n
            Common.NotificationCenter.trigger("copywarning:show");\r\n
        },\r\n
        autoSize: function () {\r\n
            var text_cnt = this.getChild(".box"),\r\n
            footer = this.getChild(".footer"),\r\n
            header = this.getChild(".header"),\r\n
            body = this.getChild(".body");\r\n
            body.height(parseInt(text_cnt.height()) + parseInt(footer.css("height")));\r\n
            this.setHeight(parseInt(body.css("height")) + parseInt(header.css("height")));\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            if (this.options.handler) {\r\n
                this.options.handler.call(this, this.chDontShow.getValue() == "checked");\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onKeyPress: function (event) {\r\n
            if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                if (this.options.handler) {\r\n
                    this.options.handler.call(this, this.chDontShow.getValue() == "checked");\r\n
                }\r\n
                this.close();\r\n
            }\r\n
        },\r\n
        getSettings: function () {\r\n
            return (this.chDontShow.getValue() == "checked");\r\n
        },\r\n
        textTitle: "Copy, Cut and Paste Actions",\r\n
        textMsg: "Copy, cut and paste actions using the editor toolbar buttons and context menu actions will be performed within this editor tab only.<br><br>.To copy or paste to or from applications outside the editor tab use the following keyboard combinations:",\r\n
        textToCopy: "for Copy",\r\n
        textToPaste: "for Paste",\r\n
        textToCut: "for Cut",\r\n
        textDontShow: "Don\'t show this message again"\r\n
    },\r\n
    Common.Views.CopyWarningDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 function onDropDownKeyDown(e) {\r\n
    var $this = $(this),\r\n
    $parent = $this.parent(),\r\n
    beforeEvent = jQuery.Event("keydown.before.bs.dropdown"),\r\n
    afterEvent = jQuery.Event("keydown.after.bs.dropdown");\r\n
    $parent.trigger(beforeEvent);\r\n
    if (beforeEvent.isDefaultPrevented()) {\r\n
        return;\r\n
    }\r\n
    patchDropDownKeyDown.call(this, e);\r\n
    e.preventDefault();\r\n
    e.stopPropagation();\r\n
    $parent.trigger(afterEvent);\r\n
}\r\n
function patchDropDownKeyDown(e) {\r\n
    if (!/(38|40|27)/.test(e.keyCode)) {\r\n
        return;\r\n
    }\r\n
    var $this = $(this);\r\n
    e.preventDefault();\r\n
    e.stopPropagation();\r\n
    if ($this.is(".disabled, :disabled")) {\r\n
        return;\r\n
    }\r\n
    var $parent = getParent($this);\r\n
    var isActive = $parent.hasClass("open");\r\n
    if (!isActive || (isActive && e.keyCode == 27)) {\r\n
        if (e.which == 27) {\r\n
            $items = $("[role=menu] li.dropdown-submenu.over:visible", $parent);\r\n
            if ($items.size()) {\r\n
                $items.eq($items.size() - 1).removeClass("over");\r\n
                return false;\r\n
            } else {\r\n
                $parent.find("[data-toggle=dropdown]").focus();\r\n
            }\r\n
        }\r\n
        return $this.click();\r\n
    }\r\n
    var $items = $("[role=menu] li:not(.divider):not(.disabled):visible", $parent).find("> a");\r\n
    if (!$items.length) {\r\n
        return;\r\n
    }\r\n
    var index = $items.index($items.filter(":focus"));\r\n
    if (e.keyCode == 38) {\r\n
        index > 0 ? index--:(index = $items.length - 1);\r\n
    } else {\r\n
        if (e.keyCode == 40) {\r\n
            index < $items.length - 1 ? index++:(index = 0);\r\n
        }\r\n
    }\r\n
    if (!~index) {\r\n
        index = 0;\r\n
    }\r\n
    $items.eq(index).focus();\r\n
}\r\n
function getParent($this) {\r\n
    var selector = $this.attr("data-target");\r\n
    if (!selector) {\r\n
        selector = $this.attr("href");\r\n
        selector = selector && /#/.test(selector) && selector.replace(/.*(?=#[^\\s]*$)/, "");\r\n
    }\r\n
    var $parent = selector && $(selector);\r\n
    return $parent && $parent.length ? $parent : $this.parent();\r\n
}\r\n
$(document).off("keydown.bs.dropdown.data-api").on("keydown.bs.dropdown.data-api", "[data-toggle=dropdown], [role=menu]", onDropDownKeyDown);\n
define("common/main/lib/extend/Bootstrap", function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ToggleManager\',["common/main/lib/component/BaseView"], function () {\r\n
    var groups = {};\r\n
    function toggleGroup(cmp, state) {\r\n
        var g, i, l;\r\n
        if (state) {\r\n
            g = groups[cmp.toggleGroup];\r\n
            for (i = 0, l = g.length; i < l; i++) {\r\n
                if (g[i] !== cmp) {\r\n
                    if (g[i].isActive) {\r\n
                        g[i].isActive() && g[i].toggle(false);\r\n
                    } else {\r\n
                        g[i].toggle(false);\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
    Common.UI.ToggleManager = {\r\n
        register: function (cmp) {\r\n
            if (!cmp.toggleGroup) {\r\n
                return;\r\n
            }\r\n
            var group = groups[cmp.toggleGroup];\r\n
            if (!group) {\r\n
                group = groups[cmp.toggleGroup] = [];\r\n
            }\r\n
            group.push(cmp);\r\n
            cmp.on("toggle", toggleGroup);\r\n
        },\r\n
        unregister: function (cmp) {\r\n
            if (!cmp.toggleGroup) {\r\n
                return;\r\n
            }\r\n
            var group = groups[cmp.toggleGroup];\r\n
            if (group) {\r\n
                _.without(group, cmp);\r\n
                cmp.off("toggle", toggleGroup);\r\n
            }\r\n
        },\r\n
        getToggled: function (group) {\r\n
            var g = groups[group],\r\n
            i = 0,\r\n
            len;\r\n
            if (g) {\r\n
                for (len = g.length; i < len; i++) {\r\n
                    if (g[i].pressed === true || g[i].checked === true) {\r\n
                        return g[i];\r\n
                    }\r\n
                }\r\n
            }\r\n
            return null;\r\n
        }\r\n
    };\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/MenuItem\',["common/main/lib/component/BaseView", "common/main/lib/component/ToggleManager"], function () {\r\n
    Common.UI.MenuItem = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            id: null,\r\n
            cls: "",\r\n
            style: "",\r\n
            hint: false,\r\n
            checkable: false,\r\n
            checked: false,\r\n
            allowDepress: false,\r\n
            disabled: false,\r\n
            value: null,\r\n
            toggleGroup: null,\r\n
            iconCls: "",\r\n
            menu: null,\r\n
            canFocused: true\r\n
        },\r\n
        tagName: "li",\r\n
        template: _.template([\'<a id="<%= id %>" style="<%= style %>" <% if(options.canFocused) { %> tabindex="-1" type="menuitem" <% }; if(!_.isUndefined(options.stopPropagation)) { %> data-stopPropagation="true" <% }; %> >\', "<% if (!_.isEmpty(iconCls)) { %>", \'<span class="menu-item-icon <%= iconCls %>"></span>\', "<% } %>", "<%= caption %>", "</a>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            this.id = me.options.id || Common.UI.getId();\r\n
            this.cls = me.options.cls;\r\n
            this.style = me.options.style;\r\n
            this.caption = me.options.caption;\r\n
            this.menu = me.options.menu || null;\r\n
            this.checkable = me.options.checkable;\r\n
            this.checked = me.options.checked;\r\n
            me.allowDepress = me.options.allowDepress;\r\n
            this.disabled = me.options.disabled;\r\n
            this.value = me.options.value;\r\n
            this.toggleGroup = me.options.toggleGroup;\r\n
            this.template = me.options.template || this.template;\r\n
            this.iconCls = me.options.iconCls;\r\n
            this.rendered = false;\r\n
            if (this.menu !== null && !(this.menu instanceof Common.UI.Menu)) {\r\n
                this.menu = new Common.UI.Menu(_.extend({},\r\n
                me.options.menu));\r\n
            }\r\n
            if (me.options.el) {\r\n
                this.render();\r\n
            }\r\n
        },\r\n
        render: function () {\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            me.trigger("render:before", me);\r\n
            if (me.caption === "--") {\r\n
                el.addClass("divider");\r\n
            } else {\r\n
                if (!this.rendered) {\r\n
                    el.off("click");\r\n
                    Common.UI.ToggleManager.unregister(me);\r\n
                    $(this.el).html(this.template({\r\n
                        id: me.id,\r\n
                        caption: me.caption,\r\n
                        iconCls: me.iconCls,\r\n
                        style: me.style,\r\n
                        options: me.options\r\n
                    }));\r\n
                    if (me.menu) {\r\n
                        el.addClass("dropdown-submenu");\r\n
                        me.menu.render($(this.el));\r\n
                        el.mouseenter(_.bind(me.menu.alignPosition, me.menu));\r\n
                        el.focusout(_.bind(me.onBlurItem, me));\r\n
                        el.hover(_.bind(me.onHoverItem, me), _.bind(me.onUnHoverItem, me));\r\n
                    }\r\n
                    var firstChild = el.children(":first");\r\n
                    if (this.checkable && firstChild) {\r\n
                        firstChild.toggleClass("checkable", this.checkable);\r\n
                        firstChild.toggleClass("checked", this.checked);\r\n
                        if (!_.isEmpty(this.iconCls)) {\r\n
                            firstChild.css("background-image", "none");\r\n
                        }\r\n
                    }\r\n
                    if (this.disabled) {\r\n
                        $(this.el).toggleClass("disabled", this.disabled);\r\n
                    }\r\n
                    el.on("click", _.bind(this.onItemClick, this));\r\n
                    el.on("mousedown", _.bind(this.onItemMouseDown, this));\r\n
                    Common.UI.ToggleManager.register(me);\r\n
                }\r\n
            }\r\n
            me.cmpEl = $(this.el);\r\n
            me.rendered = true;\r\n
            me.trigger("render:after", me);\r\n
            return this;\r\n
        },\r\n
        setCaption: function (caption) {\r\n
            this.caption = caption;\r\n
            if (this.rendered) {\r\n
                this.cmpEl.find("a").contents().last()[0].textContent = Common.Utils.String.htmlEncode(caption);\r\n
            }\r\n
        },\r\n
        setChecked: function (check, suppressEvent) {\r\n
            this.toggle(check, suppressEvent);\r\n
        },\r\n
        isChecked: function () {\r\n
            return this.checked;\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            this.disabled = !!disabled;\r\n
            if (this.rendered) {\r\n
                this.cmpEl.toggleClass("disabled", this.disabled);\r\n
            }\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        toggle: function (toggle, suppressEvent) {\r\n
            var state = toggle === undefined ? !this.checked : !!toggle;\r\n
            if (this.checkable) {\r\n
                this.checked = state;\r\n
                if (this.rendered) {\r\n
                    var firstChild = this.cmpEl.children(":first");\r\n
                    if (firstChild) {\r\n
                        firstChild.toggleClass("checked", this.checked);\r\n
                        if (!_.isEmpty(this.iconCls)) {\r\n
                            firstChild.css("background-image", "none");\r\n
                        }\r\n
                    }\r\n
                }\r\n
                if (!suppressEvent) {\r\n
                    this.trigger("toggle", this, state);\r\n
                }\r\n
            }\r\n
        },\r\n
        onItemMouseDown: function (e) {\r\n
            if (e.which != 1) {\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
                return false;\r\n
            }\r\n
        },\r\n
        onItemClick: function (e) {\r\n
            if (e.which != 1 && (e.which !== undefined || this.menu)) {\r\n
                return false;\r\n
            }\r\n
            if (!this.disabled && (this.allowDepress || !(this.checked && this.toggleGroup))) {\r\n
                this.setChecked(!this.checked);\r\n
            }\r\n
            if (this.menu) {\r\n
                if (e.target.id == this.id) {\r\n
                    return false;\r\n
                }\r\n
                if (!this.menu.isOver) {\r\n
                    this.cmpEl.removeClass("over");\r\n
                }\r\n
                return;\r\n
            }\r\n
            if (!this.disabled) {\r\n
                this.trigger("click", this, e);\r\n
            } else {\r\n
                return false;\r\n
            }\r\n
        },\r\n
        onHoverItem: function (e) {\r\n
            this._doHover(e);\r\n
        },\r\n
        onUnHoverItem: function (e) {\r\n
            this._doUnHover(e);\r\n
        },\r\n
        onBlurItem: function (e) {\r\n
            this._doUnHover(e);\r\n
        },\r\n
        _doHover: function (e) {\r\n
            var me = this;\r\n
            if (me.menu && !me.disabled) {\r\n
                clearTimeout(me.hideMenuTimer);\r\n
                me.cmpEl.trigger("show.bs.dropdown");\r\n
                me.expandMenuTimer = _.delay(function () {\r\n
                    me.cmpEl.addClass("over");\r\n
                    me.cmpEl.trigger("shown.bs.dropdown");\r\n
                },\r\n
                200);\r\n
            }\r\n
        },\r\n
        _doUnHover: function (e) {\r\n
            var me = this;\r\n
            if (me.menu && !me.disabled) {\r\n
                clearTimeout(me.expandMenuTimer);\r\n
                me.hideMenuTimer = _.delay(function () {\r\n
                    if (!me.menu.isOver) {\r\n
                        me.cmpEl.removeClass("over");\r\n
                    }\r\n
                },\r\n
                200);\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)\n
 * Licensed under the MIT License (LICENSE.txt).\n
 *\n
 * Version: 3.1.9\n
 *\n
 * Requires: jQuery 1.2.2+\n
 */\n
\n
(function (factory) {\n
    if ( typeof define === \'function\' && define.amd ) {\n
        // AMD. Register as an anonymous module.\n
        define(\'jmousewheel\',[\'jquery\'], factory);\n
    } else if (typeof exports === \'object\') {\n
        // Node/CommonJS style for Browserify\n
        module.exports = factory;\n
    } else {\n
        // Browser globals\n
        factory(jQuery);\n
    }\n
}(function ($) {\n
\n
    var toFix  = [\'wheel\', \'mousewheel\', \'DOMMouseScroll\', \'MozMousePixelScroll\'],\n
        toBind = ( \'onwheel\' in document || document.documentMode >= 9 ) ?\n
                    [\'wheel\'] : [\'mousewheel\', \'DomMouseScroll\', \'MozMousePixelScroll\'],\n
        slice  = Array.prototype.slice,\n
        nullLowestDeltaTimeout, lowestDelta;\n
\n
    if ( $.event.fixHooks ) {\n
        for ( var i = toFix.length; i; ) {\n
            $.event.fixHooks[ toFix[--i] ] = $.event.mouseHooks;\n
        }\n
    }\n
\n
    var special = $.event.special.mousewheel = {\n
        version: \'3.1.9\',\n
\n
        setup: function() {\n
            if ( this.addEventListener ) {\n
                for ( var i = toBind.length; i; ) {\n
                    this.addEventListener( toBind[--i], handler, false );\n
                }\n
            } else {\n
                this.onmousewheel = handler;\n
            }\n
            // Store the line height and page height for this particular element\n
            $.data(this, \'mousewheel-line-height\', special.getLineHeight(this));\n
            $.data(this, \'mousewheel-page-height\', special.getPageHeight(this));\n
        },\n
\n
        teardown: function() {\n
            if ( this.removeEventListener ) {\n
                for ( var i = toBind.length; i; ) {\n
                    this.removeEventListener( toBind[--i], handler, false );\n
                }\n
            } else {\n
                this.onmousewheel = null;\n
            }\n
        },\n
\n
        getLineHeight: function(elem) {\n
            return parseInt($(elem)[\'offsetParent\' in $.fn ? \'offsetParent\' : \'parent\']().css(\'fontSize\'), 10);\n
        },\n
\n
        getPageHeight: function(elem) {\n
            return $(elem).height();\n
        },\n
\n
        settings: {\n
            adjustOldDeltas: true\n
        }\n
    };\n
\n
    $.fn.extend({\n
        mousewheel: function(fn) {\n
            return fn ? this.bind(\'mousewheel\', fn) : this.trigger(\'mousewheel\');\n
        },\n
\n
        unmousewheel: function(fn) {\n
            return this.unbind(\'mousewheel\', fn);\n
        }\n
    });\n
\n
\n
    function handler(event) {\n
        var orgEvent   = event || window.event,\n
            args       = slice.call(arguments, 1),\n
            delta      = 0,\n
            deltaX     = 0,\n
            deltaY     = 0,\n
            absDelta   = 0;\n
        event = $.event.fix(orgEvent);\n
        event.type = \'mousewheel\';\n
\n
        // Old school scrollwheel delta\n
        if ( \'detail\'      in orgEvent ) { deltaY = orgEvent.detail * -1;      }\n
        if ( \'wheelDelta\'  in orgEvent ) { deltaY = orgEvent.wheelDelta;       }\n
        if ( \'wheelDeltaY\' in orgEvent ) { deltaY = orgEvent.wheelDeltaY;      }\n
        if ( \'wheelDeltaX\' in orgEvent ) { deltaX = orgEvent.wheelDeltaX * -1; }\n
\n
        // Firefox < 17 horizontal scrolling related to DOMMouseScroll event\n
        if ( \'axis\' in orgEvent && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {\n
            deltaX = deltaY * -1;\n
            deltaY = 0;\n
        }\n
\n
        // Set delta to be deltaY or deltaX if deltaY is 0 for backwards compatabilitiy\n
        delta = deltaY === 0 ? deltaX : deltaY;\n
\n
        // New school wheel delta (wheel event)\n
        if ( \'deltaY\' in orgEvent ) {\n
            deltaY = orgEvent.deltaY * -1;\n
            delta  = deltaY;\n
        }\n
        if ( \'deltaX\' in orgEvent ) {\n
            deltaX = orgEvent.deltaX;\n
            if ( deltaY === 0 ) { delta  = deltaX * -1; }\n
        }\n
\n
        // No change actually happened, no reason to go any further\n
        if ( deltaY === 0 && deltaX === 0 ) { return; }\n
\n
        // Need to convert lines and pages to pixels if we aren\'t already in pixels\n
        // There are three delta modes:\n
        //   * deltaMode 0 is by pixels, nothing to do\n
        //   * deltaMode 1 is by lines\n
        //   * deltaMode 2 is by pages\n
        if ( orgEvent.deltaMode === 1 ) {\n
            var lineHeight = $.data(this, \'mousewheel-line-height\');\n
            delta  *= lineHeight;\n
            deltaY *= lineHeight;\n
            deltaX *= lineHeight;\n
        } else if ( orgEvent.deltaMode === 2 ) {\n
            var pageHeight = $.data(this, \'mousewheel-page-height\');\n
            delta  *= pageHeight;\n
            deltaY *= pageHeight;\n
            deltaX *= pageHeight;\n
        }\n
\n
        // Store lowest absolute delta to normalize the delta values\n
        absDelta = Math.max( Math.abs(deltaY), Math.abs(deltaX) );\n
\n
        if ( !lowestDelta || absDelta < lowestDelta ) {\n
            lowestDelta = absDelta;\n
\n
            // Adjust older deltas if necessary\n
            if ( shouldAdjustOldDeltas(orgEvent, absDelta) ) {\n
                lowestDelta /= 40;\n
            }\n
        }\n
\n
        // Adjust older deltas if necessary\n
        if ( shouldAdjustOldDeltas(orgEvent, absDelta) ) {\n
            // Divide all the things by 40!\n
            delta  /= 40;\n
            deltaX /= 40;\n
            deltaY /= 40;\n
        }\n
\n
        // Get a whole, normalized value for the deltas\n
        delta  = Math[ delta  >= 1 ? \'floor\' : \'ceil\' ](delta  / lowestDelta);\n
        deltaX = Math[ deltaX >= 1 ? \'floor\' : \'ceil\' ](deltaX / lowestDelta);\n
        deltaY = Math[ deltaY >= 1 ? \'floor\' : \'ceil\' ](deltaY / lowestDelta);\n
\n
        // Add information to the event object\n
        event.deltaX = deltaX;\n
        event.deltaY = deltaY;\n
        event.deltaFactor = lowestDelta;\n
        // Go ahead and set deltaMode to 0 since we converted to pixels\n
        // Although this is a little odd since we overwrite the deltaX/Y\n
        // properties with normalized deltas.\n
        event.deltaMode = 0;\n
\n
        // Add event and delta to the front of the arguments\n
        args.unshift(event, delta, deltaX, deltaY);\n
\n
        // Clearout lowestDelta after sometime to better\n
        // handle multiple device types that give different\n
        // a different lowestDelta\n
        // Ex: trackpad = 3 and mouse wheel = 120\n
        if (nullLowestDeltaTimeout) { clearTimeout(nullLowestDeltaTimeout); }\n
        nullLowestDeltaTimeout = setTimeout(nullLowestDelta, 200);\n
\n
        return ($.event.dispatch || $.event.handle).apply(this, args);\n
    }\n
\n
    function nullLowestDelta() {\n
        lowestDelta = null;\n
    }\n
\n
    function shouldAdjustOldDeltas(orgEvent, absDelta) {\n
        // If this is an older event and the delta is divisable by 120,\n
        // then we are assuming that the browser is treating this as an\n
        // older mouse wheel event and that we should divide the deltas\n
        // by 40 to try and get a more usable deltaFactor.\n
        // Side note, this actually impacts the reported scroll distance\n
        // in older browsers and can cause scrolling to be slower than native.\n
        // Turn this off by setting $.event.special.mousewheel.settings.adjustOldDeltas to false.\n
        return special.settings.adjustOldDeltas && orgEvent.type === \'mousewheel\' && absDelta % 120 === 0;\n
    }\n
\n
}));\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 (function (factory) {\r\n
    if (typeof define === "function" && define.amd) {\r\n
        define(\'perfectscrollbar\',["jquery"], factory);\r\n
    } else {\r\n
        if (typeof exports === "object") {\r\n
            factory(require("jquery"));\r\n
        } else {\r\n
            factory(jQuery);\r\n
        }\r\n
    }\r\n
} (function ($) {\r\n
    var defaultSettings = {\r\n
        wheelSpeed: 10,\r\n
        wheelPropagation: false,\r\n
        minScrollbarLength: null,\r\n
        useBothWheelAxes: false,\r\n
        useKeyboard: true,\r\n
        suppressScrollX: false,\r\n
        suppressScrollY: false,\r\n
        scrollXMarginOffset: 0,\r\n
        scrollYMarginOffset: 0,\r\n
        includePadding: false,\r\n
        includeMargin: true\r\n
    };\r\n
    var getEventClassName = (function () {\r\n
        var incrementingId = 0;\r\n
        return function () {\r\n
            var id = incrementingId;\r\n
            incrementingId += 1;\r\n
            return ".perfect-scrollbar-" + id;\r\n
        };\r\n
    } ());\r\n
    $.fn.perfectScrollbar = function (suppliedSettings, option) {\r\n
        return this.each(function () {\r\n
            var settings = $.extend(true, {},\r\n
            defaultSettings),\r\n
            $this = $(this);\r\n
            if (typeof suppliedSettings === "object") {\r\n
                $.extend(true, settings, suppliedSettings);\r\n
            } else {\r\n
                option = suppliedSettings;\r\n
            }\r\n
            if (option === "update") {\r\n
                if ($this.data("perfect-scrollbar-update")) {\r\n
                    $this.data("perfect-scrollbar-update")();\r\n
                }\r\n
                return $this;\r\n
            } else {\r\n
                if (option === "destroy") {\r\n
                    if ($this.data("perfect-scrollbar-destroy")) {\r\n
                        $this.data("perfect-scrollbar-destroy")();\r\n
                    }\r\n
                    return $this;\r\n
                }\r\n
            }\r\n
            if ($this.data("perfect-scrollbar")) {\r\n
                return $this.data("perfect-scrollbar");\r\n
            }\r\n
            $this.addClass("ps-container");\r\n
            var $scrollbarXRail = $("<div class=\'ps-scrollbar-x-rail\'></div>").appendTo($this),\r\n
            $scrollbarYRail = $("<div class=\'ps-scrollbar-y-rail\'></div>").appendTo($this),\r\n
            $scrollbarX = $("<div class=\'ps-scrollbar-x\'></div>").appendTo($scrollbarXRail),\r\n
            $scrollbarY = $("<div class=\'ps-scrollbar-y\'></div>").appendTo($scrollbarYRail),\r\n
            scrollbarXActive,\r\n
            scrollbarYActive,\r\n
            containerWidth,\r\n
            containerHeight,\r\n
            contentWidth,\r\n
            contentHeight,\r\n
            scrollbarXWidth,\r\n
            scrollbarXLeft,\r\n
            scrollbarXBottom = parseInt($scrollbarXRail.css("bottom"), 10),\r\n
            scrollbarYHeight,\r\n
            scrollbarYTop,\r\n
            scrollbarYRight = parseInt($scrollbarYRail.css("right"), 10),\r\n
            scrollbarYRailHeight,\r\n
            eventClassName = getEventClassName();\r\n
            var updateContentScrollTop = function (currentTop, deltaY) {\r\n
                var newTop = currentTop + deltaY,\r\n
                maxTop = scrollbarYRailHeight - scrollbarYHeight;\r\n
                if (newTop < 0) {\r\n
                    scrollbarYTop = 0;\r\n
                } else {\r\n
                    if (newTop > maxTop) {\r\n
                        scrollbarYTop = maxTop;\r\n
                    } else {\r\n
                        scrollbarYTop = newTop;\r\n
                    }\r\n
                }\r\n
                var scrollTop = parseInt(scrollbarYTop * (contentHeight - containerHeight) / (scrollbarYRailHeight - scrollbarYHeight), 10);\r\n
                $this.scrollTop(scrollTop);\r\n
                $scrollbarXRail.css({\r\n
                    bottom: scrollbarXBottom - scrollTop\r\n
                });\r\n
            };\r\n
            var updateContentScrollLeft = function (currentLeft, deltaX) {\r\n
                var newLeft = currentLeft + deltaX,\r\n
                maxLeft = containerWidth - scrollbarXWidth;\r\n
                if (newLeft < 0) {\r\n
                    scrollbarXLeft = 0;\r\n
                } else {\r\n
                    if (newLeft > maxLeft) {\r\n
                        scrollbarXLeft = maxLeft;\r\n
                    } else {\r\n
                        scrollbarXLeft = newLeft;\r\n
                    }\r\n
                }\r\n
                var scrollLeft = parseInt(scrollbarXLeft * (contentWidth - containerWidth) / (containerWidth - scrollbarXWidth), 10);\r\n
                $this.scrollLeft(scrollLeft);\r\n
                $scrollbarYRail.css({\r\n
                    right: scrollbarYRight - scrollLeft\r\n
                });\r\n
            };\r\n
            var getSettingsAdjustedThumbSize = function (thumbSize) {\r\n
                if (settings.minScrollbarLength) {\r\n
                    thumbSize = Math.max(thumbSize, settings.minScrollbarLength);\r\n
                }\r\n
                return thumbSize;\r\n
            };\r\n
            var updateScrollbarCss = function () {\r\n
                $scrollbarXRail.css({\r\n
                    left: $this.scrollLeft(),\r\n
                    bottom: scrollbarXBottom - $this.scrollTop(),\r\n
                    width: containerWidth,\r\n
                    display: scrollbarXActive ? "inherit" : "none"\r\n
                });\r\n
                if ($scrollbarYRail.hasClass("in-scrolling")) {\r\n
                    $scrollbarYRail.css({\r\n
                        right: scrollbarYRight - $this.scrollLeft(),\r\n
                        height: scrollbarYRailHeight,\r\n
                        display: scrollbarYActive ? "inherit" : "none"\r\n
                    });\r\n
                } else {\r\n
                    $scrollbarYRail.css({\r\n
                        top: $this.scrollTop(),\r\n
                        right: scrollbarYRight - $this.scrollLeft(),\r\n
                        height: scrollbarYRailHeight,\r\n
                        display: scrollbarYActive ? "inherit" : "none"\r\n
                    });\r\n
                }\r\n
                $scrollbarX.css({\r\n
                    left: scrollbarXLeft,\r\n
                    width: scrollbarXWidth\r\n
                });\r\n
                $scrollbarY.css({\r\n
                    top: scrollbarYTop,\r\n
                    height: scrollbarYHeight\r\n
                });\r\n
            };\r\n
            var updateBarSizeAndPosition = function () {\r\n
                containerWidth = settings.includePadding ? $this.innerWidth() : $this.width();\r\n
                containerHeight = settings.includePadding ? $this.innerHeight() : $this.height();\r\n
                scrollbarYRailHeight = containerHeight - (settings.includeMargin ? (parseInt($scrollbarYRail.css("margin-top")) + parseInt($scrollbarYRail.css("margin-bottom"))) : 0);\r\n
                contentWidth = $this.prop("scrollWidth");\r\n
                contentHeight = $this.prop("scrollHeight");\r\n
                if (!settings.suppressScrollX && containerWidth + settings.scrollXMarginOffset < contentWidth) {\r\n
                    scrollbarXActive = true;\r\n
                    scrollbarXWidth = getSettingsAdjustedThumbSize(parseInt(containerWidth * containerWidth / contentWidth, 10));\r\n
                    scrollbarXLeft = parseInt($this.scrollLeft() * (containerWidth - scrollbarXWidth) / (contentWidth - containerWidth), 10);\r\n
                } else {\r\n
                    scrollbarXActive = false;\r\n
                    scrollbarXWidth = 0;\r\n
                    scrollbarXLeft = 0;\r\n
                    $this.scrollLeft(0);\r\n
                }\r\n
                if (!settings.suppressScrollY && containerHeight + settings.scrollYMarginOffset < contentHeight) {\r\n
                    scrollbarYActive = true;\r\n
                    scrollbarYHeight = getSettingsAdjustedThumbSize(parseInt(scrollbarYRailHeight * containerHeight / contentHeight, 10));\r\n
                    scrollbarYTop = parseInt($this.scrollTop() * (scrollbarYRailHeight - scrollbarYHeight) / (contentHeight - containerHeight), 10);\r\n
                } else {\r\n
                    scrollbarYActive = false;\r\n
                    scrollbarYHeight = 0;\r\n
                    scrollbarYTop = 0;\r\n
                    $this.scrollTop(0);\r\n
                }\r\n
                if (scrollbarYTop >= scrollbarYRailHeight - scrollbarYHeight) {\r\n
                    scrollbarYTop = scrollbarYRailHeight - scrollbarYHeight;\r\n
                }\r\n
                if (scrollbarXLeft >= containerWidth - scrollbarXWidth) {\r\n
                    scrollbarXLeft = containerWidth - scrollbarXWidth;\r\n
                }\r\n
                updateScrollbarCss();\r\n
                if (settings.onChange) {\r\n
                    settings.onChange(this);\r\n
                }\r\n
            };\r\n
            var bindMouseScrollXHandler = function () {\r\n
                var currentLeft, currentPageX;\r\n
                $scrollbarX.bind("mousedown" + eventClassName, function (e) {\r\n
                    currentPageX = e.pageX;\r\n
                    currentLeft = $scrollbarX.position().left;\r\n
                    $scrollbarXRail.addClass("in-scrolling");\r\n
                    e.stopPropagation();\r\n
                    e.preventDefault();\r\n
                });\r\n
                $(document).bind("mousemove" + eventClassName, function (e) {\r\n
                    if ($scrollbarXRail.hasClass("in-scrolling")) {\r\n
                        updateContentScrollLeft(currentLeft, e.pageX - currentPageX);\r\n
                        e.stopPropagation();\r\n
                        e.preventDefault();\r\n
                    }\r\n
                });\r\n
                $(document).bind("mouseup" + eventClassName, function (e) {\r\n
                    if ($scrollbarXRail.hasClass("in-scrolling")) {\r\n
                        $scrollbarXRail.removeClass("in-scrolling");\r\n
                    }\r\n
                });\r\n
                currentLeft = currentPageX = null;\r\n
            };\r\n
            var bindMouseScrollYHandler = function () {\r\n
                var currentTop, currentPageY;\r\n
                $scrollbarY.bind("mousedown" + eventClassName, function (e) {\r\n
                    currentPageY = e.pageY;\r\n
                    currentTop = $scrollbarY.position().top;\r\n
                    $scrollbarYRail.addClass("in-scrolling");\r\n
                    var margin = parseInt($scrollbarYRail.css("margin-top"));\r\n
                    var rect = $scrollbarYRail[0].getBoundingClientRect();\r\n
                    $scrollbarYRail.css({\r\n
                        position: "fixed",\r\n
                        left: rect.left,\r\n
                        top: rect.top - margin\r\n
                    });\r\n
                    e.stopPropagation();\r\n
                    e.preventDefault();\r\n
                });\r\n
                $(document).bind("mousemove" + eventClassName, function (e) {\r\n
                    if ($scrollbarYRail.hasClass("in-scrolling")) {\r\n
                        updateContentScrollTop(currentTop, e.pageY - currentPageY);\r\n
                        e.stopPropagation();\r\n
                        e.preventDefault();\r\n
                    }\r\n
                });\r\n
                $(document).bind("mouseup" + eventClassName, function (e) {\r\n
                    if ($scrollbarYRail.hasClass("in-scrolling")) {\r\n
                        $scrollbarYRail.removeClass("in-scrolling");\r\n
                        $scrollbarYRail.css({\r\n
                            position: "",\r\n
                            left: "",\r\n
                            top: ""\r\n
                        });\r\n
                        updateScrollbarCss();\r\n
                    }\r\n
                });\r\n
                currentTop = currentPageY = null;\r\n
            };\r\n
            var shouldPreventDefault = function (deltaX, deltaY) {\r\n
                var scrollTop = $this.scrollTop();\r\n
                if (deltaX === 0) {\r\n
                    if (!scrollbarYActive) {\r\n
                        return false;\r\n
                    }\r\n
                    if ((scrollTop === 0 && deltaY > 0) || (scrollTop >= contentHeight - containerHeight && deltaY < 0)) {\r\n
                        return !settings.wheelPropagation;\r\n
                    }\r\n
                }\r\n
                var scrollLeft = $this.scrollLeft();\r\n
                if (deltaY === 0) {\r\n
                    if (!scrollbarXActive) {\r\n
                        return false;\r\n
                    }\r\n
                    if ((scrollLeft === 0 && deltaX < 0) || (scrollLeft >= contentWidth - containerWidth && deltaX > 0)) {\r\n
                        return !settings.wheelPropagation;\r\n
                    }\r\n
                }\r\n
                return true;\r\n
            };\r\n
            var bindMouseWheelHandler = function () {\r\n
                settings.wheelSpeed /= 10;\r\n
                var shouldPrevent = false;\r\n
                $this.bind("mousewheel" + eventClassName, function (e, deprecatedDelta, deprecatedDeltaX, deprecatedDeltaY) {\r\n
                    var deltaX = e.deltaX * e.deltaFactor || deprecatedDeltaX,\r\n
                    deltaY = e.deltaY * e.deltaFactor || deprecatedDeltaY;\r\n
                    if (e && e.target && (e.target.type === "textarea" || e.target.type === "input")) {\r\n
                        e.stopImmediatePropagation();\r\n
                        e.preventDefault();\r\n
                        var scroll = $(e.target).scrollTop(),\r\n
                        wheelDeltaY = 0;\r\n
                        if (e.originalEvent) {\r\n
                            if (e.originalEvent.wheelDelta) {\r\n
                                wheelDeltaY = e.originalEvent.wheelDelta / -40;\r\n
                            }\r\n
                            if (e.originalEvent.deltaY) {\r\n
                                wheelDeltaY = e.originalEvent.deltaY;\r\n
                            }\r\n
                            if (e.originalEvent.detail) {\r\n
                                wheelDeltaY = e.originalEvent.detail;\r\n
                            }\r\n
                        }\r\n
                        $(e.target).scrollTop(scroll - wheelDeltaY);\r\n
                        return;\r\n
                    }\r\n
                    shouldPrevent = false;\r\n
                    if (!settings.useBothWheelAxes) {\r\n
                        $this.scrollTop($this.scrollTop() - (deltaY * settings.wheelSpeed));\r\n
                        $this.scrollLeft($this.scrollLeft() + (deltaX * settings.wheelSpeed));\r\n
                    } else {\r\n
                        if (scrollbarYActive && !scrollbarXActive) {\r\n
                            if (deltaY) {\r\n
                                $this.scrollTop($this.scrollTop() - (deltaY * settings.wheelSpeed));\r\n
                            } else {\r\n
                                $this.scrollTop($this.scrollTop() + (deltaX * settings.wheelSpeed));\r\n
                            }\r\n
                            shouldPrevent = true;\r\n
                        } else {\r\n
                            if (scrollbarXActive && !scrollbarYActive) {\r\n
                                if (deltaX) {\r\n
                                    $this.scrollLeft($this.scrollLeft() + (deltaX * settings.wheelSpeed));\r\n
                                } else {\r\n
                                    $this.scrollLeft($this.scrollLeft() - (deltaY * settings.wheelSpeed));\r\n
                                }\r\n
                                shouldPrevent = true;\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    updateBarSizeAndPosition();\r\n
                    shouldPrevent = (shouldPrevent || shouldPreventDefault(deltaX, deltaY));\r\n
                    if (shouldPrevent) {\r\n
                        e.stopPropagation();\r\n
                        e.preventDefault();\r\n
                    }\r\n
                });\r\n
                $this.bind("MozMousePixelScroll" + eventClassName, function (e) {\r\n
                    if (shouldPrevent) {\r\n
                        e.preventDefault();\r\n
                    }\r\n
                });\r\n
            };\r\n
            var bindKeyboardHandler = function () {\r\n
                var hovered = false;\r\n
                $this.bind("mouseenter" + eventClassName, function (e) {\r\n
                    hovered = true;\r\n
                });\r\n
                $this.bind("mouseleave" + eventClassName, function (e) {\r\n
                    hovered = false;\r\n
                });\r\n
                var shouldPrevent = false;\r\n
                $(document).bind("keydown" + eventClassName, function (e) {\r\n
                    if (!hovered || $(document.activeElement).is(":input,[contenteditable]")) {\r\n
                        return;\r\n
                    }\r\n
                    var deltaX = 0,\r\n
                    deltaY = 0;\r\n
                    switch (e.which) {\r\n
                    case 37:\r\n
                        deltaX = -30;\r\n
                        break;\r\n
                    case 38:\r\n
                        deltaY = 30;\r\n
                        break;\r\n
                    case 39:\r\n
                        deltaX = 30;\r\n
                        break;\r\n
                    case 40:\r\n
                        deltaY = -30;\r\n
                        break;\r\n
                    case 33:\r\n
                        deltaY = 90;\r\n
                        break;\r\n
                    case 32:\r\n
                        case 34:\r\n
                        deltaY = -90;\r\n
                        break;\r\n
                    case 35:\r\n
                        deltaY = -containerHeight;\r\n
                        break;\r\n
                    case 36:\r\n
                        deltaY = containerHeight;\r\n
                        break;\r\n
                    default:\r\n
                        return;\r\n
                    }\r\n
                    $this.scrollTop($this.scrollTop() - deltaY);\r\n
                    $this.scrollLeft($this.scrollLeft() + deltaX);\r\n
                    shouldPrevent = shouldPreventDefault(deltaX, deltaY);\r\n
                    if (shouldPrevent) {\r\n
                        e.preventDefault();\r\n
                    }\r\n
                });\r\n
            };\r\n
            var bindRailClickHandler = function () {\r\n
                var stopPropagation = function (e) {\r\n
                    e.stopPropagation();\r\n
                };\r\n
                $scrollbarY.bind("click" + eventClassName, stopPropagation);\r\n
                $scrollbarYRail.bind("click" + eventClassName, function (e) {\r\n
                    var halfOfScrollbarLength = parseInt(scrollbarYHeight / 2, 10),\r\n
                    positionTop = e.pageY - $scrollbarYRail.offset().top - halfOfScrollbarLength,\r\n
                    maxPositionTop = scrollbarYRailHeight - scrollbarYHeight,\r\n
                    positionRatio = positionTop / maxPositionTop;\r\n
                    if (positionRatio < 0) {\r\n
                        positionRatio = 0;\r\n
                    } else {\r\n
                        if (positionRatio > 1) {\r\n
                            positionRatio = 1;\r\n
                        }\r\n
                    }\r\n
                    $this.scrollTop((contentHeight - containerHeight) * positionRatio);\r\n
                });\r\n
                $scrollbarX.bind("click" + eventClassName, stopPropagation);\r\n
                $scrollbarXRail.bind("click" + eventClassName, function (e) {\r\n
                    var halfOfScrollbarLength = parseInt(scrollbarXWidth / 2, 10),\r\n
                    positionLeft = e.pageX - $scrollbarXRail.offset().left - halfOfScrollbarLength,\r\n
                    maxPositionLeft = containerWidth - scrollbarXWidth,\r\n
                    positionRatio = positionLeft / maxPositionLeft;\r\n
                    if (positionRatio < 0) {\r\n
                        positionRatio = 0;\r\n
                    } else {\r\n
                        if (positionRatio > 1) {\r\n
                            positionRatio = 1;\r\n
                        }\r\n
                    }\r\n
                    $this.scrollLeft((contentWidth - containerWidth) * positionRatio);\r\n
                });\r\n
            };\r\n
            var bindMobileTouchHandler = function () {\r\n
                var applyTouchMove = function (differenceX, differenceY) {\r\n
                    $this.scrollTop($this.scrollTop() - differenceY);\r\n
                    $this.scrollLeft($this.scrollLeft() - differenceX);\r\n
                    updateBarSizeAndPosition();\r\n
                };\r\n
                var startCoords = {},\r\n
                startTime = 0,\r\n
                speed = {},\r\n
                breakingProcess = null,\r\n
                inGlobalTouch = false;\r\n
                $(window).bind("touchstart" + eventClassName, function (e) {\r\n
                    inGlobalTouch = true;\r\n
                });\r\n
                $(window).bind("touchend" + eventClassName, function (e) {\r\n
                    inGlobalTouch = false;\r\n
                });\r\n
                $this.bind("touchstart" + eventClassName, function (e) {\r\n
                    var touch = e.originalEvent.targetTouches[0];\r\n
                    startCoords.pageX = touch.pageX;\r\n
                    startCoords.pageY = touch.pageY;\r\n
                    startTime = (new Date()).getTime();\r\n
                    if (breakingProcess !== null) {\r\n
                        clearInterval(breakingProcess);\r\n
                    }\r\n
                    e.stopPropagation();\r\n
                });\r\n
                $this.bind("touchmove" + eventClassName, function (e) {\r\n
                    if (!inGlobalTouch && e.originalEvent.targetTouches.length === 1) {\r\n
                        var touch = e.originalEvent.targetTouches[0];\r\n
                        var currentCoords = {};\r\n
                        currentCoords.pageX = touch.pageX;\r\n
                        currentCoords.pageY = touch.pageY;\r\n
                        var differenceX = currentCoords.pageX - startCoords.pageX,\r\n
                        differenceY = currentCoords.pageY - startCoords.pageY;\r\n
                        applyTouchMove(differenceX, differenceY);\r\n
                        startCoords = currentCoords;\r\n
                        var currentTime = (new Date()).getTime();\r\n
                        var timeGap = currentTime - startTime;\r\n
                        if (timeGap > 0) {\r\n
                            speed.x = differenceX / timeGap;\r\n
                            speed.y = differenceY / timeGap;\r\n
                            startTime = currentTime;\r\n
                        }\r\n
                        e.preventDefault();\r\n
                    }\r\n
                });\r\n
                $this.bind("touchend" + eventClassName, function (e) {\r\n
                    clearInterval(breakingProcess);\r\n
                    breakingProcess = setInterval(function () {\r\n
                        if (Math.abs(speed.x) < 0.01 && Math.abs(speed.y) < 0.01) {\r\n
                            clearInterval(breakingProcess);\r\n
                            return;\r\n
                        }\r\n
                        applyTouchMove(speed.x * 30, speed.y * 30);\r\n
                        speed.x *= 0.8;\r\n
                        speed.y *= 0.8;\r\n
                    },\r\n
                    10);\r\n
                });\r\n
            };\r\n
            var bindScrollHandler = function () {\r\n
                $this.bind("scroll" + eventClassName, function (e) {\r\n
                    updateBarSizeAndPosition();\r\n
                });\r\n
            };\r\n
            var destroy = function () {\r\n
                $this.unbind(eventClassName);\r\n
                $(window).unbind(eventClassName);\r\n
                $(document).unbind(eventClassName);\r\n
                $this.data("perfect-scrollbar", null);\r\n
                $this.data("perfect-scrollbar-update", null);\r\n
                $this.data("perfect-scrollbar-destroy", null);\r\n
                $scrollbarX.remove();\r\n
                $scrollbarY.remove();\r\n
                $scrollbarXRail.remove();\r\n
                $scrollbarYRail.remove();\r\n
                $scrollbarX = $scrollbarY = containerWidth = containerHeight = contentWidth = contentHeight = scrollbarXWidth = scrollbarXLeft = scrollbarXBottom = scrollbarYHeight = scrollbarYTop = scrollbarYRight = null;\r\n
            };\r\n
            var ieSupport = function (version) {\r\n
                $this.addClass("ie").addClass("ie" + version);\r\n
                var bindHoverHandlers = function () {\r\n
                    var mouseenter = function () {\r\n
                        $(this).addClass("hover");\r\n
                    };\r\n
                    var mouseleave = function () {\r\n
                        $(this).removeClass("hover");\r\n
                    };\r\n
                    $this.bind("mouseenter" + eventClassName, mouseenter).bind("mouseleave" + eventClassName, mouseleave);\r\n
                    $scrollbarXRail.bind("mouseenter" + eventClassName, mouseenter).bind("mouseleave" + eventClassName, mouseleave);\r\n
                    $scrollbarYRail.bind("mouseenter" + eventClassName, mouseenter).bind("mouseleave" + eventClassName, mouseleave);\r\n
                    $scrollbarX.bind("mouseenter" + eventClassName, mouseenter).bind("mouseleave" + eventClassName, mouseleave);\r\n
                    $scrollbarY.bind("mouseenter" + eventClassName, mouseenter).bind("mouseleave" + eventClassName, mouseleave);\r\n
                };\r\n
                var fixIe6ScrollbarPosition = function () {\r\n
                    updateScrollbarCss = function () {\r\n
                        $scrollbarX.css({\r\n
                            left: scrollbarXLeft + $this.scrollLeft(),\r\n
                            bottom: scrollbarXBottom,\r\n
                            width: scrollbarXWidth\r\n
                        });\r\n
                        $scrollbarY.css({\r\n
                            top: scrollbarYTop + $this.scrollTop(),\r\n
                            right: scrollbarYRight,\r\n
                            height: scrollbarYHeight\r\n
                        });\r\n
                        $scrollbarX.hide().show();\r\n
                        $scrollbarY.hide().show();\r\n
                    };\r\n
                };\r\n
                if (version === 6) {\r\n
                    bindHoverHandlers();\r\n
                    fixIe6ScrollbarPosition();\r\n
                }\r\n
            };\r\n
            var supportsTouch = (("ontouchstart" in window) || window.DocumentTouch && document instanceof window.DocumentTouch);\r\n
            var initialize = function () {\r\n
                var ieMatch = navigator.userAgent.toLowerCase().match(/(msie) ([\\w.]+)/);\r\n
                if (ieMatch && ieMatch[1] === "msie") {\r\n
                    ieSupport(parseInt(ieMatch[2], 10));\r\n
                }\r\n
                updateBarSizeAndPosition();\r\n
                bindScrollHandler();\r\n
                bindMouseScrollXHandler();\r\n
                bindMouseScrollYHandler();\r\n
                bindRailClickHandler();\r\n
                if (supportsTouch) {\r\n
                    bindMobileTouchHandler();\r\n
                }\r\n
                if ($this.mousewheel) {\r\n
                    bindMouseWheelHandler();\r\n
                }\r\n
                if (settings.useKeyboard) {\r\n
                    bindKeyboardHandler();\r\n
                }\r\n
                $this.data("perfect-scrollbar", $this);\r\n
                $this.data("perfect-scrollbar-update", updateBarSizeAndPosition);\r\n
                $this.data("perfect-scrollbar-destroy", destroy);\r\n
            };\r\n
            initialize();\r\n
            return $this;\r\n
        });\r\n
    };\r\n
}));\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as publishe

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAo=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="10" aka="AAAAAAAAAAo=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

d by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Scroller\',["jmousewheel", "perfectscrollbar", "common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.Scroller = (function () {\r\n
        var mouseCapture;\r\n
        return _.extend(Common.UI.BaseView.extend({\r\n
            options: {\r\n
                wheelSpeed: 20,\r\n
                wheelPropagation: false,\r\n
                minScrollbarLength: null,\r\n
                useBothWheelAxes: false,\r\n
                useKeyboard: true,\r\n
                suppressScrollX: false,\r\n
                suppressScrollY: false,\r\n
                scrollXMarginOffset: 5,\r\n
                scrollYMarginOffset: 5,\r\n
                includePadding: true,\r\n
                includeMargin: true,\r\n
                alwaysVisibleX: false,\r\n
                alwaysVisibleY: false\r\n
            },\r\n
            initialize: function (options) {\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                if (this.options.el) {\r\n
                    this.render();\r\n
                }\r\n
            },\r\n
            render: function () {\r\n
                var me = this;\r\n
                me.cmpEl = $(this.el);\r\n
                if (!me.rendered) {\r\n
                    me.cmpEl.perfectScrollbar(_.extend({},\r\n
                    me.options));\r\n
                    me.rendered = true;\r\n
                    this.setAlwaysVisibleX(me.options.alwaysVisibleX);\r\n
                    this.setAlwaysVisibleY(me.options.alwaysVisibleY);\r\n
                }\r\n
                return this;\r\n
            },\r\n
            remove: function () {\r\n
                this.destroy();\r\n
                Backbone.View.prototype.remove.call(this);\r\n
            },\r\n
            update: function (config) {\r\n
                var options = this.options;\r\n
                if (config) {\r\n
                    this.destroy();\r\n
                    options = _.extend(this.options, config);\r\n
                    this.cmpEl.perfectScrollbar(options);\r\n
                } else {\r\n
                    this.cmpEl.perfectScrollbar("update");\r\n
                }\r\n
                this.setAlwaysVisibleX(options.alwaysVisibleX);\r\n
                this.setAlwaysVisibleY(options.alwaysVisibleY);\r\n
                var mouseDownHandler = function (e) {\r\n
                    mouseCapture = true;\r\n
                    var upHandler = function (e) {\r\n
                        $(document).unbind("mouseup", upHandler);\r\n
                        _.delay(function () {\r\n
                            mouseCapture = false;\r\n
                        },\r\n
                        10);\r\n
                    };\r\n
                    $(document).mouseup(upHandler);\r\n
                };\r\n
                $(".ps-scrollbar-x-rail, .ps-scrollbar-y-rail, .ps-scrollbar-x, .ps-scrollbar-y", this.cmpEl).off("mousedown", mouseDownHandler).on("mousedown", mouseDownHandler);\r\n
            },\r\n
            destroy: function () {\r\n
                this.cmpEl.perfectScrollbar("destroy");\r\n
            },\r\n
            scrollLeft: function (pos) {\r\n
                this.cmpEl.scrollLeft(pos);\r\n
                this.update();\r\n
            },\r\n
            scrollTop: function (pos) {\r\n
                this.cmpEl.scrollTop(pos);\r\n
                this.update();\r\n
            },\r\n
            getScrollTop: function () {\r\n
                return this.cmpEl.scrollTop();\r\n
            },\r\n
            getScrollLeft: function () {\r\n
                return this.cmpEl.scrollLeft();\r\n
            },\r\n
            setAlwaysVisibleX: function (flag) {\r\n
                if (flag) {\r\n
                    $(this.el).find(".ps-scrollbar-x-rail").addClass("always-visible-x");\r\n
                    $(this.el).find(".ps-scrollbar-x").addClass("always-visible-x");\r\n
                } else {\r\n
                    $(this.el).find(".ps-scrollbar-x-rail").removeClass("always-visible-x");\r\n
                    $(this.el).find(".ps-scrollbar-x").addClass("always-visible-x");\r\n
                }\r\n
            },\r\n
            setAlwaysVisibleY: function (flag) {\r\n
                if (flag) {\r\n
                    $(this.el).find(".ps-scrollbar-y-rail").addClass("always-visible-y");\r\n
                    $(this.el).find(".ps-scrollbar-y").addClass("always-visible-y");\r\n
                } else {\r\n
                    $(this.el).find(".ps-scrollbar-y-rail").removeClass("always-visible-y");\r\n
                    $(this.el).find(".ps-scrollbar-y").addClass("always-visible-y");\r\n
                }\r\n
            }\r\n
        }), {\r\n
            isMouseCapture: function () {\r\n
                return mouseCapture;\r\n
            }\r\n
        });\r\n
    })();\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Menu\',["common/main/lib/extend/Bootstrap", "common/main/lib/component/BaseView", "common/main/lib/component/MenuItem", "common/main/lib/component/Scroller"], function () {\r\n
    Common.UI.Menu = (function () {\r\n
        var manager = (function () {\r\n
            var active = [],\r\n
            menus = {};\r\n
            return {\r\n
                register: function (menu) {\r\n
                    menus[menu.id] = menu;\r\n
                    menu.on("show:after", function (m) {\r\n
                        active.push(m);\r\n
                    }).on("hide:after", function (m) {\r\n
                        var index = active.indexOf(m);\r\n
                        if (index > -1) {\r\n
                            active.splice(index, 1);\r\n
                        }\r\n
                    });\r\n
                },\r\n
                unregister: function (menu) {\r\n
                    var index = active.indexOf(menu);\r\n
                    delete menus[menu.id];\r\n
                    if (index > -1) {\r\n
                        active.splice(index, 1);\r\n
                    }\r\n
                    menu.off("show:after").off("hide:after");\r\n
                },\r\n
                hideAll: function () {\r\n
                    Common.NotificationCenter.trigger("menumanager:hideall");\r\n
                    if (active && active.length > 0) {\r\n
                        _.each(active, function (menu) {\r\n
                            menu.hide();\r\n
                        });\r\n
                        return true;\r\n
                    }\r\n
                    return false;\r\n
                }\r\n
            };\r\n
        })();\r\n
        return _.extend(Common.UI.BaseView.extend({\r\n
            options: {\r\n
                cls: "",\r\n
                style: "",\r\n
                itemTemplate: null,\r\n
                items: [],\r\n
                menuAlign: "tl-bl",\r\n
                menuAlignEl: null,\r\n
                offset: [0, 0]\r\n
            },\r\n
            template: _.template([\'<ul class="dropdown-menu <%= options.cls %>" style="<%= options.style %>" role="menu"></ul>\'].join("")),\r\n
            initialize: function (options) {\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                var me = this;\r\n
                this.id = this.options.id || Common.UI.getId();\r\n
                this.itemTemplate = this.options.itemTemplate || Common.UI.MenuItem.prototype.template;\r\n
                this.rendered = false;\r\n
                this.items = [];\r\n
                this.offset = [0, 0];\r\n
                this.menuAlign = this.options.menuAlign;\r\n
                this.menuAlignEl = this.options.menuAlignEl;\r\n
                _.each(this.options.items, function (item) {\r\n
                    if (item instanceof Common.UI.MenuItem) {\r\n
                        me.items.push(item);\r\n
                    } else {\r\n
                        me.items.push(new Common.UI.MenuItem(_.extend({\r\n
                            tagName: "li",\r\n
                            template: me.itemTemplate\r\n
                        },\r\n
                        item)));\r\n
                    }\r\n
                });\r\n
                if (this.options.el) {\r\n
                    this.render();\r\n
                }\r\n
                manager.register(this);\r\n
            },\r\n
            remove: function () {\r\n
                manager.unregister(this);\r\n
                Common.UI.BaseView.prototype.remove.call(this);\r\n
            },\r\n
            render: function (parentEl) {\r\n
                var me = this;\r\n
                this.trigger("render:before", this);\r\n
                this.cmpEl = $(this.el);\r\n
                if (parentEl) {\r\n
                    this.setElement(parentEl, false);\r\n
                    if (!me.rendered) {\r\n
                        this.cmpEl = $(this.template({\r\n
                            options: me.options\r\n
                        }));\r\n
                        parentEl.append(this.cmpEl);\r\n
                    }\r\n
                } else {\r\n
                    if (!me.rendered) {\r\n
                        this.cmpEl = this.template({\r\n
                            options: me.options\r\n
                        });\r\n
                        $(this.el).append(this.cmpEl);\r\n
                    }\r\n
                }\r\n
                var rootEl = this.cmpEl.parent(),\r\n
                menuRoot = (rootEl.attr("role") === "menu") ? rootEl : rootEl.find("[role=menu]");\r\n
                if (menuRoot) {\r\n
                    if (!me.rendered) {\r\n
                        _.each(me.items || [], function (item) {\r\n
                            menuRoot.append(item.render().el);\r\n
                            item.on("click", _.bind(me.onItemClick, me));\r\n
                            item.on("toggle", _.bind(me.onItemToggle, me));\r\n
                        });\r\n
                    }\r\n
                    menuRoot.css({\r\n
                        "max-height": me.options.maxHeight || "none",\r\n
                        position: "fixed",\r\n
                        right: "auto",\r\n
                        left: -1000,\r\n
                        top: -1000\r\n
                    });\r\n
                    this.parentEl = menuRoot.parent();\r\n
                    this.parentEl.on("show.bs.dropdown", _.bind(me.onBeforeShowMenu, me));\r\n
                    this.parentEl.on("shown.bs.dropdown", _.bind(me.onAfterShowMenu, me));\r\n
                    this.parentEl.on("hide.bs.dropdown", _.bind(me.onBeforeHideMenu, me));\r\n
                    this.parentEl.on("hidden.bs.dropdown", _.bind(me.onAfterHideMenu, me));\r\n
                    this.parentEl.on("keydown.after.bs.dropdown", _.bind(me.onAfterKeydownMenu, me));\r\n
                    menuRoot.on("scroll", _.bind(me.onScroll, me));\r\n
                    menuRoot.hover(function (e) {\r\n
                        me.isOver = true;\r\n
                    },\r\n
                    function (e) {\r\n
                        me.isOver = false;\r\n
                    });\r\n
                }\r\n
                this.rendered = true;\r\n
                this.trigger("render:after", this);\r\n
                return this;\r\n
            },\r\n
            isVisible: function () {\r\n
                return this.rendered && (this.cmpEl.is(":visible"));\r\n
            },\r\n
            show: function () {\r\n
                if (this.rendered && this.parentEl && !this.parentEl.hasClass("open")) {\r\n
                    this.cmpEl.dropdown("toggle");\r\n
                }\r\n
            },\r\n
            hide: function () {\r\n
                if (this.rendered && this.parentEl && this.parentEl.hasClass("open")) {\r\n
                    this.cmpEl.dropdown("toggle");\r\n
                }\r\n
            },\r\n
            insertItem: function (index, item) {\r\n
                var me = this,\r\n
                el = this.cmpEl;\r\n
                if (! (item instanceof Common.UI.MenuItem)) {\r\n
                    item = new Common.UI.MenuItem(_.extend({\r\n
                        tagName: "li",\r\n
                        template: me.itemTemplate\r\n
                    },\r\n
                    item));\r\n
                }\r\n
                if (index < 0 || index >= me.items.length) {\r\n
                    me.items.push(item);\r\n
                } else {\r\n
                    me.items.splice(index, 0, item);\r\n
                }\r\n
                if (this.rendered) {\r\n
                    var menuRoot = (el.attr("role") === "menu") ? el : el.find("[role=menu]");\r\n
                    if (menuRoot) {\r\n
                        if (index < 0) {\r\n
                            menuRoot.append(item.render().el);\r\n
                        } else {\r\n
                            if (index === 0) {\r\n
                                menuRoot.prepend(item.render().el);\r\n
                            } else {\r\n
                                $("li:nth-child(" + index + ")", menuRoot).before(item.render().el);\r\n
                            }\r\n
                        }\r\n
                        item.on("click", _.bind(me.onItemClick, me));\r\n
                        item.on("toggle", _.bind(me.onItemToggle, me));\r\n
                    }\r\n
                }\r\n
            },\r\n
            doLayout: function () {\r\n
                if (this.options.maxHeight > 0) {\r\n
                    if (!this.rendered) {\r\n
                        this.mustLayout = true;\r\n
                        return;\r\n
                    }\r\n
                    var me = this,\r\n
                    el = this.cmpEl;\r\n
                    var menuRoot = (el.attr("role") === "menu") ? el : el.find("[role=menu]");\r\n
                    if (!menuRoot.is(":visible")) {\r\n
                        var pos = [menuRoot.css("left"), menuRoot.css("top")];\r\n
                        menuRoot.css({\r\n
                            left: "-1000px",\r\n
                            top: "-1000px",\r\n
                            display: "block"\r\n
                        });\r\n
                    }\r\n
                    var $items = menuRoot.find("li");\r\n
                    if ($items.height() * $items.length > this.options.maxHeight) {\r\n
                        var scroll = \'<div class="menu-scroll top"></div>\';\r\n
                        menuRoot.prepend(scroll);\r\n
                        scroll = \'<div class="menu-scroll bottom"></div>\';\r\n
                        menuRoot.append(scroll);\r\n
                        menuRoot.css({\r\n
                            "box-shadow": "none",\r\n
                            "overflow-y": "hidden",\r\n
                            "padding-top": "18px"\r\n
                        });\r\n
                        menuRoot.find("> li:last-of-type").css("margin-bottom", 18);\r\n
                        var addEvent = function (elem, type, fn) {\r\n
                            elem.addEventListener ? elem.addEventListener(type, fn, false) : elem.attachEvent("on" + type, fn);\r\n
                        };\r\n
                        var eventname = (/Firefox/i.test(navigator.userAgent)) ? "DOMMouseScroll" : "mousewheel";\r\n
                        addEvent(menuRoot[0], eventname, _.bind(this.onMouseWheel, this));\r\n
                        menuRoot.find(".menu-scroll").on("click", _.bind(this.onScrollClick, this));\r\n
                    }\r\n
                    if (pos) {\r\n
                        menuRoot.css({\r\n
                            display: "",\r\n
                            left: pos[0],\r\n
                            top: pos[1]\r\n
                        });\r\n
                    }\r\n
                }\r\n
            },\r\n
            addItem: function (item) {\r\n
                this.insertItem(-1, item);\r\n
            },\r\n
            removeItem: function (item) {\r\n
                var me = this,\r\n
                index = me.items.indexOf(item);\r\n
                if (index > -1) {\r\n
                    me.items.splice(index, 1);\r\n
                    item.off("click").off("toggle");\r\n
                    item.remove();\r\n
                }\r\n
            },\r\n
            removeAll: function () {\r\n
                var me = this;\r\n
                _.each(me.items, function (item) {\r\n
                    item.off("click").off("toggle");\r\n
                    item.remove();\r\n
                });\r\n
                me.items = [];\r\n
            },\r\n
            onBeforeShowMenu: function (e) {\r\n
                if (this.mustLayout) {\r\n
                    delete this.mustLayout;\r\n
                    this.doLayout.call(this);\r\n
                }\r\n
                this.trigger("show:before", this, e);\r\n
                this.alignPosition();\r\n
            },\r\n
            onAfterShowMenu: function (e) {\r\n
                this.trigger("show:after", this, e);\r\n
                if (this.$el.find("> ul > .menu-scroll").length) {\r\n
                    var el = this.$el.find("li .checked")[0];\r\n
                    if (el) {\r\n
                        var offset = el.offsetTop - this.options.maxHeight / 2;\r\n
                        this.scrollMenu(offset < 0 ? 0 : offset);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onBeforeHideMenu: function (e) {\r\n
                this.trigger("hide:before", this, e);\r\n
                if (Common.UI.Scroller.isMouseCapture()) {\r\n
                    e.preventDefault();\r\n
                }\r\n
            },\r\n
            onAfterHideMenu: function (e) {\r\n
                this.trigger("hide:after", this, e);\r\n
            },\r\n
            onAfterKeydownMenu: function (e) {\r\n
                if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                    var li = $(e.target).closest("li");\r\n
                    if (li.length <= 0) {\r\n
                        li = $(e.target).parent().find("li .dataview");\r\n
                    }\r\n
                    if (li.length > 0) {\r\n
                        li.click();\r\n
                    }\r\n
                } else {\r\n
                    if (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN) {\r\n
                        this.fromKeyDown = true;\r\n
                    }\r\n
                }\r\n
            },\r\n
            onScroll: function (item, e) {\r\n
                if (this.fromKeyDown) {\r\n
                    var menuRoot = (this.cmpEl.attr("role") === "menu") ? this.cmpEl : this.cmpEl.find("[role=menu]");\r\n
                    menuRoot.find(".menu-scroll.top").css("top", menuRoot.scrollTop() + "px");\r\n
                    menuRoot.find(".menu-scroll.bottom").css("bottom", (-menuRoot.scrollTop()) + "px");\r\n
                }\r\n
            },\r\n
            onItemClick: function (item, e) {\r\n
                if (!item.menu) {\r\n
                    this.isOver = false;\r\n
                }\r\n
                if (item.options.stopPropagation) {\r\n
                    e.stopPropagation();\r\n
                    var me = this;\r\n
                    _.delay(function () {\r\n
                        me.$el.parent().parent().find("[data-toggle=dropdown]").focus();\r\n
                    },\r\n
                    10);\r\n
                    return;\r\n
                }\r\n
                this.trigger("item:click", this, item, e);\r\n
            },\r\n
            onItemToggle: function (item, state, e) {\r\n
                this.trigger("item:toggle", this, item, state, e);\r\n
            },\r\n
            onScrollClick: function (e) {\r\n
                this.scrollMenu(/top/.test(e.currentTarget.className));\r\n
                return false;\r\n
            },\r\n
            onMouseWheel: function (e) {\r\n
                this.scrollMenu(((e.detail && -e.detail) || e.wheelDelta) > 0);\r\n
            },\r\n
            scrollMenu: function (up) {\r\n
                this.fromKeyDown = false;\r\n
                var menuRoot = (this.cmpEl.attr("role") === "menu") ? this.cmpEl : this.cmpEl.find("[role=menu]"),\r\n
                value = typeof(up) === "boolean" ? menuRoot.scrollTop() + (up ? -20 : 20) : up;\r\n
                menuRoot.scrollTop(value);\r\n
                menuRoot.find(".menu-scroll.top").css("top", menuRoot.scrollTop() + "px");\r\n
                menuRoot.find(".menu-scroll.bottom").css("bottom", (-menuRoot.scrollTop()) + "px");\r\n
            },\r\n
            setOffset: function (offsetX, offsetY) {\r\n
                this.offset[0] = _.isUndefined(offsetX) ? this.offset[0] : offsetX;\r\n
                this.offset[1] = _.isUndefined(offsetY) ? this.offset[1] : offsetY;\r\n
                this.alignPosition();\r\n
            },\r\n
            getOffset: function () {\r\n
                return this.offset;\r\n
            },\r\n
            alignPosition: function () {\r\n
                var menuRoot = (this.cmpEl.attr("role") === "menu") ? this.cmpEl : this.cmpEl.find("[role=menu]"),\r\n
                menuParent = this.menuAlignEl || menuRoot.parent(),\r\n
                m = this.menuAlign.match(/^([a-z]+)-([a-z]+)/),\r\n
                offset = menuParent.offset(),\r\n
                docW = Math.min($(document).width(), $("body").width()),\r\n
                docH = $(document).height() - 10,\r\n
                menuW = menuRoot.outerWidth(),\r\n
                menuH = menuRoot.outerHeight(),\r\n
                parentW = menuParent.outerWidth(),\r\n
                parentH = menuParent.outerHeight();\r\n
                var posMenu = {\r\n
                    "tl": [0, 0],\r\n
                    "bl": [0, menuH],\r\n
                    "tr": [menuW, 0],\r\n
                    "br": [menuW, menuH]\r\n
                };\r\n
                var posParent = {\r\n
                    "tl": [0, 0],\r\n
                    "tr": [parentW, 0],\r\n
                    "bl": [0, parentH],\r\n
                    "br": [parentW, parentH]\r\n
                };\r\n
                var left = offset.left - posMenu[m[1]][0] + posParent[m[2]][0] + this.offset[0];\r\n
                var top = offset.top - posMenu[m[1]][1] + posParent[m[2]][1] + this.offset[1];\r\n
                if (left + menuW > docW) {\r\n
                    if (menuParent.is("li.dropdown-submenu")) {\r\n
                        left = offset.left - menuW + 2;\r\n
                    } else {\r\n
                        left = docW - menuW;\r\n
                    }\r\n
                }\r\n
                if (top + menuH > docH) {\r\n
                    top = docH - menuH;\r\n
                }\r\n
                if (top < 0) {\r\n
                    top = 0;\r\n
                }\r\n
                menuRoot.css({\r\n
                    left: left,\r\n
                    top: top\r\n
                });\r\n
            }\r\n
        }), {\r\n
            Manager: (function () {\r\n
                return manager;\r\n
            })()\r\n
        });\r\n
    })();\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/DocumentHolder\',["jquery", "underscore", "backbone", "gateway", "common/main/lib/component/Menu"], function ($, _, Backbone, gateway) {\r\n
    SSE.Views.DocumentHolder = Backbone.View.extend(_.extend({\r\n
        el: "#editor_sdk",\r\n
        template: null,\r\n
        events: {},\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            this.setApi = function (api) {\r\n
                me.api = api;\r\n
                return me;\r\n
            };\r\n
            var value = window.localStorage.getItem("sse-settings-livecomment");\r\n
            me.isLiveCommenting = !(value !== null && parseInt(value) == 0);\r\n
        },\r\n
        render: function () {\r\n
            this.fireEvent("render:before", this);\r\n
            this.cmpEl = $(this.el);\r\n
            this.fireEvent("render:after", this);\r\n
            return this;\r\n
        },\r\n
        focus: function () {\r\n
            var me = this;\r\n
            _.defer(function () {\r\n
                me.cmpEl.focus();\r\n
            },\r\n
            50);\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            var me = this;\r\n
            me.pmiCut = new Common.UI.MenuItem({\r\n
                caption: me.txtCut,\r\n
                value: "cut"\r\n
            });\r\n
            me.pmiCopy = new Common.UI.MenuItem({\r\n
                caption: me.txtCopy,\r\n
                value: "copy"\r\n
            });\r\n
            me.pmiPaste = new Common.UI.MenuItem({\r\n
                caption: me.txtPaste,\r\n
                value: "paste"\r\n
            });\r\n
            me.pmiInsertEntire = new Common.UI.MenuItem({\r\n
                caption: me.txtInsert\r\n
            });\r\n
            me.pmiInsertCells = new Common.UI.MenuItem({\r\n
                caption: me.txtInsert,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [{\r\n
                        caption: me.txtShiftRight,\r\n
                        value: c_oAscInsertOptions.InsertCellsAndShiftRight\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtShiftDown,\r\n
                        value: c_oAscInsertOptions.InsertCellsAndShiftDown\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtRow,\r\n
                        value: c_oAscInsertOptions.InsertRows\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtColumn,\r\n
                        value: c_oAscInsertOptions.InsertColumns\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.pmiDeleteEntire = new Common.UI.MenuItem({\r\n
                caption: me.txtDelete\r\n
            });\r\n
            me.pmiDeleteCells = new Common.UI.MenuItem({\r\n
                caption: me.txtDelete,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [{\r\n
                        caption: me.txtShiftLeft,\r\n
                        value: c_oAscDeleteOptions.DeleteCellsAndShiftLeft\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtShiftUp,\r\n
                        value: c_oAscDeleteOptions.DeleteCellsAndShiftTop\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtRow,\r\n
                        value: c_oAscDeleteOptions.DeleteRows\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtColumn,\r\n
                        value: c_oAscDeleteOptions.DeleteColumns\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.pmiClear = new Common.UI.MenuItem({\r\n
                caption: me.txtClear,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [{\r\n
                        caption: me.txtClearAll,\r\n
                        value: c_oAscCleanOptions.All\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearText,\r\n
                        value: c_oAscCleanOptions.Text\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearFormat,\r\n
                        value: c_oAscCleanOptions.Format\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearComments,\r\n
                        value: c_oAscCleanOptions.Comments\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearHyper,\r\n
                        value: c_oAscCleanOptions.Hyperlinks\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.pmiSortCells = new Common.UI.MenuItem({\r\n
                caption: me.txtSort,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [{\r\n
                        caption: me.txtAscending,\r\n
                        value: "ascending"\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtDescending,\r\n
                        value: "descending"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.pmiInsFunction = new Common.UI.MenuItem({\r\n
                caption: me.txtFormula\r\n
            });\r\n
            me.menuAddHyperlink = new Common.UI.MenuItem({\r\n
                caption: me.txtInsHyperlink,\r\n
                inCell: true\r\n
            });\r\n
            me.menuEditHyperlink = new Common.UI.MenuItem({\r\n
                caption: me.editHyperlinkText,\r\n
                inCell: true\r\n
            });\r\n
            me.menuRemoveHyperlink = new Common.UI.MenuItem({\r\n
                caption: me.removeHyperlinkText\r\n
            });\r\n
            me.menuHyperlink = new Common.UI.MenuItem({\r\n
                caption: me.txtInsHyperlink,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [me.menuEditHyperlink, me.menuRemoveHyperlink]\r\n
                })\r\n
            });\r\n
            me.pmiRowHeight = new Common.UI.MenuItem({\r\n
                caption: me.txtRowHeight,\r\n
                action: "row-height"\r\n
            });\r\n
            me.pmiColumnWidth = new Common.UI.MenuItem({\r\n
                caption: me.txtColumnWidth,\r\n
                action: "column-width"\r\n
            });\r\n
            me.pmiEntireHide = new Common.UI.MenuItem({\r\n
                caption: me.txtHide\r\n
            });\r\n
            me.pmiEntireShow = new Common.UI.MenuItem({\r\n
                caption: me.txtShow\r\n
            });\r\n
            me.pmiAddComment = new Common.UI.MenuItem({\r\n
                id: "id-context-menu-item-add-comment",\r\n
                caption: me.txtAddComment\r\n
            });\r\n
            me.pmiCellMenuSeparator = new Common.UI.MenuItem({\r\n
                caption: "--"\r\n
            });\r\n
            me.ssMenu = new Common.UI.Menu({\r\n
                id: "id-context-menu-cell",\r\n
                items: [me.pmiCut, me.pmiCopy, me.pmiPaste, {\r\n
                    caption: "--"\r\n
                },\r\n
                me.pmiInsertEntire, me.pmiInsertCells, me.pmiDeleteEntire, me.pmiDeleteCells, me.pmiClear, me.pmiSortCells, {\r\n
                    caption: "--"\r\n
                },\r\n
                me.pmiAddComment, me.pmiCellMenuSeparator, me.pmiInsFunction, me.menuAddHyperlink, me.menuHyperlink, me.pmiRowHeight, me.pmiColumnWidth, me.pmiEntireHide, me.pmiEntireShow]\r\n
            });\r\n
            me.mnuGroupImg = new Common.UI.MenuItem({\r\n
                caption: this.txtGroup,\r\n
                iconCls: "mnu-group",\r\n
                type: "group",\r\n
                value: "grouping"\r\n
            });\r\n
            me.mnuUnGroupImg = new Common.UI.MenuItem({\r\n
                caption: this.txtUngroup,\r\n
                iconCls: "mnu-ungroup",\r\n
                type: "group",\r\n
                value: "ungrouping"\r\n
            });\r\n
            me.mnuShapeSeparator = new Common.UI.MenuItem({\r\n
                caption: "--"\r\n
            });\r\n
            me.mnuShapeAdvanced = new Common.UI.MenuItem({\r\n
                caption: me.advancedShapeText\r\n
            });\r\n
            me.mnuChartEdit = new Common.UI.MenuItem({\r\n
                caption: me.chartText\r\n
            });\r\n
            me.pmiImgCut = new Common.UI.MenuItem({\r\n
                caption: me.txtCut,\r\n
                value: "cut"\r\n
            });\r\n
            me.pmiImgCopy = new Common.UI.MenuItem({\r\n
                caption: me.txtCopy,\r\n
                value: "copy"\r\n
            });\r\n
            me.pmiImgPaste = new Common.UI.MenuItem({\r\n
                caption: me.txtPaste,\r\n
                value: "paste"\r\n
            });\r\n
            this.imgMenu = new Common.UI.Menu({\r\n
                items: [me.pmiImgCut, me.pmiImgCopy, me.pmiImgPaste, {\r\n
                    caption: "--"\r\n
                },\r\n
                {\r\n
                    caption: this.textArrangeFront,\r\n
                    iconCls: "mnu-arrange-front",\r\n
                    type: "arrange",\r\n
                    value: c_oAscDrawingLayerType.BringToFront\r\n
                },\r\n
                {\r\n
                    caption: this.textArrangeBack,\r\n
                    iconCls: "mnu-arrange-back",\r\n
                    type: "arrange",\r\n
                    value: c_oAscDrawingLayerType.SendToBack\r\n
                },\r\n
                {\r\n
                    caption: this.textArrangeForward,\r\n
                    iconCls: "mnu-arrange-forward",\r\n
                    type: "arrange",\r\n
                    value: c_oAscDrawingLayerType.BringForward\r\n
                },\r\n
                {\r\n
                    caption: this.textArrangeBackward,\r\n
                    iconCls: "mnu-arrange-backward",\r\n
                    type: "arrange",\r\n
                    value: c_oAscDrawingLayerType.SendBackward\r\n
                },\r\n
                {\r\n
                    caption: "--"\r\n
                },\r\n
                me.mnuGroupImg, me.mnuUnGroupImg, me.mnuShapeSeparator, me.mnuChartEdit, me.mnuShapeAdvanced]\r\n
            });\r\n
            this.menuParagraphVAlign = new Common.UI.MenuItem({\r\n
                caption: this.vertAlignText,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [me.menuParagraphTop = new Common.UI.MenuItem({\r\n
                        caption: me.topCellText,\r\n
                        checkable: true,\r\n
                        toggleGroup: "popupparagraphvalign",\r\n
                        value: c_oAscVerticalTextAlign.TEXT_ALIGN_TOP\r\n
                    }), me.menuParagraphCenter = new Common.UI.MenuItem({\r\n
                        caption: me.centerCellText,\r\n
                        checkable: true,\r\n
                        toggleGroup: "popupparagraphvalign",\r\n
                        value: c_oAscVerticalTextAlign.TEXT_ALIGN_CTR\r\n
                    }), this.menuParagraphBottom = new Common.UI.MenuItem({\r\n
                        caption: me.bottomCellText,\r\n
                        checkable: true,\r\n
                        toggleGroup: "popupparagraphvalign",\r\n
                        value: c_oAscVerticalTextAlign.TEXT_ALIGN_BOTTOM\r\n
                    })]\r\n
                })\r\n
            });\r\n
            me.menuAddHyperlinkShape = new Common.UI.MenuItem({\r\n
                caption: me.txtInsHyperlink\r\n
            });\r\n
            me.menuEditHyperlinkShape = new Common.UI.MenuItem({\r\n
                caption: me.editHyperlinkText\r\n
            });\r\n
            me.menuRemoveHyperlinkShape = new Common.UI.MenuItem({\r\n
                caption: me.removeHyperlinkText\r\n
            });\r\n
            me.menuHyperlinkShape = new Common.UI.MenuItem({\r\n
                caption: me.txtInsHyperlink,\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-tr",\r\n
                    items: [me.menuEditHyperlinkShape, me.menuRemoveHyperlinkShape]\r\n
                })\r\n
            });\r\n
            this.pmiTextAdvanced = new Common.UI.MenuItem({\r\n
                caption: me.txtTextAdvanced\r\n
            });\r\n
            me.pmiTextCut = new Common.UI.MenuItem({\r\n
                caption: me.txtCut,\r\n
                value: "cut"\r\n
            });\r\n
            me.pmiTextCopy = new Common.UI.MenuItem({\r\n
                caption: me.txtCopy,\r\n
                value: "copy"\r\n
            });\r\n
            me.pmiTextPaste = new Common.UI.MenuItem({\r\n
                caption: me.txtPaste,\r\n
                value: "paste"\r\n
            });\r\n
            this.textInShapeMenu = new Common.UI.Menu({\r\n
                items: [me.pmiTextCut, me.pmiTextCopy, me.pmiTextPaste, {\r\n
                    caption: "--"\r\n
                },\r\n
                me.menuParagraphVAlign, me.menuAddHyperlinkShape, me.menuHyperlinkShape, {\r\n
                    caption: "--"\r\n
                },\r\n
                me.pmiTextAdvanced]\r\n
            });\r\n
            this.funcMenu = new Common.UI.Menu({\r\n
                items: [{\r\n
                    caption: "item 1"\r\n
                },\r\n
                {\r\n
                    caption: "item 2"\r\n
                },\r\n
                {\r\n
                    caption: "item 3"\r\n
                },\r\n
                {\r\n
                    caption: "item 4"\r\n
                },\r\n
                {\r\n
                    caption: "item 5"\r\n
                }]\r\n
            });\r\n
            me.fireEvent("createdelayedelements", [me]);\r\n
        },\r\n
        setMenuItemCommentCaptionMode: function (edit) {\r\n
            edit ? this.pmiAddComment.setCaption(this.txtEditComment) : this.pmiAddComment.setCaption(this.txtAddComment);\r\n
        },\r\n
        setLiveCommenting: function (value) {\r\n
            this.isLiveCommenting = value;\r\n
        },\r\n
        txtSort: "Sort",\r\n
        txtAscending: "Ascending",\r\n
        txtDescending: "Descending",\r\n
        txtFormula: "Insert Function",\r\n
        txtInsHyperlink: "Hyperlink",\r\n
        txtCut: "Cut",\r\n
        txtCopy: "Copy",\r\n
        txtPaste: "Paste",\r\n
        txtInsert: "Insert",\r\n
        txtDelete: "Delete",\r\n
        txtClear: "Clear",\r\n
        txtClearAll: "All",\r\n
        txtClearText: "Text",\r\n
        txtClearFormat: "Format",\r\n
        txtClearHyper: "Hyperlink",\r\n
        txtClearComments: "Comments",\r\n
        txtShiftRight: "Shift cells right",\r\n
        txtShiftLeft: "Shift cells left",\r\n
        txtShiftUp: "Shift cells up",\r\n
        txtShiftDown: "Shift cells down",\r\n
        txtRow: "Entire Row",\r\n
        txtColumn: "Entire Column",\r\n
        txtColumnWidth: "Column Width",\r\n
        txtRowHeight: "Row Height",\r\n
        txtWidth: "Width",\r\n
        txtHide: "Hide",\r\n
        txtShow: "Show",\r\n
        textArrangeFront: "Bring To Front",\r\n
        textArrangeBack: "Send To Back",\r\n
        textArrangeForward: "Bring Forward",\r\n
        textArrangeBackward: "Send Backward",\r\n
        txtArrange: "Arrange",\r\n
        txtAddComment: "Add Comment",\r\n
        txtEditComment: "Edit Comment",\r\n
        txtUngroup: "Ungroup",\r\n
        txtGroup: "Group",\r\n
        topCellText: "Align Top",\r\n
        centerCellText: "Align Center",\r\n
        bottomCellText: "Align Bottom",\r\n
        vertAlignText: "Vertical Alignment",\r\n
        txtTextAdvanced: "Text Advanced Settings",\r\n
        editHyperlinkText: "Edit Hyperlink",\r\n
        removeHyperlinkText: "Remove Hyperlink",\r\n
        editChartText: "Edit Data",\r\n
        advancedShapeText: "Shape Advanced Settings",\r\n
        chartText: "Chart Advanced Settings"\r\n
    },\r\n
    SSE.Views.DocumentHolder || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ComboBox\',["common/main/lib/component/BaseView", "common/main/lib/component/Scroller"], function () {\r\n
    Common.UI.ComboBoxModel = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                value: null,\r\n
                displayValue: null\r\n
            };\r\n
        }\r\n
    });\r\n
    Common.UI.ComboBoxStore = Backbone.Collection.extend({\r\n
        model: Common.UI.ComboBoxModel\r\n
    });\r\n
    Common.UI.ComboBox = Common.UI.BaseView.extend((function () {\r\n
        return {\r\n
            options: {\r\n
                id: null,\r\n
                cls: "",\r\n
                style: "",\r\n
                hint: false,\r\n
                editable: true,\r\n
                disabled: false,\r\n
                menuCls: "",\r\n
                menuStyle: "",\r\n
                displayField: "displayValue",\r\n
                valueField: "value"\r\n
            },\r\n
            template: _.template([\'<span class="input-group combobox <%= cls %>" id="<%= id %>" style="<%= style %>">\', \'<input type="text" class="form-control">\', \'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>\', \'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">\', "<% _.each(items, function(item) { %>", \'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>\', "<% }); %>", "</ul>", "</span>"].join("")),\r\n
            initialize: function (options) {\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                var me = this,\r\n
                el = $(this.el);\r\n
                this.id = me.options.id || Common.UI.getId();\r\n
                this.cls = me.options.cls;\r\n
                this.style = me.options.style;\r\n
                this.menuCls = me.options.menuCls;\r\n
                this.menuStyle = me.options.menuStyle;\r\n
                this.template = me.options.template || me.template;\r\n
                this.hint = me.options.hint;\r\n
                this.editable = me.options.editable;\r\n
                this.disabled = me.options.disabled;\r\n
                this.store = me.options.store || new Common.UI.ComboBoxStore();\r\n
                this.displayField = me.options.displayField;\r\n
                this.valueField = me.options.valueField;\r\n
                me.rendered = me.options.rendered || false;\r\n
                this.lastValue = null;\r\n
                me.store.add(me.options.data);\r\n
                if (me.options.el) {\r\n
                    me.render();\r\n
                }\r\n
            },\r\n
            render: function (parentEl) {\r\n
                var me = this;\r\n
                if (!me.rendered) {\r\n
                    this.cmpEl = $(this.template({\r\n
                        id: this.id,\r\n
                        cls: this.cls,\r\n
                        style: this.style,\r\n
                        menuCls: this.menuCls,\r\n
                        menuStyle: this.menuStyle,\r\n
                        items: this.store.toJSON(),\r\n
                        scope: me\r\n
                    }));\r\n
                    if (parentEl) {\r\n
                        this.setElement(parentEl, false);\r\n
                        parentEl.html(this.cmpEl);\r\n
                    } else {\r\n
                        $(this.el).html(this.cmpEl);\r\n
                    }\r\n
                } else {\r\n
                    this.cmpEl = $(this.el);\r\n
                }\r\n
                if (!me.rendered) {\r\n
                    var el = this.cmpEl;\r\n
                    this._input = el.find("input");\r\n
                    this._button = el.find(".btn");\r\n
                    el.on("click", "a", _.bind(this.itemClicked, this));\r\n
                    el.on("mousedown", "a", _.bind(this.itemMouseDown, this));\r\n
                    if (this.editable) {\r\n
                        el.on("change", "input", _.bind(this.onInputChanged, this));\r\n
                        el.on("keydown", "input", _.bind(this.onInputKeyDown, this));\r\n
                        el.on("click", ".form-control", _.bind(this.onEditableInputClick, this));\r\n
                    } else {\r\n
                        el.on("click", ".form-control", _.bind(this.onInputClick, this));\r\n
                        this._input.attr("readonly", "readonly");\r\n
                        this._input.attr("data-can-copy", false);\r\n
                    }\r\n
                    if (me.options.hint) {\r\n
                        el.attr("data-toggle", "tooltip");\r\n
                        el.tooltip({\r\n
                            title: me.options.hint,\r\n
                            placement: me.options.hintAnchor || "cursor"\r\n
                        });\r\n
                    }\r\n
                    el.on("show.bs.dropdown", _.bind(me.onBeforeShowMenu, me));\r\n
                    el.on("shown.bs.dropdown", _.bind(me.onAfterShowMenu, me));\r\n
                    el.on("hide.bs.dropdown", _.bind(me.onBeforeHideMenu, me));\r\n
                    el.on("hidden.bs.dropdown", _.bind(me.onAfterHideMenu, me));\r\n
                    el.on("keydown.after.bs.dropdown", _.bind(me.onAfterKeydownMenu, me));\r\n
                    Common.NotificationCenter.on("menumanager:hideall", _.bind(me.closeMenu, me));\r\n
                    this.scroller = new Common.UI.Scroller({\r\n
                        el: $(".dropdown-menu", me.cmpEl),\r\n
                        minScrollbarLength: 40,\r\n
                        scrollYMarginOffset: 30,\r\n
                        includePadding: true\r\n
                    });\r\n
                    this.setDefaultSelection();\r\n
                    this.listenTo(this.store, "reset", this.onResetItems);\r\n
                }\r\n
                me.rendered = true;\r\n
                if (me.disabled) {\r\n
                    me.setDisabled(me.disabled);\r\n
                }\r\n
                return this;\r\n
            },\r\n
            setData: function (data) {\r\n
                this.store.reset([]);\r\n
                this.store.add(data);\r\n
                this.setRawValue("");\r\n
                this.onResetItems();\r\n
            },\r\n
            openMenu: function (delay) {\r\n
                var me = this;\r\n
                _.delay(function () {\r\n
                    me.cmpEl.addClass("open");\r\n
                },\r\n
                delay || 0);\r\n
            },\r\n
            closeMenu: function () {\r\n
                this.cmpEl.removeClass("open");\r\n
            },\r\n
            isMenuOpen: function () {\r\n
                return this.cmpEl.hasClass("open");\r\n
            },\r\n
            onBeforeShowMenu: function (e) {\r\n
                this.trigger("show:before", this, e);\r\n
                if (this.options.hint) {\r\n
                    var tip = this.cmpEl.data("bs.tooltip");\r\n
                    if (tip) {\r\n
                        if (tip.dontShow === undefined) {\r\n
                            tip.dontShow = true;\r\n
                        }\r\n
                        tip.hide();\r\n
                    }\r\n
                }\r\n
            },\r\n
            onAfterShowMenu: function (e) {\r\n
                var $list = $(this.el).find("ul"),\r\n
                $selected = $list.find("> li.selected");\r\n
                if ($selected.length) {\r\n
                    var itemTop = $selected.position().top,\r\n
                    itemHeight = $selected.height(),\r\n
                    listHeight = $list.height();\r\n
                    if (itemTop < 0 || itemTop + itemHeight > listHeight) {\r\n
                        $list.scrollTop($list.scrollTop() + itemTop + itemHeight - (listHeight / 2));\r\n
                    }\r\n
                }\r\n
                if (this.scroller) {\r\n
                    this.scroller.update();\r\n
                }\r\n
                this.trigger("show:after", this, e);\r\n
            },\r\n
            onBeforeHideMenu: function (e) {\r\n
                this.trigger("hide:before", this, e);\r\n
                if (Common.UI.Scroller.isMouseCapture()) {\r\n
                    e.preventDefault();\r\n
                }\r\n
            },\r\n
            onAfterHideMenu: function (e) {\r\n
                this.cmpEl.find(".dropdown-toggle").blur();\r\n
                this.trigger("hide:after", this, e);\r\n
            },\r\n
            onAfterKeydownMenu: function (e) {\r\n
                if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                    $(e.target).click();\r\n
                    var me = this;\r\n
                    if (this.rendered) {\r\n
                        if (Common.Utils.isIE) {\r\n
                            this._input.trigger("change", {\r\n
                                onkeydown: true\r\n
                            });\r\n
                        } else {\r\n
                            this._input.blur();\r\n
                        }\r\n
                    }\r\n
                    return false;\r\n
                } else {\r\n
                    if (e.keyCode == Common.UI.Keys.ESC && this.isMenuOpen()) {\r\n
                        this.closeMenu();\r\n
                        this.onAfterHideMenu(e);\r\n
                        return false;\r\n
                    }\r\n
                }\r\n
            },\r\n
            onInputKeyDown: function (e) {\r\n
                var me = this;\r\n
                if (e.keyCode == Common.UI.Keys.ESC) {\r\n
                    this.closeMenu();\r\n
                    this.onAfterHideMenu(e);\r\n
                } else {\r\n
                    if (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN) {\r\n
                        if (!this.isMenuOpen()) {\r\n
                            this.openMenu();\r\n
                        }\r\n
                        _.delay(function () {\r\n
                            me._skipInputChange = true;\r\n
                            me.cmpEl.find("ul li:first a").focus();\r\n
                        },\r\n
                        10);\r\n
                    } else {\r\n
                        me._skipInputChange = false;\r\n
                    }\r\n
                }\r\n
            },\r\n
            onInputChanged: function (e, extra) {\r\n
                if (extra && extra.synthetic) {\r\n
                    return;\r\n
                }\r\n
                if (this._skipInputChange) {\r\n
                    this._skipInputChange = false;\r\n
                    return;\r\n
                }\r\n
                var val = $(e.target).val(),\r\n
                record = {};\r\n
                if (this.lastValue === val) {\r\n
                    if (extra && extra.onkeydown) {\r\n
                        this.trigger("combo:blur", this, e);\r\n
                    }\r\n
                    return;\r\n
                }\r\n
                record[this.valueField] = val;\r\n
                this.trigger("changed:before", this, record, e);\r\n
                if (e.isDefaultPrevented()) {\r\n
                    return;\r\n
                }\r\n
                var obj;\r\n
                this._selectedItem = this.store.findWhere((obj = {},\r\n
                obj[this.displayField] = val, obj));\r\n
                if (this._selectedItem) {\r\n
                    record = this._selectedItem.toJSON();\r\n
                    $(".selected", $(this.el)).removeClass("selected");\r\n
                    $("#" + this._selectedItem.get("id"), $(this.el)).addClass("selected");\r\n
                }\r\n
                this.trigger("changed:after", this, record, e);\r\n
            },\r\n
            onInputClick: function (e) {\r\n
                if (this._button) {\r\n
                    this._button.dropdown("toggle");\r\n
                }\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
            },\r\n
            onEditableInputClick: function (e) {\r\n
                if (this.options.hint) {\r\n
                    var tip = this.cmpEl.data("bs.tooltip");\r\n
                    if (tip) {\r\n
                        if (tip.dontShow === undefined) {\r\n
                            tip.dontShow = true;\r\n
                        }\r\n
                        tip.hide();\r\n
                    }\r\n
                }\r\n
                if (this.isMenuOpen() && e.which == 1) {\r\n
                    e.stopPropagation();\r\n
                }\r\n
            },\r\n
            setDefaultSelection: function () {\r\n
                if (!this.rendered) {\r\n
                    return;\r\n
                }\r\n
                var val = this._input.val(),\r\n
                obj;\r\n
                if (val) {\r\n
                    this._selectedItem = this.store.findWhere((obj = {},\r\n
                    obj[this.displayField] = val, obj));\r\n
                    if (this._selectedItem) {\r\n
                        $(".selected", $(this.el)).removeClass("selected");\r\n
                        $("#" + this._selectedItem.get("id"), $(this.el)).addClass("selected");\r\n
                    }\r\n
                }\r\n
            },\r\n
            setDisabled: function (disabled) {\r\n
                this.disabled = disabled;\r\n
                if (!this.rendered) {\r\n
                    return;\r\n
                }\r\n
                disabled ? this._input.attr("disabled", true) : this._input.removeAttr("disabled");\r\n
                this.cmpEl.toggleClass("disabled", disabled);\r\n
                this._button.toggleClass("disabled", disabled);\r\n
            },\r\n
            isDisabled: function () {\r\n
                return this.disabled;\r\n
            },\r\n
            setRawValue: function (value) {\r\n
                if (this.rendered) {\r\n
                    this._input.val(value).trigger("change", {\r\n
                        synthetic: true\r\n
                    });\r\n
                    this.lastValue = (value !== null && value !== undefined) ? value.toString() : value;\r\n
                }\r\n
            },\r\n
            getRawValue: function () {\r\n
                return this.rendered ? this._input.val() : null;\r\n
            },\r\n
            setValue: function (value) {\r\n
                if (!this.rendered) {\r\n
                    return;\r\n
                }\r\n
                var obj;\r\n
                this._selectedItem = this.store.findWhere((obj = {},\r\n
                obj[this.valueField] = value, obj));\r\n
                $(".selected", $(this.el)).removeClass("selected");\r\n
                if (this._selectedItem) {\r\n
                    this.setRawValue(this._selectedItem.get(this.displayField));\r\n
                    $("#" + this._selectedItem.get("id"), $(this.el)).addClass("selected");\r\n
                } else {\r\n
                    this.setRawValue(value);\r\n
                }\r\n
            },\r\n
            getValue: function () {\r\n
                if (!this.rendered) {\r\n
                    return null;\r\n
                }\r\n
                if (this._selectedItem && !_.isUndefined(this._selectedItem.get(this.valueField))) {\r\n
                    return this._selectedItem.get(this.valueField);\r\n
                }\r\n
                return this._input.val();\r\n
            },\r\n
            getDisplayValue: function (record) {\r\n
                return Common.Utils.String.htmlEncode(record[this.displayField]);\r\n
            },\r\n
            getSelectedRecord: function () {\r\n
                if (!this.rendered) {\r\n
                    return null;\r\n
                }\r\n
                if (this._selectedItem && !_.isUndefined(this._selectedItem.get(this.valueField))) {\r\n
                    return _.extend({},\r\n
                    this._selectedItem.toJSON());\r\n
                }\r\n
                return null;\r\n
            },\r\n
            selectRecord: function (record) {\r\n
                if (!this.rendered || !record) {\r\n
                    return;\r\n
                }\r\n
                this._selectedItem = record;\r\n
                $(".selected", $(this.el)).removeClass("selected");\r\n
                this.setRawValue(this._selectedItem.get(this.displayField));\r\n
                $("#" + this._selectedItem.get("id"), $(this.el)).addClass("selected");\r\n
            },\r\n
            itemClicked: function (e) {\r\n
                var el = $(e.target).closest("li");\r\n
                this._selectedItem = this.store.findWhere({\r\n
                    id: el.attr("id")\r\n
                });\r\n
                if (this._selectedItem) {\r\n
                    this.lastValue = this._selectedItem.get(this.displayField);\r\n
                    this._input.val(this.lastValue).trigger("change", {\r\n
                        synthetic: true\r\n
                    });\r\n
                    $(".selected", $(this.el)).removeClass("selected");\r\n
                    el.addClass("selected");\r\n
                    this.trigger("selected", this, _.extend({},\r\n
                    this._selectedItem.toJSON()), e);\r\n
                    e.preventDefault();\r\n
                }\r\n
                this._isMouseDownMenu = false;\r\n
            },\r\n
            itemMouseDown: function (e) {\r\n
                if (e.which != 1) {\r\n
                    e.preventDefault();\r\n
                    e.stopPropagation();\r\n
                    return false;\r\n
                }\r\n
                this._isMouseDownMenu = true;\r\n
            },\r\n
            onResetItems: function () {\r\n
                $(this.el).find("ul").html(_.template(["<% _.each(items, function(item) { %>", \'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem"><%= scope.getDisplayValue(item) %></a></li>\', "<% }); %>"].join(""), {\r\n
                    items: this.store.toJSON(),\r\n
                    scope: this\r\n
                }));\r\n
                if (!_.isUndefined(this.scroller)) {\r\n
                    this.scroller.destroy();\r\n
                    delete this.scroller;\r\n
                }\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(".dropdown-menu", this.cmpEl),\r\n
                    minScrollbarLength: 40,\r\n
                    scrollYMarginOffset: 30,\r\n
                    includePadding: true\r\n
                });\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 (function ($) {\r\n
    var _superclass = $.fn.tooltip;\r\n
    _superclass.prototype = $.fn.tooltip.Constructor.prototype;\r\n
    $.extend($.fn.tooltip.Constructor.DEFAULTS, {\r\n
        container: "body",\r\n
        delay: {\r\n
            show: 500\r\n
        },\r\n
        arrow: false\r\n
    });\r\n
    var Tip = function (element, options) {\r\n
        this.init("tooltip", element, options);\r\n
    };\r\n
    Tip.prototype = $.extend({},\r\n
    $.fn.tooltip.Constructor.prototype, {\r\n
        constructor: Tip,\r\n
        init: function () {\r\n
            _superclass.prototype.init.apply(this, arguments);\r\n
            if (this.options.placement == "cursor") {\r\n
                if (/hover/.exec(this.options.trigger)) {\r\n
                    this.$element.on("mousemove.tooltip", this.options.selector, $.proxy(this.mousemove, this));\r\n
                }\r\n
            }\r\n
            if (this.options.zIndex) {\r\n
                this.tip().css("z-index", this.options.zIndex);\r\n
            }\r\n
            var me = this;\r\n
            Common.NotificationCenter.on({\r\n
                "layout:changed": function (e) {\r\n
                    if (!me.options.hideonclick && me.tip().is(":visible")) {\r\n
                        me.hide();\r\n
                    }\r\n
                }\r\n
            });\r\n
        },\r\n
        mousemove: function (e) {\r\n
            this.targetXY = [e.clientX, e.clientY];\r\n
        },\r\n
        leave: function (obj) {\r\n
            _superclass.prototype.leave.apply(this, arguments);\r\n
            this.dontShow = undefined;\r\n
        },\r\n
        show: function (at) {\r\n
            if (this.hasContent() && this.enabled && !this.dontShow) {\r\n
                if (!this.$element.is(":visible") && this.$element.closest("[role=menu]").length > 0) {\r\n
                    return;\r\n
                }\r\n
                var $tip = this.tip();\r\n
                var placement = typeof this.options.placement === "function" ? this.options.placement.call(this, $tip[0], this.$element[0]) : this.options.placement;\r\n
                if (this.options.arrow === false) {\r\n
                    $tip.addClass("arrow-free");\r\n
                }\r\n
                if (this.options.cls) {\r\n
                    $tip.addClass(this.options.cls);\r\n
                }\r\n
                var placementEx = /^([a-zA-Z]+)-?([a-zA-Z]*)$/.exec(placement);\r\n
                if (!at && !placementEx[2].length) {\r\n
                    _superclass.prototype.show.apply(this, arguments);\r\n
                } else {\r\n
                    var e = $.Event("show.bs.tooltip");\r\n
                    this.$element.trigger(e);\r\n
                    if (e.isDefaultPrevented()) {\r\n
                        return;\r\n
                    }\r\n
                    this.setContent();\r\n
                    if (this.options.animation) {\r\n
                        $tip.addClass("fade");\r\n
                    }\r\n
                    $tip.detach().css({\r\n
                        top: 0,\r\n
                        left:

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAs=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="11" aka="AAAAAAAAAAs=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

 0,\r\n
                        display: "block"\r\n
                    });\r\n
                    this.options.container ? $tip.appendTo(this.options.container) : $tip.insertAfter(this.$element);\r\n
                    if (typeof at == "object") {\r\n
                        var tp = {\r\n
                            top: at[1] + 15,\r\n
                            left: at[0] + 18\r\n
                        };\r\n
                        if (tp.left + $tip.width() > window.innerWidth) {\r\n
                            tp.left = window.innerWidth - $tip.width() - 30;\r\n
                        }\r\n
                        $tip.offset(tp).addClass("in");\r\n
                    } else {\r\n
                        var pos = this.getPosition();\r\n
                        var actualWidth = $tip[0].offsetWidth,\r\n
                        actualHeight = $tip[0].offsetHeight;\r\n
                        switch (placementEx[1]) {\r\n
                        case "bottom":\r\n
                            tp = {\r\n
                                top: pos.top + pos.height + 10\r\n
                            };\r\n
                            break;\r\n
                        case "top":\r\n
                            tp = {\r\n
                                top: pos.top - actualHeight - 10\r\n
                            };\r\n
                            break;\r\n
                        }\r\n
                        switch (placementEx[2]) {\r\n
                        case "left":\r\n
                            tp.left = pos.left;\r\n
                            if (this.$element.outerWidth() <= 18) {\r\n
                                tp.left -= 4;\r\n
                            }\r\n
                            break;\r\n
                        case "right":\r\n
                            tp.left = pos.left + pos.width - actualWidth;\r\n
                            if (this.$element.outerWidth() <= 18) {\r\n
                                tp.left += 4;\r\n
                            }\r\n
                            break;\r\n
                        }\r\n
                        this.applyPlacement(tp, placementEx[1]);\r\n
                        this.moveArrow();\r\n
                        $tip.addClass(placementEx[1]).addClass(placementEx[0]);\r\n
                    }\r\n
                    this.$element.trigger("shown.bs.tooltip");\r\n
                }\r\n
                var self = this;\r\n
                clearTimeout(self.timeout);\r\n
                self.timeout = setTimeout(function () {\r\n
                    if (self.hoverState == "in") {\r\n
                        self.hide();\r\n
                    }\r\n
                    self.dontShow = false;\r\n
                },\r\n
                5000);\r\n
            }\r\n
        },\r\n
        moveArrow: function () {\r\n
            var $arrow = this.tip().find(".tooltip-arrow, .arrow");\r\n
            var new_arrow_position = 10;\r\n
            switch (this.options.placement) {\r\n
            case "top-left":\r\n
                case "bottom-left":\r\n
                $arrow.css("left", new_arrow_position);\r\n
                break;\r\n
            case "top-right":\r\n
                case "bottom-right":\r\n
                $arrow.css("right", new_arrow_position);\r\n
                break;\r\n
            }\r\n
        },\r\n
        enter: function (obj) {\r\n
            if (obj.type !== "mouseenter") {\r\n
                return;\r\n
            }\r\n
            var $target = $(obj.target);\r\n
            if ($target.is("[role=menu]") || $target.parentsUntil(obj.currentTarget, "[role=menu]").length || this.tip().is(":visible")) {\r\n
                return;\r\n
            }\r\n
            var self = obj instanceof this.constructor ? obj : $(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs.tooltip");\r\n
            clearTimeout(self.timeout);\r\n
            self.hoverState = "in";\r\n
            if (!self.options.delay || !self.options.delay.show) {\r\n
                self.show();\r\n
            } else {\r\n
                self.timeout = setTimeout(function () {\r\n
                    if (self.hoverState == "in") {\r\n
                        self.show(self.options.placement == "cursor" ? self.targetXY : undefined);\r\n
                    }\r\n
                },\r\n
                self.options.delay.show);\r\n
            }\r\n
        },\r\n
        replaceArrow: function (delta, dimension, position) {\r\n
            this.options.arrow === false ? this.arrow().hide() : _superclass.prototype.replaceArrow.apply(this, arguments);\r\n
        },\r\n
        getCalculatedOffset: function (placement, pos, actualWidth, actualHeight) {\r\n
            var out = _superclass.prototype.getCalculatedOffset.apply(this, arguments);\r\n
            if (this.options.offset > 0 || this.options.offset < 0) {\r\n
                switch (/(bottom|top)/.exec(placement)[1]) {\r\n
                case "bottom":\r\n
                    out.top += this.options.offset;\r\n
                    break;\r\n
                case "top":\r\n
                    out.top -= this.options.offset;\r\n
                    break;\r\n
                }\r\n
            }\r\n
            return out;\r\n
        }\r\n
    });\r\n
    var old = $.fn.tooltip;\r\n
    $.fn.tooltip = function (option) {\r\n
        return this.each(function () {\r\n
            var $this = $(this),\r\n
            data = $this.data("bs.tooltip"),\r\n
            options = typeof option === "object" && option;\r\n
            if (!data) {\r\n
                $this.data("bs.tooltip", (data = new Tip(this, options)));\r\n
            }\r\n
            if (typeof option === "string") {\r\n
                data[option]();\r\n
            }\r\n
        });\r\n
    };\r\n
    $.fn.tooltip.Constructor = Tip;\r\n
    $.fn.tooltip.noConflict = function () {\r\n
        $.fn.tooltip = old;\r\n
        return this;\r\n
    };\r\n
})(window.jQuery);\n
define("tip", function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/component/Tooltip\',["tip", "backbone"], function () {\r\n
    var Tooltip = function (options) {\r\n
        this.$element = this.placement = undefined;\r\n
        this.init.call(this, options);\r\n
    };\r\n
    _.extend(Tooltip.prototype, Backbone.Events, {\r\n
        init: function (opts) {\r\n
            this.$element = opts.owner instanceof Backbone.View ? opts.owner.$el : $(opts.owner);\r\n
            this.placement = opts.placement;\r\n
            if (this.$element.data("bs.tooltip")) {\r\n
                this.$element.removeData("bs.tooltip");\r\n
            }\r\n
            this.$element.tooltip({\r\n
                title: opts.title,\r\n
                trigger: "manual",\r\n
                placement: opts.placement,\r\n
                offset: opts.offset,\r\n
                cls: opts.cls,\r\n
                html: opts.html,\r\n
                hideonclick: opts.hideonclick\r\n
            });\r\n
            if (opts.hideonclick) {\r\n
                var tip = this.$element.data("bs.tooltip");\r\n
                tip.tip().on("click", function () {\r\n
                    tip.hide();\r\n
                });\r\n
            }\r\n
            this.$element.on("shown.bs.tooltip", _.bind(this.onTipShown, this));\r\n
            this.$element.on("hidden.bs.tooltip", _.bind(this.onTipHidden, this));\r\n
        },\r\n
        show: function (at) {\r\n
            this.getBSTip().show(at);\r\n
        },\r\n
        hide: function () {\r\n
            this.getBSTip().hide();\r\n
        },\r\n
        setTitle: function (title) {\r\n
            var tip = this.getBSTip();\r\n
            tip.options.title = title;\r\n
        },\r\n
        updateTitle: function () {\r\n
            var tip = this.getBSTip();\r\n
            tip.$tip.find(".tooltip-inner")[tip.options.html ? "html" : "text"](tip.options.title);\r\n
        },\r\n
        getBSTip: function () {\r\n
            return this.$element.data("bs.tooltip");\r\n
        },\r\n
        onTipShown: function () {\r\n
            this.trigger("tooltip:show", this);\r\n
        },\r\n
        onTipHidden: function () {\r\n
            this.trigger("tooltip:hide", this);\r\n
        },\r\n
        isVisible: function () {\r\n
            return this.getBSTip().tip().is(":visible");\r\n
        }\r\n
    });\r\n
    Common.UI = Common.UI || {};\r\n
    Common.UI.Tooltip = Tooltip;\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/InputField\',["common/main/lib/component/BaseView", "common/main/lib/component/Tooltip"], function () {\r\n
    Common.UI.InputField = Common.UI.BaseView.extend((function () {\r\n
        return {\r\n
            options: {\r\n
                id: null,\r\n
                cls: "",\r\n
                style: "",\r\n
                value: "",\r\n
                type: "text",\r\n
                name: "",\r\n
                validation: null,\r\n
                allowBlank: true,\r\n
                placeHolder: "",\r\n
                blankError: null,\r\n
                spellcheck: false,\r\n
                maskExp: "",\r\n
                validateOnChange: false,\r\n
                validateOnBlur: true,\r\n
                disabled: false\r\n
            },\r\n
            template: _.template([\'<div class="input-field" style="<%= style %>">\', "<input ", \'type="<%= type %>" \', \'name="<%= name %>" \', \'spellcheck="<%= spellcheck %>" \', \'class="form-control <%= cls %>" \', \'placeholder="<%= placeHolder %>" \', \'value="<%= value %>"\', ">", \'<span class="input-error"/>\', "</div>"].join("")),\r\n
            initialize: function (options) {\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                var me = this,\r\n
                el = $(this.el);\r\n
                this.id = me.options.id || Common.UI.getId();\r\n
                this.cls = me.options.cls;\r\n
                this.style = me.options.style;\r\n
                this.value = me.options.value;\r\n
                this.type = me.options.type;\r\n
                this.name = me.options.name;\r\n
                this.validation = me.options.validation;\r\n
                this.allowBlank = me.options.allowBlank;\r\n
                this.placeHolder = me.options.placeHolder;\r\n
                this.template = me.options.template || me.template;\r\n
                this.editable = me.options.editable || true;\r\n
                this.disabled = me.options.disabled;\r\n
                this.spellcheck = me.options.spellcheck;\r\n
                this.blankError = me.options.blankError || "This field is required";\r\n
                this.validateOnChange = me.options.validateOnChange;\r\n
                this.validateOnBlur = me.options.validateOnBlur;\r\n
                me.rendered = me.options.rendered || false;\r\n
                if (me.options.el) {\r\n
                    me.render();\r\n
                }\r\n
            },\r\n
            render: function (parentEl) {\r\n
                var me = this;\r\n
                if (!me.rendered) {\r\n
                    this.cmpEl = $(this.template({\r\n
                        id: this.id,\r\n
                        cls: this.cls,\r\n
                        style: this.style,\r\n
                        value: this.value,\r\n
                        type: this.type,\r\n
                        name: this.name,\r\n
                        placeHolder: this.placeHolder,\r\n
                        spellcheck: this.spellcheck,\r\n
                        scope: me\r\n
                    }));\r\n
                    if (parentEl) {\r\n
                        this.setElement(parentEl, false);\r\n
                        parentEl.html(this.cmpEl);\r\n
                    } else {\r\n
                        $(this.el).html(this.cmpEl);\r\n
                    }\r\n
                } else {\r\n
                    this.cmpEl = $(this.el);\r\n
                }\r\n
                if (!me.rendered) {\r\n
                    var el = this.cmpEl;\r\n
                    this._input = this.cmpEl.find("input").andSelf().filter("input");\r\n
                    if (this.editable) {\r\n
                        this._input.on("blur", _.bind(this.onInputChanged, this));\r\n
                        this._input.on("keypress", _.bind(this.onKeyPress, this));\r\n
                        this._input.on("keyup", _.bind(this.onKeyUp, this));\r\n
                        if (this.validateOnChange) {\r\n
                            this._input.on("input", _.bind(this.onInputChanging, this));\r\n
                        }\r\n
                    }\r\n
                    this.setEditable(this.editable);\r\n
                    if (this.disabled) {\r\n
                        this.setDisabled(this.disabled);\r\n
                    }\r\n
                }\r\n
                me.rendered = true;\r\n
                return this;\r\n
            },\r\n
            _doChange: function (e, extra) {\r\n
                if (extra && extra.synthetic) {\r\n
                    return;\r\n
                }\r\n
                var newValue = $(e.target).val(),\r\n
                oldValue = this.value;\r\n
                this.trigger("changed:before", this, newValue, oldValue, e);\r\n
                if (e.isDefaultPrevented()) {\r\n
                    return;\r\n
                }\r\n
                this.value = newValue;\r\n
                if (this.validateOnBlur) {\r\n
                    this.checkValidate();\r\n
                }\r\n
                this.trigger("changed:after", this, newValue, oldValue, e);\r\n
            },\r\n
            onInputChanged: function (e, extra) {\r\n
                this._doChange(e, extra);\r\n
            },\r\n
            onInputChanging: function (e, extra) {\r\n
                var newValue = $(e.target).val(),\r\n
                oldValue = this.value;\r\n
                if (e.isDefaultPrevented()) {\r\n
                    return;\r\n
                }\r\n
                this.value = newValue;\r\n
                if (this.validateOnBlur) {\r\n
                    this.checkValidate();\r\n
                }\r\n
                this.trigger("changing", this, newValue, oldValue, e);\r\n
            },\r\n
            onKeyPress: function (e) {\r\n
                this.trigger("keypress:before", this, e);\r\n
                if (e.isDefaultPrevented()) {\r\n
                    return;\r\n
                }\r\n
                if (e.keyCode === Common.UI.Keys.RETURN) {\r\n
                    this._doChange(e);\r\n
                } else {\r\n
                    if (this.options.maskExp && !_.isEmpty(this.options.maskExp.source)) {\r\n
                        var charCode = String.fromCharCode(e.which);\r\n
                        if (!this.options.maskExp.test(charCode) && !e.ctrlKey && e.keyCode !== Common.UI.Keys.DELETE && e.keyCode !== Common.UI.Keys.BACKSPACE && e.keyCode !== Common.UI.Keys.LEFT && e.keyCode !== Common.UI.Keys.RIGHT && e.keyCode !== Common.UI.Keys.HOME && e.keyCode !== Common.UI.Keys.END && e.keyCode !== Common.UI.Keys.ESC && e.keyCode !== Common.UI.Keys.INSERT) {\r\n
                            e.preventDefault();\r\n
                            e.stopPropagation();\r\n
                        }\r\n
                    }\r\n
                }\r\n
                this.trigger("keypress:after", this, e);\r\n
            },\r\n
            onKeyUp: function (e) {\r\n
                this.trigger("keyup:before", this, e);\r\n
                if (e.isDefaultPrevented()) {\r\n
                    return;\r\n
                }\r\n
                this.trigger("keyup:after", this, e);\r\n
            },\r\n
            setEditable: function (editable) {\r\n
                var input = this._input;\r\n
                this.editable = editable;\r\n
                if (editable && input) {\r\n
                    input.removeAttr("readonly");\r\n
                    input.removeAttr("data-can-copy");\r\n
                } else {\r\n
                    input.attr("readonly", "readonly");\r\n
                    input.attr("data-can-copy", false);\r\n
                }\r\n
            },\r\n
            isEditable: function () {\r\n
                return this.editable;\r\n
            },\r\n
            setDisabled: function (disabled) {\r\n
                this.disabled = disabled;\r\n
                $(this.el).toggleClass("disabled", disabled);\r\n
                disabled ? this._input.attr("disabled", true) : this._input.removeAttr("disabled");\r\n
            },\r\n
            isDisabled: function () {\r\n
                return this.disabled;\r\n
            },\r\n
            setValue: function (value) {\r\n
                this.value = value;\r\n
                if (this.rendered) {\r\n
                    this._input.val(value);\r\n
                }\r\n
            },\r\n
            getValue: function () {\r\n
                return this.value;\r\n
            },\r\n
            focus: function () {\r\n
                this._input.focus();\r\n
            },\r\n
            checkValidate: function () {\r\n
                var me = this,\r\n
                errors = [];\r\n
                if (!me.allowBlank && _.isEmpty(me.value)) {\r\n
                    errors.push(me.blankError);\r\n
                }\r\n
                if (_.isFunction(me.validation)) {\r\n
                    var res = me.validation.call(me, me.value);\r\n
                    if (res !== true) {\r\n
                        errors = _.flatten(errors.concat(res));\r\n
                    }\r\n
                }\r\n
                if (!_.isEmpty(errors)) {\r\n
                    me.cmpEl.addClass("error");\r\n
                    var errorBadge = me.cmpEl.find(".input-error"),\r\n
                    modalParents = errorBadge.closest(".asc-window");\r\n
                    errorBadge.attr("data-toggle", "tooltip");\r\n
                    errorBadge.removeData("bs.tooltip");\r\n
                    errorBadge.tooltip({\r\n
                        title: errors.join("\\n"),\r\n
                        placement: "cursor"\r\n
                    });\r\n
                    if (modalParents.length > 0) {\r\n
                        errorBadge.data("bs.tooltip").tip().css("z-index", parseInt(modalParents.css("z-index")) + 10);\r\n
                    }\r\n
                    return errors;\r\n
                } else {\r\n
                    me.cmpEl.removeClass("error");\r\n
                }\r\n
                return true;\r\n
            },\r\n
            showError: function (errors) {\r\n
                var me = this;\r\n
                if (!_.isEmpty(errors)) {\r\n
                    me.cmpEl.addClass("error");\r\n
                    var errorBadge = me.cmpEl.find(".input-error"),\r\n
                    modalParents = errorBadge.closest(".asc-window");\r\n
                    errorBadge.attr("data-toggle", "tooltip");\r\n
                    errorBadge.removeData("bs.tooltip");\r\n
                    errorBadge.tooltip({\r\n
                        title: errors.join("\\n"),\r\n
                        placement: "cursor"\r\n
                    });\r\n
                    if (modalParents.length > 0) {\r\n
                        errorBadge.data("bs.tooltip").tip().css("z-index", parseInt(modalParents.css("z-index")) + 10);\r\n
                    }\r\n
                } else {\r\n
                    me.cmpEl.removeClass("error");\r\n
                }\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'spreadsheeteditor/main/app/view/HyperlinkSettingsDialog\',["common/main/lib/util/utils", "common/main/lib/component/ComboBox", "common/main/lib/component/InputField", "common/main/lib/component/Window"], function () {\r\n
    SSE.Views.HyperlinkSettingsDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 350,\r\n
            style: "min-width: 230px;",\r\n
            cls: "modal-dlg"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle\r\n
            },\r\n
            options || {});\r\n
            this.template = [\'<div class="box">\', \'<div class="input-row">\', "<label>" + this.textLinkType + "</label>", "</div>", \'<div class="input-row" id="id-dlg-hyperlink-type" style="margin-bottom: 5px;">\', "</div>", \'<div id="id-dlg-hyperlink-external">\', \'<div class="input-row">\', "<label>" + this.strLinkTo + " *</label>", "</div>", \'<div id="id-dlg-hyperlink-url" class="input-row" style="margin-bottom: 5px;"></div>\', "</div>", \'<div id="id-dlg-hyperlink-internal" style="display: none;">\', \'<div class="input-row">\', \'<label style="width: 50%;">\' + this.strSheet + "</label>", \'<label style="width: 50%;">\' + this.strRange + " *</label>", "</div>", \'<div class="input-row" style="margin-bottom: 5px;">\', \'<div id="id-dlg-hyperlink-sheet" style="display: inline-block; width: 50%; padding-right: 10px; float: left;"></div>\', \'<div id="id-dlg-hyperlink-range" style="display: inline-block; width: 50%;"></div>\', "</div>", "</div>", \'<div class="input-row">\', "<label>" + this.strDisplay + "</label>", "</div>", \'<div id="id-dlg-hyperlink-display" class="input-row" style="margin-bottom: 5px;"></div>\', \'<div class="input-row">\', "<label>" + this.textTipText + "</label>", "</div>", \'<div id="id-dlg-hyperlink-tip" class="input-row" style="margin-bottom: 5px;"></div>\', "</div>", \'<div class="footer right">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + this.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + this.cancelButtonText + "</button>", "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var $window = this.getChild(),\r\n
            me = this;\r\n
            me.cmbLinkType = new Common.UI.ComboBox({\r\n
                el: $("#id-dlg-hyperlink-type"),\r\n
                cls: "input-group-nr",\r\n
                editable: false,\r\n
                menuStyle: "min-width: 100%;",\r\n
                data: [{\r\n
                    displayValue: this.textInternalLink,\r\n
                    value: c_oAscHyperlinkType.RangeLink\r\n
                },\r\n
                {\r\n
                    displayValue: this.textExternalLink,\r\n
                    value: c_oAscHyperlinkType.WebLink\r\n
                }]\r\n
            }).on("selected", function (combo, record) {\r\n
                $("#id-dlg-hyperlink-external")[record.value == c_oAscHyperlinkType.WebLink ? "show" : "hide"]();\r\n
                $("#id-dlg-hyperlink-internal")[record.value != c_oAscHyperlinkType.WebLink ? "show" : "hide"]();\r\n
            });\r\n
            me.cmbLinkType.setValue(c_oAscHyperlinkType.WebLink);\r\n
            me.cmbSheets = new Common.UI.ComboBox({\r\n
                el: $("#id-dlg-hyperlink-sheet"),\r\n
                cls: "input-group-nr",\r\n
                editable: false,\r\n
                menuStyle: "min-width: 100%;max-height: 150px;"\r\n
            });\r\n
            me.inputUrl = new Common.UI.InputField({\r\n
                el: $("#id-dlg-hyperlink-url"),\r\n
                allowBlank: false,\r\n
                blankError: me.txtEmpty,\r\n
                validateOnBlur: false,\r\n
                style: "width: 100%;",\r\n
                validation: function (value) {\r\n
                    me.isEmail = false;\r\n
                    var isvalid = value.strongMatch(Common.Utils.hostnameRe); ! isvalid && (me.isEmail = isvalid = value.strongMatch(Common.Utils.emailRe)); ! isvalid && (isvalid = value.strongMatch(Common.Utils.ipRe)); ! isvalid && (isvalid = value.strongMatch(Common.Utils.localRe));\r\n
                    if (isvalid) {\r\n
                        return true;\r\n
                    } else {\r\n
                        return me.txtNotUrl;\r\n
                    }\r\n
                }\r\n
            });\r\n
            me.inputRange = new Common.UI.InputField({\r\n
                el: $("#id-dlg-hyperlink-range"),\r\n
                allowBlank: false,\r\n
                blankError: me.txtEmpty,\r\n
                style: "width: 100%;",\r\n
                validateOnChange: true,\r\n
                validateOnBlur: false,\r\n
                validation: function (value) {\r\n
                    var isvalid = /^[A-Z]+[1-9]\\d*:[A-Z]+[1-9]\\d*$/.test(value);\r\n
                    if (!isvalid) {\r\n
                        isvalid = /^[A-Z]+[1-9]\\d*$/.test(value);\r\n
                    }\r\n
                    if (isvalid) {\r\n
                        return true;\r\n
                    } else {\r\n
                        return me.textInvalidRange;\r\n
                    }\r\n
                }\r\n
            });\r\n
            me.inputDisplay = new Common.UI.InputField({\r\n
                el: $("#id-dlg-hyperlink-display"),\r\n
                allowBlank: true,\r\n
                validateOnBlur: false,\r\n
                style: "width: 100%;"\r\n
            });\r\n
            me.inputTip = new Common.UI.InputField({\r\n
                el: $("#id-dlg-hyperlink-tip"),\r\n
                style: "width: 100%;"\r\n
            });\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            $window.find("input").on("keypress", _.bind(this.onKeyPress, this));\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.Window.prototype.show.apply(this, arguments);\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                if (me.focusedInput) {\r\n
                    me.focusedInput.focus();\r\n
                }\r\n
            },\r\n
            500);\r\n
        },\r\n
        setSettings: function (settings) {\r\n
            if (settings) {\r\n
                var me = this;\r\n
                this.cmbSheets.setData(settings.sheets);\r\n
                if (!settings.props) {\r\n
                    this.cmbLinkType.setValue(c_oAscHyperlinkType.WebLink);\r\n
                    this.cmbLinkType.setDisabled(!settings.allowInternal);\r\n
                    this.inputDisplay.setValue(settings.isLock ? this.textDefault : settings.text);\r\n
                    this.focusedInput = this.inputUrl.cmpEl.find("input");\r\n
                    this.cmbSheets.setValue(settings.currentSheet);\r\n
                } else {\r\n
                    this.cmbLinkType.setValue(settings.props.asc_getType());\r\n
                    this.cmbLinkType.setDisabled(!settings.allowInternal);\r\n
                    if (settings.props.asc_getType() == c_oAscHyperlinkType.RangeLink) {\r\n
                        $("#id-dlg-hyperlink-external").hide();\r\n
                        $("#id-dlg-hyperlink-internal").show();\r\n
                        this.cmbSheets.setValue(settings.props.asc_getSheet());\r\n
                        this.inputRange.setValue(settings.props.asc_getRange());\r\n
                        this.focusedInput = this.inputRange.cmpEl.find("input");\r\n
                    } else {\r\n
                        this.inputUrl.setValue(settings.props.asc_getHyperlinkUrl());\r\n
                        this.focusedInput = this.inputUrl.cmpEl.find("input");\r\n
                        this.cmbSheets.setValue(settings.currentSheet);\r\n
                    }\r\n
                    this.inputDisplay.setValue(settings.isLock ? this.textDefault : settings.props.asc_getText());\r\n
                    this.inputTip.setValue(settings.props.asc_getTooltip());\r\n
                }\r\n
                this.inputDisplay.setDisabled(settings.isLock);\r\n
            }\r\n
        },\r\n
        getSettings: function () {\r\n
            var props = new Asc.asc_CHyperlink(),\r\n
            def_display = "";\r\n
            props.asc_setType(this.cmbLinkType.getValue());\r\n
            if (this.cmbLinkType.getValue() == c_oAscHyperlinkType.RangeLink) {\r\n
                props.asc_setSheet(this.cmbSheets.getValue());\r\n
                props.asc_setRange(this.inputRange.getValue());\r\n
                def_display = this.cmbSheets.getValue() + "!" + this.inputRange.getValue();\r\n
            } else {\r\n
                var url = this.inputUrl.getValue().replace(/^\\s+|\\s+$/g, "");\r\n
                if (!/(((^https?)|(^ftp)):\\/\\/)|(^mailto:)/i.test(url)) {\r\n
                    url = ((this.isEmail) ? "mailto:": "http://") + url;\r\n
                }\r\n
                props.asc_setHyperlinkUrl(url);\r\n
                def_display = url;\r\n
            }\r\n
            if (this.inputDisplay.isDisabled()) {\r\n
                props.asc_setText(null);\r\n
            } else {\r\n
                if (_.isEmpty(this.inputDisplay.getValue())) {\r\n
                    this.inputDisplay.setValue(def_display);\r\n
                }\r\n
                props.asc_setText(this.inputDisplay.getValue());\r\n
            }\r\n
            props.asc_setTooltip(this.inputTip.getValue());\r\n
            return props;\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            this._handleInput(event.currentTarget.attributes["result"].value);\r\n
        },\r\n
        onKeyPress: function (event) {\r\n
            if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                this._handleInput("ok");\r\n
                return false;\r\n
            }\r\n
        },\r\n
        _handleInput: function (state) {\r\n
            if (this.options.handler) {\r\n
                if (state == "ok") {\r\n
                    var checkurl = (this.cmbLinkType.getValue() === c_oAscHyperlinkType.WebLink) ? this.inputUrl.checkValidate() : true,\r\n
                    checkrange = (this.cmbLinkType.getValue() === c_oAscHyperlinkType.RangeLink) ? this.inputRange.checkValidate() : true,\r\n
                    checkdisp = this.inputDisplay.checkValidate();\r\n
                    if (checkurl !== true) {\r\n
                        this.inputUrl.cmpEl.find("input").focus();\r\n
                        return;\r\n
                    }\r\n
                    if (checkrange !== true) {\r\n
                        this.inputRange.cmpEl.find("input").focus();\r\n
                        return;\r\n
                    }\r\n
                    if (checkdisp !== true) {\r\n
                        this.inputDisplay.cmpEl.find("input").focus();\r\n
                        return;\r\n
                    }\r\n
                }\r\n
                this.options.handler.call(this, this, state);\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        textTitle: "Hyperlink Settings",\r\n
        textInternalLink: "Internal Data Range",\r\n
        textExternalLink: "Web Link",\r\n
        textEmptyLink: "Enter link here",\r\n
        textEmptyDesc: "Enter caption here",\r\n
        textEmptyTooltip: "Enter tooltip here",\r\n
        strSheet: "Sheet",\r\n
        strRange: "Range",\r\n
        textLinkType: "Link Type",\r\n
        strDisplay: "Display",\r\n
        textTipText: "Screen Tip Text",\r\n
        strLinkTo: "Link To",\r\n
        txtEmpty: "This field is required",\r\n
        textInvalidRange: "ERROR! Invalid cells range",\r\n
        txtNotUrl: \'This field should be a URL in the format "http://www.example.com"\',\r\n
        cancelButtonText: "Cancel",\r\n
        textDefault: "Selected range"\r\n
    },\r\n
    SSE.Views.HyperlinkSettingsDialog || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/ParagraphSettingsAdvanced.template\',[],function () { return \'<div id="id-adv-paragraph-indents" class="settings-panel active">\\r\\n    <div class="inner-content">\\r\\n        <table cols="3" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label"><%= scope.strIndentsFirstLine %></label>\\r\\n                    <div id="paragraphadv-spin-first-line" style="width: 85px;"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label"><%= scope.strIndentsLeftText %></label>\\r\\n                    <div id="paragraphadv-spin-indent-left"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label"><%= scope.strIndentsRightText %></label>\\r\\n                    <div id="paragraphadv-spin-indent-right"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-adv-paragraph-font" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textEffects %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <div id="paragraphadv-checkbox-strike"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <div id="paragraphadv-checkbox-subscript"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <div id="paragraphadv-checkbox-double-strike"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <div id="paragraphadv-checkbox-small-caps"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <div id="paragraphadv-checkbox-superscript"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                    <div id="paragraphadv-checkbox-all-caps"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textCharacterSpacing %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-large" width="50%">\\r\\n                    <div id="paragraphadv-spin-spacing"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td colspan=2>\\r\\n                    <div style="border: 1px solid #cbcbcb;">\\r\\n                        <div id="paragraphadv-font-img" style="width: 300px; height: 80px; position: relative;"></div>\\r\\n                    </div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-adv-paragraph-tabs" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <div class="padding-small" style="display: inline-block;">\\r\\n            <label class="input-label"><%= scope.textTabPosition %></label>\\r\\n            <div id="paraadv-spin-tab"></div>\\r\\n        </div>\\r\\n        <div class="padding-small" style="display: inline-block; float: right;">\\r\\n            <label class="input-label"><%= scope.textDefault %></label>\\r\\n            <div id="paraadv-spin-default-tab"></div>\\r\\n        </div>\\r\\n        <div class="padding-large">\\r\\n            <div id="paraadv-list-tabs" style="width:180px; height: 90px;"></div>\\r\\n        </div>\\r\\n        <div class="padding-large" >\\r\\n            <label class="input-label padding-small" style="display: block;"><%= scope.textAlign %></label>\\r\\n            <div id="paragraphadv-radio-left" class="padding-small" style="display: block;"></div>\\r\\n            <div id="paragraphadv-radio-center" class="padding-small" style="display: block;"></div>\\r\\n            <div id="paragraphadv-radio-right" style="display: block;"></div>\\r\\n        </div>\\r\\n        <div>\\r\\n            <button type="button" class="btn btn-text-default" id="paraadv-button-add-tab" style="width:90px;margin-right: 4px;"><%= scope.textSet %></button>\\r\\n            <button type="button" class="btn btn-text-default" id="paraadv-button-remove-tab" style="width:90px;margin-right: 4px;"><%= scope.textRemove %></button>\\r\\n            <button type="button" class="btn btn-text-default" id="paraadv-button-remove-all" style="width:90px;margin-right: 4px;"><%= scope.textRemoveAll %></button>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/view/AdvancedSettingsWindow\',["common/main/lib/component/Window"], function () {\r\n
    Common.Views.AdvancedSettingsWindow = Common.UI.Window.extend(_.extend({\r\n
        initialize: function (options) {\r\n
            var _options = {};\r\n
            _.extend(_options, {\r\n
                height: 200,\r\n
                header: true,\r\n
                cls: "advanced-settings-dlg",\r\n
                toggleGroup: "advanced-settings-group",\r\n
                contentTemplate: "",\r\n
                items: []\r\n
            },\r\n
            options);\r\n
            this.template = options.template || [\'<div class="box" style="height:\' + (_options.height - 85) + \'px;">\', \'<div class="menu-panel">\', "<% _.each(items, function(item) { %>", \'<button class="btn btn-category" style="margin-bottom: 2px;" content-target="<%= item.panelId %>"><span class=""><%= item.panelCaption %></span></button>\', "<% }); %>", "</div>", \'<div class="separator"/>\', \'<div class="content-panel" >\' + _options.contentTemplate + "</div>", "</div>", \'<div class="separator horizontal"/>\', \'<div class="footer center">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + this.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + this.cancelButtonText + "</button>", "</div>"].join("");\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            this.handler = _options.handler;\r\n
            this.toggleGroup = _options.toggleGroup;\r\n
            this.contentWidth = _options.contentWidth;\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var me = this;\r\n
            var $window = this.getChild();\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onDlgBtnClick, this));\r\n
            this.btnsCategory = [];\r\n
            _.each($window.find(".btn-category"), function (item, index) {\r\n
                var btnEl = $(item);\r\n
                var btn = new Common.UI.Button({\r\n
                    el: btnEl,\r\n
                    enableToggle: true,\r\n
                    toggleGroup: me.toggleGroup,\r\n
                    allowDepress: false,\r\n
                    contentTarget: btnEl.attr("content-target")\r\n
                });\r\n
                btn.on("click", _.bind(me.onCategoryClick, me));\r\n
                me.btnsCategory.push(btn);\r\n
            });\r\n
            var cnt_panel = $window.find(".content-panel");\r\n
            cnt_panel.width(this.contentWidth);\r\n
            $window.width($window.find(".menu-panel").width() + cnt_panel.outerWidth() + 1);\r\n
            this.content_panels = $window.find(".settings-panel");\r\n
            if (this.btnsCategory.length > 0) {\r\n
                this.btnsCategory[0].toggle(true, true);\r\n
            }\r\n
        },\r\n
        setHeight: function (height) {\r\n
            Common.UI.Window.prototype.setHeight.call(this, height);\r\n
            var $window = this.getChild();\r\n
            var boxEl = $window.find(".body > .box");\r\n
            boxEl.css("height", height - 85);\r\n
        },\r\n
        onDlgBtnClick: function (event) {\r\n
            var state = event.currentTarget.attributes["result"].value;\r\n
            if (this.handler && this.handler.call(this, state, (state == "ok") ? this.getSettings() : undefined)) {\r\n
                return;\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onCategoryClick: function (btn, event) {\r\n
            this.content_panels.filter(".active").removeClass("active");\r\n
            $("#" + btn.options.contentTarget).addClass("active");\r\n
        },\r\n
        getSettings: function () {\r\n
            return;\r\n
        },\r\n
        onPrimary: function () {\r\n
            if (this.handler && this.handler.call(this, "ok", this.getSettings())) {\r\n
                return;\r\n
            }\r\n
            this.close();\r\n
            return false;\r\n
        },\r\n
        cancelButtonText: "Cancel",\r\n
        okButtonText: "Ok"\r\n
    },\r\n
    Common.Views.AdvancedSettingsWindow || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/MetricSpinner\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.MetricSpinner = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            minValue: 0,\r\n
            maxValue: 100,\r\n
            step: 1,\r\n
            defaultUnit: "px",\r\n
            allowAuto: false,\r\n
            autoText: "Auto",\r\n
            hold: true,\r\n
            speed: "medium",\r\n
            width: 90,\r\n
            allowDecimal: true\r\n
        },\r\n
        disabled: false,\r\n
        value: "0 px",\r\n
        rendered: false,\r\n
        template: \'<input type="text" class="form-control">\' + \'<div class="spinner-buttons">\' + \'<button type="button" class="spinner-up"><i></i></button>\' + \'<button type="button" class="spinner-down"><i></i></button>\' + "</div>",\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            el.addClass("spinner");\r\n
            el.on("mousedown", ".spinner-up", _.bind(this.onMouseDown, this, true));\r\n
            el.on("mousedown", ".spinner-down", _.bind(this.onMouseDown, this, false));\r\n
            el.on("mouseup", ".spinner-up", _.bind(this.onMouseUp, this, true));\r\n
            el.on("mouseup", ".spinner-down", _.bind(this.onMouseUp, this, false));\r\n
            el.on("mouseover", ".spinner-up, .spinner-down", _.bind(this.onMouseOver, this));\r\n
            el.on("mouseout", ".spinner-up, .spinner-down", _.bind(this.onMouseOut, this));\r\n
            el.on("keydown", ".form-control", _.bind(this.onKeyDown, this));\r\n
            el.on("keyup", ".form-control", _.bind(this.onKeyUp, this));\r\n
            el.on("blur", ".form-control", _.bind(this.onBlur, this));\r\n
            el.on("input", ".form-control", _.bind(this.onInput, this));\r\n
            if (!this.options.allowDecimal) {\r\n
                el.on("keypress", ".form-control", _.bind(this.onKeyPress, this));\r\n
            }\r\n
            this.switches = {\r\n
                count: 1,\r\n
                enabled: true,\r\n
                fromKeyDown: false\r\n
            };\r\n
            if (this.options.speed === "medium") {\r\n
                this.switches.speed = 300;\r\n
            } else {\r\n
                if (this.options.speed === "fast") {\r\n
                    this.switches.speed = 100;\r\n
                } else {\r\n
                    this.switches.speed = 500;\r\n
                }\r\n
            }\r\n
            this.render();\r\n
            if (this.options.disabled) {\r\n
                this.setDisabled(this.options.disabled);\r\n
            }\r\n
            if (this.options.value !== undefined) {\r\n
                this.value = this.options.value;\r\n
            }\r\n
            this.setRawValue(this.value);\r\n
            if (this.options.width) {\r\n
                $(this.el).width(this.options.width);\r\n
            }\r\n
            if (this.options.defaultValue === undefined) {\r\n
                this.options.defaultValue = this.options.minValue;\r\n
            }\r\n
            this.oldValue = this.options.minValue;\r\n
            this.lastValue = null;\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template);\r\n
            this.$input = el.find(".form-control");\r\n
            this.rendered = true;\r\n
            if (this.options.tabindex != undefined) {\r\n
                this.$input.attr("tabindex", this.options.tabindex);\r\n
            }\r\n
            return this;\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            var el = $(this.el);\r\n
            if (disabled !== this.disabled) {\r\n
                el.find("button").toggleClass("disabled", disabled);\r\n
                el.toggleClass("disabled", disabled);\r\n
                (disabled) ? this.$input.attr({\r\n
                    disabled: disabled\r\n
                }) : this.$input.removeAttr("disabled");\r\n
            }\r\n
            this.disabled = disabled;\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        setDefaultUnit: function (unit) {\r\n
            if (this.options.defaultUnit != unit) {\r\n
                var oldUnit = this.options.defaultUnit;\r\n
                this.options.defaultUnit = unit;\r\n
                this.setMinValue(this._recalcUnits(this.options.minValue, oldUnit));\r\n
                this.setMaxValue(this._recalcUnits(this.options.maxValue, oldUnit));\r\n
                this.setValue(this._recalcUnits(this.getNumberValue(), oldUnit), true);\r\n
            }\r\n
        },\r\n
        setMinValue: function (unit) {\r\n
            this.options.minValue = unit;\r\n
        },\r\n
        setMaxValue: function (unit) {\r\n
            this.options.maxValue = unit;\r\n
        },\r\n
        setStep: function (step) {\r\n
            this.options.step = step;\r\n
        },\r\n
        getNumberValue: function () {\r\n
            if (this.options.allowAuto && this.value == this.options.autoText) {\r\n
                return -1;\r\n
            } else {\r\n
                return parseFloat(this.value);\r\n
            }\r\n
        },\r\n
        getUnitValue: function () {\r\n
            return this.options.defaultUnit;\r\n
        },\r\n
        getValue: function () {\r\n
            return this.value;\r\n
        },\r\n
        setRawValue: function (value) {\r\n
            if (this.$input) {\r\n
                this.$input.val(value);\r\n
            }\r\n
        },\r\n
        setValue: function (value, suspendchange) {\r\n
            var showError = false;\r\n
            this._fromKeyDown = false;\r\n
            this.lastValue = this.value;\r\n
            if (typeof value === "undefined" || value === "") {\r\n
                this.value = "";\r\n
            } else {\r\n
                if (this.options.allowAuto && (Math.abs(parseFloat(value) + 1) < 0.0001 || value == this.options.autoText)) {\r\n
                    this.value = this.options.autoText;\r\n
                } else {\r\n
                    var number = this._add(parseFloat(value), 0, (this.options.allowDecimal) ? 3 : 0);\r\n
                    if (typeof value === "undefined" || isNaN(number)) {\r\n
                        number = this.oldValue;\r\n
                        showError = true;\r\n
                    }\r\n
                    var units = this.options.defaultUnit;\r\n
                    if (typeof value.match !== "undefined") {\r\n
                        var searchUnits = value.match(/(px|em|%|en|ex|pt|in|cm|mm|pc|s|ms)$/i);\r\n
                        if (null !== searchUnits && searchUnits[0] !== "undefined") {\r\n
                            units = searchUnits[0].toLowerCase();\r\n
                        }\r\n
                    }\r\n
                    if (this.options.defaultUnit !== units) {\r\n
                        number = this._recalcUnits(number, units);\r\n
                    }\r\n
                    if (number > this.options.maxValue) {\r\n
                        number = this.options.maxValue;\r\n
                        showError = true;\r\n
                    }\r\n
                    if (number < this.options.minValue) {\r\n
                        number = this.options.minValue;\r\n
                        showError = true;\r\n
                    }\r\n
                    this.value = (number + " " + this.options.defaultUnit).trim();\r\n
                    this.oldValue = number;\r\n
                }\r\n
            }\r\n
            if (suspendchange !== true && this.lastValue !== this.value) {\r\n
                this.trigger("change", this, this.value, this.lastValue);\r\n
            }\r\n
            if (suspendchange !== true && showError) {\r\n
                this.trigger("inputerror", this, this.value);\r\n
            }\r\n
            if (this.rendered) {\r\n
                this.setRawValue(this.value);\r\n
            } else {\r\n
                this.options.value = this.value;\r\n
            }\r\n
        },\r\n
        onMouseDown: function (type, e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (e) {\r\n
                $(e.currentTarget).addClass("active");\r\n
            }\r\n
            if (this.options.hold) {\r\n
                this.switches.fromKeyDown = false;\r\n
                this._startSpin(type, e);\r\n
            }\r\n
        },\r\n
        onMouseUp: function (type, e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            $(e.currentTarget).removeClass("active");\r\n
            if (this.options.hold) {\r\n
                this._stopSpin();\r\n
            } else {\r\n
                this._step(type);\r\n
            }\r\n
        },\r\n
        onMouseOver: function (e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            $(e.currentTarget).addClass("over");\r\n
        },\r\n
        onMouseOut: function (e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            $(e.currentTarget).removeClass("active over");\r\n
            if (this.options.hold) {\r\n
                this._stopSpin();\r\n
            }\r\n
        },\r\n
        onKeyDown: function (e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (this.options.hold && (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN)) {\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
                if (this.switches.timeout === undefined) {\r\n
                    this.switches.fromKeyDown = true;\r\n
                    this._startSpin(e.keyCode == Common.UI.Keys.UP, e);\r\n
                }\r\n
            } else {\r\n
                if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                    if (this.options.defaultUnit && this.options.defaultUnit.length) {\r\n
                        var value = this.$input.val();\r\n
                        if (this.value != value) {\r\n
                            this.onEnterValue();\r\n
                            return false;\r\n
                        }\r\n
                    } else {\r\n
                        this.onEnterValue();\r\n
                    }\r\n
                } else {\r\n
                    this._fromKeyDown = true;\r\n
                }\r\n
            }\r\n
        },\r\n
        onKeyUp: function (e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN) {\r\n
                e.stopPropagation();\r\n
                e.preventDefault();\r\n
                (this.options.hold) ? this._stopSpin() : this._step(e.keyCode == Common.UI.Keys.UP);\r\n
            }\r\n
        },\r\n
        onKeyPress: function (e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            var charCode = String.fromCharCode(e.charCode);\r\n
            if (charCode == "." || charCode == ",") {\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
            } else {\r\n
                if (this.options.maskExp && !this.options.maskExp.test(charCode) && !e.ctrlKey && e.keyCode !== Common.UI.Keys.DELETE && e.keyCode !== Common.UI.Keys.BACKSPACE && e.keyCode !== Common.UI.Keys.LEFT && e.keyCode !== Common.UI.Keys.RIGHT && e.keyCode !== Common.UI.Keys.HOME && e.keyCode !== Common.UI.Keys.END && e.keyCode !== Common.UI.Keys.ESC && e.keyCode !== Common.UI.Keys.RETURN && e.keyCode !== Common.UI.Keys.INSERT && e.keyCode !== Common.UI.Keys.TAB) {\r\n
                    e.preventDefault();\r\n
                    e.stopPropagation();\r\n
                }\r\n
            }\r\n
        },\r\n
        onInput: function (e, extra) {\r\n
            if (this.disabled || e.isDefaultPrevented()) {\r\n
                return;\r\n
            }\r\n
            this.trigger("changing", this, $(e.target).val(), e);\r\n
        },\r\n
        onEnterValue: function () {\r\n
            if (this.$input) {\r\n
                var val = this.$input.val();\r\n
                this.setValue((val === "") ? this.value : val);\r\n
                this.trigger("entervalue", this);\r\n
            }\r\n
        },\r\n
        onBlur: function (e) {\r\n
            if (this.$input) {\r\n
                var val = this.$input.val();\r\n
                this.setValue((val === "") ? this.value : val);\r\n
                if (this.options.hold && this.switches.fromKeyDown) {\r\n
                    this._stopSpin();\r\n
                }\r\n
            }\r\n
        },\r\n
        _startSpin: function (type, e) {\r\n
            if (!this.disabled) {\r\n
                var divisor = this.switches.count;\r\n
                if (divisor === 1) {\r\n
                    this._step(type, true);\r\n
                    divisor = 1;\r\n
                } else {\r\n
                    if (divisor < 3) {\r\n
                        divisor = 1.5;\r\n
                    } else {\r\n
                        if (divisor < 8) {\r\n
                            divisor = 2.5;\r\n
                        } else {\r\n
                            divisor = 6;\r\n
                        }\r\n
                    }\r\n
                }\r\n
                this.switches.timeout = setTimeout($.proxy(function () {\r\n
                    this._step(type, true);\r\n
                    this._startSpin(type);\r\n
                },\r\n
                this), this.switches.speed / divisor);\r\n
                this.switches.count++;\r\n
            }\r\n
        },\r\n
        _stopSpin: function (e) {\r\n
            if (this.switches.timeout !== undefined) {\r\n
                clearTimeout(this.switches.timeout);\r\n
                this.switches.timeout = undefined;\r\n
                this.switches.count = 1;\r\n
                this.trigger("change", this, this.value, this.lastValue);\r\n
            }\r\n
        },\r\n
        _increase: function (suspend) {\r\n
            var me = this;\r\n
            if (!me.readOnly) {\r\n
                var val = me.options.step;\r\n
                if (me._fromKeyDown) {\r\n
                    val = this.$input.val();\r\n
                    val = _.isEmpty(val) ? me.oldValue : parseFloat(val);\r\n
                } else {\r\n
                    if (me.getValue() !== "") {\r\n
                        if (me.options.allowAuto && me.getValue() == me.options.autoText) {\r\n
                            val = me.options.minValue - me.options.step;\r\n
                        } else {\r\n
                            val = parseFloat(me.getValue());\r\n
                        }\r\n
                        if (isNaN(val)) {\r\n
                            val = this.oldValue;\r\n
                        }\r\n
                    } else {\r\n
                        val = me.options.defaultValue;\r\n
                    }\r\n
                }\r\n
                me.setValue((this._add(val, me.options.step, (me.options.allowDecimal) ? 3 : 0) + " " + this.options.defaultUnit).trim(), suspend);\r\n
            }\r\n
        },\r\n
        _decrease: function (suspend) {\r\n
            var me = this;\r\n
            if (!me.readOnly) {\r\n
                var val = me.options.step;\r\n
                if (me._fromKeyDown) {\r\n
                    val = this.$input.val();\r\n
                    val = _.isEmpty(val) ? me.oldValue : parseFloat(val);\r\n
                } else {\r\n
                    if (me.getValue() !== "") {\r\n
                        if (me.options.allowAuto && me.getValue() == me.options.autoText) {\r\n
                            val = me.options.minValue;\r\n
                        } else {\r\n
                            val = parseFloat(me.getValue());\r\n
                        }\r\n
                        if (isNaN(val)) {\r\n
                            val = this.oldValue;\r\n
                        }\r\n
                        if (me.options.allowAuto && this._add(val, -me.options.step, (me.options.allowDecimal) ? 3 : 0) < me.options.minValue) {\r\n
                            me.setValue(me.options.autoText, true);\r\n
                            return;\r\n
                        }\r\n
                    } else {\r\n
                        val = me.options.defaultValue;\r\n
                    }\r\n
                }\r\n
                me.setValue((this._add(val, -me.options.step, (me.options.allowDecimal) ? 3 : 0) + " " + this.options.defaultUnit).trim(), suspend);\r\n
            }\r\n
        },\r\n
        _step: function (type, suspend) {\r\n
            (type) ? this._increase(suspend) : this._decrease(suspend);\r\n
        },\r\n
        _add: function (a, b, precision) {\r\n
            var x = Math.pow(10, precision || (this.options.allowDecimal) ? 2 : 0);\r\n
            return (Math.round(a * x) + Math.round(b * x)) / x;\r\n
        },\r\n
        _recalcUnits: function (value, fromUnit) {\r\n
            if (fromUnit.match(/(s|ms)$/i) && this.options.defaultUnit.match(/(s|ms)$/i)) {\r\n
                var v_out = value;\r\n
                if (fromUnit == "ms") {\r\n
                    v_out = v_out / 1000;\r\n
                }\r\n
                if (this.options.defaultUnit == "ms") {\r\n
                    v_out = v_out * 1000;\r\n
                }\r\n
                return v_out;\r\n
            }\r\n
            if (fromUnit.match(/(pt|in|cm|mm|pc)$/i) === null || this.options.defaultUnit.match(/(pt|in|cm|mm|pc)$/i) === null) {\r\n
                return value;\r\n
            }\r\n
            var v_out = value;\r\n
            if (fromUnit == "cm") {\r\n
                v_out = v_out * 10;\r\n
            } else {\r\n
                if (fromUnit == "pt") {\r\n
                    v_out = v_out * 25.4 / 72;\r\n
                } else {\r\n
                    if (fromUnit == "in") {\r\n
                        v_out = v_out * 25.4;\r\n
                    } else {\r\n
                        if (fromUnit == "pc") {\r\n
                            v_out = v_out * 25.4 / 6;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (this.options.defaultUnit == "cm") {\r\n
                v_out = v_out / 10;\r\n
            } else {\r\n
                if (this.options.defaultUnit == "pt") {\r\n
                    v_out = parseFloat((v_out * 72 / 25.4).toFixed(3));\r\n
                } else {\r\n
                    if (this.options.defaultUnit == "in") {\r\n
                        v_out = v_out / 25.4;\r\n
                    } else {\r\n
                        if (this.options.defaultUnit == "pc") {\r\n
                            v_out = v_out * 6 / 25.4;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            return v_out;\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAw=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="12" aka="AAAAAAAAAAw=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/CheckBox\',["common/main/lib/component/BaseView", "underscore"], function (base, _) {\r\n
    Common.UI.CheckBox = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            labelText: ""\r\n
        },\r\n
        disabled: false,\r\n
        rendered: false,\r\n
        indeterminate: false,\r\n
        checked: false,\r\n
        value: "unchecked",\r\n
        template: _.template(\'<label class="checkbox-indeterminate"><input type="button"><%= labelText %></label>\'),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            this.render();\r\n
            if (this.options.disabled) {\r\n
                this.setDisabled(this.options.disabled);\r\n
            }\r\n
            if (this.options.value !== undefined) {\r\n
                this.setValue(this.options.value, true);\r\n
            }\r\n
            this.$chk.on("click", _.bind(this.onItemCheck, this));\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                labelText: this.options.labelText\r\n
            }));\r\n
            this.$chk = el.find("input[type=button]");\r\n
            this.$label = el.find("label");\r\n
            this.rendered = true;\r\n
            return this;\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            if (disabled !== this.disabled) {\r\n
                this.$label.toggleClass("disabled", disabled);\r\n
                (disabled) ? this.$chk.attr({\r\n
                    disabled: disabled\r\n
                }) : this.$chk.removeAttr("disabled");\r\n
            }\r\n
            this.disabled = disabled;\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        onItemCheck: function (e) {\r\n
            if (!this.disabled) {\r\n
                if (this.indeterminate) {\r\n
                    this.indeterminate = false;\r\n
                    this.setValue(false);\r\n
                } else {\r\n
                    this.setValue(!this.checked);\r\n
                }\r\n
            }\r\n
        },\r\n
        setRawValue: function (value) {\r\n
            this.checked = (value === true || value === "true" || value === "1" || value === 1 || value === "checked");\r\n
            this.indeterminate = (value === "indeterminate");\r\n
            this.$chk.toggleClass("checked", this.checked);\r\n
            this.$chk.toggleClass("indeterminate", this.indeterminate);\r\n
            this.value = this.indeterminate ? "indeterminate" : (this.checked ? "checked" : "unchecked");\r\n
        },\r\n
        setValue: function (value, suspendchange) {\r\n
            if (this.rendered) {\r\n
                this.lastValue = this.value;\r\n
                this.setRawValue(value);\r\n
                if (suspendchange !== true && this.lastValue !== value) {\r\n
                    this.trigger("change", this, this.value, this.lastValue);\r\n
                }\r\n
            } else {\r\n
                this.options.value = value;\r\n
            }\r\n
        },\r\n
        getValue: function () {\r\n
            return this.value;\r\n
        },\r\n
        isChecked: function () {\r\n
            return this.checked;\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/RadioBox\',["common/main/lib/component/BaseView", "underscore"], function (base, _) {\r\n
    Common.UI.RadioBox = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            labelText: ""\r\n
        },\r\n
        disabled: false,\r\n
        rendered: false,\r\n
        template: _.template(\'<label class="radiobox"><input type="button" name="<%= name %>"><%= labelText %></label>\'),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            this.name = this.options.name || Common.UI.getId();\r\n
            this.render();\r\n
            if (this.options.disabled) {\r\n
                this.setDisabled(this.options.disabled);\r\n
            }\r\n
            if (this.options.checked !== undefined) {\r\n
                this.setValue(this.options.checked, true);\r\n
            }\r\n
            this.$radio.on("click", _.bind(this.onItemCheck, this));\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                labelText: this.options.labelText,\r\n
                name: this.name\r\n
            }));\r\n
            this.$radio = el.find("input[type=button]");\r\n
            this.rendered = true;\r\n
            return this;\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            if (disabled !== this.disabled) {\r\n
                this.$radio.toggleClass("disabled", disabled);\r\n
                (disabled) ? this.$radio.attr({\r\n
                    disabled: disabled\r\n
                }) : this.$radio.removeAttr("disabled");\r\n
            }\r\n
            this.disabled = disabled;\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        onItemCheck: function (e) {\r\n
            if (!this.disabled) {\r\n
                this.setValue(true);\r\n
            }\r\n
        },\r\n
        setRawValue: function (value) {\r\n
            var value = (value === true || value === "true" || value === "1" || value === 1);\r\n
            $("input[type=button][name=" + this.name + "]").removeClass("checked");\r\n
            this.$radio.toggleClass("checked", value);\r\n
        },\r\n
        setValue: function (value, suspendchange) {\r\n
            if (this.rendered) {\r\n
                var lastValue = this.$radio.hasClass("checked");\r\n
                this.setRawValue(value);\r\n
                if (suspendchange !== true && lastValue !== value) {\r\n
                    this.trigger("change", this, this.$radio.hasClass("checked"));\r\n
                }\r\n
            } else {\r\n
                this.options.checked = value;\r\n
            }\r\n
        },\r\n
        getValue: function () {\r\n
            return this.$radio.hasClass("checked");\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/DataView\',["common/main/lib/component/BaseView", "common/main/lib/component/Scroller"], function () {\r\n
    Common.UI.DataViewGroupModel = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                caption: ""\r\n
            };\r\n
        }\r\n
    });\r\n
    Common.UI.DataViewGroupStore = Backbone.Collection.extend({\r\n
        model: Common.UI.DataViewGroupModel\r\n
    });\r\n
    Common.UI.DataViewModel = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                selected: false,\r\n
                allowSelected: true,\r\n
                value: null\r\n
            };\r\n
        }\r\n
    });\r\n
    Common.UI.DataViewStore = Backbone.Collection.extend({\r\n
        model: Common.UI.DataViewModel\r\n
    });\r\n
    Common.UI.DataViewItem = Common.UI.BaseView.extend({\r\n
        options: {},\r\n
        template: _.template([\'<div id="<%= id %>"><%= value %></div>\'].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this;\r\n
            me.template = me.options.template || me.template;\r\n
            me.listenTo(me.model, "change", me.render);\r\n
            me.listenTo(me.model, "change:selected", me.onSelectChange);\r\n
            me.listenTo(me.model, "remove", me.remove);\r\n
        },\r\n
        render: function () {\r\n
            if (_.isUndefined(this.model.id)) {\r\n
                return this;\r\n
            }\r\n
            var el = $(this.el);\r\n
            el.html(this.template(this.model.toJSON()));\r\n
            el.toggleClass("selected", this.model.get("selected") && this.model.get("allowSelected"));\r\n
            el.off("click").on("click", _.bind(this.onClick, this));\r\n
            el.off("dblclick").on("dblclick", _.bind(this.onDblClick, this));\r\n
            if (!_.isUndefined(this.model.get("cls"))) {\r\n
                el.addClass(this.model.get("cls"));\r\n
            }\r\n
            this.trigger("change", this, this.model);\r\n
            return this;\r\n
        },\r\n
        remove: function () {\r\n
            this.stopListening(this.model);\r\n
            this.trigger("remove", this, this.model);\r\n
            Common.UI.BaseView.prototype.remove.call(this);\r\n
        },\r\n
        onClick: function (e) {\r\n
            this.trigger("click", this, this.model, e);\r\n
        },\r\n
        onDblClick: function (e) {\r\n
            this.trigger("dblclick", this, this.model, e);\r\n
        },\r\n
        onSelectChange: function (model, selected) {\r\n
            this.trigger("select", this, model, selected);\r\n
        }\r\n
    });\r\n
    Common.UI.DataView = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            multiSelect: false,\r\n
            handleSelect: true,\r\n
            enableKeyEvents: true,\r\n
            keyMoveDirection: "both",\r\n
            restoreHeight: 0,\r\n
            emptyText: "",\r\n
            listenStoreEvents: true,\r\n
            allowScrollbar: true\r\n
        },\r\n
        template: _.template([\'<div class="dataview inner" style="<%= style %>">\', "<% _.each(groups, function(group) { %>", \'<div class="grouped-data" id="<%= group.id %>">\', \'<div class="group-description">\', "<span><b><%= group.caption %></b></span>", "</div>", \'<div class="group-items-container">\', "</div>", "</div>", "<% }); %>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this;\r\n
            me.template = me.options.template || me.template;\r\n
            me.store = me.options.store || new Common.UI.DataViewStore();\r\n
            me.groups = me.options.groups || null;\r\n
            me.itemTemplate = me.options.itemTemplate || null;\r\n
            me.multiSelect = me.options.multiSelect;\r\n
            me.handleSelect = me.options.handleSelect;\r\n
            me.parentMenu = me.options.parentMenu;\r\n
            me.enableKeyEvents = me.options.enableKeyEvents;\r\n
            me.style = me.options.style || "";\r\n
            me.emptyText = me.options.emptyText || "";\r\n
            me.listenStoreEvents = (me.options.listenStoreEvents !== undefined) ? me.options.listenStoreEvents : true;\r\n
            me.allowScrollbar = (me.options.allowScrollbar !== undefined) ? me.options.allowScrollbar : true;\r\n
            me.rendered = false;\r\n
            me.dataViewItems = [];\r\n
            if (me.options.keyMoveDirection == "vertical") {\r\n
                me.moveKeys = [Common.UI.Keys.UP, Common.UI.Keys.DOWN];\r\n
            } else {\r\n
                if (me.options.keyMoveDirection == "horizontal") {\r\n
                    me.moveKeys = [Common.UI.Keys.LEFT, Common.UI.Keys.RIGHT];\r\n
                } else {\r\n
                    me.moveKeys = [Common.UI.Keys.UP, Common.UI.Keys.DOWN, Common.UI.Keys.LEFT, Common.UI.Keys.RIGHT];\r\n
                }\r\n
            }\r\n
            if (me.options.el) {\r\n
                me.render();\r\n
            }\r\n
        },\r\n
        render: function (parentEl) {\r\n
            var me = this;\r\n
            this.trigger("render:before", this);\r\n
            this.cmpEl = $(this.el);\r\n
            if (parentEl) {\r\n
                this.setElement(parentEl, false);\r\n
                this.cmpEl = $(this.template({\r\n
                    groups: me.groups ? me.groups.toJSON() : null,\r\n
                    style: me.style\r\n
                }));\r\n
                parentEl.html(this.cmpEl);\r\n
            } else {\r\n
                this.cmpEl.html(this.template({\r\n
                    groups: me.groups ? me.groups.toJSON() : null,\r\n
                    style: me.style\r\n
                }));\r\n
            }\r\n
            if (!this.rendered) {\r\n
                if (this.listenStoreEvents) {\r\n
                    this.listenTo(this.store, "add", this.onAddItem);\r\n
                    this.listenTo(this.store, "reset", this.onResetItems);\r\n
                }\r\n
                this.onResetItems();\r\n
                if (this.parentMenu) {\r\n
                    this.cmpEl.closest("li").css("height", "100%");\r\n
                    this.cmpEl.css("height", "100%");\r\n
                    this.parentMenu.on("show:after", _.bind(this.alignPosition, this));\r\n
                }\r\n
                if (this.enableKeyEvents && this.parentMenu && this.handleSelect) {\r\n
                    this.parentMenu.on("show:after", function () {\r\n
                        me.showLastSelected();\r\n
                        Common.NotificationCenter.trigger("dataview:focus");\r\n
                    });\r\n
                    this.parentMenu.on("hide:after", function () {\r\n
                        Common.NotificationCenter.trigger("dataview:blur");\r\n
                    });\r\n
                }\r\n
            }\r\n
            if (_.isUndefined(this.scroller) && this.allowScrollbar) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el).find(".inner").andSelf().filter(".inner"),\r\n
                    useKeyboard: this.enableKeyEvents && !this.handleSelect,\r\n
                    minScrollbarLength: 40\r\n
                });\r\n
            }\r\n
            var modalParents = this.cmpEl.closest(".asc-window");\r\n
            if (modalParents.length > 0) {\r\n
                this.tipZIndex = parseInt(modalParents.css("z-index")) + 10;\r\n
            }\r\n
            this.rendered = true;\r\n
            this.cmpEl.on("click", function (e) {\r\n
                if (/dataview/.test(e.target.className)) {\r\n
                    return false;\r\n
                }\r\n
            });\r\n
            this.trigger("render:after", this);\r\n
            return this;\r\n
        },\r\n
        setStore: function (store) {\r\n
            if (store) {\r\n
                this.stopListening(this.store);\r\n
                this.store = store;\r\n
                if (this.listenStoreEvents) {\r\n
                    this.listenTo(this.store, "add", this.onAddItem);\r\n
                    this.listenTo(this.store, "reset", this.onResetItems);\r\n
                }\r\n
            }\r\n
        },\r\n
        selectRecord: function (record, suspendEvents) {\r\n
            if (!this.handleSelect) {\r\n
                return;\r\n
            }\r\n
            if (suspendEvents) {\r\n
                this.suspendEvents();\r\n
            }\r\n
            if (!this.multiSelect) {\r\n
                _.each(this.store.where({\r\n
                    selected: true\r\n
                }), function (rec) {\r\n
                    rec.set({\r\n
                        selected: false\r\n
                    });\r\n
                });\r\n
                if (record) {\r\n
                    record.set({\r\n
                        selected: true\r\n
                    });\r\n
                }\r\n
            } else {\r\n
                if (record) {\r\n
                    record.set({\r\n
                        selected: !record.get("selected")\r\n
                    });\r\n
                }\r\n
            }\r\n
            if (suspendEvents) {\r\n
                this.resumeEvents();\r\n
            }\r\n
        },\r\n
        selectByIndex: function (index, suspendEvents) {\r\n
            if (this.store.length > 0 && index > -1 && index < this.store.length) {\r\n
                this.selectRecord(this.store.at(index), suspendEvents);\r\n
            }\r\n
        },\r\n
        deselectAll: function (suspendEvents) {\r\n
            if (suspendEvents) {\r\n
                this.suspendEvents();\r\n
            }\r\n
            _.each(this.store.where({\r\n
                selected: true\r\n
            }), function (record) {\r\n
                record.set({\r\n
                    selected: false\r\n
                });\r\n
            });\r\n
            if (suspendEvents) {\r\n
                this.resumeEvents();\r\n
            }\r\n
        },\r\n
        getSelectedRec: function () {\r\n
            if (this.multiSelect) {\r\n
                var items = [];\r\n
                _.each(this.store.where({\r\n
                    selected: true\r\n
                }), function (rec) {\r\n
                    items.push(rec);\r\n
                });\r\n
                return items;\r\n
            }\r\n
            return this.store.where({\r\n
                selected: true\r\n
            });\r\n
        },\r\n
        onAddItem: function (record, index, opts) {\r\n
            var view = new Common.UI.DataViewItem({\r\n
                template: this.itemTemplate,\r\n
                model: record\r\n
            });\r\n
            if (view) {\r\n
                var innerEl = $(this.el).find(".inner").andSelf().filter(".inner");\r\n
                if (this.groups && this.groups.length > 0) {\r\n
                    var group = this.groups.findWhere({\r\n
                        id: record.get("group")\r\n
                    });\r\n
                    if (group) {\r\n
                        innerEl = innerEl.find("#" + group.id + " " + ".group-items-container");\r\n
                    }\r\n
                }\r\n
                if (innerEl) {\r\n
                    if (opts && opts.at == 0) {\r\n
                        innerEl.prepend(view.render().el);\r\n
                    } else {\r\n
                        innerEl.append(view.render().el);\r\n
                    }\r\n
                    innerEl.find(".empty-text").remove();\r\n
                    this.dataViewItems.push(view);\r\n
                    if (record.get("tip")) {\r\n
                        var view_el = $(view.el);\r\n
                        view_el.attr("data-toggle", "tooltip");\r\n
                        view_el.tooltip({\r\n
                            title: record.get("tip"),\r\n
                            placement: "cursor",\r\n
                            zIndex: this.tipZIndex\r\n
                        });\r\n
                    }\r\n
                    this.listenTo(view, "change", this.onChangeItem);\r\n
                    this.listenTo(view, "remove", this.onRemoveItem);\r\n
                    this.listenTo(view, "click", this.onClickItem);\r\n
                    this.listenTo(view, "dblclick", this.onDblClickItem);\r\n
                    this.listenTo(view, "select", this.onSelectItem);\r\n
                    if (!this.isSuspendEvents) {\r\n
                        this.trigger("item:add", this, view, record);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onResetItems: function () {\r\n
            $(this.el).html(this.template({\r\n
                groups: this.groups ? this.groups.toJSON() : null,\r\n
                style: this.style\r\n
            }));\r\n
            if (!_.isUndefined(this.scroller)) {\r\n
                this.scroller.destroy();\r\n
                delete this.scroller;\r\n
            }\r\n
            if (this.store.length < 1 && this.emptyText.length > 0) {\r\n
                $(this.el).find(".inner").andSelf().filter(".inner").append(\'<table class="empty-text"><tr><td>\' + this.emptyText + "</td></tr></table>");\r\n
            }\r\n
            _.each(this.dataViewItems, function (item) {\r\n
                this.stopListening(item);\r\n
                item.stopListening(item.model);\r\n
            },\r\n
            this);\r\n
            this.dataViewItems = [];\r\n
            this.store.each(this.onAddItem, this);\r\n
            if (this.allowScrollbar) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el).find(".inner").andSelf().filter(".inner"),\r\n
                    useKeyboard: this.enableKeyEvents && !this.handleSelect,\r\n
                    minScrollbarLength: 40\r\n
                });\r\n
            }\r\n
            this.attachKeyEvents();\r\n
        },\r\n
        onChangeItem: function (view, record) {\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("item:change", this, view, record);\r\n
            }\r\n
        },\r\n
        onRemoveItem: function (view, record) {\r\n
            this.stopListening(view);\r\n
            view.stopListening();\r\n
            if (this.store.length < 1 && this.emptyText.length > 0) {\r\n
                var el = $(this.el).find(".inner").andSelf().filter(".inner");\r\n
                if (el.find(".empty-text").length <= 0) {\r\n
                    el.append(\'<table class="empty-text"><tr><td>\' + this.emptyText + "</td></tr></table>");\r\n
                }\r\n
            }\r\n
            for (var i = 0; i < this.dataViewItems.length; i++) {\r\n
                if (_.isEqual(view, this.dataViewItems[i])) {\r\n
                    this.dataViewItems.splice(i, 1);\r\n
                    break;\r\n
                }\r\n
            }\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("item:remove", this, view, record);\r\n
            }\r\n
        },\r\n
        onClickItem: function (view, record, e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            window._event = e;\r\n
            this.selectRecord(record);\r\n
            this.lastSelectedRec = undefined;\r\n
            var tip = view.$el.data("bs.tooltip");\r\n
            if (tip) {\r\n
                tip.hide();\r\n
            }\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("item:click", this, view, record, e);\r\n
            }\r\n
        },\r\n
        onDblClickItem: function (view, record, e) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            window._event = e;\r\n
            this.selectRecord(record);\r\n
            this.lastSelectedRec = undefined;\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("item:dblclick", this, view, record, e);\r\n
            }\r\n
        },\r\n
        onSelectItem: function (view, record, selected) {\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger(selected ? "item:select": "item:deselect", this, view, record);\r\n
            }\r\n
        },\r\n
        scrollToRecord: function (record) {\r\n
            var innerEl = $(this.el).find(".inner");\r\n
            var inner_top = innerEl.offset().top;\r\n
            var div = innerEl.find("#" + record.get("id"));\r\n
            var div_top = div.offset().top;\r\n
            if (div_top < inner_top || div_top + div.height() > inner_top + innerEl.height()) {\r\n
                if (this.scroller && this.allowScrollbar) {\r\n
                    this.scroller.scrollTop(innerEl.scrollTop() + div_top - inner_top, 0);\r\n
                } else {\r\n
                    innerEl.scrollTop(innerEl.scrollTop() + div_top - inner_top);\r\n
                }\r\n
            }\r\n
        },\r\n
        onKeyDown: function (e, data) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (data === undefined) {\r\n
                data = e;\r\n
            }\r\n
            if (_.indexOf(this.moveKeys, data.keyCode) > -1 || data.keyCode == Common.UI.Keys.RETURN) {\r\n
                data.preventDefault();\r\n
                data.stopPropagation();\r\n
                var rec = this.getSelectedRec()[0];\r\n
                if (this.lastSelectedRec === undefined) {\r\n
                    this.lastSelectedRec = rec;\r\n
                }\r\n
                if (data.keyCode == Common.UI.Keys.RETURN) {\r\n
                    this.lastSelectedRec = undefined;\r\n
                    this.trigger("item:click", this, this, rec, e);\r\n
                    this.trigger("item:select", this, this, rec, e);\r\n
                    this.trigger("entervalue", this, rec, e);\r\n
                } else {\r\n
                    var idx = _.indexOf(this.store.models, rec);\r\n
                    idx = (data.keyCode == Common.UI.Keys.UP || data.keyCode == Common.UI.Keys.LEFT) ? Math.max(0, idx - 1) : Math.min(this.store.length - 1, idx + 1);\r\n
                    rec = this.store.at(idx);\r\n
                    if (rec) {\r\n
                        this.selectRecord(rec);\r\n
                        this.scrollToRecord(rec);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        attachKeyEvents: function () {\r\n
            if (this.enableKeyEvents && this.handleSelect) {\r\n
                var el = $(this.el).find(".inner").andSelf().filter(".inner");\r\n
                el.addClass("canfocused");\r\n
                el.attr("tabindex", "0");\r\n
                el.on((this.parentMenu) ? "dataview:keydown": "keydown", _.bind(this.onKeyDown, this));\r\n
            }\r\n
        },\r\n
        showLastSelected: function () {\r\n
            if (this.lastSelectedRec) {\r\n
                this.selectRecord(this.lastSelectedRec, true);\r\n
                this.scrollToRecord(this.lastSelectedRec);\r\n
                this.lastSelectedRec = undefined;\r\n
            }\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            this.disabled = disabled;\r\n
            $(this.el).find(".inner").andSelf().filter(".inner").toggleClass("disabled", disabled);\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        alignPosition: function () {\r\n
            var menuRoot = (this.parentMenu.cmpEl.attr("role") === "menu") ? this.parentMenu.cmpEl : this.parentMenu.cmpEl.find("[role=menu]"),\r\n
            innerEl = $(this.el).find(".inner").andSelf().filter(".inner"),\r\n
            docH = $(document).height(),\r\n
            menuH = menuRoot.outerHeight(),\r\n
            top = parseInt(menuRoot.css("top"));\r\n
            if (menuH > docH) {\r\n
                innerEl.css("max-height", (docH - parseInt(menuRoot.css("padding-top")) - parseInt(menuRoot.css("padding-bottom")) - 5) + "px");\r\n
                if (this.allowScrollbar) {\r\n
                    this.scroller.update({\r\n
                        minScrollbarLength: 40\r\n
                    });\r\n
                }\r\n
            } else {\r\n
                if (innerEl.height() < this.options.restoreHeight) {\r\n
                    innerEl.css("max-height", (Math.min(docH - parseInt(menuRoot.css("padding-top")) - parseInt(menuRoot.css("padding-bottom")) - 5, this.options.restoreHeight)) + "px");\r\n
                    menuH = menuRoot.outerHeight();\r\n
                    if (top + menuH > docH) {\r\n
                        menuRoot.css("top", 0);\r\n
                    }\r\n
                    if (this.allowScrollbar) {\r\n
                        this.scroller.update({\r\n
                            minScrollbarLength: 40\r\n
                        });\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    });\r\n
    $(document).on("keydown.bs.dropdown.data-api", "[data-toggle=dropdown], [role=menu]", function (e) {\r\n
        if (e.keyCode !== Common.UI.Keys.UP && e.keyCode !== Common.UI.Keys.DOWN && e.keyCode !== Common.UI.Keys.LEFT && e.keyCode !== Common.UI.Keys.RIGHT && e.keyCode !== Common.UI.Keys.RETURN) {\r\n
            return;\r\n
        }\r\n
        _.defer(function () {\r\n
            var target = $(e.target).closest(".dropdown-toggle");\r\n
            target.parent().find(".inner.canfocused").trigger("dataview:keydown", e);\r\n
        },\r\n
        100);\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ListView\',["common/main/lib/component/DataView"], function () {\r\n
    Common.UI.ListView = Common.UI.DataView.extend((function () {\r\n
        return {\r\n
            options: {\r\n
                handleSelect: true,\r\n
                enableKeyEvents: true,\r\n
                showLast: true,\r\n
                keyMoveDirection: "vertical",\r\n
                itemTemplate: _.template(\'<div id="<%= id %>" class="list-item" style=""><%= value %></div>\')\r\n
            },\r\n
            template: _.template([\'<div class="listview inner"></div>\'].join("")),\r\n
            onAddItem: function (record, index) {\r\n
                var view = new Common.UI.DataViewItem({\r\n
                    template: this.itemTemplate,\r\n
                    model: record\r\n
                });\r\n
                var idx = _.indexOf(this.store.models, record);\r\n
                if (view) {\r\n
                    var innerEl = $(this.el).find(".inner");\r\n
                    if (innerEl) {\r\n
                        var innerDivs = innerEl.find("> div");\r\n
                        innerEl.find(".empty-text").remove();\r\n
                        if (idx > 0) {\r\n
                            $(innerDivs.get(idx - 1)).after(view.render().el);\r\n
                        } else {\r\n
                            (innerDivs.length > 0) ? $(innerDivs[idx]).before(view.render().el) : innerEl.append(view.render().el);\r\n
                        }\r\n
                        this.dataViewItems.push(view);\r\n
                        this.listenTo(view, "change", this.onChangeItem);\r\n
                        this.listenTo(view, "remove", this.onRemoveItem);\r\n
                        this.listenTo(view, "click", this.onClickItem);\r\n
                        this.listenTo(view, "dblclick", this.onDblClickItem);\r\n
                        this.listenTo(view, "select", this.onSelectItem);\r\n
                        if (!this.isSuspendEvents) {\r\n
                            this.trigger("item:add", this, view, record);\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced\',["text!spreadsheeteditor/main/app/template/ParagraphSettingsAdvanced.template", "common/main/lib/view/AdvancedSettingsWindow", "common/main/lib/component/MetricSpinner", "common/main/lib/component/CheckBox", "common/main/lib/component/RadioBox", "common/main/lib/component/ListView"], function (contentTemplate) {\r\n
    SSE.Views.ParagraphSettingsAdvanced = Common.Views.AdvancedSettingsWindow.extend(_.extend({\r\n
        options: {\r\n
            contentWidth: 320,\r\n
            height: 390,\r\n
            toggleGroup: "paragraph-adv-settings-group"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle,\r\n
                items: [{\r\n
                    panelId: "id-adv-paragraph-indents",\r\n
                    panelCaption: this.strParagraphIndents\r\n
                },\r\n
                {\r\n
                    panelId: "id-adv-paragraph-font",\r\n
                    panelCaption: this.strParagraphFont\r\n
                },\r\n
                {\r\n
                    panelId: "id-adv-paragraph-tabs",\r\n
                    panelCaption: this.strTabs\r\n
                }],\r\n
                contentTemplate: _.template(contentTemplate)({\r\n
                    scope: this\r\n
                })\r\n
            },\r\n
            options);\r\n
            Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this, this.options);\r\n
            this._changedProps = null;\r\n
            this.checkGroup = 0;\r\n
            this._noApply = true;\r\n
            this._tabListChanged = false;\r\n
            this.spinners = [];\r\n
            this.api = this.options.api;\r\n
            this._originalProps = new Asc.asc_CParagraphProperty(this.options.paragraphProps);\r\n
        },\r\n
        render: function () {\r\n
            Common.Views.AdvancedSettingsWindow.prototype.render.call(this);\r\n
            var me = this;\r\n
            this.numFirstLine = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraphadv-spin-first-line"),\r\n
                step: 0.1,\r\n
                width: 85,\r\n
                defaultUnit: "cm",\r\n
                defaultValue: 0,\r\n
                value: "0 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: -55.87\r\n
            });\r\n
            this.numFirstLine.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getInd() === null || this._changedProps.asc_getInd() === undefined) {\r\n
                        this._changedProps.asc_putInd(new Asc.asc_CParagraphInd());\r\n
                    }\r\n
                    this._changedProps.asc_getInd().asc_putFirstLine(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.numFirstLine);\r\n
            this.numIndentsLeft = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraphadv-spin-indent-left"),\r\n
                step: 0.1,\r\n
                width: 85,\r\n
                defaultUnit: "cm",\r\n
                defaultValue: 0,\r\n
                value: "0 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: -55.87\r\n
            });\r\n
            this.numIndentsLeft.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getInd() === null || this._changedProps.asc_getInd() === undefined) {\r\n
                        this._changedProps.asc_putInd(new Asc.asc_CParagraphInd());\r\n
                    }\r\n
                    this._changedProps.asc_getInd().asc_putLeft(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.numIndentsLeft);\r\n
            this.numIndentsRight = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraphadv-spin-indent-right"),\r\n
                step: 0.1,\r\n
                width: 85,\r\n
                defaultUnit: "cm",\r\n
                defaultValue: 0,\r\n
                value: "0 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: -55.87\r\n
            });\r\n
            this.numIndentsRight.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getInd() === null || this._changedProps.asc_getInd() === undefined) {\r\n
                        this._changedProps.asc_putInd(new Asc.asc_CParagraphInd());\r\n
                    }\r\n
                    this._changedProps.asc_getInd().asc_putRight(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.numIndentsRight);\r\n
            this.chStrike = new Common.UI.CheckBox({\r\n
                el: $("#paragraphadv-checkbox-strike"),\r\n
                labelText: this.strStrike\r\n
            });\r\n
            this.chStrike.on("change", _.bind(this.onStrikeChange, this));\r\n
            this.chDoubleStrike = new Common.UI.CheckBox({\r\n
                el: $("#paragraphadv-checkbox-double-strike"),\r\n
                labelText: this.strDoubleStrike\r\n
            });\r\n
            this.chDoubleStrike.on("change", _.bind(this.onDoubleStrikeChange, this));\r\n
            this.chSuperscript = new Common.UI.CheckBox({\r\n
                el: $("#paragraphadv-checkbox-superscript"),\r\n
                labelText: this.strSuperscript\r\n
            });\r\n
            this.chSuperscript.on("change", _.bind(this.onSuperscriptChange, this));\r\n
            this.chSubscript = new Common.UI.CheckBox({\r\n
                el: $("#paragraphadv-checkbox-subscript"),\r\n
                labelText: this.strSubscript\r\n
            });\r\n
            this.chSubscript.on("change", _.bind(this.onSubscriptChange, this));\r\n
            this.chSmallCaps = new Common.UI.CheckBox({\r\n
                el: $("#paragraphadv-checkbox-small-caps"),\r\n
                labelText: this.strSmallCaps\r\n
            });\r\n
            this.chSmallCaps.on("change", _.bind(this.onSmallCapsChange, this));\r\n
            this.chAllCaps = new Common.UI.CheckBox({\r\n
                el: $("#paragraphadv-checkbox-all-caps"),\r\n
                labelText: this.strAllCaps\r\n
            });\r\n
            this.chAllCaps.on("change", _.bind(this.onAllCapsChange, this));\r\n
            this.numSpacing = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraphadv-spin-spacing"),\r\n
                step: 0.01,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                defaultValue: 0,\r\n
                value: "0 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: -55.87\r\n
            });\r\n
            this.numSpacing.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putTextSpacing(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
                if (this.api && !this._noApply) {\r\n
                    var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                    properties.asc_putTextSpacing(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                    this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.numSpacing);\r\n
            this.numTab = new Common.UI.MetricSpinner({\r\n
                el: $("#paraadv-spin-tab"),\r\n
                step: 0.1,\r\n
                width: 180,\r\n
                defaultUnit: "cm",\r\n
                value: "1.25 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.numTab);\r\n
            this.numDefaultTab = new Common.UI.MetricSpinner({\r\n
                el: $("#paraadv-spin-default-tab"),\r\n
                step: 0.1,\r\n
                width: 107,\r\n
                defaultUnit: "cm",\r\n
                value: "1.25 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: 0\r\n
            });\r\n
            this.numDefaultTab.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putDefaultTab(parseFloat(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()).toFixed(1)));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.numDefaultTab);\r\n
            this.tabList = new Common.UI.ListView({\r\n
                el: $("#paraadv-list-tabs"),\r\n
                emptyText: this.noTabs,\r\n
                store: new Common.UI.DataViewStore()\r\n
            });\r\n
            this.tabList.store.comparator = function (rec) {\r\n
                return rec.get("tabPos");\r\n
            };\r\n
            this.tabList.on("item:select", _.bind(this.onSelectTab, this));\r\n
            var storechanged = function () {\r\n
                if (!me._noApply) {\r\n
                    me._tabListChanged = true;\r\n
                }\r\n
            };\r\n
            this.listenTo(this.tabList.store, "add", storechanged);\r\n
            this.listenTo(this.tabList.store, "remove", storechanged);\r\n
            this.listenTo(this.tabList.store, "reset", storechanged);\r\n
            this.radioLeft = new Common.UI.RadioBox({\r\n
                el: $("#paragraphadv-radio-left"),\r\n
                labelText: this.textTabLeft,\r\n
                name: "asc-radio-tab",\r\n
                checked: true\r\n
            });\r\n
            this.radioCenter = new Common.UI.RadioBox({\r\n
                el: $("#paragraphadv-radio-center"),\r\n
                labelText: this.textTabCenter,\r\n
                name: "asc-radio-tab"\r\n
            });\r\n
            this.radioRight = new Common.UI.RadioBox({\r\n
                el: $("#paragraphadv-radio-right"),\r\n
                labelText: this.textTabRight,\r\n
                name: "asc-radio-tab"\r\n
            });\r\n
            this.btnAddTab = new Common.UI.Button({\r\n
                el: $("#paraadv-button-add-tab")\r\n
            });\r\n
            this.btnAddTab.on("click", _.bind(this.addTab, this));\r\n
            this.btnRemoveTab = new Common.UI.Button({\r\n
                el: $("#paraadv-button-remove-tab")\r\n
            });\r\n
            this.btnRemoveTab.on("click", _.bind(this.removeTab, this));\r\n
            this.btnRemoveAll = new Common.UI.Button({\r\n
                el: $("#paraadv-button-remove-all")\r\n
            });\r\n
            this.btnRemoveAll.on("click", _.bind(this.removeAllTabs, this));\r\n
            this.afterRender();\r\n
        },\r\n
        getSettings: function () {\r\n
            if (this._tabListChanged) {\r\n
                if (this._changedProps.asc_getTabs() === null || this._changedProps.asc_getTabs() === undefined) {\r\n
                    this._changedProps.asc_putTabs(new Asc.asc_CParagraphTabs());\r\n
                }\r\n
                this.tabList.store.each(function (item, index) {\r\n
                    var tab = new Asc.asc_CParagraphTab(Common.Utils.Metric.fnRecalcToMM(item.get("tabPos")), item.get("tabAlign"));\r\n
                    this._changedProps.asc_getTabs().add_Tab(tab);\r\n
                },\r\n
                this);\r\n
            }\r\n
            return {\r\n
                paragraphProps: this._changedProps\r\n
            };\r\n
        },\r\n
        _setDefaults: function (props) {\r\n
            if (props) {\r\n
                this._originalProps = new Asc.asc_CParagraphProperty(props);\r\n
                this.numFirstLine.setValue((props.asc_getInd() !== null && props.asc_getInd().asc_getFirstLine() !== null) ? Common.Utils.Metric.fnRecalcFromMM(props.asc_getInd().asc_getFirstLine()) : "", true);\r\n
                this.numIndentsLeft.setValue((props.asc_getInd() !== null && props.asc_getInd().asc_getLeft() !== null) ? Common.Utils.Metric.fnRecalcFromMM(props.asc_getInd().asc_getLeft()) : "", true);\r\n
                this.numIndentsRight.setValue((props.asc_getInd() !== null && props.asc_getInd().asc_getRight() !== null) ? Common.Utils.Metric.fnRecalcFromMM(props.asc_getInd().asc_getRight()) : "", true);\r\n
                this._noApply = true;\r\n
                this.chStrike.setValue((props.asc_getStrikeout() !== null && props.asc_getStrikeout() !== undefined) ? props.asc_getStrikeout() : "indeterminate", true);\r\n
                this.chDoubleStrike.setValue((props.asc_getDStrikeout() !== null && props.asc_getDStrikeout() !== undefined) ? props.asc_getDStrikeout() : "indeterminate", true);\r\n
                this.chSubscript.setValue((props.asc_getSubscript() !== null && props.asc_getSubscript() !== undefined) ? props.asc_getSubscript() : "indeterminate", true);\r\n
                this.chSuperscript.setValue((props.asc_getSuperscript() !== null && props.asc_getSuperscript() !== undefined) ? props.asc_getSuperscript() : "indeterminate", true);\r\n
                this.chSmallCaps.setValue((props.asc_getSmallCaps() !== null && props.asc_getSmallCaps() !== undefined) ? props.asc_getSmallCaps() : "indeterminate", true);\r\n
                this.chAllCaps.setValue((props.asc_getAllCaps() !== null && props.asc_getAllCaps() !== undefined) ? props.asc_getAllCaps() : "indeterminate", true);\r\n
                this.numSpacing.setValue((props.asc_getTextSpacing() !== null && props.asc_getTextSpacing() !== undefined) ? Common.Utils.Metric.fnRecalcFromMM(props.asc_getTextSpacing()) : "", true);\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", this._originalProps);\r\n
                this.numDefaultTab.setValue((props.asc_getDefaultTab() !== null && props.asc_getDefaultTab() !== undefined) ? Common.Utils.Metric.fnRecalcFromMM(parseFloat(props.asc_getDefaultTab().toFixed(1))) : "", true);\r\n
                var store = this.tabList.store;\r\n
                var tabs = props.asc_getTabs();\r\n
                if (tabs) {\r\n
                    var arr = [];\r\n
                    var count = tabs.asc_getCount();\r\n
                    for (var i = 0; i < count; i++) {\r\n
                        var tab = tabs.asc_getTab(i);\r\n
                        var pos = Common.Utils.Metric.fnRecalcFromMM(parseFloat(tab.asc_getPos().toFixed(1)));\r\n
                        var rec = new Common.UI.DataViewModel();\r\n
                        rec.set({\r\n
                            tabPos: pos,\r\n
                            value: parseFloat(pos.toFixed(3)) + " " + Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()],\r\n
                            tabAlign: tab.asc_getValue()\r\n
                        });\r\n
                        arr.push(rec);\r\n
                    }\r\n
                    store.reset(arr, {\r\n
                        silent: false\r\n
                    });\r\n
                    this.tabList.selectByIndex(0);\r\n
                }\r\n
                this._noApply = false;\r\n
                this._changedProps = new Asc.asc_CParagraphProperty();\r\n
            }\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    if (spinner.el.id == "paragraphadv-spin-spacing" || spinner.el.id == "paragraphadv-spin-position") {\r\n
                        spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.01 : 1);\r\n
                    } else {\r\n
                        spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.1 : 1);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        afterRender: function () {\r\n
            this.updateMetricUnit();\r\n
            this._setDefaults(this._originalProps);\r\n
        },\r\n
        onStrikeChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this._changedProps && this.checkGroup != 1) {\r\n
                this._changedProps.asc_putStrikeout(field.getValue() == "checked");\r\n
            }\r\n
            this.checkGroup = 0;\r\n
            if (field.getValue() == "checked") {\r\n
                this.checkGroup = 1;\r\n
                this.chDoubleStrike.setValue(0);\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putDStrikeout(false);\r\n
                }\r\n
                this.checkGroup = 0;\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                properties.asc_putStrikeout(field.getValue() == "checked");\r\n
                properties.asc_putDStrikeout(this.chDoubleStrike.getValue() == "checked");\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
            }\r\n
        },\r\n
        onDoubleStrikeChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this._changedProps && this.checkGroup != 1) {\r\n
                this._changedProps.asc_putDStrikeout(field.getValue() == "checked");\r\n
            }\r\n
            this.checkGroup = 0;\r\n
            if (field.getValue() == "checked") {\r\n
                this.checkGroup = 1;\r\n
                this.chStrike.setValue(0);\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putStrikeout(false);\r\n
                }\r\n
                this.checkGroup = 0;\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                properties.asc_putDStrikeout(field.getValue() == "checked");\r\n
                properties.asc_putStrikeout(this.chStrike.getValue() == "checked");\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
            }\r\n
        },\r\n
        onSuperscriptChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this._changedProps && this.checkGroup != 2) {\r\n
                this._changedProps.asc_putSuperscript(field.getValue() == "checked");\r\n
            }\r\n
            this.checkGroup = 0;\r\n
            if (field.getValue() == "checked") {\r\n
                this.checkGroup = 2;\r\n
                this.chSubscript.setValue(0);\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putSubscript(false);\r\n
                }\r\n
                this.checkGroup = 0;\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                properties.asc_putSuperscript(field.getValue() == "checked");\r\n
                properties.asc_putSubscript(this.chSubscript.getValue() == "checked");\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
            }\r\n
        },\r\n
        onSubscriptChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this._changedProps && this.checkGroup != 2) {\r\n
                this._changedProps.asc_putSubscript(field.getValue() == "checked");\r\n
            }\r\n
            this.checkGroup = 0;\r\n
            if (field.getValue() == "checked") {\r\n
                this.checkGroup = 2;\r\n
                this.chSuperscript.setValue(0);\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putSuperscript(false);\r\n
                }\r\n
                this.checkGroup = 0;\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                properties.asc_putSubscript(field.getValue() == "checked");\r\n
                properties.asc_putSuperscript(this.chSuperscript.getValue() == "checked");\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
            }\r\n
        },\r\n
        onSmallCapsChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this._changedProps && this.checkGroup != 3) {\r\n
                this._changedProps.asc_putSmallCaps(field.getValue() == "checked");\r\n
            }\r\n
            this.checkGroup = 0;\r\n
            if (field.getValue() == "checked") {\r\n
                this.checkGroup = 3;\r\n
                this.chAllCaps.setValue(0);\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putAllCaps(false);\r\n
                }\r\n
                this.checkGroup = 0;\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                properties.asc_putSmallCaps(field.getValue() == "checked");\r\n
                properties.asc_putAllCaps(this.chAllCaps.getValue() == "checked");\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
            }\r\n
        },\r\n
        onAllCapsChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this._changedProps && this.checkGroup != 3) {\r\n
                this._changedProps.asc_putAllCaps(field.getValue() == "checked");\r\n
            }\r\n
            this.checkGroup = 0;\r\n
            if (field.getValue() == "checked") {\r\n
                this.checkGroup = 3;\r\n
                this.chSmallCaps.setValue(0);\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putSmallCaps(false);\r\n
                }\r\n
                this.checkGroup = 0;\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var properties = (this._originalProps) ? this._originalProps : new Asc.asc_CParagraphProperty();\r\n
                properties.asc_putAllCaps(field.getValue() == "checked");\r\n
                properties.asc_putSmallCaps(this.chSmallCaps.getValue() == "checked");\r\n
                this.api.asc_setDrawImagePlaceParagraph("paragraphadv-font-img", properties);\r\n
            }\r\n
        },\r\n
        addTab: function (btn, eOpts) {\r\n
            var val = this.numTab.getNumberValue();\r\n
            var align = this.radioLeft.getValue() ? 1 : (this.radioCenter.getValue() ? 3 : 2);\r\n
            var store = this.tabList.store;\r\n
            var rec = store.find(function (record) {\r\n
                return (Math.abs(record.get("tabPos") - val) < 0.001);\r\n
            });\r\n
            if (rec) {\r\n
                rec.set("tabAlign", align);\r\n
            } else {\r\n
                rec = new Common.UI.DataViewModel();\r\n
                rec.set({\r\n
                    tabPos: val,\r\n
                    value: val + " " + Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()],\r\n
                    tabAlign: align\r\n
                });\r\n
                store.add(rec);\r\n
            }\r\n
            this.tabList.selectRecord(rec);\r\n
            this.tabList.scrollToRecord(rec);\r\n
        },\r\n
        removeTab: function (btn, eOpts) {\r\n
            var rec = this.tabList.getSelectedRec();\r\n
            if (rec.length > 0) {\r\n
                var store = this.tabList.store;\r\n
                var idx = _.indexOf(store.models, rec[0]);\r\n
                store.remove(rec[0]);\r\n
                if (idx > store.length - 1) {\r\n
                    idx = store.length - 1;\r\n
                }\r\n
                if (store.length > 0) {\r\n
                    this.tabList.selectByIndex(idx);\r\n
                    this.tabList.scrollToRecord(store.at(idx));\r\n
                }\r\n
            }\r\n
        },\r\n
        removeAllTabs: function (btn, eOpts) {\r\n
            this.tabList.store.reset();\r\n
        },\r\n
        onSelectTab: function (lisvView, itemView, record) {\r\n
            var rawData = {},\r\n
            isViewSelect = _.isFunction(record.toJSON);\r\n
            if (isViewSelect) {\r\n
                if (record.get("selected")) {\r\n
                    rawData = record.toJSON();\r\n
                } else {\r\n
                    return;\r\n
                }\r\n
            } else {\r\n
                rawData = record;\r\n
            }\r\n
            this.numTab.setValue(rawData.tabPos);\r\n
            (rawData.tabAlign == 1) ? this.radioLeft.setValue(true) : ((rawData.tabAlign == 3) ? this.radioCenter.setValue(true) : this.radioRight.setValue(true));\r\n
        },\r\n
        textTitle: "Paragraph - Advanced Settings",\r\n
        strIndentsFirstLine: "First line",\r\n
        strIndentsLeftText: "Left",\r\n
        strIndentsRightText: "Right",\r\n
        strParagraphIndents: "Indents & Placement",\r\n
        strParagraphFont: "Font",\r\n
        cancelButtonText: "Cancel",\r\n
        okButtonText: "Ok",\r\n
        textEffects: "Effects",\r\n
        textCharacterSpacing: "Character Spacing",\r\n
        strDoubleStrike: "Double strikethrough",\r\n
        strStrike: "Strikethrough",\r\n
        strSuperscript: "Superscript",\r\n
        strSubscript: "Subscript",\r\n
        strSmallCaps: "Small caps",\r\n
        strAllCaps: "All caps",\r\n
        strTabs: "Tab",\r\n
        textSet: "Specify",\r\n
        textRemove: "Remove",\r\n
        textRemoveAll: "Remove All",\r\n
        textTabLeft: "Left",\r\n
        textTabRight: "Right",\r\n
        textTabCenter: "Center",\r\n
        textAlign: "Alignment",\r\n
        textTabPosition: "Tab Position",\r\n
        textDefault: "Default Tab",\r\n
        noTabs: "The specified tabs will appear in this field"\r\n
    },\r\n
    SSE.Views.ParagraphSettingsAdvanced || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/SetValueDialog\',["common/main/lib/component/Window", "common/main/lib/component/ComboBox"], function () {\r\n
    SSE.Views.SetValueDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 214,\r\n
            header: true,\r\n
            style: "min-width: 214px;",\r\n
            cls: "modal-dlg"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle\r\n
            },\r\n
            options || {});\r\n
            this.template = [\'<div class="box">\', \'<div class="input-row">\', \'<div id="id-spin-set-value"></div>\', "</div>", \'<div class="footer center">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + this.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + this.cancelButtonText + "</button>", "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            this.startvalue = this.options.startvalue;\r\n
            this.maxvalue = this.options.maxvalue;\r\n
            this.defaultUnit = this.options.defaultUnit;\r\n
            this.step = this.options.step;\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.spnSize = new Common.UI.MetricSpinner({\r\n
                el: $("#id-spin-set-value"),\r\n
                width: 182,\r\n
                step: this.step,\r\n
                defaultUnit: this.defaultUnit,\r\n
                minValue: 0,\r\n
                maxValue: this.maxvalue,\r\n
                value: this.startvalue + " " + this.defaultUnit\r\n
            });\r\n
            var $window = this.getChild();\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            this.spnSize.on("entervalue", _.bind(this.onEnterValue, this));\r\n
            this.spnSize.on("change", _.bind(this.onChange, this));\r\n
            this.spnSize.$el.find("input").focus();\r\n
        },\r\n
        _handleInput: function (state) {\r\n
            if (this.options.handler) {\r\n
                this.options.handler.call(this, this, state);\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            this._handleInput(event.currentTarget.attributes["result"].value);\r\n
        },\r\n
        onEnterValue: function (e

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAA0=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="13" aka="AAAAAAAAAA0=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

vent) {\r\n
            this._handleInput("ok");\r\n
        },\r\n
        onChange: function () {\r\n
            var val = this.spnSize.getNumberValue();\r\n
            val = val / this.step;\r\n
            val = (val | val) * this.step;\r\n
            this.spnSize.setValue(val, true);\r\n
        },\r\n
        getSettings: function () {\r\n
            return this.spnSize.getNumberValue();\r\n
        },\r\n
        cancelButtonText: "Cancel",\r\n
        okButtonText: "Ok",\r\n
        txtMinText: "The minimum value for this field is {0}",\r\n
        txtMaxText: "The maximum value for this field is {0}"\r\n
    },\r\n
    SSE.Views.SetValueDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/AutoFilterDialog\',["common/main/lib/component/Window"], function () {\r\n
    SSE.Views = SSE.Views || {};\r\n
    SSE.Views.DigitalFilterDialog = Common.UI.Window.extend(_.extend({\r\n
        initialize: function (options) {\r\n
            var t = this,\r\n
            _options = {};\r\n
            _.extend(_options, {\r\n
                width: 500,\r\n
                height: 230,\r\n
                contentWidth: 180,\r\n
                header: true,\r\n
                cls: "filter-dlg",\r\n
                contentTemplate: "",\r\n
                title: t.txtTitle,\r\n
                items: []\r\n
            },\r\n
            options);\r\n
            this.template = options.template || [\'<div class="box" style="height:\' + (_options.height - 85) + \'px;">\', \'<div class="content-panel" >\', \'<label class="header">\', t.textShowRows, "</label>", \'<div style="margin-top:15px;">\', \'<div id="id-search-begin-digital-combo" class="input-group-nr" style="vertical-align:top;width:225px;display:inline-block;"></div>\', \'<div id="id-sd-cell-search-begin" class="" style="width:225px;display:inline-block;margin-left:18px;"></div>\', "</div>", "<div>", \'<div id="id-and-radio" class="padding-small" style="display: inline-block; margin-top:10px;"></div>\', \'<div id="id-or-radio" class="padding-small" style="display: inline-block; margin-left:25px;"></div>\', "</div>", \'<div style="margin-top:10px;">\', \'<div id="id-search-end-digital-combo" class="input-group-nr" style="vertical-align:top;width:225px;display:inline-block;"></div>\', \'<div id="id-sd-cell-search-end" class="" style="width:225px;display:inline-block;margin-left:18px;"></div>\', "</div>", "</div>", "</div>", \'<div class="separator horizontal" style="width:100%"></div>\', \'<div class="footer right" style="margin-left:-15px;">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right:10px;">\', t.okButtonText, "</button>", \'<button class="btn normal dlg-btn" result="cancel">\', t.cancelButtonText, "</button>", "</div>"].join("");\r\n
            this.api = options.api;\r\n
            this.handler = options.handler;\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var conditions = [{\r\n
                value: c_oAscCustomAutoFilter.equals,\r\n
                displayValue: this.capCondition1\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.doesNotEqual,\r\n
                displayValue: this.capCondition2\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.isGreaterThan,\r\n
                displayValue: this.capCondition3\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.isGreaterThanOrEqualTo,\r\n
                displayValue: this.capCondition4\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.isLessThan,\r\n
                displayValue: this.capCondition5\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.isLessThanOrEqualTo,\r\n
                displayValue: this.capCondition6\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.beginsWith,\r\n
                displayValue: this.capCondition7\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.doesNotBeginWith,\r\n
                displayValue: this.capCondition8\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.endsWith,\r\n
                displayValue: this.capCondition9\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.doesNotEndWith,\r\n
                displayValue: this.capCondition10\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.contains,\r\n
                displayValue: this.capCondition11\r\n
            },\r\n
            {\r\n
                value: c_oAscCustomAutoFilter.doesNotContain,\r\n
                displayValue: this.capCondition12\r\n
            }];\r\n
            this.cmbCondition1 = new Common.UI.ComboBox({\r\n
                el: $("#id-search-begin-digital-combo", this.$window),\r\n
                menuStyle: "min-width: 225px;",\r\n
                cls: "input-group-nr",\r\n
                data: conditions,\r\n
                editable: false\r\n
            });\r\n
            this.cmbCondition1.setValue(c_oAscCustomAutoFilter.equals);\r\n
            conditions.splice(0, 0, {\r\n
                value: 0,\r\n
                displayValue: this.textNoFilter\r\n
            });\r\n
            this.cmbCondition2 = new Common.UI.ComboBox({\r\n
                el: $("#id-search-end-digital-combo", this.$window),\r\n
                menuStyle: "min-width: 225px;",\r\n
                cls: "input-group-nr",\r\n
                data: conditions,\r\n
                editable: false\r\n
            });\r\n
            this.cmbCondition2.setValue(0);\r\n
            this.rbAnd = new Common.UI.RadioBox({\r\n
                el: $("#id-and-radio", this.$window),\r\n
                labelText: this.capAnd,\r\n
                name: "asc-radio-filter-tab",\r\n
                checked: true\r\n
            });\r\n
            this.rbOr = new Common.UI.RadioBox({\r\n
                el: $("#id-or-radio", this.$window),\r\n
                labelText: this.capOr,\r\n
                name: "asc-radio-filter-tab"\r\n
            });\r\n
            this.txtValue1 = new Common.UI.InputField({\r\n
                el: $("#id-sd-cell-search-begin", this.$window),\r\n
                template: _.template([\'<div class="input-field" style="<%= style %>">\', "<input ", \'type="<%= type %>" \', \'name="<%= name %>" \', \'class="form-control <%= cls %>" style="float:none" \', \'placeholder="<%= placeHolder %>" \', \'value="<%= value %>"\', ">", "</div>"].join("")),\r\n
                allowBlank: true,\r\n
                validation: function () {\r\n
                    return true;\r\n
                }\r\n
            });\r\n
            this.txtValue2 = new Common.UI.InputField({\r\n
                el: $("#id-sd-cell-search-end", this.$window),\r\n
                template: _.template([\'<div class="input-field" style="<%= style %>">\', "<input ", \'type="<%= type %>" \', \'name="<%= name %>" \', \'class="form-control <%= cls %>" style="float:none" \', \'placeholder="<%= placeHolder %>" \', \'value="<%= value %>"\', ">", "</div>"].join("")),\r\n
                allowBlank: true,\r\n
                validation: function () {\r\n
                    return true;\r\n
                }\r\n
            });\r\n
            this.$window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            this.loadDefaults();\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.Window.prototype.show.call(this);\r\n
            var me = this;\r\n
            _.defer(function () {\r\n
                if (me.txtValue1) {\r\n
                    me.txtValue1.focus();\r\n
                }\r\n
            },\r\n
            500);\r\n
        },\r\n
        close: function () {\r\n
            if (this.api) {\r\n
                this.api.asc_enableKeyEvents(true);\r\n
            }\r\n
            Common.UI.Window.prototype.close.call(this);\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            if (event.currentTarget.attributes && event.currentTarget.attributes.result) {\r\n
                if ("ok" === event.currentTarget.attributes.result.value) {\r\n
                    this.save();\r\n
                }\r\n
                this.close();\r\n
            }\r\n
        },\r\n
        setSettings: function (properties) {\r\n
            this.properties = properties;\r\n
        },\r\n
        loadDefaults: function () {\r\n
            if (this.properties && this.rbOr && this.rbAnd && this.cmbCondition1 && this.cmbCondition2 && this.txtValue1 && this.txtValue2) {\r\n
                (this.properties.asc_getIsChecked()) ? this.rbOr.setValue(true) : this.rbAnd.setValue(true);\r\n
                this.cmbCondition1.setValue(this.properties.asc_getFilter1() || c_oAscCustomAutoFilter.equals);\r\n
                this.cmbCondition2.setValue(this.properties.asc_getFilter2() || 0);\r\n
                this.txtValue1.setValue(null === this.properties.asc_getValFilter1() ? "" : this.properties.asc_getValFilter1());\r\n
                this.txtValue2.setValue(null === this.properties.asc_getValFilter2() ? "" : this.properties.asc_getValFilter2());\r\n
            }\r\n
        },\r\n
        save: function () {\r\n
            if (this.api && this.properties && this.rbOr && this.rbAnd && this.cmbCondition1 && this.cmbCondition2 && this.txtValue1 && this.txtValue2) {\r\n
                var options = new Asc.AutoFiltersOptions();\r\n
                if (options) {\r\n
                    options.asc_setCellId(this.properties.asc_getCellId());\r\n
                    options.asc_setIsChecked(this.rbOr.getValue());\r\n
                    options.asc_setFilter1(this.cmbCondition1.getValue());\r\n
                    options.asc_setFilter2(this.cmbCondition2.getValue() || undefined);\r\n
                    options.asc_setValFilter1(this.txtValue1.getValue());\r\n
                    options.asc_setValFilter2(this.txtValue2.getValue());\r\n
                    this.api.asc_applyAutoFilter("digitalFilter", options);\r\n
                }\r\n
            }\r\n
        },\r\n
        onPrimary: function () {\r\n
            this.save();\r\n
            this.close();\r\n
            return false;\r\n
        },\r\n
        cancelButtonText: "Cancel",\r\n
        capAnd: "And",\r\n
        capCondition1: "equals",\r\n
        capCondition10: "does not end with",\r\n
        capCondition11: "contains",\r\n
        capCondition12: "does not contain",\r\n
        capCondition2: "does not equal",\r\n
        capCondition3: "is greater than",\r\n
        capCondition4: "is greater than or equal to",\r\n
        capCondition5: "is less than",\r\n
        capCondition6: "is less than or equal to",\r\n
        capCondition7: "begins with",\r\n
        capCondition8: "does not begin with",\r\n
        capCondition9: "ends with",\r\n
        capOr: "Or",\r\n
        textNoFilter: "no filter",\r\n
        textShowRows: "Show rows where",\r\n
        textUse1: "Use ? to present any single character",\r\n
        textUse2 : "Use * to present any series of character",\r\n
        txtTitle: "Custom Filter"\r\n
    },\r\n
    SSE.Views.DigitalFilterDialog || {}));\r\n
    SSE.Views.AutoFilterDialog = Common.UI.Window.extend(_.extend({\r\n
        initialize: function (options) {\r\n
            var t = this,\r\n
            _options = {};\r\n
            _.extend(_options, {\r\n
                width: 270,\r\n
                height: 450,\r\n
                contentWidth: 400,\r\n
                header: true,\r\n
                cls: "filter-dlg",\r\n
                contentTemplate: "",\r\n
                title: t.txtTitle,\r\n
                items: []\r\n
            },\r\n
            options);\r\n
            this.template = options.template || [\'<div class="box" style="height:\' + (_options.height - 85) + \'px;">\', \'<div class="content-panel">\', \'<div class="">\', \'<div id="id-btn-sort-down" class="btn-placeholder border"></div>\', \'<div id="id-btn-sort-up" class="btn-placeholder border"></div>\', \'<div id="id-checkbox-custom-filter" style="max-width:50px;margin-left:50px;display:inline-block;"></div>\', \'<button class="btn normal dlg-btn primary" result="custom" id="id-btn-custom-filter" style="min-width:120px;">\', t.btnCustomFilter, "</button>", \'<div id="id-sd-cell-search" class="input-row" style="margin-bottom:10px;"></div>\', \'<div class="border-values" style="margin-top:45px;">\', \'<div id="id-dlg-filter-values" class="combo-values"/>\', "</div>", "</div>", "</div>", "</div>", \'<div class="separator horizontal"></div>\', \'<div class="footer center">\', \'<div id="id-apply-filter" style="display: inline-block;"></div>\', \'<button class="btn normal dlg-btn" result="cancel">\', t.cancelButtonText, "</button>", "</div>"].join("");\r\n
            this.api = options.api;\r\n
            this.handler = options.handler;\r\n
            this.throughIndexes = [];\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            var me = this;\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.$window.find(".btn").on("click", _.bind(this.onBtnClick, this));\r\n
            this.btnOk = new Common.UI.Button({\r\n
                cls: "btn normal dlg-btn primary",\r\n
                caption: this.okButtonText,\r\n
                style: "margin-right:10px;",\r\n
                enableToggle: false,\r\n
                allowDepress: false\r\n
            });\r\n
            if (this.btnOk) {\r\n
                this.btnOk.render($("#id-apply-filter", this.$window));\r\n
                this.btnOk.on("click", _.bind(this.onApplyFilter, this));\r\n
            }\r\n
            this.btnSortDown = new Common.UI.Button({\r\n
                cls: "btn-toolbar btn-toolbar-default border",\r\n
                iconCls: "btn-icon btn-sort-down",\r\n
                pressed: true,\r\n
                enableToggle: true,\r\n
                allowDepress: false\r\n
            });\r\n
            if (this.btnSortDown) {\r\n
                this.btnSortDown.render($("#id-btn-sort-down", this.$window));\r\n
                this.btnSortDown.on("click", _.bind(this.onSortType, this, "ascending"));\r\n
            }\r\n
            this.btnSortUp = new Common.UI.Button({\r\n
                cls: "btn-toolbar btn-toolbar-default border",\r\n
                iconCls: "btn-icon btn-sort-up",\r\n
                pressed: true,\r\n
                enableToggle: true,\r\n
                allowDepress: false\r\n
            });\r\n
            if (this.btnSortUp) {\r\n
                this.btnSortUp.render($("#id-btn-sort-up", this.$window));\r\n
                this.btnSortUp.on("click", _.bind(this.onSortType, this, "descending"));\r\n
            }\r\n
            this.chCustomFilter = new Common.UI.CheckBox({\r\n
                el: $("#id-checkbox-custom-filter", this.$window)\r\n
            });\r\n
            this.chCustomFilter.setDisabled(true);\r\n
            this.btnCustomFilter = new Common.UI.Button({\r\n
                el: $("#id-btn-custom-filter", this.$window)\r\n
            }).on("click", _.bind(this.onShowCustomFilterDialog, this));\r\n
            this.input = new Common.UI.InputField({\r\n
                el: $("#id-sd-cell-search", this.$window),\r\n
                allowBlank: true,\r\n
                placeHolder: this.txtEmpty,\r\n
                style: "margin-top: 10px;",\r\n
                validateOnChange: true,\r\n
                validation: function () {\r\n
                    return true;\r\n
                }\r\n
            }).on("changing", function (input, value) {\r\n
                if (value.length) {\r\n
                    value = value.replace(/([.?*+^$[\\]\\\\(){}|-])/g, "\\\\$1");\r\n
                    me.filter = new RegExp(value, "ig");\r\n
                } else {\r\n
                    me.filter = undefined;\r\n
                }\r\n
                me.setupDataCells();\r\n
            });\r\n
            this.cells = new Common.UI.DataViewStore();\r\n
            this.filterExcludeCells = new Common.UI.DataViewStore();\r\n
            if (this.cells) {\r\n
                this.cellsList = new Common.UI.ListView({\r\n
                    el: $("#id-dlg-filter-values", this.$window),\r\n
                    store: this.cells,\r\n
                    template: _.template([\'<div class="listview inner" style="border:none;"></div>\'].join("")),\r\n
                    itemTemplate: _.template(["<div>", \'<label class="checkbox-indeterminate" style="position:absolute;">\', "<% if (!check) { %>", \'<input type="button"/>\', "<% } else { %>", \'<input type="button" class="checked"/>\', "<% } %>", "</label>", \'<div id="<%= id %>" class="list-item" style="pointer-events:none;margin-left:20px;display:inline-block;"><%= value %></div>\', "</div>"].join(""))\r\n
                });\r\n
                this.cellsList.on("item:select", _.bind(this.onCellCheck, this));\r\n
                this.cellsList.onKeyDown = _.bind(this.onListKeyDown, this);\r\n
            }\r\n
            this.setupListCells();\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.Window.prototype.show.call(this);\r\n
            var me = this;\r\n
            if (this.input) {\r\n
                _.delay(function () {\r\n
                    me.input.$el.find("input").focus();\r\n
                },\r\n
                500, this);\r\n
            }\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            if (event.currentTarget.attributes && event.currentTarget.attributes.result) {\r\n
                if ("cancel" === event.currentTarget.attributes.result.value) {\r\n
                    this.close();\r\n
                }\r\n
            }\r\n
        },\r\n
        onApplyFilter: function () {\r\n
            if (this.testFilter()) {\r\n
                this.save();\r\n
                this.close();\r\n
            }\r\n
        },\r\n
        onSortType: function (type) {\r\n
            if (this.api && this.configTo) {\r\n
                this.api.asc_sortColFilter(type, this.configTo.asc_getCellId());\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onShowCustomFilterDialog: function () {\r\n
            var me = this,\r\n
            dlgDigitalFilter = new SSE.Views.DigitalFilterDialog({\r\n
                api: this.api\r\n
            }).on({\r\n
                "close": function () {\r\n
                    me.close();\r\n
                }\r\n
            });\r\n
            dlgDigitalFilter.setSettings(this.configTo);\r\n
            dlgDigitalFilter.show();\r\n
            this.close();\r\n
        },\r\n
        onCellCheck: function (listView, itemView, record) {\r\n
            if (this.checkCellTrigerBlock) {\r\n
                return;\r\n
            }\r\n
            var target = "",\r\n
            type = "",\r\n
            isLabel = false,\r\n
            bound = null;\r\n
            var event = window.event ? window.event : window._event;\r\n
            if (event) {\r\n
                type = event.target.type;\r\n
                target = $(event.currentTarget).find(".list-item");\r\n
                if (target.length) {\r\n
                    bound = target.get(0).getBoundingClientRect();\r\n
                    if (bound.left < event.clientX && event.clientX < bound.right && bound.top < event.clientY && event.clientY < bound.bottom) {\r\n
                        isLabel = true;\r\n
                    }\r\n
                }\r\n
                if (type === "button" || isLabel) {\r\n
                    this.updateCellCheck(listView, record);\r\n
                    _.delay(function () {\r\n
                        listView.$el.find(".listview").focus();\r\n
                    },\r\n
                    100, this);\r\n
                }\r\n
            }\r\n
        },\r\n
        onListKeyDown: function (e, data) {\r\n
            var record = null,\r\n
            listView = this.cellsList;\r\n
            if (listView.disabled) {\r\n
                return;\r\n
            }\r\n
            if (_.isUndefined(undefined)) {\r\n
                data = e;\r\n
            }\r\n
            if (data.keyCode == Common.UI.Keys.SPACE) {\r\n
                data.preventDefault();\r\n
                data.stopPropagation();\r\n
                this.updateCellCheck(listView, listView.getSelectedRec()[0]);\r\n
            } else {\r\n
                Common.UI.DataView.prototype.onKeyDown.call(this.cellsList, e, data);\r\n
            }\r\n
        },\r\n
        updateCellCheck: function (listView, record) {\r\n
            if (record && listView) {\r\n
                listView.isSuspendEvents = true;\r\n
                if ("1" !== record.get("groupid")) {\r\n
                    var check = !record.get("check");\r\n
                    this.cells.each(function (cell) {\r\n
                        cell.set("check", check);\r\n
                    });\r\n
                } else {\r\n
                    record.set("check", !record.get("check"));\r\n
                }\r\n
                this.chCustomFilter.setValue(false);\r\n
                this.btnOk.setDisabled(false);\r\n
                listView.isSuspendEvents = false;\r\n
                listView.scroller.update({\r\n
                    minScrollbarLength: 40,\r\n
                    alwaysVisibleY: true\r\n
                });\r\n
            }\r\n
        },\r\n
        setSettings: function (config) {\r\n
            this.config = config;\r\n
            this.configTo = config;\r\n
        },\r\n
        setupListCells: function () {\r\n
            function isNumeric(value) {\r\n
                return !isNaN(parseFloat(value)) && isFinite(value);\r\n
            }\r\n
            var me = this,\r\n
            isnumber, value, index = 0,\r\n
            haveUnselectedCell = false,\r\n
            throughIndex = 1,\r\n
            isCustomFilter = (this.configTo.asc_getIsCustomFilter() === true);\r\n
            if (_.isUndefined(this.config)) {\r\n
                return;\r\n
            }\r\n
            this.cells.reset();\r\n
            this.filterExcludeCells.reset();\r\n
            me.cells.push(new Common.UI.DataViewModel({\r\n
                id: ++index,\r\n
                selected: false,\r\n
                allowSelected: true,\r\n
                value: this.textSelectAll,\r\n
                groupid: "0",\r\n
                check: true,\r\n
                throughIndex: 0\r\n
            }));\r\n
            this.throughIndexes.push(true);\r\n
            this.config.asc_getResult().forEach(function (item) {\r\n
                value = item.asc_getVal();\r\n
                isnumber = isNumeric(value);\r\n
                if ("hidden" !== item.asc_getVisible()) {\r\n
                    me.cells.push(new Common.UI.DataViewModel({\r\n
                        id: ++index,\r\n
                        selected: false,\r\n
                        allowSelected: true,\r\n
                        cellvalue: value,\r\n
                        value: isnumber ? value : (value.length > 0 ? value : me.textEmptyItem),\r\n
                        rowvisible: item.asc_getVisible(),\r\n
                        intval: isnumber ? parseFloat(value) : undefined,\r\n
                        strval: !isnumber ? value : "",\r\n
                        groupid: "1",\r\n
                        check: item.asc_getVisible(),\r\n
                        throughIndex: throughIndex\r\n
                    }));\r\n
                    if (!item.asc_getVisible()) {\r\n
                        haveUnselectedCell = true;\r\n
                    }\r\n
                    me.throughIndexes.push(item.asc_getVisible());\r\n
                    ++throughIndex;\r\n
                }\r\n
            });\r\n
            this.checkCellTrigerBlock = true;\r\n
            this.cells.at(0).set("check", !haveUnselectedCell);\r\n
            this.checkCellTrigerBlock = undefined;\r\n
            this.btnSortDown.toggle(false, false);\r\n
            this.btnSortUp.toggle(false, false);\r\n
            var sort = this.config.asc_getSortState();\r\n
            if (sort) {\r\n
                if ("ascending" === sort) {\r\n
                    this.btnSortDown.toggle(true, false);\r\n
                } else {\r\n
                    this.btnSortUp.toggle(true, false);\r\n
                }\r\n
            }\r\n
            this.chCustomFilter.setValue(isCustomFilter);\r\n
            this.btnOk.setDisabled(isCustomFilter);\r\n
            this.cellsList.scroller.update({\r\n
                minScrollbarLength: 40,\r\n
                alwaysVisibleY: true\r\n
            });\r\n
            this.config = undefined;\r\n
        },\r\n
        setupDataCells: function () {\r\n
            function isNumeric(value) {\r\n
                return !isNaN(parseFloat(value)) && isFinite(value);\r\n
            }\r\n
            var me = this,\r\n
            isnumber, value, index = 0,\r\n
            applyfilter = true,\r\n
            throughIndex = 1;\r\n
            this.cells.forEach(function (item) {\r\n
                value = item.get("check");\r\n
                if (_.isUndefined(value)) {\r\n
                    value = false;\r\n
                }\r\n
                me.throughIndexes[parseInt(item.get("throughIndex"))] = item.get("check");\r\n
            });\r\n
            this.cells.reset();\r\n
            this.filterExcludeCells.reset();\r\n
            if (!me.filter) {\r\n
                me.cells.push(new Common.UI.DataViewModel({\r\n
                    id: ++index,\r\n
                    selected: false,\r\n
                    allowSelected: true,\r\n
                    value: this.textSelectAll,\r\n
                    groupid: "0",\r\n
                    check: me.throughIndexes[0],\r\n
                    throughIndex: 0\r\n
                }));\r\n
            }\r\n
            this.configTo.asc_getResult().forEach(function (item) {\r\n
                value = item.asc_getVal();\r\n
                isnumber = isNumeric(value);\r\n
                applyfilter = true;\r\n
                if (me.filter) {\r\n
                    if (null === value.match(me.filter)) {\r\n
                        applyfilter = false;\r\n
                    }\r\n
                }\r\n
                if ("hidden" !== item.asc_getVisible()) {\r\n
                    if (applyfilter) {\r\n
                        me.cells.push(new Common.UI.DataViewModel({\r\n
                            id: ++index,\r\n
                            selected: false,\r\n
                            allowSelected: true,\r\n
                            cellvalue: value,\r\n
                            value: isnumber ? value : (value.length > 0 ? value : me.textEmptyItem),\r\n
                            rowvisible: item.asc_getVisible(),\r\n
                            intval: isnumber ? parseFloat(value) : undefined,\r\n
                            strval: !isnumber ? value : "",\r\n
                            groupid: "1",\r\n
                            check: me.throughIndexes[throughIndex],\r\n
                            throughIndex: throughIndex\r\n
                        }));\r\n
                    } else {\r\n
                        me.filterExcludeCells.push(new Common.UI.DataViewModel({\r\n
                            cellvalue: value\r\n
                        }));\r\n
                    }++throughIndex;\r\n
                }\r\n
            });\r\n
            if (this.cells.length) {\r\n
                this.chCustomFilter.setValue(this.configTo.asc_getIsCustomFilter() === true);\r\n
            }\r\n
            this.cellsList.scroller.update({\r\n
                minScrollbarLength: 40,\r\n
                alwaysVisibleY: true\r\n
            });\r\n
        },\r\n
        testFilter: function () {\r\n
            var me = this,\r\n
            isValid = false;\r\n
            if (this.cells) {\r\n
                this.cells.forEach(function (item) {\r\n
                    if ("1" === item.get("groupid")) {\r\n
                        if (item.get("check")) {\r\n
                            isValid = true;\r\n
                        }\r\n
                    }\r\n
                });\r\n
            }\r\n
            if (!isValid) {\r\n
                Common.UI.warning({\r\n
                    title: this.textWarning,\r\n
                    msg: this.warnNoSelected,\r\n
                    callback: function () {\r\n
                        _.delay(function () {\r\n
                            me.input.$el.find("input").focus();\r\n
                        },\r\n
                        100, this);\r\n
                    }\r\n
                });\r\n
            }\r\n
            return isValid;\r\n
        },\r\n
        save: function () {\r\n
            if (this.api && this.configTo && this.cells && this.filterExcludeCells) {\r\n
                var options = new Asc.AutoFiltersOptions();\r\n
                if (options) {\r\n
                    options.asc_setCellId(this.configTo.asc_getCellId());\r\n
                    var me = this,\r\n
                    result_arr = [],\r\n
                    visibility;\r\n
                    this.cells.forEach(function (item) {\r\n
                        if ("1" === item.get("groupid")) {\r\n
                            if ((visibility = item.get("rowvisible")) !== "hidden") {\r\n
                                visibility = item.get("check");\r\n
                                result_arr.push(new Asc.AutoFiltersOptionsElements(item.get("cellvalue"), visibility));\r\n
                            }\r\n
                        }\r\n
                    });\r\n
                    this.filterExcludeCells.forEach(function (item) {\r\n
                        result_arr.push(new Asc.AutoFiltersOptionsElements(item.get("cellvalue"), false));\r\n
                    });\r\n
                    options.asc_setResult(result_arr);\r\n
                    options.sortState = this.configTo.asc_getSortState();\r\n
                    this.api.asc_applyAutoFilter("mainFilter", options);\r\n
                }\r\n
            }\r\n
        },\r\n
        onPrimary: function () {\r\n
            this.save();\r\n
            this.close();\r\n
            return false;\r\n
        },\r\n
        okButtonText: "Ok",\r\n
        btnCustomFilter: "Custom Filter",\r\n
        textSelectAll: "Select All",\r\n
        txtTitle: "Filter",\r\n
        warnNoSelected: "You must choose at least one value",\r\n
        textWarning: "Warning",\r\n
        cancelButtonText: "Cancel",\r\n
        textEmptyItem: "{Blanks}",\r\n
        txtEmpty: "Enter cell\'s filter"\r\n
    },\r\n
    SSE.Views.AutoFilterDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/DocumentHolder\',["core", "common/main/lib/util/utils", "common/main/lib/view/CopyWarningDialog", "spreadsheeteditor/main/app/view/DocumentHolder", "spreadsheeteditor/main/app/view/HyperlinkSettingsDialog", "spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced", "spreadsheeteditor/main/app/view/SetValueDialog", "spreadsheeteditor/main/app/view/AutoFilterDialog"], function () {\r\n
    SSE.Controllers.DocumentHolder = Backbone.Controller.extend(_.extend({\r\n
        models: [],\r\n
        collections: [],\r\n
        views: ["DocumentHolder"],\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            me.tooltips = {\r\n
                hyperlink: {},\r\n
                comment: {},\r\n
                coauth: {\r\n
                    ttHeight: 20\r\n
                },\r\n
                row_column: {\r\n
                    ttHeight: 20\r\n
                }\r\n
            };\r\n
            me.mouse = {};\r\n
            me.popupmenu = false;\r\n
            me.rangeSelectionMode = false;\r\n
            me.show_copywarning = true;\r\n
            this.wrapEvents = {\r\n
                apiHideComment: _.bind(this.onApiHideComment, this)\r\n
            };\r\n
            this.addListeners({\r\n
                "DocumentHolder": {\r\n
                    "createdelayedelements": this.onCreateDelayedElements\r\n
                }\r\n
            });\r\n
            var keymap = {};\r\n
            this.hkComments = "command+alt+h,ctrl+alt+h";\r\n
            keymap[this.hkComments] = function () {\r\n
                me.onAddComment();\r\n
            };\r\n
            Common.util.Shortcuts.delegateShortcuts({\r\n
                shortcuts: keymap\r\n
            });\r\n
        },\r\n
        onLaunch: function () {\r\n
            var me = this;\r\n
            me.documentHolder = this.createView("DocumentHolder");\r\n
            me.documentHolder.render();\r\n
            me.documentHolder.el.tabIndex = -1;\r\n
            $(document).on("mousewheel", _.bind(me.onDocumentWheel, me));\r\n
            $(document).on("mousedown", _.bind(me.onDocumentRightDown, me));\r\n
            $(document).on("mouseup", _.bind(me.onDocumentRightUp, me));\r\n
            $(document).on("keydown", _.bind(me.onDocumentKeyDown, me));\r\n
            $(window).on("resize", _.bind(me.onDocumentResize, me));\r\n
            var viewport = SSE.getController("Viewport").getView("Viewport");\r\n
            viewport.hlayout.on("layout:resizedrag", _.bind(me.onDocumentResize, me));\r\n
            Common.NotificationCenter.on({\r\n
                "window:show": function (e) {\r\n
                    me.hideHyperlinkTip();\r\n
                },\r\n
                "modal:show": function (e) {\r\n
                    me.hideCoAuthTips();\r\n
                },\r\n
                "layout:changed": function (e) {\r\n
                    me.hideHyperlinkTip();\r\n
                    me.hideCoAuthTips();\r\n
                    me.onDocumentResize();\r\n
                },\r\n
                "cells:range": function (status) {\r\n
                    me.onCellsRange(status);\r\n
                },\r\n
                "copywarning:show": function () {\r\n
                    me.show_copywarning = false;\r\n
                }\r\n
            });\r\n
        },\r\n
        onCreateDelayedElements: function (view) {\r\n
            var me = this;\r\n
            view.pmiCut.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiCopy.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiPaste.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiImgCut.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiImgCopy.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiImgPaste.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiTextCut.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiTextCopy.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiTextPaste.on("click", _.bind(me.onCopyPaste, me));\r\n
            view.pmiInsertEntire.on("click", _.bind(me.onInsertEntire, me));\r\n
            view.pmiDeleteEntire.on("click", _.bind(me.onDeleteEntire, me));\r\n
            view.pmiInsertCells.menu.on("item:click", _.bind(me.onInsertCells, me));\r\n
            view.pmiDeleteCells.menu.on("item:click", _.bind(me.onDeleteCells, me));\r\n
            view.pmiSortCells.menu.on("item:click", _.bind(me.onSortCells, me));\r\n
            view.pmiClear.menu.on("item:click", _.bind(me.onClear, me));\r\n
            view.pmiInsFunction.on("click", _.bind(me.onInsFunction, me));\r\n
            view.menuAddHyperlink.on("click", _.bind(me.onInsHyperlink, me));\r\n
            view.menuEditHyperlink.on("click", _.bind(me.onInsHyperlink, me));\r\n
            view.menuRemoveHyperlink.on("click", _.bind(me.onDelHyperlink, me));\r\n
            view.pmiRowHeight.on("click", _.bind(me.onSetSize, me));\r\n
            view.pmiColumnWidth.on("click", _.bind(me.onSetSize, me));\r\n
            view.pmiEntireHide.on("click", _.bind(me.onEntireHide, me));\r\n
            view.pmiEntireShow.on("click", _.bind(me.onEntireShow, me));\r\n
            view.pmiAddComment.on("click", _.bind(me.onAddComment, me));\r\n
            view.imgMenu.on("item:click", _.bind(me.onImgMenu, me));\r\n
            view.menuParagraphVAlign.menu.on("item:click", _.bind(me.onParagraphVAlign, me));\r\n
            view.menuAddHyperlinkShape.on("click", _.bind(me.onInsHyperlink, me));\r\n
            view.menuEditHyperlinkShape.on("click", _.bind(me.onInsHyperlink, me));\r\n
            view.menuRemoveHyperlinkShape.on("click", _.bind(me.onRemoveHyperlinkShape, me));\r\n
            view.pmiTextAdvanced.on("click", _.bind(me.onTextAdvanced, me));\r\n
            view.mnuShapeAdvanced.on("click", _.bind(me.onShapeAdvanced, me));\r\n
            view.mnuChartEdit.on("click", _.bind(me.onChartEdit, me));\r\n
            var documentHolderEl = view.cmpEl;\r\n
            if (documentHolderEl) {\r\n
                documentHolderEl.on({\r\n
                    keydown: function (e) {\r\n
                        if (e.keyCode == e.F10 && e.shiftKey) {\r\n
                            e.stopEvent();\r\n
                            me.showObjectMenu(e);\r\n
                        }\r\n
                    },\r\n
                    mousedown: function (e) {\r\n
                        if (e.target.localName == "canvas" && e.button != 2) {\r\n
                            Common.UI.Menu.Manager.hideAll();\r\n
                        }\r\n
                    },\r\n
                    click: function (e) {\r\n
                        if (me.api) {\r\n
                            me.api.isTextAreaBlur = false;\r\n
                            if (e.target.localName == "canvas") {\r\n
                                documentHolderEl.focus();\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                });\r\n
                var addEvent = function (elem, type, fn) {\r\n
                    elem.addEventListener ? elem.addEventListener(type, fn, false) : elem.attachEvent("on" + type, fn);\r\n
                };\r\n
                var eventname = (/Firefox/i.test(navigator.userAgent)) ? "DOMMouseScroll" : "mousewheel";\r\n
                addEvent(view.el, eventname, _.bind(this.onDocumentWheel, this));\r\n
            }\r\n
        },\r\n
        loadConfig: function (data) {\r\n
            this.editorConfig = data.config;\r\n
        },\r\n
        setMode: function (permissions) {\r\n
            this.permissions = permissions; ! (this.permissions.canCoAuthoring && this.permissions.isEdit && this.permissions.canComments) ? Common.util.Shortcuts.suspendEvents(this.hkComments) : Common.util.Shortcuts.resumeEvents(this.hkComments);\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.asc_registerCallback("asc_onContextMenu", _.bind(this.onApiContextMenu, this));\r\n
            this.api.asc_registerCallback("asc_onMouseMove", _.bind(this.onApiMouseMove, this));\r\n
            this.api.asc_registerCallback("asc_onHideComment", this.wrapEvents.apiHideComment);\r\n
            this.api.asc_registerCallback("asc_onHyperlinkClick", _.bind(this.onApiHyperlinkClick, this));\r\n
            this.api.asc_registerCallback("asc_onSetAFDialog", _.bind(this.onApiAutofilter, this));\r\n
            this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onApiCoAuthoringDisconnect, this));\r\n
            Common.NotificationCenter.on("api:disconnect", _.bind(this.onApiCoAuthoringDisconnect, this));\r\n
            return this;\r\n
        },\r\n
        resetApi: function (api) {\r\n
            this.api.asc_unregisterCallback("asc_onHideComment", this.wrapEvents.apiHideComment);\r\n
            this.api.asc_registerCallback("asc_onHideComment", this.wrapEvents.apiHideComment);\r\n
        },\r\n
        onCopyPaste: function (item) {\r\n
            var me = this;\r\n
            if (me.api) {\r\n
                if (typeof window["AscDesktopEditor"] === "object") {\r\n
                    (item.value == "cut") ? me.api.asc_Cut() : ((item.value == "copy") ? me.api.asc_Copy() : me.api.asc_Paste());\r\n
                } else {\r\n
                    var value = window.localStorage.getItem("sse-hide-copywarning");\r\n
                    if (! (value && parseInt(value) == 1) && me.show_copywarning) {\r\n
                        (new Common.Views.CopyWarningDialog({\r\n
                            handler: function (dontshow) {\r\n
                                (item.value == "cut") ? me.api.asc_Cut() : ((item.value == "copy") ? me.api.asc_Copy() : me.api.asc_Paste());\r\n
                                if (dontshow) {\r\n
                                    window.localStorage.setItem("sse-hide-copywarning", 1);\r\n
                                }\r\n
                                Common.NotificationCenter.trigger("edit:complete", me.documentHolder);\r\n
                            }\r\n
                        })).show();\r\n
                    } else {\r\n
                        (item.value == "cut") ? me.api.asc_Cut() : ((item.value == "copy") ? me.api.asc_Copy() : me.api.asc_Paste());\r\n
                        Common.NotificationCenter.trigger("edit:complete", me.documentHolder);\r\n
                    }\r\n
                    Common.component.Analytics.trackEvent("ToolBar", "Copy Warning");\r\n
                }\r\n
            }\r\n
        },\r\n
        onInsertEntire: function (item) {\r\n
            if (this.api) {\r\n
                switch (this.api.asc_getCellInfo().asc_getFlags().asc_getSelectionType()) {\r\n
                case c_oAscSelectionType.RangeRow:\r\n
                    this.api.asc_insertCells(c_oAscInsertOptions.InsertRows);\r\n
                    break;\r\n
                case c_oAscSelectionType.RangeCol:\r\n
                    this.api.asc_insertCells(c_oAscInsertOptions.InsertColumns);\r\n
                    break;\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Insert Entire");\r\n
            }\r\n
        },\r\n
        onInsertCells: function (menu, item) {\r\n
            if (this.api) {\r\n
                this.api.asc_insertCells(item.value);\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Insert Cells");\r\n
            }\r\n
        },\r\n
        onDeleteEntire: function (item) {\r\n
            if (this.api) {\r\n
                switch (this.api.asc_getCellInfo().asc_getFlags().asc_getSelectionType()) {\r\n
                case c_oAscSelectionType.RangeRow:\r\n
                    this.api.asc_deleteCells(c_oAscDeleteOptions.DeleteRows);\r\n
                    break;\r\n
                case c_oAscSelectionType.RangeCol:\r\n
                    this.api.asc_deleteCells(c_oAscDeleteOptions.DeleteColumns);\r\n
                    break;\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Delete Entire");\r\n
            }\r\n
        },\r\n
        onDeleteCells: function (menu, item) {\r\n
            if (this.api) {\r\n
                this.api.asc_deleteCells(item.value);\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Delete Cells");\r\n
            }\r\n
        },\r\n
        onSortCells: function (menu, item) {\r\n
            if (this.api) {\r\n
                this.api.asc_sortColFilter(item.value, "");\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Sort Cells");\r\n
            }\r\n
        },\r\n
        onClear: function (menu, item) {\r\n
            if (this.api) {\r\n
                this.api.asc_emptyCells(item.value);\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Clear");\r\n
            }\r\n
        },\r\n
        onInsFunction: function (item) {\r\n
            var controller = this.getApplication().getController("FormulaDialog");\r\n
            if (controller && this.api) {\r\n
                this.api.asc_enableKeyEvents(false);\r\n
                controller.showDialog();\r\n
            }\r\n
        },\r\n
        onInsHyperlink: function (item) {\r\n
            var me = this;\r\n
            var win, props;\r\n
            if (me.api) {\r\n
                var wc = me.api.asc_getWorksheetsCount(),\r\n
                i = -1,\r\n
                items = [];\r\n
                while (++i < wc) {\r\n
                    if (!this.api.asc_isWorksheetHidden(i)) {\r\n
                        items.push({\r\n
                            displayValue: me.api.asc_getWorksheetName(i),\r\n
                            value: me.api.asc_getWorksheetName(i)\r\n
                        });\r\n
                    }\r\n
                }\r\n
                var handlerDlg = function (dlg, result) {\r\n
                    if (result == "ok") {\r\n
                        props = dlg.getSettings();\r\n
                        me.api.asc_insertHyperlink(props);\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me.documentHolder);\r\n
                };\r\n
                var cell = me.api.asc_getCellInfo();\r\n
                props = cell.asc_getHyperlink();\r\n
                win = new SSE.Views.HyperlinkSettingsDialog({\r\n
                    handler: handlerDlg\r\n
                });\r\n
                win.show();\r\n
                win.setSettings({\r\n
                    sheets: items,\r\n
                    currentSheet: me.api.asc_getWorksheetName(me.api.asc_getActiveWorksheetIndex()),\r\n
                    props: props,\r\n
                    text: cell.asc_getText(),\r\n
                    isLock: cell.asc_getFlags().asc_getLockText(),\r\n
                    allowInternal: item.options.inCell\r\n
                });\r\n
            }\r\n
            Common.component.Analytics.trackEvent("DocumentHolder", "Add Hyperlink");\r\n
        },\r\n
        onDelHyperlink: function (item) {\r\n
            if (this.api) {\r\n
                this.api.asc_removeHyperlink();\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Remove Hyperlink");\r\n
            }\r\n
        },\r\n
        onSetSize: function (item) {\r\n
            var me = this;\r\n
            (new SSE.Views.SetValueDialog({\r\n
                title: item.caption,\r\n
                startvalue: item.options.action == "row-height" ? me.api.asc_getRowHeight() : me.api.asc_getColumnWidth(),\r\n
                maxvalue: 409,\r\n
                step: item.options.action == "row-height" ? 0.75 : 1,\r\n
                defaultUnit: item.options.action == "row-height" ? "pt" : "sym",\r\n
                handler: function (dlg, result) {\r\n
                    if (result == "ok") {\r\n
                        var val = dlg.getSettings();\r\n
                        (item.options.action == "row-height") ? me.api.asc_setRowHeight(val) : me.api.asc_setColumnWidth(val);\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me.documentHolder);\r\n
                }\r\n
            })).show();\r\n
        },\r\n
        onEntireHide: function (item) {\r\n
            if (this.api) {\r\n
                this.api[item.isrowmenu ? "asc_hideRows" : "asc_hideColumns"]();\r\n
            }\r\n
        },\r\n
        onEntireShow: function (item) {\r\n
            if (this.api) {\r\n
                this.api[item.isrowmenu ? "asc_showRows" : "asc_showColumns"]();\r\n
            }\r\n
        },\r\n
        onAddComment: function (item) {\r\n
            if (this.api && this.permissions.canCoAuthoring && this.permissions.isEdit && this.permissions.canComments) {\r\n
                this.api.asc_enableKeyEvents(false);\r\n
                var controller = SSE.getController("Common.Controllers.Comments"),\r\n
                cellinfo = this.api.asc_getCellInfo();\r\n
                if (controller) {\r\n
                    var comments = cellinfo.asc_getComments();\r\n
                    if (comments.length) {\r\n
                        controller.onEditComments(comments);\r\n
                    } else {\r\n
                        controller.addDummyComment();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onImgMenu: function (menu, item) {\r\n
            if (this.api) {\r\n
                if (item.options.type == "arrange") {\r\n
                    this.api.asc_setSelectedDrawingObjectLayer(item.value);\r\n
                    Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                    Common.component.Analytics.trackEvent("DocumentHolder", "Arrange");\r\n
                } else {\r\n
                    if (item.options.type == "group") {\r\n
                        this.api[(item.value == "grouping") ? "asc_groupGraphicsObjects" : "asc_unGroupGraphicsObjects"]();\r\n
                        Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                        Common.component.Analytics.trackEvent("DocumentHolder", (item.value == "grouping") ? "Grouping" : "Ungrouping");\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onParagraphVAlign: function (menu, item) {\r\n
            if (this.api) {\r\n
                var properties = new Asc.asc_CImgProperty();\r\n
                properties.asc_putVerticalTextAlign(item.value);\r\n
                this.api.asc_setGraphicObjectProps(properties);\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Paragraph Vertical Align");\r\n
            }\r\n
        },\r\n
        onRemoveHyperlinkShape: function (item) {\r\n
            if (this.api) {\r\n
                this.api.asc_removeHyperlink();\r\n
                Common.NotificationCenter.trigger("edit:complete", this.documentHolder);\r\n
                Common.component.Analytics.trackEvent("DocumentHolder", "Remove Hyperlink");\r\n
            }\r\n
        },\r\n
        onTextAdvanced: function (item) {\r\n
            var me = this;\r\n
            (new SSE.Views.ParagraphSettingsAdvanced({\r\n
                paragraphProps: item.textInfo,\r\n
                api: me.api,\r\n
                handler: function (result, value) {\r\n
                    if (result == "ok") {\r\n
                        if (me.api) {\r\n
                            me.api.asc_setGraphicObjectProps(value.paragraphProps);\r\n
                            Common.component.Analytics.trackEvent("DocumentHolder", "Apply advanced paragraph settings");\r\n
                        }\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me);\r\n
                }\r\n
            })).show();\r\n
        },\r\n
        onShapeAdvanced: function (item) {\r\n
            var me = this;\r\n
            (new SSE.Views.ShapeSettingsAdvanced({\r\n
                shapeProps: item.shapeInfo,\r\n
                api: me.api,\r\n
                handler: function (result, value) {\r\n
                    if (result == "ok") {\r\n
                        if (me.api) {\r\n
                            me.api.asc_setGraphicObjectProps(value.shapeProps);\r\n
                            Common.component.Analytics.trackEvent("DocumentHolder", "Apply advanced shape settings");\r\n
                        }\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me);\r\n
                }\r\n
            })).show();\r\n
        },\r\n
        onChartEdit: function (item) {\r\n
            var me = this;\r\n
            var win, props;\r\n
            if (me.api) {\r\n
                props = me.api.asc_getChartObject();\r\n
                if (props) {\r\n
                    (new SSE.Views.ChartSettingsDlg({\r\n
                        chartSettings: props,\r\n
                        api: me.api,\r\n
                        handler: function (result, value) {\r\n
                            if (result == "ok") {\r\n
                                if (me.api) {\r\n
                                    me.api.asc_editChartDrawingObject(value.chartSettings);\r\n
                                }\r\n
                            }\r\n
                            Common.NotificationCenter.trigger("edit:complete", me);\r\n
                        }\r\n
                    })).show();\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiCoAuthoringDisconnect: function () {\r\n
            this.permissions.isEdit = false;\r\n
        },\r\n
        hideCoAuthTips: function () {\r\n
            if (this.tooltips.coauth.ref) {\r\n
                $(this.tooltips.coauth.ref).remove();\r\n
                this.tooltips.coauth.ref = undefined;\r\n
                this.tooltips.coauth.x_point = undefined;\r\n
                this.tooltips.coauth.y_point = undefined;\r\n
            }\r\n
        },\r\n
        hideHyperlinkTip: function () {\r\n
            if (!this.tooltips.hyperlink.isHidden && this.tooltips.hyperlink.ref) {\r\n
                this.tooltips.hyperlink.ref.hide();\r\n
                this.tooltips.hyperlink.isHidden = true;\r\n
            }\r\n
        },\r\n
        onApiMouseMove: function (dataarray) {\r\n
            if (!this._isFullscreenMenu && dataarray.length) {\r\n
                var index_hyperlink, index_comments, index_locked, index_column, index_row;\r\n
                for (var i = dataarray.length; i > 0; i--) {\r\n
                    switch (dataarray[i - 1].asc_getType()) {\r\n
                    case c_oAscMouseMoveType.Hyperlink:\r\n
                        index_hyperlink = i;\r\n
                        break;\r\n
                    case c_oAscMouseMoveType.Comment:\r\n
                        index_comments = i;\r\n
                        break;\r\n
                    case c_oAscMouseMoveType.LockedObject:\r\n
                        index_locked = i;\r\n
                        break;\r\n
                    case c_oAscMouseMoveType.ResizeColumn:\r\n
                        index_column = i;\r\n
                        break;\r\n
                    case c_oAscMouseMoveType.ResizeRow:\r\n
                        index_row = i;\r\n
                        break;\r\n
                    }\r\n
                }\r\n
                var me = this,\r\n
                showPoint = [0, 0],\r\n
                coAuthTip = me.tooltips.coauth,\r\n
                commentTip = me.tooltips.comment,\r\n
                hyperlinkTip = me.tooltips.hyperlink,\r\n
                row_columnTip = me.tooltips.row_column,\r\n
                pos = [me.documentHolder.cmpEl.offset().left - $(window).scrollLeft(), me.documentHolder.cmpEl.offset().top - $(window).scrollTop()];\r\n
                hyperlinkTip.isHidden = false;\r\n
                row_columnTip.isHidden = false;\r\n
                var getUserName = function (id) {\r\n
                    var usersStore = SSE.getCollection("Common.Collections.Users");\r\n
                    if (usersStore) {\r\n
                        var rec = usersStore.findUser(id);\r\n
                        if (rec) {\r\n
                            return rec.get("username");\r\n
                        }\r\n
                    }\r\n
                    return me.guestText;\r\n
                };\r\n
                if (index_hyperlink) {\r\n
                    var data = dataarray[index_hyperlink - 1],\r\n
                    props = data.asc_getHyperlink();\r\n
                    if (props.asc_getType() == c_oAscHyperlinkType.WebLink) {\r\n
                        var linkstr = props.asc_getTooltip();\r\n
                        if (linkstr) {\r\n
                            linkstr = Common.Utils.String.htmlEncode(linkstr) + "<br><b>" + me.textCtrlClick + "</b>";\r\n
                        } else {\r\n
                            linkstr = props.asc_getHyperlinkUrl() + "<br><b>" + me.textCtrlClick + "</b>";\r\n
                        }\r\n
                    } else {\r\n
                        linkstr = props.asc_getTooltip() || (props.asc_getSheet() + "!" + props.asc_getRange());\r\n
                    }\r\n
                    if (hyperlinkTip.ref && hyperlinkTip.ref.isVisible()) {\r\n
                        if (hyperlinkTip.text != linkstr) {\r\n
                            hyperlinkTip.ref.hide();\r\n
                            hyperlinkTip.isHidden = true;\r\n
                        }\r\n
                    }\r\n
                    if (!hyperlinkTip.ref || !hyperlinkTip.ref.isVisible()) {\r\n
                        hyperlinkTip.text = linkstr;\r\n
                        hyperlinkTip.ref = new Common.UI.Tooltip({\r\n
                            owner: me.documentHolder,\r\n
                            html: true,\r\n
                            title: linkstr\r\n
                        }).on("tooltip:hide", function (tip) {\r\n
                            hyperlinkTip.ref = undefined;\r\n
                            hyperlinkTip.text = "";\r\n
                        });\r\n
                        hyperlinkTip.ref.show([-10000, -10000]);\r\n
                        hyperlinkTip.isHidden = false;\r\n
                    }\r\n
                    showPoint = [data.asc_getX(), data.asc_getY()];\r\n
                    showPoint[0] += (pos[0] + 6);\r\n
                    showPoint[1] += (pos[1] - 20);\r\n
                    showPoint[1] -= hyperlinkTip.ref.getBSTip().$tip.height();\r\n
                    var tipwidth = hyperlinkTip.ref.getBSTip().$tip.width();\r\n
                    if (showPoint[0] + tipwidth > me.tooltips.coauth.bodyWidth) {\r\n
                        showPoint[0] = me.tooltips.coauth.bodyWidth - tipwidth;\r\n
                    }\r\n
                    hyperlinkTip.ref.getBSTip().$tip.css({\r\n
                        top: showPoint[1] + "px",\r\n
                        left: showPoint[0] + "px"\r\n
                    });\r\n
                } else {\r\n
                    me.hideHyperlinkTip();\r\n
                }\r\n
                if (index_column !== undefined || index_row !== undefined) {\r\n
                    var data = dataarray[(index_column !== undefined) ? (index_column - 1) : (index_row - 1)];\r\n
                    var str = Common.Utils.String.format((index_column !== undefined) ? this.textChangeColumnWidth : this.textChangeRowHeight, data.asc_getSizeCCOrPt().toFixed(2), data.asc_getSizePx());\r\n
                    if (row_columnTip.ref && row_columnTip.ref.isVisible()) {\r\n
                        if (row_columnTip.text != str) {\r\n
                            row_columnTip.text = str;\r\n
                            row_columnTip.ref.setTitle(str);\r\n
                            row_columnTip.ref.updateTitle();\r\n
                        }\r\n
                    }\r\n
                    if (!row_columnTip.ref || !row_columnTip.ref.isVisible()) {\r\n
                        row_columnTip.text = str;\r\n
                        row_columnTip.ref = new Common.UI.Tooltip({\r\n
                            owner: me.documentHolder,\r\n
                            html: true,\r\n
                            title: str\r\n
                        }).on("tooltip:hide", function (tip) {\r\n
                            row_columnTip.ref = undefined;\r\n
                            row_columnTip.text = "";\r\n
                        });\r\n
                        row_columnTip.ref.show([-10000, -10000]);\r\n
                        row_columnTip.isHidden = false;\r\n
                        showPoint = [data.asc_getX(), data.asc_getY()];\r\n
                        showPoint[0] += (pos[0] + 6);\r\n
                        showPoint[1] += (pos[1] - 20 - row_columnTip.ttHeight);\r\n
                        var tipwidth = row_columnTip.ref.getBSTip().$tip.width();\r\n
                        if (showPoint[0] + tipwidth > me.tooltips.coauth.bodyWidth) {\r\n
                            showPoint[0] = me.tooltips.coauth.bodyWidth - tipwidth - 20;\r\n
                        }\r\n
                        row_columnTip.ref.getBSTip().$tip.css({\r\n
                            top: showPoint[1] + "px",\r\n
                            left: showPoint[0] + "px"\r\n
                        });\r\n
                    }\r\n
                } else {\r\n
                    if (!row_columnTip.isHidden && row_columnTip.ref) {\r\n
                        row_columnTip.ref.hide();\r\n
                        row_columnTip.isHidden = true;\r\n
                    }\r\n
                }\r\n
                if (me.permissions.isEdit) {\r\n
                    if (index_comments && !this.popupmenu) {\r\n
                        data = dataarray[index_comments - 1];\r\n
                        if (!commentTip.editCommentId && commentTip.moveCommentId != data.asc_getCommentIndexes()[0]) {\r\n
                            commentTip.moveCommentId = data.asc_getCommentIndexes()[0];\r\n
                            if (commentTip.moveCommentTimer) {\r\n
                                clearTimeout(commentTip.moveCommentTimer);\r\n
                            }\r\n
                            var idxs = data.asc_getCommentIndexes(),\r\n
                            x = data.asc_getX(),\r\n
                            y = data.asc_getY(),\r\n
                            leftx = data.asc_getReverseX();\r\n
                            commentTip.moveCommentTimer = setTimeout(function () {\r\n
                                if (commentTip.moveCommentId && !commentTip.editCommentId) {\r\n
                                    commentTip.viewCommentId = commentTip.moveCommentId;\r\n
                                    var commentsController = me.getApplication().getController("Common.Controllers.Comments");\r\n
                                    if (commentsController) {\r\n
                                        if (!commentsController.isSelectedComment) {\r\n
                                            commentsController.onApiShowComment(idxs, x, y, leftx, false, true);\r\n
                                        }\r\n
                                    }\r\n
                                }\r\n
                            },\r\n
                            400);\r\n
                        }\r\n
                    } else {\r\n
                        commentTip.moveCommentId = undefined;\r\n
                        if (commentTip.viewCommentId != undefined) {\r\n
                            commentTip = {};\r\n
                            var commentsController = this.getApplication().getController("Common.Controllers.Comments");\r\n
                            if (commentsController) {\r\n
                                commentsController.onApiHideComment(true);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    if (index_locked) {\r\n
                        data = dataarray[index_locked - 1];\r\n
                        if (!coAuthTip.XY) {\r\n
                            me.onDocumentResize();\r\n
                        }\r\n
                        if (coAuthTip.x_point != data.asc_getX() || coAuthTip.y_point != data.asc_getY()) {\r\n
                            me.hideCoAuthTips();\r\n
                            coAuthTip.x_point = data.asc_getX();\r\n
                            coAuthTip.y_point = data.asc_getY();\r\n
                            var src = $(document.createElement("div")),\r\n
                            is_sheet_lock = data.asc_getLockedObjectType() == c_oAscMouseMoveLockedObjectType.Sheet || data.asc_getLockedObjectType() == c_oAscMouseMoveLockedObjectType.TableProperties;\r\n
                            coAuthTip.ref = src;\r\n
                            src.addClass("username-tip");\r\n
                            src.css({\r\n
                                height: coAuthTip.ttHeight + "px",\r\n
                                position: "absolute",\r\n
                                zIndex: "900",\r\n
                                visibility: "visible"\r\n
                            });\r\n
                            $(document.body).append(src);\r\n
                            showPoint = [coAuthTip.x_point + coAuthTip.XY[0], coAuthTip.y_point + coAuthTip.XY[1]]; ! is_sheet_lock && (showPoint[0] = coAuthTip.bodyWidth - showPoint[0]);\r\n
                            if (showPoint[1] > coAuthTip.XY[1] && showPoint[1] + coAuthTip.ttHeight < coAuthTip.XY[1] + coAuthTip.apiHeight) {\r\n
                                src.text(getUserName(data.asc_getUserId()));\r\n
                                if (coAuthTip.bodyWidth - showPoint[0] < coAuthTip.ref.width()) {\r\n
                                    src.css({\r\n
                                        visibility: "visible",\r\n
                                        left: "0px"

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAA4=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="14" aka="AAAAAAAAAA4=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

,\r\n
                                        top: (showPoint[1] - coAuthTip.ttHeight) + "px"\r\n
                                    });\r\n
                                } else {\r\n
                                    src.css({\r\n
                                        visibility: "visible",\r\n
                                        right: showPoint[0] + "px",\r\n
                                        top: showPoint[1] + "px"\r\n
                                    });\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    } else {\r\n
                        me.hideCoAuthTips();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiHideComment: function () {\r\n
            this.tooltips.comment.viewCommentId = this.tooltips.comment.editCommentId = this.tooltips.comment.moveCommentId = undefined;\r\n
        },\r\n
        onApiHyperlinkClick: function (url) {\r\n
            if (url) {\r\n
                var isvalid = url.strongMatch(Common.Utils.hostnameRe); ! isvalid && (isvalid = url.strongMatch(Common.Utils.emailRe)); ! isvalid && (isvalid = url.strongMatch(Common.Utils.ipRe)); ! isvalid && (isvalid = url.strongMatch(Common.Utils.localRe));\r\n
                if (isvalid) {\r\n
                    var newDocumentPage = window.open(url, "_blank");\r\n
                    if (newDocumentPage) {\r\n
                        newDocumentPage.focus();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiAutofilter: function (config) {\r\n
            var me = this;\r\n
            if (me.permissions.isEdit) {\r\n
                var dlgFilter = new SSE.Views.AutoFilterDialog({\r\n
                    api: this.api\r\n
                }).on({\r\n
                    "close": function () {\r\n
                        if (me.api) {\r\n
                            me.api.asc_enableKeyEvents(true);\r\n
                        }\r\n
                    }\r\n
                });\r\n
                if (me.api) {\r\n
                    me.api.asc_enableKeyEvents(false);\r\n
                }\r\n
                Common.UI.Menu.Manager.hideAll();\r\n
                dlgFilter.setSettings(config);\r\n
                dlgFilter.show();\r\n
            }\r\n
        },\r\n
        onApiContextMenu: function (event) {\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                me.showObjectMenu.call(me, event);\r\n
            },\r\n
            10);\r\n
        },\r\n
        onAfterRender: function (view) {},\r\n
        onDocumentResize: function (e) {\r\n
            var me = this;\r\n
            if (me.documentHolder) {\r\n
                me.tooltips.coauth.XY = [me.documentHolder.cmpEl.offset().left - $(window).scrollLeft(), me.documentHolder.cmpEl.offset().top - $(window).scrollTop()];\r\n
                me.tooltips.coauth.apiHeight = me.documentHolder.cmpEl.height();\r\n
                me.tooltips.coauth.bodyWidth = $(window).width();\r\n
            }\r\n
        },\r\n
        onDocumentWheel: function (e) {\r\n
            if (this.api) {\r\n
                var delta = (_.isUndefined(e.originalEvent)) ? e.wheelDelta : e.originalEvent.wheelDelta;\r\n
                if (_.isUndefined(delta)) {\r\n
                    delta = e.deltaY;\r\n
                }\r\n
                if (e.ctrlKey || e.metaKey) {\r\n
                    var factor = this.api.asc_getZoom();\r\n
                    if (delta < 0) {\r\n
                        factor -= 0.1;\r\n
                        if (! (factor < 0.5)) {\r\n
                            this.api.asc_setZoom(factor);\r\n
                        }\r\n
                    } else {\r\n
                        if (delta > 0) {\r\n
                            factor += 0.1;\r\n
                            if (factor > 0 && !(factor > 2)) {\r\n
                                this.api.asc_setZoom(factor);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    e.preventDefault();\r\n
                    e.stopPropagation();\r\n
                }\r\n
            }\r\n
        },\r\n
        onDocumentKeyDown: function (event) {\r\n
            if (this.api) {\r\n
                var key = event.keyCode;\r\n
                if ((event.ctrlKey || event.metaKey) && !event.shiftKey) {\r\n
                    if (key === Common.UI.Keys.NUM_PLUS || key === Common.UI.Keys.EQUALITY || (Common.Utils.isOpera && key == 43)) {\r\n
                        if (!this.api.isCellEdited) {\r\n
                            var factor = this.api.asc_getZoom() + 0.1;\r\n
                            if (factor > 0 && !(factor > 2)) {\r\n
                                this.api.asc_setZoom(factor);\r\n
                            }\r\n
                            event.preventDefault();\r\n
                            event.stopPropagation();\r\n
                            return false;\r\n
                        }\r\n
                    } else {\r\n
                        if (key === Common.UI.Keys.NUM_MINUS || key === Common.UI.Keys.MINUS || (Common.Utils.isOpera && key == 45)) {\r\n
                            if (!this.api.isCellEdited) {\r\n
                                factor = this.api.asc_getZoom() - 0.1;\r\n
                                if (! (factor < 0.5)) {\r\n
                                    this.api.asc_setZoom(factor);\r\n
                                }\r\n
                                event.preventDefault();\r\n
                                event.stopPropagation();\r\n
                                return false;\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                } else {\r\n
                    if (key == Common.UI.Keys.F10 && event.shiftKey) {\r\n
                        this.showObjectMenu(event);\r\n
                        event.preventDefault();\r\n
                        event.stopPropagation();\r\n
                        return false;\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onDocumentRightDown: function (event) {\r\n
            event.button == 0 && (this.mouse.isLeftButtonDown = true);\r\n
        },\r\n
        onDocumentRightUp: function (event) {\r\n
            event.button == 0 && (this.mouse.isLeftButtonDown = false);\r\n
        },\r\n
        showObjectMenu: function (event) {\r\n
            if (this.api && this.permissions.isEdit && !this.mouse.isLeftButtonDown && !this.rangeSelectionMode) {\r\n
                var iscellmenu, isrowmenu, iscolmenu, isallmenu, ischartmenu, isimagemenu, istextshapemenu, isshapemenu, istextchartmenu, documentHolder = this.documentHolder,\r\n
                cellinfo = this.api.asc_getCellInfo(),\r\n
                seltype = cellinfo.asc_getFlags().asc_getSelectionType(),\r\n
                isCellLocked = cellinfo.asc_getLocked(),\r\n
                isObjLocked = false,\r\n
                commentsController = this.getApplication().getController("Common.Controllers.Comments");\r\n
                if (!this.permissions.isEditDiagram) {\r\n
                    switch (seltype) {\r\n
                    case c_oAscSelectionType.RangeCells:\r\n
                        iscellmenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeRow:\r\n
                        isrowmenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeCol:\r\n
                        iscolmenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeMax:\r\n
                        isallmenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeImage:\r\n
                        isimagemenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeShape:\r\n
                        isshapemenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeChart:\r\n
                        ischartmenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeChartText:\r\n
                        istextchartmenu = true;\r\n
                        break;\r\n
                    case c_oAscSelectionType.RangeShapeText:\r\n
                        istextshapemenu = true;\r\n
                        break;\r\n
                    }\r\n
                } else {\r\n
                    var insfunc = (seltype == c_oAscSelectionType.RangeCells);\r\n
                }\r\n
                if (isimagemenu || isshapemenu || ischartmenu) {\r\n
                    isimagemenu = isshapemenu = ischartmenu = false;\r\n
                    var has_chartprops = false;\r\n
                    var selectedObjects = this.api.asc_getGraphicObjectProps();\r\n
                    for (var i = 0; i < selectedObjects.length; i++) {\r\n
                        if (selectedObjects[i].asc_getObjectType() == c_oAscTypeSelectElement.Image) {\r\n
                            var elValue = selectedObjects[i].asc_getObjectValue();\r\n
                            isObjLocked = isObjLocked || elValue.asc_getLocked();\r\n
                            var shapeprops = elValue.asc_getShapeProperties();\r\n
                            if (shapeprops) {\r\n
                                if (shapeprops.asc_getFromChart()) {\r\n
                                    ischartmenu = true;\r\n
                                } else {\r\n
                                    documentHolder.mnuShapeAdvanced.shapeInfo = elValue;\r\n
                                    isshapemenu = true;\r\n
                                }\r\n
                            } else {\r\n
                                if (elValue.asc_getChartProperties()) {\r\n
                                    ischartmenu = true;\r\n
                                    has_chartprops = true;\r\n
                                } else {\r\n
                                    isimagemenu = true;\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    documentHolder.mnuUnGroupImg.setDisabled(isObjLocked || !this.api.asc_canUnGroupGraphicsObjects());\r\n
                    documentHolder.mnuGroupImg.setDisabled(isObjLocked || !this.api.asc_canGroupGraphicsObjects());\r\n
                    documentHolder.mnuShapeAdvanced.setVisible(isshapemenu && !isimagemenu && !ischartmenu);\r\n
                    documentHolder.mnuShapeAdvanced.setDisabled(isObjLocked);\r\n
                    documentHolder.mnuChartEdit.setVisible(ischartmenu && !isimagemenu && !isshapemenu && has_chartprops);\r\n
                    documentHolder.mnuChartEdit.setDisabled(isObjLocked);\r\n
                    documentHolder.pmiImgCut.setDisabled(isObjLocked);\r\n
                    documentHolder.pmiImgPaste.setDisabled(isObjLocked);\r\n
                    this.showPopupMenu(documentHolder.imgMenu, {},\r\n
                    event);\r\n
                    documentHolder.mnuShapeSeparator.setVisible(documentHolder.mnuShapeAdvanced.isVisible() || documentHolder.mnuChartEdit.isVisible());\r\n
                } else {\r\n
                    if (istextshapemenu || istextchartmenu) {\r\n
                        documentHolder.pmiTextAdvanced.textInfo = undefined;\r\n
                        var selectedObjects = this.api.asc_getGraphicObjectProps();\r\n
                        for (var i = 0; i < selectedObjects.length; i++) {\r\n
                            var elType = selectedObjects[i].asc_getObjectType();\r\n
                            if (elType == c_oAscTypeSelectElement.Image) {\r\n
                                var value = selectedObjects[i].asc_getObjectValue(),\r\n
                                align = value.asc_getVerticalTextAlign();\r\n
                                isObjLocked = isObjLocked || value.asc_getLocked();\r\n
                                documentHolder.menuParagraphTop.setChecked(align == c_oAscVerticalTextAlign.TEXT_ALIGN_TOP);\r\n
                                documentHolder.menuParagraphCenter.setChecked(align == c_oAscVerticalTextAlign.TEXT_ALIGN_CTR);\r\n
                                documentHolder.menuParagraphBottom.setChecked(align == c_oAscVerticalTextAlign.TEXT_ALIGN_BOTTOM);\r\n
                            } else {\r\n
                                if (elType == c_oAscTypeSelectElement.Paragraph) {\r\n
                                    documentHolder.pmiTextAdvanced.textInfo = selectedObjects[i].asc_getObjectValue();\r\n
                                    isObjLocked = isObjLocked || documentHolder.pmiTextAdvanced.textInfo.asc_getLocked();\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                        var hyperinfo = cellinfo.asc_getHyperlink(),\r\n
                        can_add_hyperlink = this.api.asc_canAddShapeHyperlink();\r\n
                        documentHolder.menuHyperlinkShape.setVisible(istextshapemenu && can_add_hyperlink !== false && hyperinfo);\r\n
                        documentHolder.menuAddHyperlinkShape.setVisible(istextshapemenu && can_add_hyperlink !== false && !hyperinfo);\r\n
                        documentHolder.menuParagraphVAlign.setVisible(istextchartmenu !== true);\r\n
                        documentHolder.pmiTextAdvanced.setVisible(documentHolder.pmiTextAdvanced.textInfo !== undefined);\r\n
                        _.each(documentHolder.textInShapeMenu.items, function (item) {\r\n
                            item.setDisabled(isObjLocked);\r\n
                        });\r\n
                        documentHolder.pmiTextCopy.setDisabled(false);\r\n
                        this.showPopupMenu(documentHolder.textInShapeMenu, {},\r\n
                        event);\r\n
                        documentHolder.textInShapeMenu.items[3].setVisible(documentHolder.menuHyperlinkShape.isVisible() || documentHolder.menuAddHyperlinkShape.isVisible() || documentHolder.menuParagraphVAlign.isVisible());\r\n
                    } else {\r\n
                        if (!this.permissions.isEditDiagram || (seltype !== c_oAscSelectionType.RangeImage && seltype !== c_oAscSelectionType.RangeShape && seltype !== c_oAscSelectionType.RangeChart && seltype !== c_oAscSelectionType.RangeChartText && seltype !== c_oAscSelectionType.RangeShapeText)) {\r\n
                            var iscelledit = this.api.isCellEdited;\r\n
                            documentHolder.pmiInsertEntire.setVisible(isrowmenu || iscolmenu);\r\n
                            documentHolder.pmiDeleteEntire.setVisible(isrowmenu || iscolmenu);\r\n
                            documentHolder.pmiInsertCells.setVisible(iscellmenu && !iscelledit);\r\n
                            documentHolder.pmiDeleteCells.setVisible(iscellmenu && !iscelledit);\r\n
                            documentHolder.pmiSortCells.setVisible((iscellmenu || isallmenu) && !iscelledit);\r\n
                            documentHolder.pmiInsFunction.setVisible(iscellmenu || insfunc);\r\n
                            var hyperinfo = cellinfo.asc_getHyperlink();\r\n
                            documentHolder.menuHyperlink.setVisible(iscellmenu && hyperinfo && !iscelledit);\r\n
                            documentHolder.menuAddHyperlink.setVisible(iscellmenu && !hyperinfo && !iscelledit);\r\n
                            documentHolder.pmiRowHeight.setVisible(isrowmenu || isallmenu);\r\n
                            documentHolder.pmiColumnWidth.setVisible(iscolmenu || isallmenu);\r\n
                            documentHolder.pmiEntireHide.setVisible(iscolmenu || isrowmenu);\r\n
                            documentHolder.pmiEntireShow.setVisible(iscolmenu || isrowmenu);\r\n
                            documentHolder.ssMenu.items[10].setVisible(iscellmenu && !iscelledit && this.permissions.canCoAuthoring && this.permissions.canComments);\r\n
                            documentHolder.pmiAddComment.setVisible(iscellmenu && !iscelledit && this.permissions.canCoAuthoring && this.permissions.canComments);\r\n
                            documentHolder.pmiCellMenuSeparator.setVisible(iscellmenu || isrowmenu || iscolmenu || isallmenu || insfunc);\r\n
                            documentHolder.pmiEntireHide.isrowmenu = isrowmenu;\r\n
                            documentHolder.pmiEntireShow.isrowmenu = isrowmenu;\r\n
                            documentHolder.setMenuItemCommentCaptionMode(cellinfo.asc_getComments().length > 0);\r\n
                            commentsController && commentsController.blockPopover(true);\r\n
                            documentHolder.pmiClear.menu.items[1].setDisabled(iscelledit);\r\n
                            documentHolder.pmiClear.menu.items[2].setDisabled(iscelledit);\r\n
                            documentHolder.pmiClear.menu.items[3].setDisabled(iscelledit);\r\n
                            documentHolder.pmiClear.menu.items[4].setDisabled(iscelledit);\r\n
                            _.each(documentHolder.ssMenu.items, function (item) {\r\n
                                item.setDisabled(isCellLocked);\r\n
                            });\r\n
                            documentHolder.pmiCopy.setDisabled(false);\r\n
                            this.showPopupMenu(documentHolder.ssMenu, {},\r\n
                            event);\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        showPopupMenu: function (menu, value, event) {\r\n
            if (!_.isUndefined(menu) && menu !== null) {\r\n
                Common.UI.Menu.Manager.hideAll();\r\n
                var me = this,\r\n
                documentHolderView = me.documentHolder,\r\n
                showPoint = [event.pageX - documentHolderView.cmpEl.offset().left, event.pageY - documentHolderView.cmpEl.offset().top],\r\n
                menuContainer = documentHolderView.cmpEl.find(Common.Utils.String.format("#menu-container-{0}", menu.id));\r\n
                if (!menu.rendered) {\r\n
                    if (menuContainer.length < 1) {\r\n
                        menuContainer = $(Common.Utils.String.format(\'<div id="menu-container-{0}" style="position: absolute; z-index: 10000;"><div class="dropdown-toggle" data-toggle="dropdown"></div></div>\', menu.id));\r\n
                        documentHolderView.cmpEl.append(menuContainer);\r\n
                    }\r\n
                    menu.render(menuContainer);\r\n
                    menu.cmpEl.attr({\r\n
                        tabindex: "-1"\r\n
                    });\r\n
                }\r\n
                if (\r\n
                /*this.mouse.isRightButtonDown &&*/\r\n
                event.button !== 2) {\r\n
                    var coord = me.api.asc_getActiveCellCoord(),\r\n
                    offset = {\r\n
                        left: 0,\r\n
                        top: 0\r\n
                    };\r\n
                    showPoint[0] = coord.asc_getX() + coord.asc_getWidth() + offset.left;\r\n
                    showPoint[1] = (coord.asc_getY() < 0 ? 0 : coord.asc_getY()) + coord.asc_getHeight() + offset.top;\r\n
                }\r\n
                menuContainer.css({\r\n
                    left: showPoint[0],\r\n
                    top: showPoint[1]\r\n
                });\r\n
                if (_.isFunction(menu.options.initMenu)) {\r\n
                    menu.options.initMenu(value);\r\n
                    menu.alignPosition();\r\n
                }\r\n
                _.delay(function () {\r\n
                    menu.cmpEl.focus();\r\n
                },\r\n
                10);\r\n
                menu.show();\r\n
            }\r\n
        },\r\n
        onCellsRange: function (status) {\r\n
            this.rangeSelectionMode = (status != c_oAscSelectionDialogType.None);\r\n
        },\r\n
        guestText: "Guest",\r\n
        textCtrlClick: "Press CTRL and click link",\r\n
        txtRowHeight: "Row Height",\r\n
        txtHeight: "Height",\r\n
        txtWidth: "Width",\r\n
        tipIsLocked: "This element is being edited by another user.",\r\n
        textChangeColumnWidth: "Column Width {0} symbols ({1} pixels)",\r\n
        textChangeRowHeight: "Row Height {0} points ({1} pixels)"\r\n
    },\r\n
    SSE.Controllers.DocumentHolder || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/CellEditor.template\',[],function () { return \'<div class="ce-group-name">\\r\\n    <input id="ce-cell-name" class="aslabel form-control" type="text">\\r\\n    <button id="ce-func-label" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon">&nbsp;</span></button>\\r\\n</div>\\r\\n<div class="ce-group-expand">\\r\\n    <button id="ce-btn-expand" type="button" class="btn"><span class="caret">&nbsp;</span></button>\\r\\n</div>\\r\\n<div class="ce-group-content">\\r\\n    <textarea id="ce-cell-content" class="form-control" spellcheck="false" rows="1" cols="20"></textarea>\\r\\n</div>\\r\\n\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/CellEditor\',["text!spreadsheeteditor/main/app/template/CellEditor.template", "common/main/lib/component/BaseView"], function (template) {\r\n
    SSE.Views.CellEditor = Common.UI.BaseView.extend({\r\n
        template: _.template(template),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.$cellname = $("#ce-cell-name", this.el);\r\n
            this.$btnexpand = $("#ce-btn-expand", this.el);\r\n
            this.$btnfunc = $("#ce-func-label", this.el);\r\n
            this.$btnfunc.addClass("disabled");\r\n
            this.$btnfunc.tooltip({\r\n
                title: this.tipFormula,\r\n
                placement: "cursor"\r\n
            });\r\n
            return this;\r\n
        },\r\n
        updateCellInfo: function (info) {\r\n
            if (info) {\r\n
                this.$cellname.val(typeof(info) == "string" ? info : info.asc_getName());\r\n
            }\r\n
        },\r\n
        tipFormula: "Insert Function"\r\n
    },\r\n
    SSE.Views.CellEditor || {});\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/CellEditor\',["core", "spreadsheeteditor/main/app/view/CellEditor"], function (Viewport) {\r\n
    SSE.Controllers.CellEditor = Backbone.Controller.extend({\r\n
        views: ["CellEditor"],\r\n
        events: function () {\r\n
            return {\r\n
                "keyup input#ce-cell-name": _.bind(this.onCellName, this),\r\n
                "keyup textarea#ce-cell-content": _.bind(this.onKeyupCellEditor, this),\r\n
                "blur textarea#ce-cell-content": _.bind(this.onBlurCellEditor, this),\r\n
                "click button#ce-btn-expand": _.bind(this.expandEditorField, this),\r\n
                "click button#ce-func-label": _.bind(this.onInsertFunction, this)\r\n
            };\r\n
        },\r\n
        initialize: function () {\r\n
            this.addListeners({\r\n
                "CellEditor": {},\r\n
                "Viewport": {\r\n
                    "layout:resizedrag": _.bind(this.onLayoutResize, this)\r\n
                }\r\n
            });\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.isCEditorFocused = false;\r\n
            this.api.asc_registerCallback("asc_onSelectionNameChanged", _.bind(this.onApiCellSelection, this));\r\n
            this.api.asc_registerCallback("asc_onEditCell", _.bind(this.onApiEditCell, this));\r\n
            this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onApiDisconnect, this));\r\n
            Common.NotificationCenter.on("api:disconnect", _.bind(this.onApiDisconnect, this));\r\n
            Common.NotificationCenter.on("cells:range", _.bind(this.onCellsRange, this));\r\n
            return this;\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = mode;\r\n
            this.editor.$btnfunc[this.mode.isEdit ? "removeClass" : "addClass"]("disabled");\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.editor = this.createView("CellEditor", {\r\n
                el: "#cell-editing-box"\r\n
            }).render();\r\n
            this.bindViewEvents(this.editor, this.events);\r\n
            this.editor.$el.parent().find(".after").css({\r\n
                zIndex: "4"\r\n
            });\r\n
            var me = this;\r\n
            $("#ce-cell-content").keydown(function (e) {\r\n
                if (Common.UI.Keys.RETURN === e.keyCode || Common.UI.Keys.ESC === e.keyCode) {\r\n
                    me.api.asc_enableKeyEvents(true);\r\n
                }\r\n
            });\r\n
        },\r\n
        onApiEditCell: function (state) {\r\n
            if (state == c_oAscCellEditorState.editStart) {\r\n
                this.api.isCellEdited = true;\r\n
            } else {\r\n
                if (state == c_oAscCellEditorState.editEnd) {\r\n
                    this.api.isCellEdited = false;\r\n
                    this.api.isCEditorFocused = false;\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiCellSelection: function (info) {\r\n
            this.editor.updateCellInfo(info);\r\n
        },\r\n
        onApiDisconnect: function () {\r\n
            this.mode.isEdit = false;\r\n
            var controller = this.getApplication().getController("FormulaDialog");\r\n
            if (controller) {\r\n
                controller.hideDialog();\r\n
            }\r\n
            if (!this.mode.isEdit) {\r\n
                $("#ce-func-label", this.editor.el).addClass("disabled");\r\n
            }\r\n
        },\r\n
        onCellsRange: function (status) {\r\n
            var isRangeSelection = (status != c_oAscSelectionDialogType.None);\r\n
            if (isRangeSelection) {\r\n
                this.editor.$cellname.attr("disabled", "disabled");\r\n
                this.editor.$btnfunc["addClass"]("disabled");\r\n
            } else {\r\n
                this.editor.$cellname.removeAttr("disabled");\r\n
                this.editor.$btnfunc["removeClass"]("disabled");\r\n
            }\r\n
        },\r\n
        onLayoutResize: function (o, r) {\r\n
            if (r == "cell:edit") {\r\n
                if (this.editor.$el.height() > 19) {\r\n
                    if (!this.editor.$btnexpand.hasClass("btn-collapse")) {\r\n
                        this.editor.$btnexpand["addClass"]("btn-collapse");\r\n
                    }\r\n
                } else {\r\n
                    this.editor.$btnexpand["removeClass"]("btn-collapse");\r\n
                }\r\n
            }\r\n
        },\r\n
        onCellName: function (e) {\r\n
            if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                var name = this.editor.$cellname.val();\r\n
                if (name && name.length) {\r\n
                    this.api.asc_findCell(name);\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this.editor);\r\n
            }\r\n
        },\r\n
        onBlurCellEditor: function () {\r\n
            if (this.api.isCEditorFocused == "clear") {\r\n
                this.api.isCEditorFocused = undefined;\r\n
            } else {\r\n
                if (this.api.isCellEdited) {\r\n
                    this.api.isCEditorFocused = true;\r\n
                }\r\n
            }\r\n
        },\r\n
        onKeyupCellEditor: function (e) {\r\n
            if (e.keyCode == Common.UI.Keys.RETURN && !e.altKey) {\r\n
                this.api.isCEditorFocused = "clear";\r\n
            }\r\n
        },\r\n
        expandEditorField: function () {\r\n
            if (this.editor.$el.height() > 19) {\r\n
                this.editor.keep_height = this.editor.$el.height();\r\n
                this.editor.$el.height(19);\r\n
                this.editor.$btnexpand["removeClass"]("btn-collapse");\r\n
            } else {\r\n
                this.editor.$el.height(this.editor.keep_height || 74);\r\n
                this.editor.$btnexpand["addClass"]("btn-collapse");\r\n
            }\r\n
            Common.NotificationCenter.trigger("layout:changed", "celleditor");\r\n
            Common.NotificationCenter.trigger("edit:complete", this.editor, {\r\n
                restorefocus: true\r\n
            });\r\n
        },\r\n
        onInsertFunction: function () {\r\n
            if (this.mode.isEdit && !this.editor.$btnfunc["hasClass"]("disabled")) {\r\n
                var controller = this.getApplication().getController("FormulaDialog");\r\n
                if (controller) {\r\n
                    $("#ce-func-label", this.editor.el).blur();\r\n
                    this.api.asc_enableKeyEvents(false);\r\n
                    controller.showDialog();\r\n
                }\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/view/ImageFromUrlDialog\',["common/main/lib/component/Window"], function () {\r\n
    Common.Views.ImageFromUrlDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 330,\r\n
            header: false,\r\n
            cls: "modal-dlg"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, options || {});\r\n
            this.template = [\'<div class="box">\', \'<div class="input-row">\', "<label>" + this.textUrl + "</label>", "</div>", \'<div id="id-dlg-url" class="input-row"></div>\', "</div>", \'<div class="footer right">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + this.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + this.cancelButtonText + "</button>", "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var me = this;\r\n
            me.inputUrl = new Common.UI.InputField({\r\n
                el: $("#id-dlg-url"),\r\n
                allowBlank: false,\r\n
                blankError: me.txtEmpty,\r\n
                style: "width: 100%;",\r\n
                validateOnBlur: false,\r\n
                validation: function (value) {\r\n
                    return (/((^https?)|(^ftp)):\\/\\/.+/i.test(value)) ? true : me.txtNotUrl;\r\n
                }\r\n
            });\r\n
            var $window = this.getChild();\r\n
            $window.find(".btn").on("click", _.bind(this.onBtnClick, this));\r\n
            $window.find("input").on("keypress", _.bind(this.onKeyPress, this));\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.Window.prototype.show.apply(this, arguments);\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                me.getChild("input").focus();\r\n
            },\r\n
            500);\r\n
        },\r\n
        onKeyPress: function (event) {\r\n
            if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                this._handleInput("ok");\r\n
            }\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            this._handleInput(event.currentTarget.attributes["result"].value);\r\n
        },\r\n
        _handleInput: function (state) {\r\n
            if (this.options.handler) {\r\n
                if (state == "ok") {\r\n
                    if (this.inputUrl.checkValidate() !== true) {\r\n
                        this.inputUrl.cmpEl.find("input").focus();\r\n
                        return;\r\n
                    }\r\n
                }\r\n
                this.options.handler.call(this, state, this.inputUrl.getValue());\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        textUrl: "Paste an image URL:",\r\n
        cancelButtonText: "Cancel",\r\n
        okButtonText: "Ok",\r\n
        txtEmpty: "This field is required",\r\n
        txtNotUrl: \'This field should be a URL in the format "http://www.example.com"\'\r\n
    },\r\n
    Common.Views.ImageFromUrlDialog || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/Toolbar.template\',[],function () { return \'<div class="toolbar" style="<%= (isCompactView || isEditDiagram) ? \\\'height: 41px;\\\' : \\\'height: 67px;\\\' %>">\\n    <!----------------------->\\n    <!-- Edit diagram mode -->\\n    <!----------------------->\\n    <div id="id-toolbar-diagramm" style="<%= isEditDiagram ? \\\'display: table;\\\' : \\\'display: none;\\\' %> width: 100%;" >\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-diagram-placeholder-btn-copy"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-diagram-placeholder-btn-paste"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-diagram-placeholder-btn-undo"></span>\\n                <span class="btn-placeholder" id="id-toolbar-diagram-placeholder-btn-redo"></span>\\n            </div>\\n        </div>\\n        <div class="separator short"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-diagram-placeholder-btn-formula"></span>\\n            </div>\\n        </div>\\n        <div class="separator short" style="margin-left: 5px;"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-diagram-placeholder-btn-digit-dec"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-diagram-placeholder-btn-digit-inc"></span>\\n                <span class="btn-placeholder border" id="id-toolbar-diagram-placeholder-btn-format" style="width: 84px; margin-left: 10px;"></span>\\n            </div>\\n        </div>\\n        <div class="separator short"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder border" id="id-toolbar-diagram-placeholder-btn-chart" style="width: auto;"></span>\\n            </div>\\n        </div>\\n        <div class="toolbar-group" style="width: 100%;"></div>\\n    </div>\\n    <!------------------------>\\n    <!-- Short view toolbar -->\\n    <!------------------------>\\n    <div id="id-toolbar-short" style="<%= (!isCompactView || isEditDiagram) ? \\\'display: none;\\\' : \\\'display: table;\\\' %> width: 100%;" >\\n        <div class="toolbar-group no-mask">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-print"></span>\\n                <span class="btn-placeholder" id="id-toolbar-short-placeholder-btn-save"></span>\\n            </div>\\n        </div>\\n        <div class="separator short"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-undo"></span>\\n                <span class="btn-placeholder" id="id-toolbar-short-placeholder-btn-redo"></span>\\n            </div>\\n        </div>\\n        <div class="separator short"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row" style="width: 140px; margin-top: -1px;">\\n                <span class="btn-placeholder" style="float: left; width: 90px;" id="id-toolbar-short-placeholder-field-fontname"></span>\\n                <span class="btn-placeholder" style="float: left; width: 45px; margin-left: 2px;" id="id-toolbar-short-placeholder-field-fontsize"></span>\\n            </div>\\n        </div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-bold"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-italic"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-underline"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-fontcolor"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-fillparag"></span>\\n            </div>\\n        </div>\\n        <div class="separator short" style="margin-left: 5px;"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-borders"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-halign"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-valign"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-merge"></span>\\n                <span class="btn-placeholder" id="id-toolbar-short-placeholder-btn-wrap"></span>\\n            </div>\\n        </div>\\n        <div class="separator short"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-insertimage"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-inserthyperlink"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-insertchart"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-insertshape"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-formula"></span>\\n            </div>\\n        </div>\\n        <div class="separator short" style="margin-left: 5px;"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-filter"></span>\\n                <span class="btn-placeholder border" id="id-toolbar-short-placeholder-btn-format" style="width: 84px; margin-left: 7px;"></span>\\n            </div>\\n        </div>\\n        <div class="separator short"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-short-placeholder-btn-copystyle"></span>\\n            </div>\\n        </div>\\n        <!--<div class="separator short"></div>-->\\n        <!--<div class="toolbar-group">-->\\n            <!--<div class="toolbar-row">-->\\n                <!--<span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-cell-ins"></span>-->\\n                <!--<span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-cell-del"></span>-->\\n            <!--</div>-->\\n        <!--</div>-->\\n        <div class="toolbar-group" style="width: 100%;"></div>\\n        <div class="toolbar-group no-mask" style="padding-left:0;">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-short-placeholder-btn-hidebars"></span>\\n            </div>\\n        </div>\\n    </div>\\n    <!------------------------>\\n    <!-- Fully view toolbar -->\\n    <!------------------------>\\n    <div id="id-toolbar-full" style="<%= (isCompactView || isEditDiagram)? \\\'display: none;\\\' : \\\'display: table;\\\' %> width: 100%;" >\\n        <div class="toolbar-group toolbar-group-native">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-newdocument"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-opendocument"></span>\\n            </div>\\n        </div>\\n        <div class="toolbar-group no-mask">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-print"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-save"></span>\\n            </div>\\n        </div>\\n        <div class="separator long" style="margin-left: 5px;"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-copy"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-paste"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-undo"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-redo"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" style="float: left; width: 90px;" id="id-toolbar-full-placeholder-field-fontname"></span>\\n                <span class="btn-placeholder" style="float: left; width: 45px; margin-left: 2px;" id="id-toolbar-full-placeholder-field-fontsize"></span>\\n                <span class="btn-placeholder border" id="id-toolbar-full-placeholder-btn-incfont" style="margin-left: 2px;"></span>\\n                <span class="btn-placeholder border" id="id-toolbar-full-placeholder-btn-decfont" style="margin-left: 2px;"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-bold"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-italic"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-underline"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-fontcolor"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-fillparag"></span>\\n                <div class="separator short" style="margin: 0 6px;"></div>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-borders"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-top"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-middle"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-bottom"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-wrap"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-text-orient"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-align-left"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-align-center"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-align-right"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-align-just"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-merge"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-insertimage"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-insertchart"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-text"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-formula"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-inserthyperlink"></span>\\n                <span class="btn-placeholder " id="id-toolbar-full-placeholder-btn-insertshape"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-sortdesc"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-sortasc"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-setfilter"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-clear-filter"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder border" id="id-toolbar-full-placeholder-btn-format" style="width: 100%;"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-percents"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-currency"></span>\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-digit-dec"></span>\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-digit-inc"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-cell-ins"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-cell-del"></span>\\n            </div>\\n        </div>\\n        <div class="separator long"></div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-clear"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-copystyle"></span>\\n            </div>\\n        </div>\\n        <div class="toolbar-group">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-colorschemas"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-table-tpl"></span>\\n            </div>\\n        </div>\\n        <div class="toolbar-group" id="id-toolbar-full-placeholder-field-styles" style="width: 100%; min-width: 100px;">\\n        </div>\\n        <div class="toolbar-group no-mask">\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder split" id="id-toolbar-full-placeholder-btn-hidebars"></span>\\n            </div>\\n            <div class="toolbar-row">\\n                <span class="btn-placeholder" id="id-toolbar-full-placeholder-btn-settings"></span>\\n            </div>\\n        </div>\\n    </div>\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Models = Common.Models || {};\r\n
define(\'common/main/lib/model/Font\',["backbone"], function (Backbone) {\r\n
    Common.Models.Font = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                name: null,\r\n
                cloneid: null,\r\n
                imgidx: 0,\r\n
                type: 0\r\n
            };\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Collections = Common.Collections || {};\r\n
define(\'common/main/lib/collection/Fonts\',["backbone", "common/main/lib/model/Font"], function (Backbone) {\r\n
    Common.Collections.Fonts = Backbone.Collection.extend({\r\n
        model: Common.Models.Font\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Button\',["common/main/lib/component/BaseView", "common/main/lib/component/ToggleManager"], function () {\r\n
    Common.UI.Button = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            id: null,\r\n
            hint: false,\r\n
            enableToggle: false,\r\n
            allowDepress: true,\r\n
            toggleGroup: null,\r\n
            cls: "",\r\n
            iconCls: "",\r\n
            caption: "",\r\n
            menu: null,\r\n
            disabled: false,\r\n
            pressed: false,\r\n
            split: false\r\n
        },\r\n
        template: _.template(["<% if (menu == null) { %>", \'<button type="button" class="btn <%= cls %>" id="<%= id %>" style="<%= style %>">\', \'<span class="caption"><%= caption %></span>\', \'<% if (iconCls != "") { %>\', \'<span class="btn-icon <%= iconCls %>">&nbsp;</span>\', "<% } %>", "</button>", "<% } else if (split == false) {%>", \'<div class="btn-group" id="<%= id %>" style="<%= style %>">\', \'<button type="button" class="btn dropdown-toggle <%= cls %>" data-toggle="dropdown">\', \'<span class="caption"><%= caption %></span>\', \'<% if (iconCls != "") { %>\', \'<span class="btn-icon <%= iconCls %>">&nbsp;</span>\', "<% } %>", \'<span class="caret"></span>\', "</button>", "</div>", "<% } else { %>", \'<div class="btn-group split" id="<%= id %>" style="<%= style %>">\', \'<button type="button" class="btn <%= cls %>">\', \'<span class="caption"><%= caption %></span>\', \'<% if (iconCls != "") { %>\', \'<span class="btn-icon <%= iconCls %>">&nbsp;</span>\', "<% } %>", "</button>", \'<button type="button" class="btn <%= cls %> dropdown-toggle" data-toggle="dropdown">\', \'<span class="caret"></span>\', \'<span class="sr-only"></span>\', "</button>", "</div>", "<% } %>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this;\r\n
            me.id = me.options.id || Common.UI.getId();\r\n
            me.hint = me.options.hint;\r\n
            me.enableToggle = me.options.enableToggle;\r\n
            me.allowDepress = me.options.allowDepress;\r\n
            me.cls = me.options.cls;\r\n
            me.iconCls = me.options.iconCls;\r\n
            me.menu = me.options.menu;\r\n
            me.split = me.options.split;\r\n
            me.toggleGroup = me.options.toggleGroup;\r\n
            me.disabled = me.options.disabled;\r\n
            me.pressed = me.options.pressed;\r\n
            me.caption = me.options.caption;\r\n
            me.template = me.options.template || me.template;\r\n
            me.style = me.options.style;\r\n
            me.rendered = false;\r\n
            if (me.options.el) {\r\n
                me.render();\r\n
            }\r\n
        },\r\n
        render: function (parentEl) {\r\n
            var me = this;\r\n
            me.trigger("render:before", me);\r\n
            me.cmpEl = $(me.el);\r\n
            if (parentEl) {\r\n
                me.setElement(parentEl, false);\r\n
                if (!me.rendered) {\r\n
                    me.cmpEl = $(this.template({\r\n
                        id: me.id,\r\n
                        cls: me.cls,\r\n
                        iconCls: me.iconCls,\r\n
                        menu: me.menu,\r\n
                        split: me.split,\r\n
                        disabled: me.disabled,\r\n
                        pressed: me.pressed,\r\n
                        caption: me.caption,\r\n
                        style: me.style\r\n
                    }));\r\n
                    if (me.menu && _.isFunction(me.menu.render)) {\r\n
                        me.menu.render(me.cmpEl);\r\n
                    }\r\n
                    parentEl.html(me.cmpEl);\r\n
                }\r\n
            }\r\n
            if (!me.rendered) {\r\n
                var el = me.cmpEl,\r\n
                isGroup = el.hasClass("btn-group"),\r\n
                isSplit = el.hasClass("split");\r\n
                if (me.options.hint) {\r\n
                    var modalParents = me.cmpEl.closest(".asc-window");\r\n
                    me.cmpEl.attr("data-toggle", "tooltip");\r\n
                    me.cmpEl.tooltip({\r\n
                        title: me.options.hint,\r\n
                        placement: me.options.hintAnchor || "cursor"\r\n
                    });\r\n
                    if (modalParents.length > 0) {\r\n
                        me.cmpEl.data("bs.tooltip").tip().css("z-index", parseInt(modalParents.css("z-index")) + 10);\r\n
                    }\r\n
                }\r\n
                if (_.isString(me.toggleGroup)) {\r\n
                    me.enableToggle = true;\r\n
                }\r\n
                var buttonHandler = function (e) {\r\n
                    if (!me.disabled && e.which == 1) {\r\n
                        me.doToggle();\r\n
                        if (me.options.hint) {\r\n
                            var tip = me.cmpEl.data("bs.tooltip");\r\n
                            if (tip) {\r\n
                                if (tip.dontShow === undefined) {\r\n
                                    tip.dontShow = true;\r\n
                                }\r\n
                                tip.hide();\r\n
                            }\r\n
                        }\r\n
                        me.trigger("click", me, e);\r\n
                    }\r\n
                };\r\n
                var doSplitSelect = function (select, e) {\r\n
                    if (!select) {\r\n
                        var isUnderMouse = false;\r\n
                        _.each($("button", el), function (el) {\r\n
                            if ($(el).is(":hover")) {\r\n
                                isUnderMouse = true;\r\n
                                return false;\r\n
                            }\r\n
                        });\r\n
                        if (!isUnderMouse) {\r\n
                            el.removeClass("over");\r\n
                            $("button", el).removeClass("over");\r\n
                        }\r\n
                    }\r\n
                    if (!select && (me.enableToggle && me.allowDepress && me.pressed)) {\r\n
                        return;\r\n
                    }\r\n
                    if (select && !isSplit && (me.enableToggle && me.allowDepress && !me.pressed)) {\r\n
                        e.preventDefault();\r\n
                        return;\r\n
                    }\r\n
                    $("button:first", el).toggleClass("active", select);\r\n
                    $("[data-toggle^=dropdown]", el).toggleClass("active", select);\r\n
                    el.toggleClass("active", select);\r\n
                };\r\n
                var menuHandler = function (e) {\r\n
                    if (!me.disabled && e.which == 1) {\r\n
                        if (isSplit) {\r\n
                            if (me.options.hint) {\r\n
                                var tip = me.cmpEl.data("bs.tooltip");\r\n
                                if (tip) {\r\n
                                    if (tip.dontShow === undefined) {\r\n
                                        tip.dontShow = true;\r\n
                                    }\r\n
                                    tip.hide();\r\n
                                }\r\n
                            }\r\n
                            var isOpen = el.hasClass("open");\r\n
                            doSplitSelect(!isOpen, e);\r\n
                        }\r\n
                    }\r\n
                };\r\n
                var doSetActiveState = function (e, state) {\r\n
                    if (isSplit) {\r\n
                        doSplitSelect(state, e);\r\n
                    } else {\r\n
                        el.toggleClass("active", state);\r\n
                        $("button", el).toggleClass("active", state);\r\n
                    }\r\n
                };\r\n
                var onMouseDown = function (e) {\r\n
                    doSplitSelect(true, e);\r\n
                    $(document).on("mouseup", onMouseUp);\r\n
                };\r\n
                var onMouseUp = function (e) {\r\n
                    doSplitSelect(false, e);\r\n
                    $(document).off("mouseup", onMouseUp);\r\n
                };\r\n
                var onAfterHideMenu = function (e) {\r\n
                    me.cmpEl.find(".dropdown-toggle").blur();\r\n
                };\r\n
                if (isGroup) {\r\n
                    if (isSplit) {\r\n
                        $("[data-toggle^=dropdown]", el).on("mousedown", _.bind(menuHandler, this));\r\n
                        $("button", el).on("mousedown", _.bind(onMouseDown, this));\r\n
                    }\r\n
                    el.on("hide.bs.dropdown", _.bind(doSplitSelect, me, false));\r\n
                    el.on("show.bs.dropdown", _.bind(doSplitSelect, me, true));\r\n
                    el.on("hidden.bs.dropdown", _.bind(onAfterHideMenu, me));\r\n
                    $("button:first", el).on("click", buttonHandler);\r\n
                } else {\r\n
                    el.on("click", buttonHandler);\r\n
                }\r\n
                el.on("button.internal.active", _.bind(doSetActiveState, me));\r\n
                el.on("mouseover", function (e) {\r\n
                    if (!me.disabled) {\r\n
                        me.cmpEl.addClass("over");\r\n
                        me.trigger("mouseover", me, e);\r\n
               

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAA8=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="15" aka="AAAAAAAAAA8=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

     }\r\n
                });\r\n
                el.on("mouseout", function (e) {\r\n
                    if (!me.disabled) {\r\n
                        me.cmpEl.removeClass("over");\r\n
                        me.trigger("mouseout", me, e);\r\n
                    }\r\n
                });\r\n
                Common.UI.ToggleManager.register(me);\r\n
            }\r\n
            me.rendered = true;\r\n
            if (me.pressed) {\r\n
                me.toggle(me.pressed, true);\r\n
            }\r\n
            if (me.disabled) {\r\n
                me.setDisabled(me.disabled);\r\n
            }\r\n
            me.trigger("render:after", me);\r\n
            return this;\r\n
        },\r\n
        doToggle: function () {\r\n
            var me = this;\r\n
            if (me.enableToggle && (me.allowDepress !== false || !me.pressed)) {\r\n
                me.toggle();\r\n
            }\r\n
        },\r\n
        toggle: function (toggle, suppressEvent) {\r\n
            var state = toggle === undefined ? !this.pressed : !!toggle;\r\n
            this.pressed = state;\r\n
            if (this.cmpEl) {\r\n
                this.cmpEl.trigger("button.internal.active", [state]);\r\n
            }\r\n
            if (!suppressEvent) {\r\n
                this.trigger("toggle", this, state);\r\n
            }\r\n
        },\r\n
        isActive: function () {\r\n
            if (this.enableToggle) {\r\n
                return this.pressed;\r\n
            }\r\n
            return this.cmpEl.hasClass("active");\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            if (this.rendered) {\r\n
                var el = this.cmpEl,\r\n
                isGroup = el.hasClass("btn-group");\r\n
                disabled = (disabled === true);\r\n
                if (disabled !== el.hasClass("disabled")) {\r\n
                    var decorateBtn = function (button) {\r\n
                        button.toggleClass("disabled", disabled);\r\n
                        (disabled) ? button.attr({\r\n
                            disabled: disabled\r\n
                        }) : button.removeAttr("disabled");\r\n
                    };\r\n
                    decorateBtn(el);\r\n
                    isGroup && decorateBtn(el.children("button"));\r\n
                }\r\n
                if (disabled) {\r\n
                    var tip = this.cmpEl.data("bs.tooltip");\r\n
                    if (tip) {\r\n
                        tip.hide();\r\n
                    }\r\n
                }\r\n
            }\r\n
            this.disabled = disabled;\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        setIconCls: function (cls) {\r\n
            var btnIconEl = $(this.el).find("span.btn-icon"),\r\n
            oldCls = this.iconCls;\r\n
            this.iconCls = cls;\r\n
            btnIconEl.removeClass(oldCls);\r\n
            btnIconEl.addClass(cls || "");\r\n
        },\r\n
        setVisible: function (visible) {\r\n
            this.cmpEl.toggleClass("hidden", !visible);\r\n
        },\r\n
        updateHint: function (hint) {\r\n
            this.options.hint = hint;\r\n
            var cmpEl = this.cmpEl,\r\n
            modalParents = cmpEl.closest(".asc-window");\r\n
            cmpEl.attr("data-toggle", "tooltip");\r\n
            cmpEl.tooltip("destroy").tooltip({\r\n
                title: hint,\r\n
                placement: this.options.hintAnchor || "cursor"\r\n
            });\r\n
            if (modalParents.length > 0) {\r\n
                cmpEl.data("bs.tooltip").tip().css("z-index", parseInt(modalParents.css("z-index")) + 10);\r\n
            }\r\n
        },\r\n
        setCaption: function (caption) {\r\n
            if (this.caption != caption) {\r\n
                this.caption = caption;\r\n
                if (this.rendered) {\r\n
                    var captionNode = this.cmpEl.find("button:first > .caption").andSelf().filter("button > .caption");\r\n
                    if (captionNode.length > 0) {\r\n
                        captionNode.text(caption);\r\n
                    } else {\r\n
                        this.cmpEl.find("button:first").andSelf().filter("button").text(caption);\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ColorPalette\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.ColorPalette = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            allowReselect: true,\r\n
            cls: "",\r\n
            style: ""\r\n
        },\r\n
        template: _.template([\'<div class="palette-color">\', "<% _.each(colors, function(color, index) { %>", \'<span class="color-item" data-color="<%= color %>" style="background-color: #<%= color %>;"></span>\', "<% }) %>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this;\r\n
            this.id = me.options.id;\r\n
            this.cls = me.options.cls;\r\n
            this.style = me.options.style;\r\n
            this.colors = me.options.colors || [];\r\n
            this.value = me.options.value;\r\n
            if (me.options.el) {\r\n
                me.render();\r\n
            }\r\n
        },\r\n
        render: function (parentEl) {\r\n
            var me = this;\r\n
            if (!me.rendered) {\r\n
                this.cmpEl = $(this.template({\r\n
                    id: this.id,\r\n
                    cls: this.cls,\r\n
                    style: this.style,\r\n
                    colors: this.colors\r\n
                }));\r\n
                if (parentEl) {\r\n
                    this.setElement(parentEl, false);\r\n
                    parentEl.html(this.cmpEl);\r\n
                } else {\r\n
                    $(this.el).html(this.cmpEl);\r\n
                }\r\n
            } else {\r\n
                this.cmpEl = $(this.el);\r\n
            }\r\n
            if (!me.rendered) {\r\n
                var el = this.cmpEl;\r\n
                el.on("click", "span.color-item", _.bind(this.itemClick, this));\r\n
            }\r\n
            me.rendered = true;\r\n
            return this;\r\n
        },\r\n
        itemClick: function (e) {\r\n
            var item = $(e.target);\r\n
            this.select(item.attr("data-color"));\r\n
        },\r\n
        select: function (color, suppressEvent) {\r\n
            if (this.value != color) {\r\n
                var me = this;\r\n
                $("span.color-item", this.cmpEl).removeClass("selected");\r\n
                this.value = color;\r\n
                if (color && /#?[a-fA-F0-9]{6}/.test(color)) {\r\n
                    color = /#?([a-fA-F0-9]{6})/.exec(color)[1].toUpperCase();\r\n
                    $("span[data-color=" + color + "]", this.cmpEl).addClass("selected");\r\n
                    if (!suppressEvent) {\r\n
                        me.trigger("select", me, this.value);\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
\n
define(\'text!common/main/lib/template/ExtendedColorDialog.template\',[],function () { return \'<div class="color-box">\\r\\n    <div id="id-hsb-colorpicker" style="vertical-align:top;">\\r\\n    </div>\\r\\n    <div class="color-info" style="">\\r\\n        <div style="margin-left:15px;">\\r\\n            <label class="color-label"><%= txtNew %></label>\\r\\n            <div id="field-new-color" class="color-cnt top"></div>\\r\\n            <div id="field-start-color" class="color-cnt bottom"></div>\\r\\n            <label class="color-label"><%= txtCurrent %></label>\\r\\n        </div>\\r\\n        <div style="padding:13px 0 2px 0;">\\r\\n            <label class="input-label">R:</label>\\r\\n            <div id="extended-spin-r" class="color-spin"></div>\\r\\n        </div>\\r\\n        <div style="padding:2px 0;">\\r\\n            <label class="input-label">G:</label>\\r\\n            <div id="extended-spin-g" class="color-spin"></div>\\r\\n        </div>\\r\\n        <div style="padding:2px 0;">\\r\\n            <label class="input-label">B:</label>\\r\\n            <div id="extended-spin-b" class="color-spin"></div>\\r\\n        </div>\\r\\n        <div style="padding:11px 0 0 0;">\\r\\n            <label class="input-label" style="width:12px;">#:</label>\\r\\n            <input id="extended-text-color" type="text" role="textbox" style="width:62px; height: 22px;">\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n<div class="footer center">\\r\\n    <button class="btn normal dlg-btn primary" result="1"><%= txtAdd %></button>\\r\\n    <button class="btn normal dlg-btn" result="0"><%= txtCancel %></button>\\r\\n</div>\\r\\n\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/HSBColorPicker\',["common/main/lib/component/BaseView", "common/main/lib/util/utils"], function () {\r\n
    Common.UI.HSBColorPicker = Common.UI.BaseView.extend({\r\n
        template: _.template(\'<div class="hsb-colorpicker">\' + "<% if (this.showCurrentColor) { %>" + \'<div class="top-panel">\' + \'<span class="color-value">\' + \'<span class="transparent-color"></span>\' + "</span>" + \'<div class="color-text"></div>\' + "</div>" + "<% } %>" + "<div>" + \'<div class="cnt-hb">\' + \'<div class="cnt-hb-arrow"></div>\' + "</div>" + "<% if (this.changeSaturation) { %>" + \'<div class="cnt-root">\' + \'<div class="cnt-sat">\' + \'<div class="cnt-sat-arrow"></div>\' + "</div>" + "</div>" + "<% } %>" + "</div>" + "<% if (this.allowEmptyColor) { %>" + \'<div class="empty-color"><%= this.textNoColor %></div>\' + "<% } %>" + "</div>"),\r\n
        color: "#ff0000",\r\n
        options: {\r\n
            allowEmptyColor: false,\r\n
            changeSaturation: true,\r\n
            showCurrentColor: true\r\n
        },\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el),\r\n
            arrowSatBrightness,\r\n
            arrowHue,\r\n
            areaSatBrightness,\r\n
            areaHue,\r\n
            previewColor,\r\n
            previewTransparentColor,\r\n
            previewColorText,\r\n
            btnNoColor,\r\n
            hueVal = 0,\r\n
            saturationVal = 100,\r\n
            brightnessVal = 100;\r\n
            me.allowEmptyColor = me.options.allowEmptyColor;\r\n
            me.changeSaturation = me.options.changeSaturation;\r\n
            me.showCurrentColor = me.options.showCurrentColor;\r\n
            var onUpdateColor = function (hsb, transparent) {\r\n
                var rgbColor = new Common.Utils.RGBColor("hsb(" + hsb.h + "," + hsb.s + "," + hsb.b + ")"),\r\n
                hexColor = rgbColor.toHex();\r\n
                me.color = transparent ? "transparent" : hexColor;\r\n
                refreshUI();\r\n
                me.trigger("changecolor", me, me.color);\r\n
            };\r\n
            var refreshUI = function () {\r\n
                if (previewColor.length > 0 && previewTransparentColor.length > 0) {\r\n
                    if (me.color == "transparent") {\r\n
                        previewTransparentColor.show();\r\n
                    } else {\r\n
                        previewColor.css("background-color", me.color);\r\n
                        previewTransparentColor.hide();\r\n
                    }\r\n
                }\r\n
                if (areaSatBrightness.length > 0) {\r\n
                    areaSatBrightness.css("background-color", new Common.Utils.RGBColor("hsb(" + hueVal + ", 100, 100)").toHex());\r\n
                }\r\n
                if (previewColorText.length > 0) {\r\n
                    previewColorText[0].innerHTML = (me.color == "transparent") ? me.textNoColor : me.color.toUpperCase();\r\n
                }\r\n
                if (arrowSatBrightness.length > 0 && arrowHue.length > 0) {\r\n
                    arrowSatBrightness.css("left", saturationVal + "%");\r\n
                    arrowSatBrightness.css("top", 100 - brightnessVal + "%");\r\n
                    arrowHue.css("top", parseInt(hueVal * 100 / 360) + "%");\r\n
                }\r\n
            };\r\n
            var onSBAreaMouseMove = function (event, element, eOpts) {\r\n
                if (arrowSatBrightness.length > 0 && areaSatBrightness.length > 0) {\r\n
                    var pos = [Math.max(0, Math.min(100, (parseInt((event.pageX - areaSatBrightness.offset().left) / areaSatBrightness.width() * 100)))), Math.max(0, Math.min(100, (parseInt((event.pageY - areaSatBrightness.offset().top) / areaSatBrightness.height() * 100))))];\r\n
                    arrowSatBrightness.css("left", pos[0] + "%");\r\n
                    arrowSatBrightness.css("top", pos[1] + "%");\r\n
                    saturationVal = pos[0];\r\n
                    brightnessVal = 100 - pos[1];\r\n
                    onUpdateColor({\r\n
                        h: hueVal,\r\n
                        s: saturationVal,\r\n
                        b: brightnessVal\r\n
                    });\r\n
                }\r\n
            };\r\n
            var onHueAreaMouseMove = function (event, element, eOpts) {\r\n
                if (arrowHue && areaHue) {\r\n
                    var pos = Math.max(0, Math.min(100, (parseInt((event.pageY - areaHue.offset().top) / areaHue.height() * 100))));\r\n
                    arrowHue.css("top", pos + "%");\r\n
                    hueVal = parseInt(360 * pos / 100);\r\n
                    onUpdateColor({\r\n
                        h: hueVal,\r\n
                        s: saturationVal,\r\n
                        b: brightnessVal\r\n
                    });\r\n
                }\r\n
            };\r\n
            var onSBAreaMouseDown = function (event, element, eOpts) {\r\n
                $(document).on("mouseup", onSBAreaMouseUp);\r\n
                $(document).on("mousemove", onSBAreaMouseMove);\r\n
            };\r\n
            var onSBAreaMouseUp = function (event, element, eOpts) {\r\n
                $(document).off("mouseup", onSBAreaMouseUp);\r\n
                $(document).off("mousemove", onSBAreaMouseMove);\r\n
                onSBAreaMouseMove(event, element, eOpts);\r\n
            };\r\n
            var onHueAreaMouseDown = function (event, element, eOpts) {\r\n
                $(document).on("mouseup", onHueAreaMouseUp);\r\n
                $(document).on("mousemove", onHueAreaMouseMove);\r\n
                onHueAreaMouseMove(event, element, eOpts);\r\n
            };\r\n
            var onHueAreaMouseUp = function (event, element, eOpts) {\r\n
                $(document).off("mouseup", onHueAreaMouseUp);\r\n
                $(document).off("mousemove", onHueAreaMouseMove);\r\n
            };\r\n
            var onNoColorClick = function (cnt) {\r\n
                var hsbColor = new Common.util.RGBColor(me.color).toHSB();\r\n
                onUpdateColor(hsbColor, true);\r\n
            };\r\n
            var onAfterRender = function (ct) {\r\n
                var rootEl = $(me.el),\r\n
                hsbColor;\r\n
                if (rootEl) {\r\n
                    arrowSatBrightness = rootEl.find(".cnt-hb-arrow");\r\n
                    arrowHue = rootEl.find(".cnt-sat-arrow");\r\n
                    areaSatBrightness = rootEl.find(".cnt-hb");\r\n
                    areaHue = rootEl.find(".cnt-sat");\r\n
                    previewColor = rootEl.find(".color-value");\r\n
                    previewColorText = rootEl.find(".color-text");\r\n
                    btnNoColor = rootEl.find(".empty-color");\r\n
                    if (previewColor.length > 0) {\r\n
                        previewTransparentColor = previewColor.find(".transparent-color");\r\n
                    }\r\n
                    if (areaSatBrightness.length > 0) {\r\n
                        areaSatBrightness.off("mousedown");\r\n
                        areaSatBrightness.on("mousedown", onSBAreaMouseDown);\r\n
                    }\r\n
                    if (areaHue.length > 0) {\r\n
                        areaHue.off("mousedown");\r\n
                        areaHue.on("mousedown", onHueAreaMouseDown);\r\n
                    }\r\n
                    if (btnNoColor.length > 0) {\r\n
                        btnNoColor.off("click");\r\n
                        btnNoColor.on("click", onNoColorClick);\r\n
                    }\r\n
                    if (me.color == "transparent") {\r\n
                        hsbColor = {\r\n
                            h: 0,\r\n
                            s: 100,\r\n
                            b: 100\r\n
                        };\r\n
                    } else {\r\n
                        hsbColor = new Common.Utils.RGBColor(me.color).toHSB();\r\n
                    }\r\n
                    hueVal = hsbColor.h;\r\n
                    saturationVal = hsbColor.s;\r\n
                    brightnessVal = hsbColor.b;\r\n
                    if (hueVal == saturationVal && hueVal == brightnessVal && hueVal == 0) {\r\n
                        saturationVal = 100;\r\n
                    }\r\n
                    refreshUI();\r\n
                }\r\n
            };\r\n
            me.setColor = function (value) {\r\n
                if (me.color == value) {\r\n
                    return;\r\n
                }\r\n
                var hsbColor;\r\n
                if (value == "transparent") {\r\n
                    hsbColor = {\r\n
                        h: 0,\r\n
                        s: 100,\r\n
                        b: 100\r\n
                    };\r\n
                } else {\r\n
                    hsbColor = new Common.Utils.RGBColor(value).toHSB();\r\n
                }\r\n
                hueVal = hsbColor.h;\r\n
                saturationVal = hsbColor.s;\r\n
                brightnessVal = hsbColor.b;\r\n
                if (hueVal == saturationVal && hueVal == brightnessVal && hueVal == 0) {\r\n
                    saturationVal = 100;\r\n
                }\r\n
                me.color = value;\r\n
                refreshUI();\r\n
            };\r\n
            me.getColor = function () {\r\n
                return me.color;\r\n
            };\r\n
            me.on("render:after", onAfterRender);\r\n
            me.render();\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.trigger("render:after", this);\r\n
            return this;\r\n
        },\r\n
        textNoColor: "No Color"\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/MaskedField\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.MaskedField = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            maskExp: "",\r\n
            maxLength: 999\r\n
        },\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            el.addClass("masked-field");\r\n
            el.attr("maxlength", me.options.maxLength);\r\n
            el.on("keypress", function (e) {\r\n
                var charCode = String.fromCharCode(e.which);\r\n
                if (!me.options.maskExp.test(charCode) && !e.ctrlKey && e.keyCode !== Common.UI.Keys.DELETE && e.keyCode !== Common.UI.Keys.BACKSPACE && e.keyCode !== Common.UI.Keys.LEFT && e.keyCode !== Common.UI.Keys.RIGHT && e.keyCode !== Common.UI.Keys.HOME && e.keyCode !== Common.UI.Keys.END && e.keyCode !== Common.UI.Keys.ESC && e.keyCode !== Common.UI.Keys.INSERT && e.keyCode !== Common.UI.Keys.TAB) {\r\n
                    if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                        me.trigger("changed", me, el.val());\r\n
                    }\r\n
                    e.preventDefault();\r\n
                    e.stopPropagation();\r\n
                }\r\n
            });\r\n
            el.on("input", function (e) {\r\n
                me.trigger("change", me, el.val());\r\n
            });\r\n
            el.on("blur", function (e) {\r\n
                me.trigger("changed", me, el.val());\r\n
            });\r\n
        },\r\n
        render: function () {\r\n
            return this;\r\n
        },\r\n
        setValue: function (value) {\r\n
            if (this.options.maskExp.test(value) && value.length <= this.options.maxLength) {\r\n
                $(this.el).val(value);\r\n
            }\r\n
        },\r\n
        getValue: function () {\r\n
            $(this.el).val();\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/view/ExtendedColorDialog\',["text!common/main/lib/template/ExtendedColorDialog.template", "common/main/lib/component/HSBColorPicker", "common/main/lib/component/MetricSpinner", "common/main/lib/component/MaskedField", "common/main/lib/component/Window"], function (dlgTemplate) {\r\n
    Common.UI.ExtendedColorDialog = Common.UI.Window.extend(_.extend({\r\n
        tpl: _.template(dlgTemplate),\r\n
        options: {},\r\n
        rendered: false,\r\n
        initialize: function (options) {\r\n
            Common.UI.Window.prototype.initialize.call(this, {\r\n
                cls: "extended-color-dlg",\r\n
                tpl: this.tpl({\r\n
                    txtNew: this.textNew,\r\n
                    txtCurrent: this.textCurrent,\r\n
                    txtAdd: this.addButtonText,\r\n
                    txtCancel: this.cancelButtonText\r\n
                }),\r\n
                header: false,\r\n
                width: 340,\r\n
                height: 272\r\n
            });\r\n
            this.hexRe = /\\s*#?([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\\s*/;\r\n
        },\r\n
        render: function () {\r\n
            var me = this;\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.colorsPicker = new Common.UI.HSBColorPicker({\r\n
                el: $("#id-hsb-colorpicker"),\r\n
                showCurrentColor: false\r\n
            });\r\n
            this.colorsPicker.on("changecolor", _.bind(this.onChangeColor, this));\r\n
            this.colorNew = $("#field-new-color");\r\n
            this.colorSaved = $("#field-start-color");\r\n
            this.spinR = new Common.UI.MetricSpinner({\r\n
                el: $("#extended-spin-r"),\r\n
                step: 1,\r\n
                width: 63,\r\n
                value: "0",\r\n
                defaultUnit: "",\r\n
                maxValue: 255,\r\n
                minValue: 0,\r\n
                tabindex: 1,\r\n
                maskExp: /[0-9]/,\r\n
                allowDecimal: false\r\n
            });\r\n
            this.spinG = new Common.UI.MetricSpinner({\r\n
                el: $("#extended-spin-g"),\r\n
                step: 1,\r\n
                width: 63,\r\n
                value: "0",\r\n
                defaultUnit: "",\r\n
                maxValue: 255,\r\n
                minValue: 0,\r\n
                tabindex: 2,\r\n
                maskExp: /[0-9]/,\r\n
                allowDecimal: false\r\n
            });\r\n
            this.spinB = new Common.UI.MetricSpinner({\r\n
                el: $("#extended-spin-b"),\r\n
                step: 1,\r\n
                width: 63,\r\n
                value: "0",\r\n
                defaultUnit: "",\r\n
                maxValue: 255,\r\n
                minValue: 0,\r\n
                tabindex: 3,\r\n
                maskExp: /[0-9]/,\r\n
                allowDecimal: false\r\n
            });\r\n
            this.textColor = new Common.UI.MaskedField({\r\n
                el: $("#extended-text-color"),\r\n
                width: 55,\r\n
                maskExp: /[a-fA-F0-9]/,\r\n
                maxLength: 6\r\n
            });\r\n
            this.spinR.on("change", _.bind(this.showColor, this, null, true)).on("changing", _.bind(this.onChangingRGB, this, 1));\r\n
            this.spinG.on("change", _.bind(this.showColor, this, null, true)).on("changing", _.bind(this.onChangingRGB, this, 2));\r\n
            this.spinB.on("change", _.bind(this.showColor, this, null, true)).on("changing", _.bind(this.onChangingRGB, this, 3));\r\n
            this.textColor.on("change", _.bind(this.onChangeMaskedField, this));\r\n
            this.textColor.on("changed", _.bind(this.onChangedMaskedField, this));\r\n
            this.textColor.$el.attr("tabindex", 4);\r\n
            this.spinR.$el.find("input").attr("maxlength", 3);\r\n
            this.spinG.$el.find("input").attr("maxlength", 3);\r\n
            this.spinB.$el.find("input").attr("maxlength", 3);\r\n
            this.on("close", function () {\r\n
                me.trigger("onmodalresult", 0);\r\n
            });\r\n
            function onBtnClick(event) {\r\n
                me.trigger("onmodalresult", parseInt(event.currentTarget.attributes["result"].value));\r\n
                me.close(true);\r\n
            }\r\n
            $(this)[0].getChild(".footer .dlg-btn").on("click", onBtnClick);\r\n
            this.rendered = true;\r\n
            if (this.color !== undefined) {\r\n
                this.setColor(this.color);\r\n
            }\r\n
            return this;\r\n
        },\r\n
        onChangeColor: function (o, color) {\r\n
            this.colorNew.css({\r\n
                "background-color": color\r\n
            });\r\n
            this.stopevents = true;\r\n
            var values = color.match(this.hexRe);\r\n
            this.spinR.setValue(parseInt(values[1], 16));\r\n
            this.spinG.setValue(parseInt(values[2], 16));\r\n
            this.spinB.setValue(parseInt(values[3], 16));\r\n
            this.textColor.setValue((values[1] + values[2] + values[3]).toUpperCase());\r\n
            this.stopevents = false;\r\n
        },\r\n
        showColor: function (exlude, validate) {\r\n
            if (!this.stopevents) {\r\n
                var val = this.spinR.getNumberValue();\r\n
                var r = (val == null || val < 0) ? 0 : (val > 255 ? 255 : val);\r\n
                if (validate) {\r\n
                    this.spinR.setValue(r, true);\r\n
                }\r\n
                r = r.toString(16);\r\n
                val = this.spinG.getNumberValue();\r\n
                var g = (val == null || val < 0) ? 0 : (val > 255 ? 255 : val);\r\n
                if (validate) {\r\n
                    this.spinG.setValue(g, true);\r\n
                }\r\n
                g = g.toString(16);\r\n
                val = this.spinB.getNumberValue();\r\n
                var b = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val));\r\n
                if (validate) {\r\n
                    this.spinB.setValue(b, true);\r\n
                }\r\n
                b = b.toString(16);\r\n
                var color = (r.length == 1 ? "0" + r : r) + (g.length == 1 ? "0" + g : g) + (b.length == 1 ? "0" + b : b);\r\n
                this.colorsPicker.setColor("#" + color);\r\n
                if (exlude != "hex") {\r\n
                    this.textColor.setValue(color.toUpperCase());\r\n
                }\r\n
                this.colorNew.css("background-color", "#" + color);\r\n
            }\r\n
        },\r\n
        onChangingRGB: function (type, cmp, newValue, e) {\r\n
            if (!this.stopevents) {\r\n
                var r, g, b, val;\r\n
                newValue = (_.isEmpty(newValue) || isNaN(parseInt(newValue))) ? parseInt(cmp.getValue()) : parseInt(newValue);\r\n
                switch (type) {\r\n
                case 1:\r\n
                    r = ((newValue == null || isNaN(newValue) || newValue < 0) ? 0 : (newValue > 255 ? 255 : newValue)).toString(16);\r\n
                    val = this.spinG.getNumberValue();\r\n
                    g = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val)).toString(16);\r\n
                    val = this.spinB.getNumberValue();\r\n
                    b = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val)).toString(16);\r\n
                    break;\r\n
                case 2:\r\n
                    val = this.spinR.getNumberValue();\r\n
                    r = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val)).toString(16);\r\n
                    g = ((newValue == null || isNaN(newValue) || newValue < 0) ? 0 : (newValue > 255 ? 255 : newValue)).toString(16);\r\n
                    val = this.spinB.getNumberValue();\r\n
                    b = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val)).toString(16);\r\n
                    break;\r\n
                case 3:\r\n
                    val = this.spinR.getNumberValue();\r\n
                    r = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val)).toString(16);\r\n
                    val = this.spinG.getNumberValue();\r\n
                    g = ((val == null || val < 0) ? 0 : (val > 255 ? 255 : val)).toString(16);\r\n
                    b = ((newValue == null || isNaN(newValue) || newValue < 0) ? 0 : (newValue > 255 ? 255 : newValue)).toString(16);\r\n
                    break;\r\n
                }\r\n
                var color = (r.length == 1 ? "0" + r : r) + (g.length == 1 ? "0" + g : g) + (b.length == 1 ? "0" + b : b);\r\n
                this.colorsPicker.setColor("#" + color);\r\n
                this.textColor.setValue(color.toUpperCase());\r\n
                this.colorNew.css("background-color", "#" + color);\r\n
            }\r\n
        },\r\n
        onChangeMaskedField: function (field, newValue) {\r\n
            newValue = ((/^[a-fA-F0-9]{0,6}$/.test(newValue))) ? newValue : "000000";\r\n
            newValue = "000000" + newValue;\r\n
            var colors = newValue.match(/([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/i);\r\n
            this.stopevents = true;\r\n
            this.spinR.setValue(parseInt(colors[1], 16));\r\n
            this.spinG.setValue(parseInt(colors[2], 16));\r\n
            this.spinB.setValue(parseInt(colors[3], 16));\r\n
            this.stopevents = false;\r\n
            if (this.rendered) {\r\n
                this.showColor("hex");\r\n
            }\r\n
        },\r\n
        onChangedMaskedField: function (field, newValue) {\r\n
            var me = this;\r\n
            if (!/^[a-fA-F0-9]{0,6}$/.test(newValue) || _.isEmpty(newValue)) {\r\n
                field.setValue("000000");\r\n
            }\r\n
            if (this.rendered) {\r\n
                this.showColor("", true);\r\n
            }\r\n
        },\r\n
        getColor: function () {\r\n
            var color = /#?([a-fA-F0-9]{6})/.exec(this.colorsPicker.getColor());\r\n
            return color ? color[1] : null;\r\n
        },\r\n
        setColor: function (cl) {\r\n
            var me = this;\r\n
            if (this.rendered !== true) {\r\n
                this.color = cl;\r\n
                return;\r\n
            }\r\n
            var color = /#?([a-fA-F0-9]{6})/.test(cl) ? cl : "ff0000";\r\n
            me.colorsPicker.setColor("#" + color);\r\n
            function keepcolor() {\r\n
                if (cl == "transparent") {\r\n
                    me.colorSaved.addClass("color-transparent");\r\n
                } else {\r\n
                    me.colorSaved.removeClass("color-transparent");\r\n
                    me.colorSaved.css("background-color", "#" + cl);\r\n
                }\r\n
                me.colorNew.css("background-color", "#" + color);\r\n
            }\r\n
            keepcolor();\r\n
            me.stopevents = true;\r\n
            var values = me.hexRe.exec(color);\r\n
            me.spinR.setValue(parseInt(values[1], 16));\r\n
            me.spinG.setValue(parseInt(values[2], 16));\r\n
            me.spinB.setValue(parseInt(values[3], 16));\r\n
            me.textColor.setValue((values[1] + values[2] + values[3]).toUpperCase());\r\n
            me.stopevents = false;\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.Window.prototype.show.apply(this, arguments);\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                me.getChild("#extended-text-color").focus();\r\n
            },\r\n
            50);\r\n
        },\r\n
        cancelButtonText: "Cancel",\r\n
        addButtonText: "Add",\r\n
        textNew: "New",\r\n
        textCurrent: "Current",\r\n
        textRGBErr: "The entered value is incorrect.<br>Please enter a numeric value between 0 and 255.",\r\n
        textHexErr: "The entered value is incorrect.<br>Please enter a value between 000000 and FFFFFF."\r\n
    },\r\n
    Common.UI.ExtendedColorDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ThemeColorPalette\',["common/main/lib/component/BaseView", "common/main/lib/view/ExtendedColorDialog"], function () {\r\n
    Common.UI.ThemeColorPalette = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            dynamiccolors: 10,\r\n
            allowReselect: true,\r\n
            value: "000000"\r\n
        },\r\n
        template: _.template(\'<div style="padding: 12px;">\' + "<% var me = this; %>" + "<% $(colors).each(function(num, item) { %>" + \'<% if (me.isBlankSeparator(item)) { %> <div class="palette-color-spacer" style="width:100%;height:8px;float:left;"></div>\' + \'<% } else if (me.isSeparator(item)) { %> </div><div class="palette-color-separator" style="width:100%;height:1px;float:left;border-bottom: 1px solid #E0E0E0"></div><div style="padding: 12px;">\' + "<% } else if (me.isColor(item)) { %> " + \'<a class="palette-color color-<%=item%>" style="background:#<%=item%>" hidefocus="on">\' + \'<em><span style="background:#<%=item%>;" unselectable="on">&#160;</span></em>\' + "</a>" + "<% } else if (me.isTransparent(item)) { %>" + \'<a class="color-<%=item%>" hidefocus="on">\' + \'<em><span unselectable="on">&#160;</span></em>\' + "</a>" + "<% } else if (me.isEffect(item)) { %>" + \'<a effectid="<%=item.effectId%>" effectvalue="<%=item.effectValue%>" class="palette-color-effect color-<%=item.color%>" style="background:#<%=item.color%>" hidefocus="on">\' + \'<em><span style="background:#<%=item.color%>;" unselectable="on">&#160;</span></em>\' + "</a>" + "<% } else if (me.isCaption(item)) { %>" + \'<div class="palette-color-caption" style="width:100%;float:left;font-size: 11px;"><%=item%></div>\' + "<% } %>" + "<% }); %>" + "</div>" + "<% if (me.options.dynamiccolors!==undefined) { %>" + \'<div class="palette-color-spacer" style="width:100%;height:8px;float:left;"></div><div style="padding: 12px;">\' + "<% for (var i=0; i<me.options.dynamiccolors; i++) { %>" + \'<a class="color-dynamic-<%=i%> dynamic-empty-color" style="background:#ffffff" color="" hidefocus="on">\' + \'<em><span unselectable="on">&#160;</span></em></a>\' + "<% } %>" + "<% } %>" + "</div>"),\r\n
        colorRe: /(?:^|\\s)color-(.{6})(?:\\s|$)/,\r\n
        selectedCls: "selected",\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            this.colors = me.options.colors || [{\r\n
                color: "000000",\r\n
                effectId: 1\r\n
            },\r\n
            {\r\n
                color: "FFFFFF",\r\n
                effectId: 2\r\n
            },\r\n
            {\r\n
                color: "000000",\r\n
                effectId: 3\r\n
            },\r\n
            {\r\n
                color: "FFFFFF",\r\n
                effectId: 4\r\n
            },\r\n
            {\r\n
                color: "000000",\r\n
                effectId: 5\r\n
            },\r\n
            {\r\n
                color: "FF0000",\r\n
                effectId: 1\r\n
            },\r\n
            {\r\n
                color: "FF6600",\r\n
                effectId: 1\r\n
            },\r\n
            {\r\n
                color: "FFFF00",\r\n
                effectId: 2\r\n
            },\r\n
            {\r\n
                color: "CCFFCC",\r\n
                effectId: 3\r\n
            },\r\n
            {\r\n
                color: "008000",\r\n
                effectId: 4\r\n
            },\r\n
            "-", "--", "-", "000000", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39"];\r\n
            el.addClass("theme-colorpalette");\r\n
            this.render();\r\n
            if (this.options.updateColorsArr) {\r\n
                this.updateColors(this.options.updateColorsArr[0], this.options.updateColorsArr[1]);\r\n
            }\r\n
            if (this.options.value) {\r\n
                this.select(this.options.value, true);\r\n
            }\r\n
            this.updateCustomColors();\r\n
            el.closest(".btn-group").on("show.bs.dropdown", _.bind(this.updateCustomColors, this));\r\n
            el.closest(".dropdown-submenu").on("show.bs.dropdown", _.bind(this.updateCustomColors, this));\r\n
            el.on("click", _.bind(this.handleClick, this));\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template({\r\n
                colors: this.colors\r\n
            }));\r\n
            return this;\r\n
        },\r\n
        isBlankSeparator: function (v) {\r\n
            return typeof(v) == "string" && v == "-";\r\n
        },\r\n
        isSeparator: function (v) {\r\n
            return typeof(v) == "string" && v == "--";\r\n
        },\r\n
        isColor: function (v) {\r\n
            return typeof(v) == "string" && (/[0-9A-F]{6}/).test(v);\r\n
        },\r\n
        isTransparent: function (v) {\r\n
            return typeof(v) == "string" && (v == "transparent");\r\n
        },\r\n
        isCaption: function (v) {\r\n
            return (typeof(v) == "string" && v != "-" && v != "--" && !(/[0-9A-F]{6}|transparent/).test(v));\r\n
        },\r\n
        isEffect: function (v) {\r\n
            return (typeof(v) == "object" && v.effectId !== undefined);\r\n
        },\r\n
        getColor: function () {\r\n
            return this.value;\r\n
        },\r\n
        updateCustomColors: function () {\r\n
            var el = $(this.el);\r\n
            if (el) {\r\n
                var colors = localStorage["asc." + window.storagename + ".colors.custom"];\r\n
                colors = colors ? colors.split(",") : [];\r\n
                var i = -1,\r\n
                colorEl, c = colors.length < this.options.dynamiccolors ? colors.length : this.options.dynamiccolors;\r\n
                while (++i < c) {\r\n
                    colorEl = el.find(".color-dynamic-" + i);\r\n
                    colorEl.removeClass("dynamic-empty-color").attr("color", colors[i]);\r\n
                    colorEl.find("span").css({\r\n
                        "background-color": "#" + colors[i]\r\n
                    });\r\n
                }\r\n
            }\r\n
        },\r\n
        handleClick: function (e) {\r\n
            var me = this;\r\n
            var target = $(e.target).closest("a");\r\n
            var color, cmp;\r\n
            if (target.length == 0) {\r\n
                return;\r\n
            }\r\n
            if (target.hasClass("color-transparent")) {\r\n
                $(me.el).find("a." + me.selectedCls).removeClass(me.selectedCls);\r\n
                target.addClass(me.selectedCls);\r\n
                me.value = "transparent";\r\n
                me.trigger("select", me, "transparent");\r\n
            } else {\r\n
                if (! (target[0].className.search("color-dynamic") < 0)) {\r\n
                    if (!/dynamic-empty-color/.test(target[0].className)) {\r\n
                        $(me.el).find("a." + me.selectedCls).removeClass(me.selectedCls);\r\n
                        target.addClass(me.selectedCls);\r\n
                        color = target.attr("color");\r\n
                        if (color) {\r\n
                            me.trigger("select", me, color);\r\n
                        }\r\n
                        me.value = color.toUpperCase();\r\n
                    } else {\r\n
                        setTimeout(function () {\r\n
                            me.addNewColor();\r\n
                        },\r\n
                        10);\r\n
                    }\r\n
                } else {\r\n
                    if (!/^[a-fA-F0-9]{6}$/.test(me.value) || _.indexOf(me.colors, me.value) < 0) {\r\n
                        me.value = false;\r\n
                    }\r\n
                    $(me.el).find("a." + me.selectedCls).removeClass(me.selectedCls);\r\n
                    target.addClass(me.selectedCls);\r\n
                    color = target[0].className.match(me.colorRe)[1];\r\n
                    if (target.hasClass("palette-color-effect")) {\r\n
                        var effectId = parseInt(target.attr("effectid"));\r\n
                        if (color) {\r\n
                            me.value = color.toUpperCase();\r\n
                            me.trigger("select", me, {\r\n
                                color: color,\r\n
                                effectId: effectId\r\n
                            });\r\n
                        }\r\n
                    } else {\r\n
                        if (/#?[a-fA-F0-9]{6}/.test(color)) {\r\n
                            color = /#?([a-fA-F0-9]{6})/.exec(color)[1].toUpperCase();\r\n
                            me.value = color;\r\n
                            me.trigger("select", me, color);\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        setCustomColor: function (color) {\r\n
            var el = $(this.el);\r\n
            color = /#?([a-fA-F0-9]{6})/.exec(color);\r\n
            if (color) {\r\n
                this.saveCustomColor(color[1]);\r\n
                el.find("a." + this.selectedCls).removeClass(this.selectedCls);\r\n
                var child = el.find(".dynamic-empty-color");\r\n
                if (child.length == 0) {\r\n
                    this.updateCustomColors();\r\n
                    child = el.find(".color-dynamic-" + (this.options.dynamiccolors - 1));\r\n
                }\r\n
                child.first().removeClass("dynamic-empty-color").addClass(this.selectedCls).attr("color", color[1]);\r\n
                child.first().find("span").css({\r\n
                    "background-color": "#" + color[1]\r\n
                });\r\n
                this.select(color[1], true);\r\n
            }\r\n
        },\r\n
        saveCustomColor: function (color) {\r\n
            var colors = localStorage["asc." + window.storagename + ".colors.custom"];\r\n
            colors = colors ? colors.split(",") : [];\r\n
            if (colors.push(color) > this.options.dynamiccolors) {\r\n
                colors.shift();\r\n
            }\r\n
            localStorage["asc." + window.storagename + ".colors.custom"] = colors.join().toUpperCase();\r\n
        },\r\n
        addNewColor: function (defcolor) {\r\n
            var me = this;\r\n
            var win = new Common.UI.ExtendedColorDialog({});\r\n
            win.on("onmodalresult", function (mr) {\r\n
                me._isdlgopen = false;\r\n
                if (mr == 1) {\r\n
                    me.setCustomColor(win.getColor());\r\n
                    me.fireEvent("select", me, win.getColor());\r\n
                }\r\n
            });\r\n
            me._isdlgopen = true;\r\n
            win.setColor((me.value !== undefined && me.value !== false) ? me.value : ((defcolor !== undefined) ? defcolor : "000000"));\r\n
            win.show();\r\n
        },\r\n
        isDialogOpen: function () {\r\n
            return this._isdlgopen == true;\r\n
        },\r\n
        select: function (color, suppressEvent) {\r\n
            var el = $(this.el);\r\n
            el.find("a." + this.selectedCls).removeClass(this.selectedCls);\r\n
            if (typeof(color) == "object") {\r\n
                var effectEl;\r\n
                if (color.effectId !== undefined) {\r\n
                    effectEl = el.find(\'a[effectid="\' + color.effectId + \'"]\').first();\r\n
                    if (effectEl.length > 0) {\r\n
                        effectEl.addClass(this.selectedCls);\r\n
                        this.value = effectEl[0].className.match(this.colorRe)[1].toUpperCase();\r\n
                    } else {\r\n
                        this.value = false;\r\n
                    }\r\n
                } else {\r\n
                    if (color.effectValue !== undefined) {\r\n
                        effectEl = el.find(\'a[effectvalue="\' + color.effectValue + \'"].color-\' + color.color.toUpperCase()).first();\r\n
                        if (effectEl.length > 0) {\r\n
                            effectEl.addClass(this.selectedCls);\r\n
                            this.value = effectEl[0].className.match(this.colorRe)[1].toUpperCase();\r\n
                        } else {\r\n
                            this.value = false;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            } else {\r\n
                if (/#?[a-fA-F0-9]{6}/.test(color)) {\r\n
                    color = /#?([a-fA-F0-9]{6})/.exec(color)[1].toUpperCase();\r\n
                    this.value = color;\r\n
                }\r\n
                if (/^[a-fA-F0-9]{6}|transparent$/.test(color) && _.indexOf(this.colors, color) >= 0) {\r\n
                    if (_.indexOf(this.colors, this.value) < 0) {\r\n
                        this.value = false;\r\n
                    }\r\n
                    if (color != this.value || this.options.allowReselect) {\r\n
                        (color == "transparent") ? el.find("a.color-transparent").addClass(this.selectedCls) : el.find("a.palette-color.color-" + color).first().addClass(this.selectedCls);\r\n
                        this.value = color;\r\n
                        if (suppressEvent !== true) {\r\n
                            this.fireEvent("select", this, color);\r\n
                        }\r\n
                    }\r\n
                } else {\r\n
                    var co = el.find("#" + color).first();\r\n
                    if (co.length == 0) {\r\n
                        co = el.find(\'a[color="\' + color + \'"]\').first();\r\n
                    }\r\n
                    if (co.length > 0) {\r\n
                        co.addClass(this.selectedCls);\r\n
                        this.value = color.toUpperCase();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        updateColors: function (effectcolors, standartcolors) {\r\n
            if (effectcolors === undefined || standartcolors === undefined) {\r\n
                return;\r\n
            }\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            if (me.aColorElements === undefined) {\r\n
                me.aColorElements = el.find("a.palette-color");\r\n
            }\r\n
            if (me.aEffectElements === undefined) {\r\n
                me.aEffectElements = el.find("a.palette-color-effect");\r\n
            }\r\n
            var aEl;\r\n
            var aColorIdx = 0,\r\n
            aEffectIdx = 0;\r\n
            for (var i = 0; i < me.colors.length; i++) {\r\n
                if (typeof(me.colors[i]) == "string" && (/[0-9A-F]{6}/).test(me.colors[i])) {\r\n
                    if (aColorIdx >= standartcolors.length) {\r\n
                        continue;\r\n
                    }\r\n
                    aEl = $(me.aColorElements[aColorIdx]);\r\n
                    aEl.removeClass("color-" + me.colors[i]);\r\n
                    me.colors[i] = standartcolors[aColorIdx].toUpperCase();\r\n
                    aEl.addClass("color-" + me.colors[i]);\r\n
                    aEl.css({\r\n
                        background: "#" + me.colors[i]\r\n
                    });\r\n
                    aEl.find("span").first().css({\r\n
                        background: "#" + me.colors[i]\r\n
                    });\r\n
                    aColorIdx++;\r\n
                } else {\r\n
                    if (typeof(me.colors[i]) == "object" && me.colors[i].effectId !== undefined) {\r\n
                        if (aEffectIdx >= effectcolors.length) {\r\n
                            continue;\r\n
                        }\r\n
                        aEl = $(me.aEffectElements[aEffectIdx]);\r\n
                        effectcolors[aEffectIdx].color = effectcolors[aEffectIdx].color.toUpperCase();\r\n
                        if (me.colors[i].color !== effectcolors[aEffectIdx].color) {\r\n
                            aEl.removeClass("color-" + me.colors[i].color);\r\n
                            aEl.addClass("color-" + effectcolors[aEffectIdx].color);\r\n
                            aEl.css({\r\n
                                background: "#" + effectcolors[aEffectIdx].color\r\n
                            });\r\n
                            aEl.find("span").first().css({\r\n
                                background: "#" + effectcolors[aEffectIdx].color\r\n
                            });\r\n
                        }\r\n
                        if (me.colors[i].effectId !== effectcolors[aEffectIdx].effectId) {\r\n
                            aEl.attr("effectid", "" + effectcolors[aEffectIdx].effectId);\r\n
                        }\r\n
                        if (me.colors[i].effectValue !== effectcolors[aEffectIdx].effectValue) {\r\n
                            aEl.attr("effectvalue", "" + effectcolors[aEffectIdx].effectValue);\r\n
                        }\r\n
                        me.colors[i] = effectcolors[aEffectIdx];\r\n
                        aEffectIdx++;\r\n
                    }\r\n
                }\r\n
            }\r\n
            this.options.updateColorsArr = undefined;\r\n
        },\r\n
        clearSelection: function (suppressEvent) {\r\n
            $(this.el).find("a." + this.selectedCls).removeClass(this.selectedCls);\r\n
            this.value = undefined;\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/DimensionPicker\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.DimensionPicker = Common.UI.BaseView.extend((function () {\r\n
        var me, rootEl, areaMouseCatcher, areaUnHighLighted, areaHighLighted, areaStatus, curColumns = 0,\r\n
        curRows = 0;\r\n
        var onMouseMove = function (event) {\r\n
            me.setTableSize(Math.ceil((event.offsetX === undefined ? event.originalEvent.layerX : event.offsetX) / me.itemSize), Math.ceil((event.offsetY === undefined ? event.originalEvent.layerY : event.offsetY) / me.itemSize), event);\r\n
        };\r\n
        var onMouseLeave = function (event) {\r\n
            me.setTableSize(0, 0, event);\r\n
        };\r\n
        var onHighLightedMouseClick = function (e) {\r\n
            me.trigger("select", me, curColumns, curRows, e);\r\n
        };\r\n
        return {\r\n
            options: {\r\n
                itemSize: 18,\r\n
                minRows: 5,\r\n
                minColumns: 5,\r\n
                maxRows: 20,\r\n
                maxColumns: 20\r\n
            },\r\n
            template: _.template([\'<div style="width: 100%; height: 100%;">\', \'<div class="dimension-picker-status">0x0</div>\', \'<div class="dimension-picker-observecontainer">\', \'<div class="dimension-picker-mousecatcher"></div>\', \'<div class="dimension-picker-unhighlighted"></div>\', \'<div class="dimension-picker-highlighted"></div>\', "</div>", "</div>"].join("")),\r\n
            initialize: function (options) {\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                me = this;\r\n
                rootEl = $(this.el);\r\n
                me.itemSize = me.options.itemSize;\r\n
                me.minRows = me.options.minRows;\r\n
                me.minColumns = me.options.minColumns;\r\n
                me.maxRows = me.options.maxRows;\r\n
                me.maxColumns = me.options.maxColumns;\r\n
                this.render();\r\n
                if (rootEl) {\r\n
                    areaMouseCatcher = rootEl.find(".dimension-picker-mousecatcher");\r\n
                    areaUnHighLighted = rootEl.find(".dimension-picker-unhighlighted");\r\n
                    areaHighLighted = rootEl.find(".dimension-picker-highlighted");\r\n
                    areaStatus = rootEl.find(".dimension-picker-status");\r\n
                    rootEl.css({\r\n
                        width: me.minColumns + "em"\r\n
                    });\r\n
                    areaMouseCatcher.css("z-index", 1);\r\n
                    areaMouseCatcher.width(me.maxColumns + "em").height(me.maxRows + "em");\r\n
                    areaUnHighLighted.width(me.minColumns + "em").height(me.minRows + "em");\r\n
                    areaStatus.html(curColumns + " x " + curRows);\r\n
                    areaStatus.width(areaUnHighLighted.width());\r\n
                }\r\n
                areaMouseCatcher.on("mousemove", onMouseMove);\r\n
                areaHighLighted.on("mousemove", onMouseMove);\r\n
                areaUnHighLighted.on("mousemove", onMouseMove);\r\n
                areaMouseCatcher.on("mouseleave", onMouseLeave);\r\n
                areaHighLighted.on("mouseleave", onMouseLeave);\r\n
                areaUnHighLighted.on("mouseleave", onMouseLeave);\r\n
                areaMouseCatcher.on("click", onHighLightedMouseClick);\r\n
                areaHighLighted.on("click", onHighLightedMouseClick);\r\n
                areaUnHighLighted.on("click", onHighLightedMouseClick);\r\n
            },\r\n
            render: function () {\r\n
                $(this.el).html(this.template());\r\n
                return this;\r\n
            },\r\n
            setTableSize: function (columns, rows, event) {\r\n
                if (columns > this.maxColumns) {\r\n
                    columns = this.maxColumns;\r\n
                }\r\n
                if (rows > this.maxRows) {\r\n
                    rows = this.maxRows;\r\n
                }\r\n
                if (curColumns != columns || curRows != rows) {\r\n
                    curColumns = columns;\r\n
                    curRows = rows;\r\n
                    areaHighLighted.width(curColumns + "em").height(curRows + "em");\r\n
                    areaUnHighLighted.width(((curColumns < me.minColumns) ? me.minColumns : ((curColumns + 1 > me.maxColumns) ? me.maxColumns : curColumns + 1)) + "em").height(((curRows < me.minRows) ? me.minRows : ((curRows + 1 > me.maxRows) ? me.maxRows : curRows + 1)) + "em");\r\n
                    rootEl.width(areaUnHighLighted.width());\r\n
                    areaStatus.html(curColumns + " x " + curRows);\r\n
                    areaStatus.width(areaUnHighLighted.width());\r\n
                    me.trigger("change", me, curColumns, curRows, event);\r\n
                }\r\n
            },\r\n
            getColumnsCount: function () {\r\n
                return curColumns;\r\n
            },\r\n
            getRowsCount: function () {\r\n
                return curRows;\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
var FONT_TYPE_RECENT = 4;\r\n
define(\'common/main/lib/component/ComboBoxFonts\',["common/main/lib/component/ComboBox"], function () {\r\n
    Common.UI.ComboBoxFonts = Common.UI.ComboBox.extend((function () {\r\n
        var iconWidth = 302,\r\n
        iconHeight = FONT_THUMBNAIL_HEIGHT || 26,\r\n
        isRetina = window.devicePixelRatio > 1,\r\n
        thumbCanvas = document.createElement("canvas"),\r\n
        thumbContext = thumbCanvas.getContext("2d"),\r\n
        thumbPath = "../../../sdk/Common/Images/fonts_thumbnail.png",\r\n
        thumbPath2x = "../../../sdk/Common/Images/fonts_thumbnail@2x.png",\r\n
        listItemHeight = 36;\r\n
        if (typeof window["AscDesktopEditor"] === "object") {\r\n
            thumbPath = window["AscDesktopEditor"].getFontsSprite();\r\n
            thumbPath2x = window["AscDesktopEditor"].getFontsSprite(true);\r\n
        }\r\n
        thumbCanvas.height = isRetina ? iconHeight * 2 : iconHeight;\r\n
        thumbCanvas.width = isRetina ? iconWidth * 2 : iconWidth;\r\n
        return {\r\n
            template: _.template([\'<div class="input-group combobox fonts <%= cls %>" id="<%= id %>" style="<%= style %>">\', \'<input type="text" class="form-control">\', \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>\', \'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">\', \'<li class="divider">\', "<% _.each(items, function(item) { %>", \'<li id="<%= item.id %>">\', \'<a class="font-item" tabindex="-1" type="menuitem" style="vertical-align:middle; margin: 0 0 0 -10px; height:<%=scope.getListItemHeight()%>px;"/>\', "</li>", "<% }); %>", "</ul>", "</div>"].join("")),\r\n
            initialize: function (options) {\r\n
                Common.UI.ComboBox.prototype.initialize.call(this, _.extend(options, {\r\n
                    displayField: "name"\r\n
                }));\r\n
                this.recent = _.isNumber(options.recent) ? options.recent : 3;\r\n
                this.bindUpdateVisibleFontsTiles = _.bind(this.updateVisibleFontsTiles, this);\r\n
                Common.NotificationCenter.on("fonts:change", _.bind(this.onApiChangeFont, this));\r\n
               

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABA=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="16" aka="AAAAAAAAABA=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

 Common.NotificationCenter.on("fonts:load", _.bind(this.fillFonts, this));\r\n
            },\r\n
            render: function (parentEl) {\r\n
                var oldRawValue = null;\r\n
                if (!_.isUndefined(this._input)) {\r\n
                    oldRawValue = this._input.val();\r\n
                }\r\n
                Common.UI.ComboBox.prototype.render.call(this, parentEl);\r\n
                this.setRawValue(oldRawValue);\r\n
                this._input.on("keyup", _.bind(this.onInputKeyUp, this));\r\n
                this._input.on("keydown", _.bind(this.onInputKeyDown, this));\r\n
                this.scroller.update({\r\n
                    alwaysVisibleY: true,\r\n
                    onChange: this.bindUpdateVisibleFontsTiles\r\n
                });\r\n
                return this;\r\n
            },\r\n
            onAfterKeydownMenu: function (e) {\r\n
                var me = this;\r\n
                if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                    if ($(e.target).closest("input").length) {\r\n
                        if (this.lastValue !== this._input.val()) {\r\n
                            this._input.trigger("change");\r\n
                        }\r\n
                    } else {\r\n
                        $(e.target).click();\r\n
                        if (this.rendered) {\r\n
                            if (Common.Utils.isIE) {\r\n
                                this._input.trigger("change", {\r\n
                                    onkeydown: true\r\n
                                });\r\n
                            } else {\r\n
                                this._input.blur();\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    return false;\r\n
                } else {\r\n
                    if (e.keyCode == Common.UI.Keys.ESC && this.isMenuOpen()) {\r\n
                        this._input.val(this.lastValue);\r\n
                        setTimeout(function () {\r\n
                            me.closeMenu();\r\n
                            me.onAfterHideMenu(e);\r\n
                        },\r\n
                        10);\r\n
                        return false;\r\n
                    } else {\r\n
                        if ((e.keyCode == Common.UI.Keys.HOME || e.keyCode == Common.UI.Keys.END || e.keyCode == Common.UI.Keys.BACKSPACE) && this.isMenuOpen()) {\r\n
                            setTimeout(function () {\r\n
                                me._input.focus();\r\n
                            },\r\n
                            10);\r\n
                        }\r\n
                    }\r\n
                }\r\n
                this.updateVisibleFontsTiles();\r\n
            },\r\n
            onInputKeyUp: function (e) {\r\n
                if (e.keyCode != Common.UI.Keys.RETURN && e.keyCode !== Common.UI.Keys.SHIFT && e.keyCode !== Common.UI.Keys.CTRL && e.keyCode !== Common.UI.Keys.ALT && e.keyCode !== Common.UI.Keys.LEFT && e.keyCode !== Common.UI.Keys.RIGHT && e.keyCode !== Common.UI.Keys.HOME && e.keyCode !== Common.UI.Keys.END && e.keyCode !== Common.UI.Keys.ESC && e.keyCode !== Common.UI.Keys.INSERT && e.keyCode !== Common.UI.Keys.TAB) {\r\n
                    e.stopPropagation();\r\n
                    this.selectCandidate(e.keyCode == Common.UI.Keys.DELETE || e.keyCode == Common.UI.Keys.BACKSPACE);\r\n
                    if (this._selectedItem) {\r\n
                        var me = this;\r\n
                        setTimeout(function () {\r\n
                            var input = me._input[0],\r\n
                            text = me._selectedItem.get(me.displayField),\r\n
                            inputVal = input.value;\r\n
                            if (me.rendered) {\r\n
                                if (document.selection) {\r\n
                                    document.selection.createRange().text = text;\r\n
                                } else {\r\n
                                    if (input.selectionStart || input.selectionStart == "0") {\r\n
                                        input.value = text;\r\n
                                        input.selectionStart = inputVal.length;\r\n
                                        input.selectionEnd = text.length;\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                        },\r\n
                        10);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onInputKeyDown: function (e) {\r\n
                var me = this;\r\n
                if (e.keyCode == Common.UI.Keys.ESC) {\r\n
                    this._input.val(this.lastValue);\r\n
                    setTimeout(function () {\r\n
                        me.closeMenu();\r\n
                        me.onAfterHideMenu(e);\r\n
                    },\r\n
                    10);\r\n
                } else {\r\n
                    if (e.keyCode != Common.UI.Keys.RETURN && e.keyCode != Common.UI.Keys.CTRL && e.keyCode != Common.UI.Keys.SHIFT && e.keyCode != Common.UI.Keys.ALT) {\r\n
                        if (!this.isMenuOpen()) {\r\n
                            this.openMenu();\r\n
                        }\r\n
                        if (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN) {\r\n
                            _.delay(function () {\r\n
                                var selected = me.cmpEl.find("ul li.selected a");\r\n
                                if (selected.length <= 0) {\r\n
                                    selected = me.cmpEl.find("ul li:not(.divider):first a");\r\n
                                }\r\n
                                me._skipInputChange = true;\r\n
                                selected.focus();\r\n
                                me.updateVisibleFontsTiles();\r\n
                            },\r\n
                            10);\r\n
                        } else {\r\n
                            me._skipInputChange = false;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            },\r\n
            onInputChanged: function (e, extra) {\r\n
                if (extra && extra.synthetic) {\r\n
                    return;\r\n
                }\r\n
                if (this._skipInputChange) {\r\n
                    this._skipInputChange = false;\r\n
                    return;\r\n
                }\r\n
                if (this._isMouseDownMenu) {\r\n
                    this._isMouseDownMenu = false;\r\n
                    return;\r\n
                }\r\n
                var val = $(e.target).val(),\r\n
                record = {};\r\n
                if (this.lastValue === val) {\r\n
                    if (extra && extra.onkeydown) {\r\n
                        this.trigger("combo:blur", this, e);\r\n
                    }\r\n
                    return;\r\n
                }\r\n
                record[this.valueField] = val;\r\n
                record[this.displayField] = val;\r\n
                this.trigger("changed:before", this, record, e);\r\n
                if (e.isDefaultPrevented()) {\r\n
                    return;\r\n
                }\r\n
                if (this._selectedItem) {\r\n
                    record[this.valueField] = this._selectedItem.get(this.displayField);\r\n
                    this.setRawValue(record[this.valueField]);\r\n
                    this.trigger("selected", this, _.extend({},\r\n
                    this._selectedItem.toJSON()), e);\r\n
                    this.addItemToRecent(this._selectedItem);\r\n
                    this.closeMenu();\r\n
                } else {\r\n
                    this.setRawValue(record[this.valueField]);\r\n
                    record["isNewFont"] = true;\r\n
                    this.trigger("selected", this, record, e);\r\n
                    this.closeMenu();\r\n
                }\r\n
                this.trigger("changed:after", this, record, e);\r\n
            },\r\n
            getImageUri: function (opts) {\r\n
                if (opts.cloneid) {\r\n
                    var img = $(this.el).find("ul > li#" + opts.cloneid + " img");\r\n
                    return img != null ? img[0].src : undefined;\r\n
                }\r\n
                if (isRetina) {\r\n
                    thumbContext.clearRect(0, 0, iconWidth * 2, iconHeight * 2);\r\n
                    thumbContext.drawImage(this.spriteThumbs, 0, -FONT_THUMBNAIL_HEIGHT * 2 * opts.imgidx);\r\n
                } else {\r\n
                    thumbContext.clearRect(0, 0, iconWidth, iconHeight);\r\n
                    thumbContext.drawImage(this.spriteThumbs, 0, -FONT_THUMBNAIL_HEIGHT * opts.imgidx);\r\n
                }\r\n
                return thumbCanvas.toDataURL();\r\n
            },\r\n
            getImageWidth: function () {\r\n
                return iconWidth;\r\n
            },\r\n
            getImageHeight: function () {\r\n
                return iconHeight;\r\n
            },\r\n
            getListItemHeight: function () {\r\n
                return listItemHeight;\r\n
            },\r\n
            loadSprite: function (callback) {\r\n
                if (callback) {\r\n
                    this.spriteThumbs = new Image();\r\n
                    this.spriteThumbs.onload = callback;\r\n
                    this.spriteThumbs.src = (window.devicePixelRatio > 1) ? thumbPath2x : thumbPath;\r\n
                }\r\n
            },\r\n
            fillFonts: function (store, select) {\r\n
                var me = this;\r\n
                this.loadSprite(function () {\r\n
                    me.store.set(store.toJSON());\r\n
                    me.rendered = false;\r\n
                    me.render($(me.el));\r\n
                    me._fontsArray = me.store.toJSON();\r\n
                    if (me.recent > 0) {\r\n
                        me.store.on("add", me.onInsertItem, me);\r\n
                        me.store.on("remove", me.onRemoveItem, me);\r\n
                    }\r\n
                });\r\n
            },\r\n
            onApiChangeFont: function (font) {\r\n
                var name = (_.isFunction(font.get_Name) ? font.get_Name() : font.asc_getName());\r\n
                if (this.getRawValue() !== name) {\r\n
                    var record = this.store.findWhere({\r\n
                        name: name\r\n
                    });\r\n
                    $(".selected", $(this.el)).removeClass("selected");\r\n
                    if (record) {\r\n
                        this.setRawValue(record.get(this.displayField));\r\n
                        var itemNode = $("#" + record.get("id"), $(this.el)),\r\n
                        menuNode = $("ul.dropdown-menu", this.cmpEl);\r\n
                        if (itemNode && menuNode) {\r\n
                            itemNode.addClass("selected");\r\n
                            if (this.recent <= 0) {\r\n
                                menuNode.scrollTop(itemNode.offset().top - menuNode.offset().top);\r\n
                            }\r\n
                        }\r\n
                    } else {\r\n
                        this.setRawValue(name);\r\n
                    }\r\n
                }\r\n
            },\r\n
            itemClicked: function (e) {\r\n
                var el = $(e.target).closest("li");\r\n
                var record = this.store.findWhere({\r\n
                    id: el.attr("id")\r\n
                });\r\n
                this.addItemToRecent(record);\r\n
                Common.UI.ComboBox.prototype.itemClicked.apply(this, arguments);\r\n
            },\r\n
            onInsertItem: function (item) {\r\n
                $(this.el).find("ul").prepend(_.template([\'<li id="<%= item.id %>">\', \'<a class="font-item" tabindex="-1" type="menuitem" style="vertical-align:middle; margin: 0 0 0 -10px; height:<%=scope.getListItemHeight()%>px;"/>\', "</li>"].join(""), {\r\n
                    item: item.attributes,\r\n
                    scope: this\r\n
                }));\r\n
            },\r\n
            onRemoveItem: function (item, store, opts) {\r\n
                $(this.el).find("ul > li#" + item.id).remove();\r\n
            },\r\n
            onBeforeShowMenu: function (e) {\r\n
                Common.UI.ComboBox.prototype.onBeforeShowMenu.apply(this, arguments);\r\n
                if (!this.getSelectedRecord() && !!this.getRawValue()) {\r\n
                    var record = this.store.where({\r\n
                        name: this.getRawValue()\r\n
                    });\r\n
                    if (record && record.length) {\r\n
                        this.selectRecord(record[record.length - 1]);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onAfterShowMenu: function (e) {\r\n
                if (this.recent > 0) {\r\n
                    if (this.scroller && !this._scrollerIsInited) {\r\n
                        this.scroller.update();\r\n
                        this._scrollerIsInited = true;\r\n
                    }\r\n
                    $(this.el).find("ul").scrollTop(0);\r\n
                    this.trigger("show:after", this, e);\r\n
                } else {\r\n
                    Common.UI.ComboBox.prototype.onAfterShowMenu.apply(this, arguments);\r\n
                }\r\n
                this.flushVisibleFontsTiles();\r\n
                this.updateVisibleFontsTiles(null, 0);\r\n
            },\r\n
            onAfterHideMenu: function (e) {\r\n
                if (this.lastValue !== this._input.val()) {\r\n
                    this._input.val(this.lastValue);\r\n
                }\r\n
                Common.UI.ComboBox.prototype.onAfterHideMenu.apply(this, arguments);\r\n
            },\r\n
            addItemToRecent: function (record) {\r\n
                if (record.get("type") != FONT_TYPE_RECENT && !this.store.findWhere({\r\n
                    name: record.get("name"),\r\n
                    type: FONT_TYPE_RECENT\r\n
                })) {\r\n
                    var fonts = this.store.where({\r\n
                        type: FONT_TYPE_RECENT\r\n
                    });\r\n
                    if (! (fonts.length < this.recent)) {\r\n
                        this.store.remove(fonts[this.recent - 1]);\r\n
                    }\r\n
                    var new_record = record.clone();\r\n
                    new_record.set({\r\n
                        "type": FONT_TYPE_RECENT,\r\n
                        "id": Common.UI.getId(),\r\n
                        cloneid: record.id\r\n
                    });\r\n
                    this.store.add(new_record, {\r\n
                        at: 0\r\n
                    });\r\n
                }\r\n
            },\r\n
            selectCandidate: function (full) {\r\n
                var me = this,\r\n
                inputVal = this._input.val().toLowerCase();\r\n
                if (!this._fontsArray) {\r\n
                    this._fontsArray = this.store.toJSON();\r\n
                }\r\n
                var font = _.find(this._fontsArray, function (font) {\r\n
                    return (full) ? (font[me.displayField].toLowerCase() == inputVal) : (font[me.displayField].toLowerCase().indexOf(inputVal) == 0);\r\n
                });\r\n
                if (font) {\r\n
                    this._selectedItem = this.store.findWhere({\r\n
                        id: font.id\r\n
                    });\r\n
                } else {\r\n
                    this._selectedItem = null;\r\n
                }\r\n
                $(".selected", $(this.el)).removeClass("selected");\r\n
                if (this._selectedItem) {\r\n
                    var itemNode = $("#" + this._selectedItem.get("id"), $(this.el)),\r\n
                    menuEl = $("ul[role=menu]", $(this.el));\r\n
                    if (itemNode.length > 0 && menuEl.length > 0) {\r\n
                        itemNode.addClass("selected");\r\n
                        var itemTop = itemNode.position().top,\r\n
                        menuTop = menuEl.scrollTop();\r\n
                        if (itemTop != 0) {\r\n
                            menuEl.scrollTop(menuTop + itemTop);\r\n
                        }\r\n
                    }\r\n
                }\r\n
            },\r\n
            updateVisibleFontsTiles: function (e, scrollY) {\r\n
                var me = this,\r\n
                j = 0,\r\n
                storeCount = me.store.length,\r\n
                index = 0;\r\n
                if (!me.tiles) {\r\n
                    me.tiles = [];\r\n
                }\r\n
                if (storeCount !== me.tiles.length) {\r\n
                    for (j = me.tiles.length; j < storeCount; ++j) {\r\n
                        me.tiles.push(null);\r\n
                    }\r\n
                }\r\n
                if (_.isUndefined(scrollY)) {\r\n
                    scrollY = parseInt($(me.el).find(".ps-scrollbar-x-rail").css("bottom"));\r\n
                }\r\n
                var scrollH = $(me.el).find(".dropdown-menu").height(),\r\n
                count = Math.max(Math.floor(scrollH / listItemHeight) + 3, 0),\r\n
                from = Math.max(Math.floor(-(scrollY / listItemHeight)) - 1, 0),\r\n
                to = from + count;\r\n
                var listItems = $(me.el).find("a");\r\n
                for (j = 0; j < storeCount; ++j) {\r\n
                    if (from <= j && j < to) {\r\n
                        if (null === me.tiles[j]) {\r\n
                            var fontImage = document.createElement("canvas");\r\n
                            var context = fontImage.getContext("2d");\r\n
                            fontImage.height = isRetina ? iconHeight * 2 : iconHeight;\r\n
                            fontImage.width = isRetina ? iconWidth * 2 : iconWidth;\r\n
                            fontImage.style.width = iconWidth + "px";\r\n
                            fontImage.style.height = iconHeight + "px";\r\n
                            index = me.store.at(j).get("imgidx");\r\n
                            if (isRetina) {\r\n
                                context.clearRect(0, 0, iconWidth * 2, iconHeight * 2);\r\n
                                context.drawImage(me.spriteThumbs, 0, -FONT_THUMBNAIL_HEIGHT * 2 * index);\r\n
                            } else {\r\n
                                context.clearRect(0, 0, iconWidth, iconHeight);\r\n
                                context.drawImage(me.spriteThumbs, 0, -FONT_THUMBNAIL_HEIGHT * index);\r\n
                            }\r\n
                            me.tiles[j] = fontImage;\r\n
                            $(listItems[j]).get(0).appendChild(fontImage);\r\n
                        }\r\n
                    } else {\r\n
                        if (me.tiles[j]) {\r\n
                            me.tiles[j].parentNode.removeChild(me.tiles[j]);\r\n
                            me.tiles[j] = null;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            },\r\n
            flushVisibleFontsTiles: function () {\r\n
                for (var j = this.tiles.length - 1; j >= 0; --j) {\r\n
                    if (this.tiles[j]) {\r\n
                        this.tiles[j].parentNode.removeChild(this.tiles[j]);\r\n
                        this.tiles[j] = null;\r\n
                    }\r\n
                }\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ComboDataView\',["common/main/lib/component/BaseView", "common/main/lib/component/DataView"], function () {\r\n
    Common.UI.ComboDataView = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            id: null,\r\n
            cls: "",\r\n
            style: "",\r\n
            hint: false,\r\n
            itemWidth: 80,\r\n
            itemHeight: 40,\r\n
            menuMaxHeight: 300,\r\n
            enableKeyEvents: false,\r\n
            beforeOpenHandler: null\r\n
        },\r\n
        template: _.template([\'<div id="<%= id %>" class="combo-dataview <%= cls %>" style="<%= style %>">\', \'<div class="view"></div> \', \'<div class="button"></div> \', "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            this.id = this.options.id || Common.UI.getId();\r\n
            this.cls = this.options.cls;\r\n
            this.style = this.options.style;\r\n
            this.hint = this.options.hint;\r\n
            this.store = this.options.store || new Common.UI.DataViewStore();\r\n
            this.itemWidth = this.options.itemWidth;\r\n
            this.itemHeight = this.options.itemHeight;\r\n
            this.menuMaxHeight = this.options.menuMaxHeight;\r\n
            this.beforeOpenHandler = this.options.beforeOpenHandler;\r\n
            this.rootWidth = 0;\r\n
            this.rootHeight = 0;\r\n
            this.rendered = false;\r\n
            this.fieldPicker = new Common.UI.DataView({\r\n
                cls: "field-picker",\r\n
                allowScrollbar: false,\r\n
                itemTemplate: _.template([\'<div class="style" id="<%= id %>">\', \'<img src="<%= imageUrl %>" width="\' + this.itemWidth + \'" height="\' + this.itemHeight + \'"/>\', \'<% if (typeof title !== "undefined") {%>\', \'<span class="title"><%= title %></span>\', "<% } %>", "</div>"].join(""))\r\n
            });\r\n
            this.openButton = new Common.UI.Button({\r\n
                cls: "open-menu",\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tl-bl",\r\n
                    offset: [0, 3],\r\n
                    items: [{\r\n
                        template: _.template(\'<div class="menu-picker-container"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.menuPicker = new Common.UI.DataView({\r\n
                cls: "menu-picker",\r\n
                parentMenu: this.openButton.menu,\r\n
                restoreHeight: this.menuMaxHeight,\r\n
                style: "max-height: " + this.menuMaxHeight + "px;",\r\n
                enableKeyEvents: this.options.enableKeyEvents,\r\n
                itemTemplate: _.template([\'<div class="style" id="<%= id %>">\', \'<img src="<%= imageUrl %>" width="\' + this.itemWidth + \'" height="\' + this.itemHeight + \'"/>\', \'<% if (typeof title !== "undefined") {%>\', \'<span class="title"><%= title %></span>\', "<% } %>", "</div>"].join(""))\r\n
            });\r\n
            setInterval(_.bind(this.checkSize, this), 500);\r\n
            if (this.options.el) {\r\n
                this.render();\r\n
            }\r\n
        },\r\n
        render: function (parentEl) {\r\n
            if (!this.rendered) {\r\n
                var me = this;\r\n
                me.trigger("render:before", me);\r\n
                me.cmpEl = $(me.el);\r\n
                var templateEl = me.template({\r\n
                    id: me.id,\r\n
                    cls: me.cls,\r\n
                    style: me.style\r\n
                });\r\n
                if (parentEl) {\r\n
                    me.setElement(parentEl, false);\r\n
                    me.cmpEl = $(templateEl);\r\n
                    parentEl.html(me.cmpEl);\r\n
                } else {\r\n
                    me.cmpEl.html(templateEl);\r\n
                }\r\n
                me.rootWidth = me.cmpEl.width();\r\n
                me.rootHeight = me.cmpEl.height();\r\n
                me.fieldPicker.render($(".view", me.cmpEl));\r\n
                me.openButton.render($(".button", me.cmpEl));\r\n
                me.menuPicker.render($(".menu-picker-container", me.cmpEl));\r\n
                if (me.openButton.menu.cmpEl) {\r\n
                    if (me.openButton.menu.cmpEl) {\r\n
                        me.openButton.menu.menuAlignEl = me.cmpEl;\r\n
                        me.openButton.menu.cmpEl.css("min-width", me.itemWidth);\r\n
                        me.openButton.menu.on("show:before", _.bind(me.onBeforeShowMenu, me));\r\n
                        me.openButton.menu.on("show:after", _.bind(me.onAfterShowMenu, me));\r\n
                        me.openButton.cmpEl.on("hide.bs.dropdown", _.bind(me.onBeforeHideMenu, me));\r\n
                        me.openButton.cmpEl.on("hidden.bs.dropdown", _.bind(me.onAfterHideMenu, me));\r\n
                    }\r\n
                }\r\n
                if (me.options.hint) {\r\n
                    me.cmpEl.attr("data-toggle", "tooltip");\r\n
                    me.cmpEl.tooltip({\r\n
                        title: me.options.hint,\r\n
                        placement: me.options.hintAnchor || "cursor"\r\n
                    });\r\n
                }\r\n
                me.fieldPicker.on("item:select", _.bind(me.onFieldPickerSelect, me));\r\n
                me.menuPicker.on("item:select", _.bind(me.onMenuPickerSelect, me));\r\n
                me.fieldPicker.on("item:click", _.bind(me.onFieldPickerClick, me));\r\n
                me.menuPicker.on("item:click", _.bind(me.onMenuPickerClick, me));\r\n
                me.onResize();\r\n
                me.rendered = true;\r\n
                me.trigger("render:after", me);\r\n
            }\r\n
            return this;\r\n
        },\r\n
        checkSize: function () {\r\n
            if (this.cmpEl) {\r\n
                var width = this.cmpEl.width(),\r\n
                height = this.cmpEl.height();\r\n
                if (this.rootWidth != width || this.rootHeight != height) {\r\n
                    this.rootWidth = width;\r\n
                    this.rootHeight = height;\r\n
                    this.onResize();\r\n
                }\r\n
            }\r\n
        },\r\n
        onResize: function () {\r\n
            if (this.openButton) {\r\n
                var button = $("button", this.openButton.cmpEl);\r\n
                button && button.css({\r\n
                    width: $(".button", this.cmpEl).width(),\r\n
                    height: $(".button", this.cmpEl).height()\r\n
                });\r\n
                this.openButton.menu.hide();\r\n
                var picker = this.menuPicker;\r\n
                if (picker) {\r\n
                    var record = picker.getSelectedRec();\r\n
                    if (record) {\r\n
                        record = record[0];\r\n
                        this.fillComboView(record || picker.store.at(0), !!record, true);\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("resize", this);\r\n
            }\r\n
        },\r\n
        onBeforeShowMenu: function (e) {\r\n
            var me = this;\r\n
            if (_.isFunction(me.beforeOpenHandler)) {\r\n
                me.beforeOpenHandler(me, e);\r\n
            } else {\r\n
                if (me.openButton.menu.cmpEl) {\r\n
                    var itemMargin = 0;\r\n
                    try {\r\n
                        var itemEl = $($(".dropdown-menu .dataview.inner .style", me.cmpEl)[0]);\r\n
                        itemMargin = itemEl ? (parseInt(itemEl.css("margin-left")) + parseInt(itemEl.css("margin-right"))) : 0;\r\n
                    } catch(e) {}\r\n
                    me.openButton.menu.cmpEl.css({\r\n
                        "width": Math.round((me.cmpEl.width() + (itemMargin * me.fieldPicker.store.length)) / me.itemWidth - 0.2) * (me.itemWidth + itemMargin),\r\n
                        "min-height": this.cmpEl.height()\r\n
                    });\r\n
                }\r\n
            }\r\n
            if (me.options.hint) {\r\n
                var tip = me.cmpEl.data("bs.tooltip");\r\n
                if (tip) {\r\n
                    if (tip.dontShow === undefined) {\r\n
                        tip.dontShow = true;\r\n
                    }\r\n
                    tip.hide();\r\n
                }\r\n
            }\r\n
        },\r\n
        onBeforeHideMenu: function (e) {\r\n
            this.trigger("hide:before", this, e);\r\n
            if (Common.UI.Scroller.isMouseCapture()) {\r\n
                e.preventDefault();\r\n
            }\r\n
        },\r\n
        onAfterShowMenu: function (e) {\r\n
            var me = this;\r\n
            if (me.menuPicker.scroller) {\r\n
                me.menuPicker.scroller.update({\r\n
                    includePadding: true,\r\n
                    suppressScrollX: true,\r\n
                    alwaysVisibleY: true\r\n
                });\r\n
            }\r\n
        },\r\n
        onAfterHideMenu: function (e) {\r\n
            this.trigger("hide:after", this, e);\r\n
        },\r\n
        onFieldPickerSelect: function (picker, item, record) {},\r\n
        onMenuPickerSelect: function (picker, item, record) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            this.fillComboView(record, false);\r\n
            if (record && !this.isSuspendEvents) {\r\n
                this.trigger("select", this, record);\r\n
            }\r\n
        },\r\n
        onFieldPickerClick: function (dataView, itemView, record) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("click", this, record);\r\n
            }\r\n
            if (this.options.hint) {\r\n
                var tip = this.cmpEl.data("bs.tooltip");\r\n
                if (tip) {\r\n
                    if (tip.dontShow === undefined) {\r\n
                        tip.dontShow = true;\r\n
                    }\r\n
                    tip.hide();\r\n
                }\r\n
            }\r\n
        },\r\n
        onMenuPickerClick: function (dataView, itemView, record) {\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (!this.isSuspendEvents) {\r\n
                this.trigger("click", this, record);\r\n
            }\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            this.disabled = disabled;\r\n
            if (!this.rendered) {\r\n
                return;\r\n
            }\r\n
            this.cmpEl.toggleClass("disabled", disabled);\r\n
            $("button", this.openButton.cmpEl).toggleClass("disabled", disabled);\r\n
            this.fieldPicker.setDisabled(disabled);\r\n
        },\r\n
        isDisabled: function () {\r\n
            return this.disabled;\r\n
        },\r\n
        fillComboView: function (record, forceSelect, forceFill) {\r\n
            if (!_.isUndefined(record) && record instanceof Backbone.Model) {\r\n
                var me = this,\r\n
                store = me.menuPicker.store,\r\n
                fieldPickerEl = $(me.fieldPicker.el);\r\n
                if (store) {\r\n
                    if (forceFill || !me.fieldPicker.store.findWhere({\r\n
                        "id": record.get("id")\r\n
                    })) {\r\n
                        if (me.itemMarginLeft === undefined) {\r\n
                            var div = $($(this.menuPicker.el).find(".inner > div:not(.grouped-data):not(.ps-scrollbar-x-rail):not(.ps-scrollbar-y-rail)")[0]);\r\n
                            if (div.length > 0) {\r\n
                                me.itemMarginLeft = parseInt(div.css("margin-left"));\r\n
                                me.itemMarginRight = parseInt(div.css("margin-right"));\r\n
                                me.itemPaddingLeft = parseInt(div.css("padding-left"));\r\n
                                me.itemPaddingRight = parseInt(div.css("padding-right"));\r\n
                                me.itemBorderLeft = parseInt(div.css("border-left-width"));\r\n
                                me.itemBorderRight = parseInt(div.css("border-right-width"));\r\n
                            }\r\n
                        }\r\n
                        me.fieldPicker.store.reset([]);\r\n
                        var indexRec = store.indexOf(record),\r\n
                        countRec = store.length,\r\n
                        maxViewCount = Math.floor((fieldPickerEl.width()) / (me.itemWidth + (me.itemMarginLeft || 0) + (me.itemMarginRight || 0) + (me.itemPaddingLeft || 0) + (me.itemPaddingRight || 0) + (me.itemBorderLeft || 0) + (me.itemBorderRight || 0))),\r\n
                        newStyles = [];\r\n
                        if (fieldPickerEl.height() / me.itemHeight > 2) {\r\n
                            maxViewCount *= Math.floor(fieldPickerEl.height() / me.itemHeight);\r\n
                        }\r\n
                        if (indexRec < 0) {\r\n
                            return;\r\n
                        }\r\n
                        indexRec = Math.floor(indexRec / maxViewCount) * maxViewCount;\r\n
                        for (var index = indexRec, viewCount = 0; index < countRec && viewCount < maxViewCount; index++, viewCount++) {\r\n
                            newStyles.push(store.at(index));\r\n
                        }\r\n
                        me.fieldPicker.store.add(newStyles);\r\n
                    }\r\n
                    if (forceSelect) {\r\n
                        var selectRecord = me.fieldPicker.store.findWhere({\r\n
                            "id": record.get("id")\r\n
                        });\r\n
                        if (selectRecord) {\r\n
                            me.suspendEvents();\r\n
                            me.fieldPicker.selectRecord(selectRecord, true);\r\n
                            me.resumeEvents();\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        selectByIndex: function (index) {\r\n
            if (index < 0) {\r\n
                this.fieldPicker.deselectAll();\r\n
            }\r\n
            this.menuPicker.selectByIndex(index);\r\n
        },\r\n
        setItemWidth: function (width) {\r\n
            if (this.itemWidth != width) {\r\n
                this.itemWidth = window.devicePixelRatio > 1 ? width / 2 : width;\r\n
            }\r\n
        },\r\n
        setItemHeight: function (height) {\r\n
            if (this.itemHeight != height) {\r\n
                this.itemHeight = window.devicePixelRatio > 1 ? height / 2 : height;\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/SynchronizeTip\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.SynchronizeTip = Common.UI.BaseView.extend(_.extend((function () {\r\n
        var tipEl;\r\n
        return {\r\n
            options: {\r\n
                target: $(document.body)\r\n
            },\r\n
            template: _.template([\'<div class="synch-tip-root">\', \'<div class="asc-synchronizetip">\', \'<div class="tip-arrow"></div>\', "<div>", \'<div style="width: 260px;"><%= scope.textSynchronize %></div>\', \'<div class="close"></div>\', "</div>", \'<div class="show-link"><label><%= scope.textDontShow %></label></div>\', "</div>", "</div>"].join("")),\r\n
            initialize: function (options) {\r\n
                this.textSynchronize += Common.Utils.String.platformKey("Ctrl+S");\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                this.target = this.options.target;\r\n
            },\r\n
            render: function () {\r\n
                tipEl = $(this.template({\r\n
                    scope: this\r\n
                }));\r\n
                tipEl.find(".close").on("click", _.bind(function () {\r\n
                    this.trigger("closeclick");\r\n
                },\r\n
                this));\r\n
                tipEl.find(".show-link label").on("click", _.bind(function () {\r\n
                    this.trigger("dontshowclick");\r\n
                },\r\n
                this));\r\n
                $(document.body).append(tipEl);\r\n
                this.applyPlacement();\r\n
                return this;\r\n
            },\r\n
            show: function () {\r\n
                if (tipEl) {\r\n
                    this.applyPlacement();\r\n
                    tipEl.show();\r\n
                } else {\r\n
                    this.render();\r\n
                }\r\n
            },\r\n
            hide: function () {\r\n
                if (tipEl) {\r\n
                    tipEl.hide();\r\n
                }\r\n
            },\r\n
            applyPlacement: function () {\r\n
                var showxy = this.target.offset();\r\n
                tipEl.css({\r\n
                    top: showxy.top + this.target.height() / 2 + "px",\r\n
                    left: showxy.left + this.target.width() + "px"\r\n
                });\r\n
            },\r\n
            textDontShow: "Don\'t show this message again",\r\n
            textSynchronize: "The document has been changed by another user.<br/>Please click to save your changes and reload the updates."\r\n
        };\r\n
    })(), Common.UI.SynchronizeTip || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/Toolbar\',["jquery", "underscore", "backbone", "text!spreadsheeteditor/main/app/template/Toolbar.template", "common/main/lib/collection/Fonts", "common/main/lib/component/Button", "common/main/lib/component/ComboBox", "common/main/lib/component/DataView", "common/main/lib/component/ColorPalette", "common/main/lib/component/ThemeColorPalette", "common/main/lib/component/Menu", "common/main/lib/component/DimensionPicker", "common/main/lib/component/Window", "common/main/lib/component/ComboBoxFonts", "common/main/lib/component/ComboDataView", "common/main/lib/component/SynchronizeTip"], function ($, _, Backbone, toolbarTemplate) {\r\n
    SSE.enumLock = {\r\n
        editCell: "cell-editing",\r\n
        editFormula: "is-formula",\r\n
        editText: "is-text",\r\n
        selImage: "sel-image",\r\n
        selShape: "sel-shape",\r\n
        selShapeText: "sel-shape-txt",\r\n
        selChart: "sel-chart",\r\n
        selChartText: "sel-chart-txt",\r\n
        selRange: "sel-range",\r\n
        lostConnect: "disconnect",\r\n
        coAuth: "co-auth",\r\n
        ruleMerge: "rule-btn-merge",\r\n
        ruleFilter: "rule-filter",\r\n
        ruleDelFilter: "rule-clear-filter",\r\n
        menuFileOpen: "menu-file-open"\r\n
    };\r\n
    SSE.Views.Toolbar = Backbone.View.extend(_.extend({\r\n
        el: "#toolbar",\r\n
        template: _.template(toolbarTemplate),\r\n
        events: {},\r\n
        initialize: function () {\r\n
            var me = this,\r\n
            options = {};\r\n
            JSON.parse(window.localStorage.getItem("sse-hidden-title")) && (options.title = true);\r\n
            JSON.parse(window.localStorage.getItem("sse-hidden-formula")) && (options.formula = true);\r\n
            JSON.parse(window.localStorage.getItem("sse-hidden-headings")) && (options.headings = true);\r\n
            me.isCompactView = !!JSON.parse(window.localStorage.getItem("sse-toolbar-compact"));\r\n
            me.SchemeNames = [me.txtScheme1, me.txtScheme2, me.txtScheme3, me.txtScheme4, me.txtScheme5, me.txtScheme6, me.txtScheme7, me.txtScheme8, me.txtScheme9, me.txtScheme10, me.txtScheme11, me.txtScheme12, me.txtScheme13, me.txtScheme14, me.txtScheme15, me.txtScheme16, me.txtScheme17, me.txtScheme18, me.txtScheme19, me.txtScheme20, me.txtScheme21];\r\n
            me._state = {\r\n
                hasCollaborativeChanges: undefined\r\n
            };\r\n
            me.btnSaveCls = "btn-save";\r\n
            me.btnSaveTip = this.tipSave + Common.Utils.String.platformKey("Ctrl+S");\r\n
            me.ascFormatOptions = {\r\n
                General: "General",\r\n
                Number: "0.00",\r\n
                Currency: "$#,##0.00",\r\n
                Accounting: \'_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)\',\r\n
                DateShort: "m/d/yyyy",\r\n
                DateLong: "[$-F800]dddd, mmmm dd, yyyy",\r\n
                Time: "[$-F400]h:mm:ss AM/PM",\r\n
                Percentage: "0.00%",\r\n
                Percent: "0%",\r\n
                Fraction: "# ?/?",\r\n
                Scientific : "0.00E+00",\r\n
                Text : "@"\r\n
            };\r\n
            me.numFormatTypes = {};\r\n
            me.numFormatTypes[c_oAscNumFormatType.General] = me.txtGeneral;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Custom] = me.txtCustom;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Text] = me.txtText;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Number] = me.txtNumber;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Integer] = me.txtInteger;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Scientific] = me.txtScientific;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Currency] = me.txtCurrency;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Accounting] = me.txtAccounting;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Date] = me.txtDate;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Time] = me.txtTime;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Percent] = me.txtPercentage;\r\n
            me.numFormatTypes[c_oAscNumFormatType.Fraction] = "Fraction";\r\n
            function dummyCmp() {\r\n
                return {\r\n
                    isDummy: true,\r\n
                    on: function () {}\r\n
                };\r\n
            }\r\n
            var _set = SSE.enumLock;\r\n
            me.cmbFontSize = new Common.UI.ComboBox({\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 55px;",\r\n
                hint: me.tipFontSize,\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                data: [{\r\n
                    value: 8,\r\n
                    displayValue: "8"\r\n
                },\r\n
                {\r\n
                    value: 9,\r\n
                    displayValue: "9"\r\n
                },\r\n
                {\r\n
                    value: 10,\r\n
                    displayValue: "10"\r\n
                },\r\n
                {\r\n
                    value: 11,\r\n
                    displayValue: "11"\r\n
                },\r\n
                {\r\n
                    value: 12,\r\n
                    displayValue: "12"\r\n
                },\r\n
                {\r\n
                    value: 14,\r\n
                    displayValue: "14"\r\n
                },\r\n
                {\r\n
                    value: 16,\r\n
                    displayValue: "16"\r\n
                },\r\n
                {\r\n
                    value: 18,\r\n
                    displayValue: "18"\r\n
                },\r\n
                {\r\n
                    value: 20,\r\n
                    displayValue: "20"\r\n
                },\r\n
                {\r\n
                    value: 22,\r\n
                    displayValue: "22"\r\n
                },\r\n
                {\r\n
                    value: 24,\r\n
                    displayValue: "24"\r\n
                },\r\n
                {\r\n
                    value: 26,\r\n
                    displayValue: "26"\r\n
                },\r\n
                {\r\n
                    value: 28,\r\n
                    displayValue: "28"\r\n
                },\r\n
                {\r\n
                    value: 36,\r\n
                    displayValue: "36"\r\n
                },\r\n
                {\r\n
                    value: 48,\r\n
                    displayValue: "48"\r\n
                },\r\n
                {\r\n
                    value: 72,\r\n
                    displayValue: "72"\r\n
                }]\r\n
            });\r\n
            me.btnNewDocument = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-newdocument",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-newdocument",\r\n
                lock: [_set.lostConnect],\r\n
                hint: me.tipNewDocument\r\n
            });\r\n
            me.btnOpenDocument = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-opendocument",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-opendocument",\r\n
                lock: [_set.lostConnect],\r\n
                hint: me.tipOpenDocument\r\n
            });\r\n
            me.cmbFontName = new Common.UI.ComboBoxFonts({\r\n
                cls: "input-group-nr",\r\n
                menuCls: "scrollable-menu",\r\n
                menuStyle: "min-width: 325px;",\r\n
                hint: me.tipFontName,\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                store: new Common.Collections.Fonts()\r\n
            });\r\n
            me.btnPrint = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-print",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-print",\r\n
                split: true,\r\n
                hint: me.tipPrint + Common.Utils.String.platformKey("Ctrl+P"),\r\n
                lock: [_set.editCell],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.textPrint,\r\n
                        value: "print"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textPrintOptions,\r\n
                        value: "options"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnSave = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-save",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: me.btnSaveCls,\r\n
                hint: me.btnSaveTip\r\n
            });\r\n
            me.btnCopy = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-copy",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-copy",\r\n
                hint: me.tipCopy + Common.Utils.String.platformKey("Ctrl+C")\r\n
            });\r\n
            me.btnPaste = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-paste",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-paste",\r\n
                lock: [_set.coAuth, _set.lostConnect],\r\n
                hint: me.tipPaste + Common.Utils.String.platformKey("Ctrl+V")\r\n
            });\r\n
            me.btnUndo = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-undo",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-undo",\r\n
                disabled: true,\r\n
                lock: [_set.lostConnect],\r\n
                hint: me.tipUndo + Common.Utils.String.platformKey("Ctrl+Z")\r\n
            });\r\n
            me.btnRedo = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-redo",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-redo",\r\n
                disabled: true,\r\n
                lock: [_set.lostConnect],\r\n
                hint: me.tipRedo + Common.Utils.String.platformKey("Ctrl+Y")\r\n
            });\r\n
            me.btnIncFontSize = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-incfont",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-incfont",\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                hint: me.tipIncFont\r\n
            });\r\n
            me.btnDecFontSize = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-decfont",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-decfont",\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                hint: me.tipDecFont\r\n
            });\r\n
            me.btnBold = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-bold",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-bold",\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                hint: me.textBold + Common.Utils.String.platformKey("Ctrl+B"),\r\n
                enableToggle: true\r\n
            });\r\n
            me.btnItalic = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-italic",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-italic",\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                hint: me.textItalic + Common.Utils.String.platformKey("Ctrl+I"),\r\n
                enableToggle: true\r\n
            });\r\n
            me.btnUnderline = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-underline",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-underline",\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                hint: me.textUnderline + Common.Utils.String.platformKey("Ctrl+U"),\r\n
                enableToggle: true\r\n
            });\r\n
            me.mnuTextColorPicker = dummyCmp();\r\n
            me.btnTextColor = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-fontcolor",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-fontcolor",\r\n
                hint: me.tipFontColor,\r\n
                split: true,\r\n
                lock: [_set.selImage, _set.editFormula, _set.selRange, _set.coAuth, _set.lostConnect],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-toolbar-menu-fontcolor" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="id-toolbar-menu-new-fontcolor" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            }).on("render:after", function (btn) {\r\n
                var colorVal = $(\'<div class="btn-color-value-line"></div>\');\r\n
                $("button:first-child", btn.cmpEl).append(colorVal);\r\n
                colorVal.css("background-color", btn.currentColor || "transparent");\r\n
                me.mnuTextColorPicker = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#id-toolbar-menu-fontcolor"),\r\n
                    dynamiccolors: 10,\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "3D55FE", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
            });\r\n
            me.mnuBackColorPicker = dummyCmp();\r\n
            me.btnBackColor = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-fillparag",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-fillparag",\r\n
                hint: me.tipPrColor,\r\n
                split: true,\r\n
                lock: [_set.selImage, _set.editCell, _set.coAuth, _set.lostConnect],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-toolbar-menu-paracolor" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="id-toolbar-menu-new-paracolor" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            }).on("render:after", function (btn) {\r\n
                var colorVal = $(\'<div class="btn-color-value-line"></div>\');\r\n
                $("button:first-child", btn.cmpEl).append(colorVal);\r\n
                colorVal.css("background-color", btn.currentColor || "transparent");\r\n
                me.mnuBackColorPicker = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#id-toolbar-menu-paracolor"),\r\n
                    dynamiccolors: 10,\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                      

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABE=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="17" aka="AAAAAAAAABE=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

  effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "transparent", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
            });\r\n
            me.mnuBorderColorPicker = dummyCmp();\r\n
            me.btnBorders = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-borders",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-border-out",\r\n
                icls: "btn-border-out",\r\n
                borderId: "outer",\r\n
                borderswidth: "thin",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                hint: me.tipBorders,\r\n
                split: true,\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.textOutBorders,\r\n
                        iconCls: "mnu-border-out",\r\n
                        icls: "btn-border-out",\r\n
                        borderId: "outer"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textAllBorders,\r\n
                        iconCls: "mnu-border-all",\r\n
                        icls: "btn-border-all",\r\n
                        borderId: "all"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textTopBorders,\r\n
                        iconCls: "mnu-border-top",\r\n
                        icls: "btn-border-top",\r\n
                        borderId: c_oAscBorderOptions.Top\r\n
                    },\r\n
                    {\r\n
                        caption: me.textBottomBorders,\r\n
                        iconCls: "mnu-border-bottom",\r\n
                        icls: "btn-border-bottom",\r\n
                        borderId: c_oAscBorderOptions.Bottom\r\n
                    },\r\n
                    {\r\n
                        caption: me.textLeftBorders,\r\n
                        iconCls: "mnu-border-left",\r\n
                        icls: "btn-border-left",\r\n
                        borderId: c_oAscBorderOptions.Left\r\n
                    },\r\n
                    {\r\n
                        caption: me.textRightBorders,\r\n
                        iconCls: "mnu-border-right",\r\n
                        icls: "btn-border-right",\r\n
                        borderId: c_oAscBorderOptions.Right\r\n
                    },\r\n
                    {\r\n
                        caption: me.textNoBorders,\r\n
                        iconCls: "mnu-border-no",\r\n
                        icls: "btn-border-no",\r\n
                        borderId: "none"\r\n
                    },\r\n
                    {\r\n
                        caption: "--"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textInsideBorders,\r\n
                        iconCls: "mnu-border-center",\r\n
                        icls: "btn-border-center",\r\n
                        borderId: "inner"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textCenterBorders,\r\n
                        iconCls: "mnu-border-vmiddle",\r\n
                        icls: "btn-border-vmiddle",\r\n
                        borderId: c_oAscBorderOptions.InnerV\r\n
                    },\r\n
                    {\r\n
                        caption: me.textMiddleBorders,\r\n
                        iconCls: "mnu-border-hmiddle",\r\n
                        icls: "btn-border-hmiddle",\r\n
                        borderId: c_oAscBorderOptions.InnerH\r\n
                    },\r\n
                    {\r\n
                        caption: me.textDiagUpBorder,\r\n
                        iconCls: "mnu-border-diagup",\r\n
                        icls: "btn-border-diagup",\r\n
                        borderId: c_oAscBorderOptions.DiagU\r\n
                    },\r\n
                    {\r\n
                        caption: me.textDiagDownBorder,\r\n
                        iconCls: "mnu-border-diagdown",\r\n
                        icls: "btn-border-diagdown",\r\n
                        borderId: c_oAscBorderOptions.DiagD\r\n
                    },\r\n
                    {\r\n
                        caption: "--"\r\n
                    },\r\n
                    {\r\n
                        id: "id-toolbar-mnu-item-border-width",\r\n
                        caption: me.textBordersWidth,\r\n
                        iconCls: "mnu-icon-item mnu-border-width",\r\n
                        template: _.template(\'<a id="<%= id %>" tabindex="-1" type="menuitem"><span class="menu-item-icon" style="background-image: none; width: 11px; height: 11px; margin: 2px 7px 0 -9px; border-style: solid; border-width: 1px; border-color: #000;"></span><%= caption %></a>\'),\r\n
                        menu: (function () {\r\n
                            var itemTemplate = _.template(\'<a id="<%= id %>" tabindex="-1" type="menuitem"><div class="border-size-item" style="background-position: 0 -<%= options.offsety %>px;"></div></a>\');\r\n
                            me.mnuBorderWidth = new Common.UI.Menu({\r\n
                                style: "min-width: 100px;",\r\n
                                menuAlign: "tl-tr",\r\n
                                id: "toolbar-menu-borders-width",\r\n
                                items: [{\r\n
                                    template: itemTemplate,\r\n
                                    stopPropagation: true,\r\n
                                    checkable: true,\r\n
                                    toggleGroup: "border-width",\r\n
                                    value: "thin",\r\n
                                    offsety: 0,\r\n
                                    checked: true\r\n
                                },\r\n
                                {\r\n
                                    template: itemTemplate,\r\n
                                    stopPropagation: true,\r\n
                                    checkable: true,\r\n
                                    toggleGroup: "border-width",\r\n
                                    value: "medium",\r\n
                                    offsety: 20\r\n
                                },\r\n
                                {\r\n
                                    template: itemTemplate,\r\n
                                    stopPropagation: true,\r\n
                                    checkable: true,\r\n
                                    toggleGroup: "border-width",\r\n
                                    value: "thick",\r\n
                                    offsety: 40\r\n
                                }]\r\n
                            });\r\n
                            return me.mnuBorderWidth;\r\n
                        })()\r\n
                    },\r\n
                    {\r\n
                        id: "id-toolbar-mnu-item-border-color",\r\n
                        caption: me.textBordersColor,\r\n
                        iconCls: "mnu-icon-item mnu-border-color",\r\n
                        template: _.template(\'<a id="<%= id %>"tabindex="-1" type="menuitem"><span class="menu-item-icon" style="background-image: none; width: 11px; height: 11px; margin: 2px 7px 0 -9px; border-style: solid; border-width: 3px; border-color: #000;"></span><%= caption %></a>\'),\r\n
                        menu: new Common.UI.Menu({\r\n
                            menuAlign: "tl-tr",\r\n
                            items: [{\r\n
                                template: _.template(\'<div id="id-toolbar-menu-bordercolor" style="width: 165px; height: 220px; margin: 10px;"></div>\'),\r\n
                                stopPropagation: true\r\n
                            },\r\n
                            {\r\n
                                template: _.template(\'<a id="id-toolbar-menu-new-bordercolor" style="padding-left:12px;">\' + me.textNewColor + "</a>"),\r\n
                                stopPropagation: true\r\n
                            }]\r\n
                        })\r\n
                    }]\r\n
                })\r\n
            }).on("render:after", function (btn) {\r\n
                var colorVal = $(\'<div class="btn-color-value-line"></div>\');\r\n
                $("button:first-child", btn.cmpEl).append(colorVal);\r\n
                colorVal.css("background-color", btn.currentColor || "transparent");\r\n
                me.mnuBorderColorPicker = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#id-toolbar-menu-bordercolor"),\r\n
                    dynamiccolors: 10,\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "3D55FE", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
            });\r\n
            me.btnAlignLeft = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-align-left",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-align-left",\r\n
                hint: me.tipAlignLeft,\r\n
                enableToggle: true,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                toggleGroup: "alignGroup"\r\n
            });\r\n
            me.btnAlignCenter = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-align-center",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-align-center",\r\n
                hint: me.tipAlignCenter,\r\n
                enableToggle: true,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                toggleGroup: "alignGroup"\r\n
            });\r\n
            me.btnAlignRight = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-align-right",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-align-right",\r\n
                hint: me.tipAlignRight,\r\n
                enableToggle: true,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                toggleGroup: "alignGroup"\r\n
            });\r\n
            me.btnAlignJust = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-align-just",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-align-just",\r\n
                hint: me.tipAlignJust,\r\n
                enableToggle: true,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                toggleGroup: "alignGroup"\r\n
            });\r\n
            me.btnMerge = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-merge",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-merge",\r\n
                hint: me.tipMerge,\r\n
                enableToggle: true,\r\n
                allowDepress: true,\r\n
                split: true,\r\n
                lock: [_set.editCell, _set.selShape, _set.selShapeText, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleMerge],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.txtMergeCenter,\r\n
                        value: c_oAscMergeOptions.MergeCenter\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtMergeAcross,\r\n
                        value: c_oAscMergeOptions.MergeAcross\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtMergeCells,\r\n
                        value: c_oAscMergeOptions.Merge\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtUnmerge,\r\n
                        value: c_oAscMergeOptions.Unmerge\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnAlignTop = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-valign-top",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-valign-top",\r\n
                hint: me.tipAlignTop,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                enableToggle: true,\r\n
                toggleGroup: "vAlignGroup"\r\n
            });\r\n
            me.btnAlignMiddle = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-valign-middle",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-valign-middle",\r\n
                hint: me.tipAlignMiddle,\r\n
                enableToggle: true,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                toggleGroup: "vAlignGroup"\r\n
            });\r\n
            me.btnAlignBottom = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-valign-bottom",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-valign-bottom",\r\n
                hint: me.tipAlignBottom,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                enableToggle: true,\r\n
                toggleGroup: "vAlignGroup"\r\n
            });\r\n
            me.btnWrap = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-wrap",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-wrap",\r\n
                hint: me.tipWrap,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                enableToggle: true,\r\n
                allowDepress: true\r\n
            });\r\n
            me.btnTextOrient = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-textorient",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-text-orient",\r\n
                hint: me.tipTextOrientation,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.textHorizontal,\r\n
                        iconCls: "mnu-direct-horiz",\r\n
                        checkable: true,\r\n
                        toggleGroup: "textorientgroup",\r\n
                        value: "horiz"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textCounterCw,\r\n
                        iconCls: "mnu-direct-ccw",\r\n
                        checkable: true,\r\n
                        toggleGroup: "textorientgroup",\r\n
                        value: "countcw"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textClockwise,\r\n
                        iconCls: "mnu-direct-cw",\r\n
                        checkable: true,\r\n
                        toggleGroup: "textorientgroup",\r\n
                        value: "clockwise"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textRotateUp,\r\n
                        iconCls: "mnu-direct-rup",\r\n
                        checkable: true,\r\n
                        toggleGroup: "textorientgroup",\r\n
                        value: "rotateup"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textRotateDown,\r\n
                        iconCls: "mnu-direct-rdown",\r\n
                        checkable: true,\r\n
                        toggleGroup: "textorientgroup",\r\n
                        value: "rotatedown"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnInsertImage = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-insertimage",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-insertimage",\r\n
                hint: me.tipInsertImage,\r\n
                lock: [_set.editCell, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.mniImageFromFile,\r\n
                        value: "file"\r\n
                    },\r\n
                    {\r\n
                        caption: me.mniImageFromUrl,\r\n
                        value: "url"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnInsertHyperlink = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-inserthyperlink",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-inserthyperlink",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selImage, _set.selShape, _set.lostConnect, _set.coAuth],\r\n
                hint: me.tipInsertHyperlink + Common.Utils.String.platformKey("Ctrl+K")\r\n
            });\r\n
            me.btnInsertChart = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-insertchart",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-insertchart",\r\n
                lock: [_set.editCell, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                hint: me.tipInsertChart\r\n
            });\r\n
            me.btnEditChart = new Common.UI.Button({\r\n
                id: "id-toolbar-rtn-edit-chart",\r\n
                cls: "btn-toolbar btn-toolbar-default btn-text-value",\r\n
                caption: me.tipEditChart,\r\n
                lock: [_set.lostConnect],\r\n
                style: "width: 120px;"\r\n
            });\r\n
            me.btnInsertShape = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-insertshape",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-insertshape",\r\n
                hint: me.tipInsertShape,\r\n
                enableToggle: true,\r\n
                lock: [_set.editCell, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    cls: "menu-shapes"\r\n
                })\r\n
            });\r\n
            me.btnInsertText = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-inserttext",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-text",\r\n
                hint: me.tipInsertText,\r\n
                lock: [_set.editCell, _set.selChartText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                enableToggle: true\r\n
            });\r\n
            me.btnSortDown = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-sort-down",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-sort-down",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleFilter],\r\n
                hint: me.txtSortAZ\r\n
            });\r\n
            me.btnSortUp = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-sort-up",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-sort-up",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleFilter],\r\n
                hint: me.txtSortZA\r\n
            });\r\n
            me.btnSetAutofilter = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-setautofilter",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-autofilter",\r\n
                hint: me.txtFilter + " (Ctrl+Shift+L)",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleFilter],\r\n
                enableToggle: true\r\n
            });\r\n
            me.btnClearAutofilter = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-clearfilter",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-clear-filter",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleDelFilter],\r\n
                hint: me.txtClearFilter\r\n
            });\r\n
            me.btnTableTemplate = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-ttempl",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-ttempl",\r\n
                hint: me.txtTableTemplate,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleFilter],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-toolbar-menu-table-templates" style="width: 285px; height: 300px; margin: 3px 10px;"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.listStyles = new Common.UI.ComboDataView({\r\n
                cls: "combo-styles",\r\n
                enableKeyEvents: true,\r\n
                itemWidth: 104,\r\n
                itemHeight: 38,\r\n
                hint: this.tipCellStyle,\r\n
                menuMaxHeight: 226,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                beforeOpenHandler: function (e) {\r\n
                    var cmp = this,\r\n
                    menu = cmp.openButton.menu,\r\n
                    minMenuColumn = 6;\r\n
                    if (menu.cmpEl) {\r\n
                        var itemEl = $(cmp.cmpEl.find(".dataview.inner .style").get(0)).parent();\r\n
                        var itemMargin = -1;\r\n
                        var itemWidth = itemEl.is(":visible") ? parseInt(itemEl.css("width")) : 112;\r\n
                        var minCount = cmp.menuPicker.store.length >= minMenuColumn ? minMenuColumn : cmp.menuPicker.store.length,\r\n
                        columnCount = Math.min(cmp.menuPicker.store.length, Math.round($(".dataview", $(cmp.fieldPicker.el)).width() / (itemMargin + itemWidth) + 0.5));\r\n
                        columnCount = columnCount < minCount ? minCount : columnCount;\r\n
                        menu.menuAlignEl = cmp.cmpEl;\r\n
                        menu.menuAlign = "tl-tl";\r\n
                        menu.setOffset(cmp.cmpEl.width() - cmp.openButton.$el.width() - columnCount * (itemMargin + itemWidth) - 1);\r\n
                        menu.cmpEl.css({\r\n
                            "width": columnCount * (itemWidth + itemMargin),\r\n
                            "min-height": cmp.cmpEl.height()\r\n
                        });\r\n
                    }\r\n
                }\r\n
            });\r\n
            var formatTemplate = _.template(\'<a id="<%= id %>" style="white-space: normal;"><%= caption %><span style="float: right; color: silver;"><%= options.tplval ? options.tplval : options.value %></span></a>\');\r\n
            me.btnNumberFormat = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-num-format",\r\n
                cls: "btn-toolbar btn-toolbar-default btn-text-value",\r\n
                hint: me.tipNumFormat,\r\n
                caption: me.txtGeneral,\r\n
                style: "width: 100%;",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.selRange, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "margin-left: -1px;",\r\n
                    items: [{\r\n
                        caption: me.txtGeneral,\r\n
                        value: me.ascFormatOptions.General\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtNumber,\r\n
                        value: me.ascFormatOptions.Number\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtInteger,\r\n
                        value: "#0"\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtScientific,\r\n
                        value: me.ascFormatOptions.Scientific\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtAccounting,\r\n
                        menu: new Common.UI.Menu({\r\n
                            style: "min-width: 120px;",\r\n
                            menuAlign: "tl-tr",\r\n
                            items: [{\r\n
                                caption: me.txtDollar,\r\n
                                value: me.ascFormatOptions.Accounting\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtEuro,\r\n
                                value: \'_(â‚¬* #,##0.00_);_(â‚¬* (#,##0.00);_(â‚¬* "-"??_);_(@_)\'\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtPound,\r\n
                                value: \'_(Â£* #,##0.00_);_(Â£* (#,##0.00);_(Â£* "-"??_);_(@_)\'\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtRouble,\r\n
                                value: \'_-* #,##0.00[$Ñ€.-419]_-;-* #,##0.00[$Ñ€.-419]_-;_-* "-"??[$Ñ€.-419]_-;_-@_-\'\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtYen,\r\n
                                value: \'_(Â¥* #,##0.00_);_(Â¥* (#,##0.00);_(Â¥* "-"??_);_(@_)\'\r\n
                            }]\r\n
                        })\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtCurrency,\r\n
                        menu: new Common.UI.Menu({\r\n
                            style: "min-width: 120px;",\r\n
                            menuAlign: "tl-tr",\r\n
                            items: [{\r\n
                                caption: me.txtDollar,\r\n
                                value: me.ascFormatOptions.Currency\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtEuro,\r\n
                                value: "â‚¬#,##0.00"\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtPound,\r\n
                                value: "Â£#,##0.00"\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtRouble,\r\n
                                value: "#,##0.00Ñ€."\r\n
                            },\r\n
                            {\r\n
                                caption: me.txtYen,\r\n
                                value: "Â¥#,##0.00"\r\n
                            }]\r\n
                        })\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtDate,\r\n
                        menu: new Common.UI.Menu({\r\n
                            style: "min-width: 200px;",\r\n
                            menuAlign: "tl-tr",\r\n
                            items: [{\r\n
                                caption: "07-24-88",\r\n
                                value: "MM-dd-yy",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "07-24-1988",\r\n
                                value: "MM-dd-yyyy",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "24-07-88",\r\n
                                value: "dd-MM-yy",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "24-07-1988",\r\n
                                value: "dd-MM-yyyy",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "24-Jul-1988",\r\n
                                value: "dd-MMM-yyyy",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "24-Jul",\r\n
                                value: "dd-MMM",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "Jul-88",\r\n
                                value: "MMM-yy",\r\n
                                template: formatTemplate\r\n
                            }]\r\n
                        })\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtTime,\r\n
                        menu: new Common.UI.Menu({\r\n
                            style: "min-width: 200px;",\r\n
                            menuAlign: "tl-tr",\r\n
                            showSeparator: false,\r\n
                            items: [{\r\n
                                caption: "10:56",\r\n
                                value: "HH:mm",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "21:56:00",\r\n
                                value: "HH:MM:ss",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "05:56 AM",\r\n
                                tplval: "hh:mm tt",\r\n
                                value: "hh:mm AM/PM",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "05:56:00 AM",\r\n
                                tplval: "hh:mm:ss tt",\r\n
                                value: "hh:mm:ss AM/PM",\r\n
                                template: formatTemplate\r\n
                            },\r\n
                            {\r\n
                                caption: "38:56:00",\r\n
                                value: "[h]:mm:ss",\r\n
                                template: formatTemplate\r\n
                            }]\r\n
                        })\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtPercentage,\r\n
                        value: me.ascFormatOptions.Percentage\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtText,\r\n
                        value: me.ascFormatOptions.Text\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnPercentStyle = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-percent-style",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-percent-style",\r\n
                hint: me.tipDigStylePercent,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                formatId: me.ascFormatOptions.Percent\r\n
            });\r\n
            me.btnCurrencyStyle = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-accounting-style",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-currency-style",\r\n
                hint: me.tipDigStyleAccounting,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                formatId: me.ascFormatOptions.Accounting,\r\n
                split: true,\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "min-width: 120px;",\r\n
                    items: [{\r\n
                        caption: me.txtDollar,\r\n
                        value: me.ascFormatOptions.Accounting\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtEuro,\r\n
                        value: \'_(â‚¬* #,##0.00_);_(â‚¬* (#,##0.00);_(â‚¬* "-"??_);_(@_)\'\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtPound,\r\n
                        value: \'_(Â£* #,##0.00_);_(Â£* (#,##0.00);_(Â£* "-"??_);_(@_)\'\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtRouble,\r\n
                        value: \'_-* #,##0.00[$Ñ€.-419]_-;-* #,##0.00[$Ñ€.-419]_-;_-* "-"??[$Ñ€.-419]_-;_-@_-\'\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtYen,\r\n
                        value: \'_(Â¥* #,##0.00_);_(Â¥* (#,##0.00);_(Â¥* "-"??_);_(@_)\'\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnDecDecimal = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-decdecimal",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-decdecimal",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                hint: me.tipDecDecimal\r\n
            });\r\n
            me.btnIncDecimal = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-incdecimal",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-incdecimal",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                hint: me.tipIncDecimal\r\n
            });\r\n
            me.btnInsertFormula = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-insertformula",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-formula",\r\n
                hint: me.txtFormula,\r\n
                split: true,\r\n
                lock: [_set.editText, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.selRange, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "min-width: 110px",\r\n
                    items: [{\r\n
                        caption: "SUM",\r\n
                        value: "SUM"\r\n
                    },\r\n
                    {\r\n
                        caption: "MIN",\r\n
                        value: "MIN"\r\n
                    },\r\n
                    {\r\n
                        caption: "MAX",\r\n
                        value: "MAX"\r\n
                    },\r\n
                    {\r\n
                        caption: "COUNT",\r\n
                        value: "COUNT"\r\n
                    },\r\n
                    {\r\n
                        caption: "--"\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtAdditional,\r\n
                        value: "more"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnClearStyle = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-clear",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-clearstyle",\r\n
                hint: me.tipClearStyle,\r\n
                lock: [_set.lostConnect, _set.coAuth, _set.selRange],\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "min-width: 110px",\r\n
                    items: [{\r\n
                        caption: me.txtClearAll,\r\n
                        value: c_oAscCleanOptions.All\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearText,\r\n
                        lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth],\r\n
                        value: c_oAscCleanOptions.Text\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearFormat,\r\n
                        lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth],\r\n
                        value: c_oAscCleanOptions.Format\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearComments,\r\n
                        lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth],\r\n
                        value: c_oAscCleanOptions.Comments\r\n
                    },\r\n
                    {\r\n
                        caption: me.txtClearHyper,\r\n
                        lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth],\r\n
                        value: c_oAscCleanOptions.Hyperlinks\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnCopyStyle = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-copystyle",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-copystyle",\r\n
                hint: this.tipCopyStyle,\r\n
                lock: [_set.editCell, _set.lostConnect, _set.coAuth, _set.selChart],\r\n
                enableToggle: true\r\n
            });\r\n
            me.btnAddCell = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-addcell",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-addcell",\r\n
                hint: me.tipInsertOpt,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.textInsRight,\r\n
                        value: c_oAscInsertOptions.InsertCellsAndShiftRight\r\n
                    },\r\n
                    {\r\n
                        caption: me.textInsDown,\r\n
                        value: c_oAscInsertOptions.InsertCellsAndShiftDown\r\n
                    },\r\n
                    {\r\n
                        caption: me.textEntireRow,\r\n
                        value: c_oAscInsertOptions.InsertRows\r\n
                    },\r\n
                    {\r\n
                        caption: me.textEntireCol,\r\n
                        value: c_oAscInsertOptions.InsertColumns\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnDeleteCell = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-delcell",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-delcell",\r\n
                hint: me.tipDeleteOpt,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.textDelLeft,\r\n
                        value: c_oAscDeleteOptions.DeleteCellsAndShiftLeft\r\n
                    },\r\n
                    {\r\n
                        caption: me.textDelUp,\r\n
                        value: c_oAscDeleteOptions.DeleteCellsAndShiftTop\r\n
                    },\r\n
                    {\r\n
                        caption: me.textEntireRow,\r\n
                        value: c_oAscDeleteOptions.DeleteRows\r\n
                    },\r\n
                    {\r\n
                        caption: me.textEntireCol,\r\n
                        value: c_oAscDeleteOptions.DeleteColumns\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnColorSchemas = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-colorschemas",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-colorschemas",\r\n
                hint: me.tipColorSchemas,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [],\r\n
                    maxHeight: 600,\r\n
                    restoreHeight: 600\r\n
                }).on("render:after", function (mnu) {\r\n
                    this.scroller = new Common.UI.Scroller({\r\n
                        el: $(this.el).find(".dropdown-menu "),\r\n
                        useKeyboard: this.enableKeyEvents && !this.handleSelect,\r\n
                        minScrollbarLength: 40,\r\n
                        alwaysVisibleY: true\r\n
                    });\r\n
                }).on("show:after", function (btn, e) {\r\n
                    var mnu = $(this.el).find(".dropdown-menu "),\r\n
                    docH = $(document).height(),\r\n
                    menuH = mnu.outerHeight(),\r\n
                    top = parseInt(mnu.css("top"));\r\n
                    if (menuH > docH) {\r\n
                        mnu.css("max-height", (docH - parseInt(mnu.css("padding-top")) - parseInt(mnu.css("padding-bottom")) - 5) + "px");\r\n
                        this.scroller.update({\r\n
                            minScrollbarLength: 40\r\n
                        });\r\n
                    } else {\r\n
                        if (mnu.height() < this.options.restoreHeight) {\r\n
                            mnu.css("max-height", (Math.min(docH - parseInt(mnu.css("padding-top")) - parseInt(mnu.css("padding-bottom")) - 5, this.options.restoreHeight)) + "px");\r\n
                            menuH = mnu.outerHeight();\r\n
                            if (top + menuH > docH) {\r\n
                                mnu.css("top", 0);\r\n
                            }\r\n
                            this.scroller.update({\r\n
                                minScrollbarLength: 40\r\n
                            });\r\n
                        }\r\n
                    }\r\n
                })\r\n
            });\r\n
            me.mnuZoomIn = dummyCmp();\r\n
            me.mnuZoomOut = dummyCmp();\r\n
            me.btnShowMode = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-showmode",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-showmode",\r\n
                hint: me.tipViewSettings,\r\n
                lock: [_set.menuFileOpen, _set.editCell],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [me.mnuitemCompactToolbar = new Common.UI.MenuItem({\r\n
                        caption: me.textCompactToolbar,\r\n
                        checkable: true,\r\n
                        checked: me.isCompactView,\r\n
                        value: "compact"\r\n
                    }), me.mnuitemHideTitleBar = new Common.UI.MenuItem({\r\n
                        caption: me.textHideTBar,\r\n
                        checkable: true,\r\n
                        checked: !!options.title,\r\n
                        value: "title"\r\n
                    }), {\r\n
                        caption: me.textHideFBar,\r\n
                        checkable: true,\r\n
                        checked: !!options.formula,\r\n
                        value: "formula"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textHideHeadings,\r\n
                        checkable: true,\r\n
                        checked: !!options.headings,\r\n
                        value: "headings"\r\n
                    },\r\n
                    {\r\n
                        caption: me.textHideGridlines,\r\n
                        checkable: true,\r\n
                        checked: false,\r\n
                        value: "gridlines"\r\n
                    },\r\n
                    {\r\n
                        caption: this.textFreezePanes,\r\n
                        checkable: true,\r\n
                        checked: false,\r\n
                        value: "freezepanes"\r\n
                    },\r\n
                    {\r\n
                        caption: "--"\r\n
                    },\r\n
                    (new Common.UI.MenuItem({\r\n
                        template: _.template([\'<div id="id-toolbar-menu-zoom" class="menu-zoom" style="height: 25px;" \', "<% if(!_.isUndefined(options.stopPropagation)) { %>", \'data-stopPropagation="true"\', "<% } %>", ">", \'<label class="title">\' + me.textZoom + "</label>", \'<button id="id-menu-zoom-in" type="button" style="float:right; margin: 2px 5px 0 0;" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-zoomin">&nbsp;</span></button>\', \'<label class="zoom">100%</label>\', \'<button id="id-menu-zoom-out" type="button" style="float:right; margin-top: 2px;" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-zoomout">&nbsp;</span></button>\', "</div>"].join("")),\r\n
                        stopPropagation: true\r\n
                    }))]\r\n
                })\r\n
            }).on("render:after", _.bind(function (cmp) {\r\n
                me.mnuZoomOut = new Common.UI.Button({\r\n
                    el: $("#id-menu-zoom-out"),\r\n
                    cls: "btn-toolbar btn-toolbar-default"\r\n
                });\r\n
                me.mnuZoomIn = new Common.UI.Button({\r\n
                    el: $("#id-menu-zoom-in"),\r\n
                    cls: "btn-toolbar btn-toolbar-default"\r\n
                });\r\n
            }), me);\r\n
            me.btnSettings = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-settings",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-settings",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth],\r\n
                hint: me.tipAdvSettings\r\n
            });\r\n
            me.btnHorizontalAlign = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-halign",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-align-left",\r\n
                hint: me.tipHAligh,\r\n
                icls: "btn-align-left",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.tipAlignLeft,\r\n
                        iconCls: "mnu-align-left",\r\n
                        icls: "btn-align-left",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        toggleGroup: "halignGroup",\r\n
                        checked: true,\r\n
                        value: "left"\r\n
                    },\r\n
                    {\r\n
                        caption: me.tipAlignCenter,\r\n
                        iconCls: "mnu-align-center",\r\n
                        icls: "btn-align-center",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        toggleGroup: "halignGroup",\r\n
                        value: "center"\r\n
                    },\r\n
                    {\r\n
                        caption: me.tipAlignRight,\r\n
                        iconCls: "mnu-align-right",\r\n
                        icls: "btn-align-right",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        toggleGroup: "halignGroup",\r\n
                        value: "right"\r\n
                    },\r\n
                    {\r\n
                        caption: me.tipAlignJust,\r\n
                        iconCls: "mnu-align-just",\r\n
                        icls: "btn-align-just",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        toggleGroup: "halignGroup",\r\n
                        value: "justify"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnVerticalAlign = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-valign",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-valign-bottom",\r\n
                hint: me.tipVAligh,\r\n
                icls: "btn-valign-bottom",\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.lostConnect, _set.coAuth],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        caption: me.tipAlignTop,\r\n
                        iconCls: "mnu-valign-top",\r\n
                        icls: "btn-valign-top",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        toggleGroup: "valignGroup",\r\n
                        value: "top"\r\n
                    },\r\n
                    {\r\n
                        caption: me.tipAlignCenter,\r\n
                        iconCls: "mnu-valign-middle",\r\n
                        icls: "btn-valign-middle",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        toggleGroup: "valignGroup",\r\n
                        value: "center"\r\n
                    },\r\n
                    {\r\n
                        caption: me.tipAlignBottom,\r\n
                        iconCls: "mnu-valign-bottom",\r\n
                        icls: "btn-valign-bottom",\r\n
                        checkable: true,\r\n
                        allowDepress: true,\r\n
                        checked: true,\r\n
                        toggleGroup: "valignGroup",\r\n
                        value: "bottom"\r\n
                    }]\r\n
                })\r\n
            });\r\n
            me.btnAutofilter = new Common.UI.Button({\r\n
                id: "id-toolbar-btn-autofilter",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-autofilter",\r\n
                hint: me.tipAutofilter,\r\n
                lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.lostConnect, _set.coAuth, _set.ruleFilter],\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [me.mnuitemSortAZ = new Common.UI.MenuItem({\r\n
                        caption: me.txtSortAZ,\r\n
                        iconCls: "mnu-sort-asc",\r\n
                        lock: [_set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth, _set.ruleFilter],\r\n
                        value: "ascending"\r\n
                    }), me.mnuitemSortZA = new Common.UI.MenuItem({\r\n
                        caption: me.txtSortZA,\r\n
                        iconCls: "mnu-sort-desc",\r\n
                        lock: [_set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth, _set.ruleFilter],\r\n
                        value: "descending"\r\n
                    }), me.mnuitemAutoFilter = new Common.UI.MenuItem({\r\n
                        caption: me.txtFilter,\r\n
                        iconCls: "mnu-filter-add",\r\n
                        checkable: true,\r\n
                        lock: [_set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth, _set.ruleFilter],\r\n
                        value: "set-filter"\r\n
                    }), me.mnuitemClearFilter = new Common.UI.MenuItem({\r\n
                        caption: me.txtClearFilter,\r\n
                        iconCls: "mnu-filter-clear",\r\n
                        lock: [_set.editCell, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.selImage, _set.coAuth, _set.ruleDelFilter],\r\n
                        value: "clear-filter"\r\n
                    })]\r\n
                })\r\n
            });\r\n
            me.mnuPrint = me.btnPrint.menu;\r\n
            me.lockControls = [me.cmbFontName, me.cmbFontSize, me.btnIncFontSize, me.btnDecFontSize, me.btnBold, me.btnItalic, me.btnUnderline, me.btnTextColor, me.btnHorizontalAlign, me.btnAlignLeft, me.btnAlignCenter, me.btnAlignRight, me.btnAlignJust, me.btnVerticalAlign, me.btnAlignTop, me.btnAlignMiddle, me.btnAlignBottom, me.btnWrap, me.btnTextOrient, me.btnBackColor, me.btnMerge, me.btnInsertFormula, me.btnIncDecimal, me.btnInsertShape, me.btnInsertText, me.btnSortUp, me.btnSortDown, me.btnSetAutofilter, me.btnClearAutofilter, me.btnTableTemplate, me.btnPercentStyle, me.btnCurrencyStyle, me.btnDecDecimal, me.btnAddCell, me.btnDeleteCell, me.btnNumberFormat, me.btnBorders, me.btnInsertImage, me.btnInsertHyperlink, me.btnInsertChart, me.btnColorSchemas, me.btnAutofilter, me.btnCopy, me.btnPaste, me.btnSettings, me.listStyles, me.btnPrint, me.btnShowMode, me.btnClearStyle, me.btnCopyStyle];\r\n
            var hidetip = window.localStorage.getItem("sse-hide-synch");\r\n
            me.showSynchTip = !(hidetip && parseInt(hidetip) == 1);\r\n
            me.needShowSynchTip = false;\r\n
            var _temp_array = [me.cmbFontName, me.cmbFontSize, me.btnAlignLeft, me.btnAlignCenter, me.btnAlignRight, me.btnAlignJust, me.btnAlignTop, me.btnAlignMiddle, me.btnAlignBottom, me.btnHorizontalAlign, me.btnVerticalAlign, me.btnInsertImage, me.btnInsertText, me.btnInsertShape, me.btnIncFontSize, me.btnDecFontSize, me.btnBold, me.btnItalic, me.btnUnderline, me.btnTextColor, me.btnBackColor, me.btnInsertHyperlink, me.btnBorders, me.btnTextOrient, me.btnPercentStyle, me.btnCurrencyStyle, me.btnColorSchemas, me.btnSettings, me.btnInsertFormula, me.btnDecDecimal, me.btnIncDecimal, me.btnNumberFormat, me.btnWrap, me.btnInsertChart, me.btnMerge, me.btnAddCell, me.btnDeleteCell, me.btnShowMode, me.btnPrint, me.btnAutofilter, me.btnSortUp, me.btnSortDown, me.btnTableTemplate, me.btnSetAutofilter, me.btnClearAutofilter, me.btnSave, me.btnClearStyle, me.btnCopyStyle, me.btnCopy, me.btnPaste];\r\n
            _.each(_temp_array, function (cmp) {\r\n
                if (cmp && _.isFunction(cmp.setDisabled)) {\r\n
                    cmp.setDisabled(true);\r\n
                }\r\n
            });\r\n
            return this;\r\n
        },\r\n
        lockToolbar: function (causes, lock, opts) { ! opts && (opts = {});\r\n
            var controls = opts.array || this.lockControls;\r\n
            opts.merge && (controls = _.union(this.lockControls, controls));\r\n
            function doLock(cmp, cause) {\r\n
                if (_.contains(cmp.options.lock, cause)) {\r\n
                    var index = cmp.keepState.indexOf(cause);\r\n
                    if (lock) {\r\n
                        if (index < 0) {\r\n
                            cmp.keepState.push(cause);\r\n
                        }\r\n
                    } else {\r\n
                        if (! (index < 0)) {\r\n
                            cmp.keepState.splice(index, 1);\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            _.each(controls, function (item) {\r\n
                if (_.isFunction(item.setDisabled)) { ! item.keepState && (item.keepState = []);\r\n
                    if (opts.clear && opts.clear.length > 0 && item.keepState.length > 0) {\r\n
                        item.keepState = _.difference(item.keepState, opts.clear);\r\n
                    }\r\n
                    _.isArr

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABI=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="18" aka="AAAAAAAAABI=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

ay(causes) ? _.each(causes, function (c) {\r\n
                        doLock(item, c);\r\n
                    }) : doLock(item, causes);\r\n
                    if (! (item.keepState.length > 0)) {\r\n
                        item.isDisabled() && item.setDisabled(false);\r\n
                    } else { ! item.isDisabled() && item.setDisabled(true);\r\n
                    }\r\n
                }\r\n
            });\r\n
        },\r\n
        render: function (isEditDiagram) {\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            this.trigger("render:before", this);\r\n
            el.html(this.template({\r\n
                isEditDiagram: isEditDiagram,\r\n
                isCompactView: this.isCompactView\r\n
            }));\r\n
            me.rendererComponents(isEditDiagram ? "diagram" : this.isCompactView ? "short" : "full");\r\n
            this.trigger("render:after", this);\r\n
            return this;\r\n
        },\r\n
        rendererComponents: function (mode) {\r\n
            var replacePlacholder = function (id, cmp) {\r\n
                var placeholderEl = $(id),\r\n
                placeholderDom = placeholderEl.get(0);\r\n
                if (placeholderDom) {\r\n
                    if (cmp.rendered) {\r\n
                        cmp.el = document.getElementById(cmp.id);\r\n
                        placeholderDom.appendChild(document.getElementById(cmp.id));\r\n
                    } else {\r\n
                        cmp.render(placeholderEl);\r\n
                    }\r\n
                }\r\n
            };\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-field-fontname", this.cmbFontName);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-field-fontsize", this.cmbFontSize);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-newdocument", this.btnNewDocument);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-opendocument", this.btnOpenDocument);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-print", this.btnPrint);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-save", this.btnSave);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-undo", this.btnUndo);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-redo", this.btnRedo);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-copy", this.btnCopy);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-paste", this.btnPaste);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-incfont", this.btnIncFontSize);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-decfont", this.btnDecFontSize);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-bold", this.btnBold);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-italic", this.btnItalic);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-underline", this.btnUnderline);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-fontcolor", this.btnTextColor);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-fillparag", this.btnBackColor);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-borders", this.btnBorders);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-align-left", this.btnAlignLeft);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-align-center", this.btnAlignCenter);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-align-right", this.btnAlignRight);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-align-just", this.btnAlignJust);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-merge", this.btnMerge);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-top", this.btnAlignTop);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-middle", this.btnAlignMiddle);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-bottom", this.btnAlignBottom);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-wrap", this.btnWrap);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-text-orient", this.btnTextOrient);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-insertimage", this.btnInsertImage);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-inserthyperlink", this.btnInsertHyperlink);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-insertshape", this.btnInsertShape);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-text", this.btnInsertText);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-sortdesc", this.btnSortDown);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-sortasc", this.btnSortUp);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-setfilter", this.btnSetAutofilter);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-clear-filter", this.btnClearAutofilter);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-table-tpl", this.btnTableTemplate);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-format", this.btnNumberFormat);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-percents", this.btnPercentStyle);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-currency", this.btnCurrencyStyle);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-digit-dec", this.btnDecDecimal);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-digit-inc", this.btnIncDecimal);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-formula", this.btnInsertFormula);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-clear", this.btnClearStyle);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-copystyle", this.btnCopyStyle);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-cell-ins", this.btnAddCell);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-cell-del", this.btnDeleteCell);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-colorschemas", this.btnColorSchemas);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-hidebars", this.btnShowMode);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-settings", this.btnSettings);\r\n
            replacePlacholder("#id-toolbar-" + mode + "-placeholder-btn-insertchart", this.btnInsertChart);\r\n
            replacePlacholder("#id-toolbar-diagram-placeholder-btn-chart", this.btnEditChart);\r\n
            replacePlacholder("#id-toolbar-short-placeholder-btn-halign", this.btnHorizontalAlign);\r\n
            replacePlacholder("#id-toolbar-short-placeholder-btn-valign", this.btnVerticalAlign);\r\n
            replacePlacholder("#id-toolbar-short-placeholder-btn-filter", this.btnAutofilter);\r\n
            replacePlacholder("#id-toolbar-full-placeholder-field-styles", this.listStyles);\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            if (!this.mode.isEditDiagram) {\r\n
                this.api.asc_registerCallback("asc_onCollaborativeChanges", _.bind(this.onApiCollaborativeChanges, this));\r\n
                this.api.asc_registerCallback("asc_onSendThemeColorSchemes", _.bind(this.onApiSendThemeColorSchemes, this));\r\n
                this.api.asc_registerCallback("asc_onAuthParticipantsChanged", _.bind(this.onApiUsersChanged, this));\r\n
                this.api.asc_registerCallback("asc_onParticipantsChanged", _.bind(this.onApiUsersChanged, this));\r\n
            }\r\n
            return this;\r\n
        },\r\n
        setMode: function (mode) {\r\n
            if (mode.isDisconnected) {\r\n
                this.lockToolbar(SSE.enumLock.lostConnect, true);\r\n
                this.lockToolbar(SSE.enumLock.lostConnect, true, {\r\n
                    array: [this.btnEditChart, this.btnUndo, this.btnRedo, this.btnOpenDocument, this.btnNewDocument, this.btnSave]\r\n
                });\r\n
            } else {\r\n
                this.mode = mode;\r\n
                if (!mode.nativeApp) {\r\n
                    var nativeBtnGroup = $(".toolbar-group-native");\r\n
                    if (nativeBtnGroup) {\r\n
                        nativeBtnGroup.hide();\r\n
                    }\r\n
                }\r\n
                if (mode.isDesktopApp) {\r\n
                    $(".toolbar-group-native").hide();\r\n
                    this.mnuitemHideTitleBar.hide();\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiSendThemeColorSchemes: function (schemas) {\r\n
            var me = this;\r\n
            this.mnuColorSchema = this.btnColorSchemas.menu;\r\n
            if (this.mnuColorSchema && this.mnuColorSchema.items.length > 0) {\r\n
                _.each(this.mnuColorSchema.items, function (item) {\r\n
                    item.remove();\r\n
                });\r\n
            }\r\n
            if (this.mnuColorSchema == null) {\r\n
                this.mnuColorSchema = new Common.UI.Menu({\r\n
                    maxHeight: 600,\r\n
                    restoreHeight: 600\r\n
                }).on("render:after", function (mnu) {\r\n
                    this.scroller = new Common.UI.Scroller({\r\n
                        el: $(this.el).find(".dropdown-menu "),\r\n
                        useKeyboard: this.enableKeyEvents && !this.handleSelect,\r\n
                        minScrollbarLength: 40\r\n
                    });\r\n
                });\r\n
            }\r\n
            this.mnuColorSchema.items = [];\r\n
            var itemTemplate = _.template([\'<a id="<%= id %>" class="<%= options.cls %>" tabindex="-1" type="menuitem">\', \'<span class="colors">\', "<% _.each(options.colors, function(color) { %>", \'<span class="color" style="background: <%= color %>;"></span>\', "<% }) %>", "</span>", \'<span class="text"><%= caption %></span>\', "</a>"].join(""));\r\n
            _.each(schemas, function (schema, index) {\r\n
                var colors = schema.get_colors();\r\n
                var schemecolors = [];\r\n
                for (var j = 2; j < 7; j++) {\r\n
                    var clr = "#" + Common.Utils.ThemeColor.getHexColor(colors[j].get_r(), colors[j].get_g(), colors[j].get_b());\r\n
                    schemecolors.push(clr);\r\n
                }\r\n
                if (index == 21) {\r\n
                    this.mnuColorSchema.addItem({\r\n
                        caption: "--"\r\n
                    });\r\n
                } else {\r\n
                    this.mnuColorSchema.addItem({\r\n
                        template: itemTemplate,\r\n
                        cls: "color-schemas-menu",\r\n
                        colors: schemecolors,\r\n
                        caption: (index < 21) ? (me.SchemeNames[index] || schema.get_name()) : schema.get_name(),\r\n
                        value: index\r\n
                    });\r\n
                }\r\n
            },\r\n
            this);\r\n
        },\r\n
        onApiCollaborativeChanges: function () {\r\n
            if (this._state.hasCollaborativeChanges) {\r\n
                return;\r\n
            }\r\n
            if (!this.btnSave.rendered) {\r\n
                this.needShowSynchTip = true;\r\n
                return;\r\n
            }\r\n
            this._state.hasCollaborativeChanges = true;\r\n
            var iconEl = $(".btn-icon", this.btnSave.cmpEl);\r\n
            iconEl.removeClass(this.btnSaveCls);\r\n
            iconEl.addClass("btn-synch");\r\n
            if (this.showSynchTip) {\r\n
                this.btnSave.updateHint("");\r\n
                if (this.synchTooltip === undefined) {\r\n
                    this.createSynchTip();\r\n
                }\r\n
                this.synchTooltip.show();\r\n
            } else {\r\n
                this.btnSave.updateHint(this.tipSynchronize + Common.Utils.String.platformKey("Ctrl+S"));\r\n
            }\r\n
            this.btnSave.setDisabled(false);\r\n
        },\r\n
        createSynchTip: function () {\r\n
            this.synchTooltip = new Common.UI.SynchronizeTip({\r\n
                target: $("#id-toolbar-btn-save")\r\n
            });\r\n
            this.synchTooltip.on("dontshowclick", function () {\r\n
                this.showSynchTip = false;\r\n
                this.synchTooltip.hide();\r\n
                this.btnSave.updateHint(this.tipSynchronize + Common.Utils.String.platformKey("Ctrl+S"));\r\n
                window.localStorage.setItem("sse-hide-synch", 1);\r\n
            },\r\n
            this);\r\n
            this.synchTooltip.on("closeclick", function () {\r\n
                this.synchTooltip.hide();\r\n
                this.btnSave.updateHint(this.tipSynchronize + Common.Utils.String.platformKey("Ctrl+S"));\r\n
            },\r\n
            this);\r\n
        },\r\n
        synchronizeChanges: function () {\r\n
            if (this.btnSave.rendered) {\r\n
                var iconEl = $(".btn-icon", this.btnSave.cmpEl);\r\n
                if (iconEl.hasClass("btn-synch")) {\r\n
                    iconEl.removeClass("btn-synch");\r\n
                    iconEl.addClass(this.btnSaveCls);\r\n
                    if (this.synchTooltip) {\r\n
                        this.synchTooltip.hide();\r\n
                    }\r\n
                    this.btnSave.updateHint(this.btnSaveTip);\r\n
                    this.btnSave.setDisabled(true);\r\n
                    this._state.hasCollaborativeChanges = false;\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiUsersChanged: function (users) {\r\n
            var length = _.size(users);\r\n
            var cls = (length > 1) ? "btn-save-coauth" : "btn-save";\r\n
            if (cls !== this.btnSaveCls && this.btnSave.rendered) {\r\n
                this.btnSaveTip = ((length > 1) ? this.tipSaveCoauth : this.tipSave) + Common.Utils.String.platformKey("Ctrl+S");\r\n
                var iconEl = $(".btn-icon", this.btnSave.cmpEl);\r\n
                if (!iconEl.hasClass("btn-synch")) {\r\n
                    iconEl.removeClass(this.btnSaveCls);\r\n
                    iconEl.addClass(cls);\r\n
                    this.btnSave.updateHint(this.btnSaveTip);\r\n
                }\r\n
                this.btnSaveCls = cls;\r\n
            }\r\n
        },\r\n
        textBold: "Bold",\r\n
        textItalic: "Italic",\r\n
        textUnderline: "Underline",\r\n
        tipFontName: "Font Name",\r\n
        tipFontSize: "Font Size",\r\n
        tipCellStyle: "Cell Style",\r\n
        tipCopy: "Copy",\r\n
        tipPaste: "Paste",\r\n
        tipUndo: "Undo",\r\n
        tipRedo: "Redo",\r\n
        tipPrint: "Print",\r\n
        tipSave: "Save",\r\n
        tipFontColor: "Font color",\r\n
        tipPrColor: "Background color",\r\n
        tipClearStyle: "Clear",\r\n
        tipCopyStyle: "Copy Style",\r\n
        tipBack: "Back",\r\n
        tipHAligh: "Horizontal Align",\r\n
        tipVAligh: "Vertical Align",\r\n
        tipAlignLeft: "Align Left",\r\n
        tipAlignRight: "Align Right",\r\n
        tipAlignCenter: "Align Center",\r\n
        tipAlignJust: "Justified",\r\n
        textAlignTop: "Align text to the top",\r\n
        textAlignMiddle: "Align text to the middle",\r\n
        textAlignBottom: "Align text to the bottom",\r\n
        tipNumFormat: "Number Format",\r\n
        txtNumber: "Number",\r\n
        txtInteger: "Integer",\r\n
        txtGeneral: "General",\r\n
        txtCustom: "Custom",\r\n
        txtCurrency: "Currency",\r\n
        txtDollar: "$ Dollar",\r\n
        txtEuro: "â‚¬ Euro",\r\n
        txtRouble: "Ñ€. Rouble",\r\n
        txtPound: "Â£ Pound",\r\n
        txtYen: "Â¥ Yen",\r\n
        txtAccounting: "Accounting",\r\n
        txtDate: "Date",\r\n
        txtTime: "Time",\r\n
        txtDateTime: "Date & Time",\r\n
        txtPercentage: "Percentage",\r\n
        txtScientific: "Scientific",\r\n
        txtText: "Text",\r\n
        tipBorders: "Borders",\r\n
        textOutBorders: "Outside Borders",\r\n
        textAllBorders: "All Borders",\r\n
        textTopBorders: "Top Borders",\r\n
        textBottomBorders: "Bottom Borders",\r\n
        textLeftBorders: "Left Borders",\r\n
        textRightBorders: "Right Borders",\r\n
        textNoBorders: "No Borders",\r\n
        textInsideBorders: "Inside Borders",\r\n
        textMiddleBorders: "Inside Horizontal Borders",\r\n
        textCenterBorders: "Inside Vertical Borders",\r\n
        textDiagDownBorder: "Diagonal Down Border",\r\n
        textDiagUpBorder: "Diagonal Up Border",\r\n
        tipWrap: "Wrap Text",\r\n
        txtClearAll: "All",\r\n
        txtClearText: "Text",\r\n
        txtClearFormat: "Format",\r\n
        txtClearFormula: "Formula",\r\n
        txtClearHyper: "Hyperlink",\r\n
        txtClearComments: "Comments",\r\n
        tipMerge: "Merge",\r\n
        txtMergeCenter: "Merge Center",\r\n
        txtMergeAcross: "Merge Across",\r\n
        txtMergeCells: "Merge Cells",\r\n
        txtUnmerge: "Unmerge Cells",\r\n
        tipIncDecimal: "Increase Decimal",\r\n
        tipDecDecimal: "Decrease Decimal",\r\n
        tipAutofilter: "Set Autofilter",\r\n
        tipInsertImage: "Insert Picture",\r\n
        tipInsertHyperlink: "Add Hyperlink",\r\n
        tipSynchronize: "The document has been changed by another user. Please click to save your changes and reload the updates.",\r\n
        tipIncFont: "Increment font size",\r\n
        tipDecFont: "Decrement font size",\r\n
        tipInsertText: "Insert Text",\r\n
        tipInsertShape: "Insert Autoshape",\r\n
        tipDigStylePercent: "Percent Style",\r\n
        tipDigStyleAccounting: "Accounting Style",\r\n
        tipViewSettings: "View Settings",\r\n
        tipAdvSettings: "Advanced Settings",\r\n
        tipTextOrientation: "Orientation",\r\n
        tipInsertOpt: "Insert Cells",\r\n
        tipDeleteOpt: "Delete Cells",\r\n
        tipAlignTop: "Align Top",\r\n
        tipAlignMiddle: "Align Middle",\r\n
        tipAlignBottom: "Align Bottom",\r\n
        textBordersWidth: "Borders Width",\r\n
        textBordersColor: "Borders Color",\r\n
        textAlignLeft: "Left align text",\r\n
        textAlignRight: "Right align text",\r\n
        textAlignCenter: "Center text",\r\n
        textAlignJust: "Justify",\r\n
        txtSort: "Sort",\r\n
        txtFormula: "Insert Function",\r\n
        txtNoBorders: "No borders",\r\n
        txtAdditional: "Additional",\r\n
        mniImageFromFile: "Picture from file",\r\n
        mniImageFromUrl: "Picture from url",\r\n
        textNewColor: "Add New Custom Color",\r\n
        tipInsertChart: "Insert Chart",\r\n
        tipEditChart: "Edit Chart",\r\n
        textPrint: "Print",\r\n
        textPrintOptions: "Print Options",\r\n
        textThemeColors: "Theme Colors",\r\n
        textStandartColors: "Standart Colors",\r\n
        tipColorSchemas: "Change Color Scheme",\r\n
        tipNewDocument: "New Document",\r\n
        tipOpenDocument: "Open Document",\r\n
        txtSortAZ: "Sort A to Z",\r\n
        txtSortZA: "Sort Z to A",\r\n
        txtFilter: "Filter",\r\n
        txtTableTemplate: "Format As Table Template",\r\n
        textHorizontal: "Horizontal Text",\r\n
        textCounterCw: "Angle Counterclockwise",\r\n
        textClockwise: "Angle Clockwise",\r\n
        textRotateUp: "Rotate Text Up",\r\n
        textRotateDown: "Rotate Text Down",\r\n
        textInsRight: "Shift Cells Right",\r\n
        textInsDown: "Shift Cells Down",\r\n
        textEntireRow: "Entire Row",\r\n
        textEntireCol: "Entire Column",\r\n
        textDelLeft: "Shift Cells Left",\r\n
        textDelUp: "Shift Cells Up",\r\n
        textZoom: "Zoom",\r\n
        textCompactToolbar: "Compact Toolbar",\r\n
        textHideTBar: "Hide Title Bar",\r\n
        textHideFBar: "Hide Formula Bar",\r\n
        textHideHeadings: "Hide Headings",\r\n
        textHideGridlines: "Hide Gridlines",\r\n
        textFreezePanes: "Freeze Panes",\r\n
        txtScheme1: "Office",\r\n
        txtScheme2: "Grayscale",\r\n
        txtScheme3: "Apex",\r\n
        txtScheme4: "Aspect",\r\n
        txtScheme5: "Civic",\r\n
        txtScheme6: "Concourse",\r\n
        txtScheme7: "Equity",\r\n
        txtScheme8: "Flow",\r\n
        txtScheme9: "Foundry",\r\n
        txtScheme10: "Median",\r\n
        txtScheme11: "Metro",\r\n
        txtScheme12: "Module",\r\n
        txtScheme13: "Opulent",\r\n
        txtScheme14: "Oriel",\r\n
        txtScheme15: "Origin",\r\n
        txtScheme16: "Paper",\r\n
        txtScheme17: "Solstice",\r\n
        txtScheme18: "Technic",\r\n
        txtScheme19: "Trek",\r\n
        txtScheme20: "Urban",\r\n
        txtScheme21: "Verve",\r\n
        txtClearFilter: "Clear Filter",\r\n
        tipSaveCoauth: "Save your changes for the other users to see them."\r\n
    },\r\n
    SSE.Views.Toolbar || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/model/TableTemplate\',["backbone"], function (Backbone) {\r\n
    SSE.Models = SSE.Models || {};\r\n
    SSE.Models.TableTemplate = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                name: null,\r\n
                caption: null,\r\n
                type: null,\r\n
                imageUrl: null\r\n
            };\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/collection/TableTemplates\',["backbone", "spreadsheeteditor/main/app/model/TableTemplate"], function (Backbone) {\r\n
    if (Common === undefined) {\r\n
        var Common = {};\r\n
    }\r\n
    Common.Collections = Common.Collections || {};\r\n
    SSE.Collections.TableTemplates = Backbone.Collection.extend({\r\n
        model: SSE.Models.TableTemplate\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'spreadsheeteditor/main/app/view/TableOptionsDialog\',["common/main/lib/component/ComboBox", "common/main/lib/component/CheckBox", "common/main/lib/component/InputField", "common/main/lib/component/Window"], function () {\r\n
    SSE.Views.TableOptionsDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 350,\r\n
            cls: "modal-dlg",\r\n
            modal: false\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.txtFormat\r\n
            },\r\n
            options);\r\n
            this.template = [\'<div class="box">\', \'<div id="id-dlg-tableoptions-range" class="input-row" style="margin-bottom: 10px;"></div>\', \'<div class="input-row" id="id-dlg-tableoptions-title"></div>\', "</div>", \'<div class="footer right">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + this.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + this.cancelButtonText + "</button>", "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var $window = this.getChild(),\r\n
            me = this;\r\n
            me.inputRange = new Common.UI.InputField({\r\n
                el: $("#id-dlg-tableoptions-range"),\r\n
                name: "range",\r\n
                style: "width: 100%;",\r\n
                allowBlank: false,\r\n
                blankError: this.txtEmpty,\r\n
                validateOnChange: true\r\n
            });\r\n
            me.cbTitle = new Common.UI.CheckBox({\r\n
                el: $("#id-dlg-tableoptions-title"),\r\n
                labelText: this.txtTitle\r\n
            });\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            me.inputRange.cmpEl.find("input").on("keypress", _.bind(this.onKeyPress, this));\r\n
            this.on("close", _.bind(this.onClose, this));\r\n
        },\r\n
        onPrimary: function () {\r\n
            this._handleInput("ok");\r\n
            return false;\r\n
        },\r\n
        setSettings: function (settings) {\r\n
            var me = this;\r\n
            if (settings.api) {\r\n
                me.api = settings.api;\r\n
                var options = me.api.asc_getAddFormatTableOptions();\r\n
                this.inputRange.setValue(options.asc_getRange());\r\n
                this.cbTitle.setValue(options.asc_getIsTitle());\r\n
                me.api.asc_setSelectionDialogMode(c_oAscSelectionDialogType.FormatTable, options.asc_getRange());\r\n
                me.api.asc_registerCallback("asc_onSelectionRangeChanged", _.bind(me.onApiRangeChanged, me));\r\n
                Common.NotificationCenter.trigger("cells:range", c_oAscSelectionDialogType.FormatTable);\r\n
            }\r\n
            me.inputRange.validation = function (value) {\r\n
                var isvalid = me.api.asc_checkDataRange(c_oAscSelectionDialogType.FormatTable, value, false);\r\n
                return (isvalid == c_oAscError.ID.DataRangeError) ? me.txtInvalidRange : true;\r\n
            };\r\n
        },\r\n
        getSettings: function () {\r\n
            var options = this.api.asc_getAddFormatTableOptions();\r\n
            options.asc_setRange(this.inputRange.getValue());\r\n
            options.asc_setIsTitle(this.cbTitle.checked);\r\n
            return options;\r\n
        },\r\n
        onApiRangeChanged: function (info) {\r\n
            this.inputRange.setValue(info);\r\n
            if (this.inputRange.cmpEl.hasClass("error")) {\r\n
                this.inputRange.cmpEl.removeClass("error");\r\n
            }\r\n
        },\r\n
        isRangeValid: function () {\r\n
            var isvalid = this.api.asc_checkDataRange(c_oAscSelectionDialogType.FormatTable, this.inputRange.getValue(), true);\r\n
            if (isvalid == c_oAscError.ID.No) {\r\n
                return true;\r\n
            } else {\r\n
                if (isvalid == c_oAscError.ID.AutoFilterDataRangeError) {\r\n
                    Common.UI.warning({\r\n
                        msg: this.errorAutoFilterDataRange\r\n
                    });\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            this._handleInput(event.currentTarget.attributes["result"].value);\r\n
        },\r\n
        onClose: function (event) {\r\n
            if (this.api) {\r\n
                this.api.asc_setSelectionDialogMode(c_oAscSelectionDialogType.None);\r\n
            }\r\n
            Common.NotificationCenter.trigger("cells:range", c_oAscSelectionDialogType.None);\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onKeyPress: function (event) {\r\n
            if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                this._handleInput("ok");\r\n
            }\r\n
        },\r\n
        _handleInput: function (state) {\r\n
            if (this.options.handler) {\r\n
                if (state == "ok") {\r\n
                    if (this.isRangeValid() !== true) {\r\n
                        return;\r\n
                    }\r\n
                }\r\n
                this.options.handler.call(this, this, state);\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        txtTitle: "Title",\r\n
        txtFormat: "Format as table",\r\n
        textCancel: "Cancel",\r\n
        txtEmpty: "This field is required",\r\n
        txtInvalidRange: "ERROR! Invalid cells range",\r\n
        errorAutoFilterDataRange: "The operation could not be done for the selected range of cells.<br>Select a uniform data range inside or outside the tableÂ and try again."\r\n
    },\r\n
    SSE.Views.TableOptionsDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/Toolbar\',["core", "common/main/lib/component/Window", "common/main/lib/view/CopyWarningDialog", "common/main/lib/view/ImageFromUrlDialog", "spreadsheeteditor/main/app/view/Toolbar", "spreadsheeteditor/main/app/collection/TableTemplates", "spreadsheeteditor/main/app/view/HyperlinkSettingsDialog", "spreadsheeteditor/main/app/view/TableOptionsDialog"], function () {\r\n
    SSE.Controllers.Toolbar = Backbone.Controller.extend({\r\n
        models: [],\r\n
        collections: [],\r\n
        views: ["Toolbar"],\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            this.addListeners({\r\n
                "Statusbar": {\r\n
                    "sheet:changed": _.bind(this.onApiSheetChanged, this)\r\n
                }\r\n
            });\r\n
            this.editMode = true;\r\n
            this._isAddingShape = false;\r\n
            this._state = {\r\n
                prstyle: undefined,\r\n
                clrtext: undefined,\r\n
                pralign: undefined,\r\n
                clrback: undefined,\r\n
                valign: undefined,\r\n
                can_undo: undefined,\r\n
                can_redo: undefined,\r\n
                bold: undefined,\r\n
                italic: undefined,\r\n
                underline: undefined,\r\n
                wrap: undefined,\r\n
                merge: undefined,\r\n
                filter: undefined,\r\n
                angle: undefined,\r\n
                controlsdisabled: {\r\n
                    rows: undefined,\r\n
                    cols: undefined,\r\n
                    filters: undefined,\r\n
                },\r\n
                show_copywarning: true,\r\n
                selection_type: undefined\r\n
            };\r\n
            var checkInsertAutoshape = function (e, action) {\r\n
                var cmp = $(e.target),\r\n
                cmp_sdk = cmp.closest("#editor_sdk"),\r\n
                btn_id = cmp.closest("button").attr("id");\r\n
                if (btn_id === undefined) {\r\n
                    btn_id = cmp.closest(".btn-group").attr("id");\r\n
                }\r\n
                if (me.api && me.api.asc_isAddAutoshape()) {\r\n
                    if (cmp_sdk.length <= 0 || action == "cancel") {\r\n
                        if (me.toolbar.btnInsertText.pressed && btn_id != me.toolbar.btnInsertText.id || me.toolbar.btnInsertShape.pressed && btn_id != me.toolbar.btnInsertShape.id) {\r\n
                            me._isAddingShape = false;\r\n
                            me._addAutoshape(false);\r\n
                            me.toolbar.btnInsertShape.toggle(false, true);\r\n
                            me.toolbar.btnInsertText.toggle(false, true);\r\n
                            Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                        } else {\r\n
                            if (me.toolbar.btnInsertShape.pressed && btn_id == me.toolbar.btnInsertShape.id) {\r\n
                                _.defer(function () {\r\n
                                    me.api.asc_endAddShape();\r\n
                                    Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                                },\r\n
                                100);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            };\r\n
            this.checkInsertAutoshape = function (cmp) {\r\n
                checkInsertAutoshape({},\r\n
                cmp.action);\r\n
            };\r\n
            this._addAutoshape = function (isstart, type) {\r\n
                if (this.api) {\r\n
                    if (isstart) {\r\n
                        this.api.asc_startAddShape(type);\r\n
                        $(document.body).on("mouseup", checkInsertAutoshape);\r\n
                    } else {\r\n
                        this.api.asc_endAddShape();\r\n
                        $(document.body).off("mouseup", checkInsertAutoshape);\r\n
                    }\r\n
                }\r\n
            };\r\n
            this.onApiEndAddShape = function () {\r\n
                if (this.toolbar.btnInsertShape.pressed) {\r\n
                    this.toolbar.btnInsertShape.toggle(false, true);\r\n
                }\r\n
                if (this.toolbar.btnInsertText.pressed) {\r\n
                    this.toolbar.btnInsertText.toggle(false, true);\r\n
                }\r\n
                $(document.body).off("mouseup", checkInsertAutoshape);\r\n
            };\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.toolbar = this.createView("Toolbar");\r\n
            this.toolbar.on("render:after", _.bind(this.onToolbarAfterRender, this));\r\n
        },\r\n
        onToolbarAfterRender: function (toolbar) {\r\n
            var me = this;\r\n
            toolbar.btnNewDocument.on("click", _.bind(this.onNewDocument, this));\r\n
            toolbar.btnOpenDocument.on("click", _.bind(this.onOpenDocument, this));\r\n
            toolbar.btnPrint.on("click", _.bind(this.onPrint, this));\r\n
            toolbar.btnPrint.menu.on("item:click", _.bind(this.onPrintMenu, this));\r\n
            toolbar.btnSave.on("click", _.bind(this.onSave, this));\r\n
            toolbar.btnUndo.on("click", _.bind(this.onUndo, this));\r\n
            toolbar.btnRedo.on("click", _.bind(this.onRedo, this));\r\n
            toolbar.btnCopy.on("click", _.bind(this.onCopyPaste, this, true));\r\n
            toolbar.btnPaste.on("click", _.bind(this.onCopyPaste, this, false));\r\n
            toolbar.btnIncFontSize.on("click", _.bind(this.onIncreaseFontSize, this));\r\n
            toolbar.btnDecFontSize.on("click", _.bind(this.onDecreaseFontSize, this));\r\n
            toolbar.btnBold.on("click", _.bind(this.onBold, this));\r\n
            toolbar.btnItalic.on("click", _.bind(this.onItalic, this));\r\n
            toolbar.btnUnderline.on("click", _.bind(this.onUnderline, this));\r\n
            toolbar.btnTextColor.on("click", _.bind(this.onTextColor, this));\r\n
            toolbar.btnBackColor.on("click", _.bind(this.onBackColor, this));\r\n
            toolbar.mnuTextColorPicker.on("select", _.bind(this.onTextColorSelect, this));\r\n
            toolbar.mnuBackColorPicker.on("select", _.bind(this.onBackColorSelect, this));\r\n
            toolbar.btnBorders.on("click", _.bind(this.onBorders, this));\r\n
            toolbar.btnBorders.menu.on("item:click", _.bind(this.onBordersMenu, this));\r\n
            toolbar.mnuBorderWidth.on("item:toggle", _.bind(this.onBordersWidth, this));\r\n
            toolbar.mnuBorderColorPicker.on("select", _.bind(this.onBordersColor, this));\r\n
            toolbar.btnAlignLeft.on("click", _.bind(this.onHorizontalAlign, this, "left"));\r\n
            toolbar.btnAlignCenter.on("click", _.bind(this.onHorizontalAlign, this, "center"));\r\n
            toolbar.btnAlignRight.on("click", _.bind(this.onHorizontalAlign, this, "right"));\r\n
            toolbar.btnAlignJust.on("click", _.bind(this.onHorizontalAlign, this, "justify"));\r\n
            toolbar.btnHorizontalAlign.menu.on("item:click", _.bind(this.onHorizontalAlignMenu, this));\r\n
            toolbar.btnVerticalAlign.menu.on("item:click", _.bind(this.onVerticalAlignMenu, this));\r\n
            toolbar.btnMerge.on("click", _.bind(this.onMergeCellsMenu, this, toolbar.btnMerge.menu, toolbar.btnMerge.menu.items[0]));\r\n
            toolbar.btnMerge.menu.on("item:click", _.bind(this.onMergeCellsMenu, this));\r\n
            toolbar.btnAlignTop.on("click", _.bind(this.onVerticalAlign, this, "top"));\r\n
            toolbar.btnAlignMiddle.on("click", _.bind(this.onVerticalAlign, this, "center"));\r\n
            toolbar.btnAlignBottom.on("click", _.bind(this.onVerticalAlign, this, "bottom"));\r\n
            toolbar.btnWrap.on("click", _.bind(this.onWrap, this));\r\n
            toolbar.btnTextOrient.menu.on("item:click", _.bind(this.onTextOrientationMenu, this));\r\n
            toolbar.btnInsertImage.menu.on("item:click", _.bind(this.onInsertImageMenu, this));\r\n
            toolbar.btnInsertHyperlink.on("click", _.bind(this.onHyperlink, this));\r\n
            toolbar.btnInsertChart.on("click", _.bind(this.onInsertChart, this));\r\n
            toolbar.btnEditChart.on("click", _.bind(this.onInsertChart, this));\r\n
            toolbar.btnInsertText.on("click", _.bind(this.onInsertText, this));\r\n
            toolbar.btnInsertShape.menu.on("hide:after", _.bind(this.onInsertShapeHide, this));\r\n
            toolbar.btnSortDown.on("click", _.bind(this.onSortType, this, "ascending"));\r\n
            toolbar.btnSortUp.on("click", _.bind(this.onSortType, this, "descending"));\r\n
            toolbar.mnuitemSortAZ.on("click", _.bind(this.onSortType, this, "ascending"));\r\n
            toolbar.mnuitemSortZA.on("click", _.bind(this.onSortType, this, "descending"));\r\n
            toolbar.btnSetAutofilter.on("click", _.bind(this.onAutoFilter, this));\r\n
            toolbar.mnuitemAutoFilter.on("click", _.bind(this.onAutoFilter, this));\r\n
            toolbar.btnClearAutofilter.on("click", _.bind(this.onClearFilter, this));\r\n
            toolbar.mnuitemClearFilter.on("click", _.bind(this.onClearFilter, this));\r\n
            toolbar.btnTableTemplate.menu.on("show:after", _.bind(this.onTableTplMenuOpen, this));\r\n
            toolbar.btnPercentStyle.on("click", _.bind(this.onNumberFormat, this));\r\n
            toolbar.btnCurrencyStyle.on("click", _.bind(this.onNumberFormat, this));\r\n
            toolbar.btnDecDecimal.on("click", _.bind(this.onDecrement, this));\r\n
            toolbar.btnIncDecimal.on("click", _.bind(this.onIncrement, this));\r\n
            toolbar.btnInsertFormula.on("click", _.bind(this.onInsertFormulaMenu, this));\r\n
            toolbar.btnSettings.on("click", _.bind(this.onAdvSettingsClick, this));\r\n
            toolbar.btnInsertFormula.menu.on("item:click", _.bind(this.onInsertFormulaMenu, this));\r\n
            toolbar.btnClearStyle.menu.on("item:click", _.bind(this.onClearStyleMenu, this));\r\n
            toolbar.btnAddCell.menu.on("item:click", _.bind(this.onCellInsertMenu, this));\r\n
            toolbar.btnCopyStyle.on("toggle", _.bind(this.onCopyStyleToggle, this));\r\n
            toolbar.btnDeleteCell.menu.on("item:click", _.bind(this.onCellDeleteMenu, this));\r\n
            toolbar.btnColorSchemas.menu.on("item:click", _.bind(this.onColorSchemaClick, this));\r\n
            toolbar.cmbFontName.on("selected", _.bind(this.onFontNameSelect, this));\r\n
            toolbar.cmbFontName.on("show:after", _.bind(this.onFontNameOpen, this));\r\n
            toolbar.cmbFontName.on("hide:after", _.bind(this.onHideMenus, this));\r\n
            toolbar.cmbFontName.on("combo:blur", _.bind(this.onComboBlur, this));\r\n
            toolbar.cmbFontSize.on("selected", _.bind(this.onFontSizeSelect, this));\r\n
            toolbar.cmbFontSize.on("changed:before", _.bind(this.onFontSizeChanged, this, true));\r\n
            toolbar.cmbFontSize.on("changed:after", _.bind(this.onFontSizeChanged, this, false));\r\n
            toolbar.cmbFontSize.on("show:after", _.bind(this.onFontSizeOpen, this));\r\n
            toolbar.cmbFontSize.on("hide:after", _.bind(this.onHideMenus, this));\r\n
            toolbar.cmbFontSize.on("combo:blur", _.bind(this.onComboBlur, this));\r\n
            if (toolbar.mnuZoomIn) {\r\n
                toolbar.mnuZoomIn.on("click", _.bind(this.onZoomInClick, this));\r\n
            }\r\n
            if (toolbar.mnuZoomOut) {\r\n
                toolbar.mnuZoomOut.on("click", _.bind(this.onZoomOutClick, this));\r\n
            }\r\n
            toolbar.btnShowMode.menu.on("item:click", _.bind(this.onHideMenu, this));\r\n
            toolbar.listStyles.on("click", _.bind(this.onListStyleSelect, this));\r\n
            toolbar.btnNumberFormat.menu.on("item:click", _.bind(this.onNumberFormatMenu, this));\r\n
            toolbar.btnCurrencyStyle.menu.on("item:click", _.bind(this.onNumberFormatMenu, this));\r\n
            toolbar.mnuitemCompactToolbar.on("toggle", _.bind(this.onChangeViewMode, this));\r\n
            $("#id-toolbar-menu-new-fontcolor").on("click", _.bind(this.onNewTextColor, this));\r\n
            $("#id-toolbar-menu-new-paracolor").on("click", _.bind(this.onNewBackColor, this));\r\n
            $("#id-toolbar-menu-new-bordercolor").on("click", _.bind(this.onNewBorderColor, this));\r\n
            _.each(toolbar.btnNumberFormat.menu.items, function (item) {\r\n
                if (item.menu) {\r\n
                    item.menu.on("item:click", _.bind(me.onNumberFormatMenu, me));\r\n
                }\r\n
            });\r\n
            this.onSetupCopyStyleButton();\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.asc_registerCallback("asc_onInitTablePictures", _.bind(this.onApiInitTableTemplates, this));\r\n
            this.api.asc_registerCallback("asc_onInitEditorStyles", _.bind(this.onApiInitEditorStyles, this));\r\n
            this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onApiCoAuthoringDisconnect, this));\r\n
            Common.NotificationCenter.on("api:disconnect", _.bind(this.onApiCoAuthoringDisconnect, this));\r\n
            Common.NotificationCenter.on("copywarning:show", _.bind(function () {\r\n
                this._state.show_copywarning = false;\r\n
            },\r\n
            this));\r\n
        },\r\n
        onNewDocument: function (btn, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_openNewDocument();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "New Document");\r\n
        },\r\n
        onOpenDocument: function (btn, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_loadDocumentFromDisk();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Open Document");\r\n
        },\r\n
        onPrint: function (e) {\r\n
            if (this.api) {\r\n
                this.api.asc_Print();\r\n
                Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
                Common.component.Analytics.trackEvent("Print");\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Print");\r\n
            }\r\n
        },\r\n
        onPrintMenu: function (menu, item) {\r\n
            if (item.value === "print" && this.api) {\r\n
                this.api.asc_Print();\r\n
                Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
                Common.component.Analytics.trackEvent("Print");\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Print");\r\n
            }\r\n
        },\r\n
        onSave: function (e) {\r\n
            if (this.api) {\r\n
                var isModified = this.api.asc_isDocumentCanSave();\r\n
                var isSyncButton = $(".btn-icon", this.toolbar.btnSave.cmpEl).hasClass("btn-synch");\r\n
                if (!isModified && !isSyncButton) {\r\n
                    return;\r\n
                }\r\n
                this.api.asc_Save();\r\n
            }\r\n
            Common.component.Analytics.trackEvent("Save");\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Save");\r\n
        },\r\n
        onUndo: function (btn, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_Undo();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Undo");\r\n
        },\r\n
        onRedo: function (btn, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_Redo();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Redo");\r\n
        },\r\n
        onCopyPaste: function (copy, e) {\r\n
            var me = this;\r\n
            if (me.api) {\r\n
                if (typeof window["AscDesktopEditor"] === "object") {\r\n
                    copy ? me.api.asc_Copy() : me.api.asc_Paste();\r\n
                    Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                } else {\r\n
                    var value = window.localStorage.getItem("sse-hide-copywarning");\r\n
                    if (! (value && parseInt(value) == 1) && this._state.show_copywarning) {\r\n
                        (new Common.Views.CopyWarningDialog({\r\n
                            handler: function (dontshow) {\r\n
                                copy ? me.api.asc_Copy() : me.api.asc_Paste();\r\n
                                if (dontshow) {\r\n
                                    window.localStorage.setItem("sse-hide-copywarning", 1);\r\n
                                }\r\n
                                Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                            }\r\n
                        })).show();\r\n
                    } else {\r\n
                        copy ? me.api.asc_Copy() : me.api.asc_Paste();\r\n
                        Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                    }\r\n
                }\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Copy Warning");\r\n
            } else {\r\n
                Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
            }\r\n
        },\r\n
        onIncreaseFontSize: function (e) {\r\n
            if (this.api) {\r\n
                this.api.asc_increaseFontSize();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Font Size");\r\n
        },\r\n
        onDecreaseFontSize: function (e) {\r\n
            if (this.api) {\r\n
                this.api.asc_decreaseFontSize();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Font Size");\r\n
        },\r\n
        onBold: function (btn, e) {\r\n
            this._state.bold = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellBold(btn.pressed);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Bold");\r\n
        },\r\n
        onItalic: function (btn, e) {\r\n
            this._state.italic = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellItalic(btn.pressed);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Italic");\r\n
        },\r\n
        onUnderline: function (btn, e) {\r\n
            this._state.underline = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellUnderline(btn.pressed);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Underline");\r\n
        },\r\n
        onTextColor: function () {\r\n
            this.toolbar.mnuTextColorPicker.trigger("select", this.toolbar.mnuTextColorPicker, this.toolbar.mnuTextColorPicker.currentColor, true);\r\n
        },\r\n
        onBackColor: function () {\r\n
            this.toolbar.mnuBackColorPicker.trigger("select", this.toolbar.mnuBackColorPicker, this.toolbar.mnuBackColorPicker.currentColor, true);\r\n
        },\r\n
        onTextColorSelect: function (picker, color, fromBtn) {\r\n
            this._state.clrtext_asccolor = this._state.clrtext = undefined;\r\n
            var clr = (typeof(color) == "object") ? color.color : color;\r\n
            this.toolbar.btnTextColor.currentColor = color;\r\n
            $(".btn-color-value-line", this.toolbar.btnTextColor.cmpEl).css("background-color", "#" + clr);\r\n
            this.toolbar.mnuTextColorPicker.currentColor = color;\r\n
            if (this.api) {\r\n
                this.toolbar.btnTextColor.ischanged = (fromBtn !== true);\r\n
                this.api.asc_setCellTextColor(Common.Utils.ThemeColor.getRgbColor(color));\r\n
                this.toolbar.btnTextColor.ischanged = false;\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Text Color");\r\n
        },\r\n
        onBackColorSelect: function (picker, color, fromBtn) {\r\n
            this._state.clrshd_asccolor = this._state.clrback = undefined;\r\n
            var clr = (typeof(color) == "object") ? color.color : color;\r\n
            this.toolbar.btnBackColor.currentColor = color;\r\n
            $(".btn-color-value-line", this.toolbar.btnBackColor.cmpEl).css("background-color", clr == "transparent" ? "transparent" : "#" + clr);\r\n
            this.toolbar.mnuBackColorPicker.currentColor = color;\r\n
            if (this.api) {\r\n
                this.toolbar.btnBackColor.ischanged = (fromBtn !== true);\r\n
                this.api.asc_setCellBackgroundColor(color == "transparent" ? null : Common.Utils.ThemeColor.getRgbColor(color));\r\n
                this.toolbar.btnBackColor.ischanged = false;\r\n
            }\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Background Color");\r\n
        },\r\n
        onNewTextColor: function (picker, color) {\r\n
            this.toolbar.mnuTextColorPicker.addNewColor();\r\n
        },\r\n
        onNewBackColor: function (picker, color) {\r\n
            this.toolbar.mnuBackColorPicker.addNewColor();\r\n
        },\r\n
        onNewBorderColor: function (picker, color) {\r\n
            this.toolbar.btnBorders.menu.hide();\r\n
            this.toolbar.btnBorders.toggle(false, true);\r\n
            this.toolbar.mnuBorderColorPicker.addNewColor();\r\n
        },\r\n
        onBorders: function (btn) {\r\n
            var menuItem;\r\n
            _.each(btn.menu.items, function (item) {\r\n
                if (btn.options.borderId == item.options.borderId) {\r\n
                    menuItem = item;\r\n
                    return false;\r\n
                }\r\n
            });\r\n
            if (menuItem) {\r\n
                this.onBordersMenu(btn.menu, menuItem);\r\n
            }\r\n
        },\r\n
        onBordersMenu: function (menu, item) {\r\n
            var me = this;\r\n
            if (me.api && !_.isUndefined(item.options.borderId)) {\r\n
                var btnBorders = me.toolbar.btnBorders,\r\n
                new_borders = [],\r\n
                bordersWidth = btnBorders.options.borderswidth,\r\n
                bordersColor = btnBorders.options.borderscolor;\r\n
                if (btnBorders.rendered) {\r\n
                    var iconEl = $(".btn-icon", btnBorders.cmpEl);\r\n
                    if (iconEl) {\r\n
                        iconEl.removeClass(btnBorders.options.icls);\r\n
                        btnBorders.options.icls = item.options.icls;\r\n
                        iconEl.addClass(btnBorders.options.icls);\r\n
                    }\r\n
                }\r\n
                btnBorders.options.borderId = item.options.borderId;\r\n
                if (item.options.borderId == "inner") {\r\n
                    new_borders[c_oAscBorderOptions.InnerV] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                    new_borders[c_oAscBorderOptions.InnerH] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                } else {\r\n
                    if (item.options.borderId == "all") {\r\n
                        new_borders[c_oAscBorderOptions.InnerV] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                        new_borders[c_oAscBorderOptions.InnerH] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                        new_borders[c_oAscBorderOptions.Left] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                        new_borders[c_oAscBorderOptions.Top] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                        new_borders[c_oAscBorderOptions.Right] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                        new_borders[c_oAscBorderOptions.Bottom] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                    } else {\r\n
                        if (item.options.borderId == "outer") {\r\n
                            new_borders[c_oAscBorderOptions.Left] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                            new_borders[c_oAscBorderOptions.Top] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                            new_borders[c_oAscBorderOptions.Right] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                            new_borders[c_oAscBorderOptions.Bottom] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                        } else {\r\n
                            if (item.options.borderId != "none") {\r\n
                                new_borders[item.options.borderId] = new Asc.asc_CBorder(bordersWidth, bordersColor);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
                me.api.asc_setCellBorders(new_borders);\r\n
                Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Borders");\r\n
            }\r\n
        },\r\n
        onBordersWidth: function (menu, item, state) {\r\n
            if (state) {\r\n
                $("#id-toolbar-mnu-item-border-width .menu-item-icon").css("border-width", (item.value == "thin" ? 1 : (item.value == "medium" ? 2 : 3)) + "px");\r\n
                this.toolbar.btnBorders.options.borderswidth = item.value;\r\n
                Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Border Width");\r\n
            }\r\n
        },\r\n
        onBordersColor: function (picker, color) {\r\n
            $("#id-toolbar-mnu-item-border-color .menu-item-icon").css("border-color", "#" + ((typeof(color) == "object") ? color.color : color));\r\n
            this.toolbar.btnBorders.options.borderscolor = Common.Utils.ThemeColor.getRgbColor(color);\r\n
            this.toolbar.mnuBorderColorPicker.currentColor = color;\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Border Color");\r\n
        },\r\n
        onHorizontalAlign: function (type, btn, e) {\r\n
            this._state.pralign = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellAlign(!btn.pressed ? "left" : type);\r\n
                this.toolbar.btnWrap.allowDepress = !(type == "justify");\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Horizontal align");\r\n
        },\r\n
        onHorizontalAlignMenu: function (menu, item) {\r\n
            var btnHorizontalAlign = this.toolbar.btnHorizontalAlign,\r\n
            iconEl = $(".btn-icon", btnHorizontalAlign.cmpEl);\r\n
            if (iconEl) {\r\n
                iconEl.removeClass(btnHorizontalAlign.options.icls);\r\n
                btnHorizontalAlign.options.icls = !item.checked ? "btn-align-left" : item.options.icls;\r\n
                iconEl.addClass(btnHorizontalAlign.options.icls);\r\n
            }\r\n
            this._state.pralign = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellAlign(!item.checked ? "left" : item.value);\r\n
            }\r\n
            this.toolbar.btnWrap.allowDepress = !(item.value == "justify");\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Horizontal Align");\r\n
        },\r\n
        onVerticalAlignMenu: function (menu, item) {\r\n
            var btnVerticalAlign = this.toolbar.btnVerticalAlign,\r\n
            iconEl = $(".btn-icon", btnVerticalAlign.cmpEl);\r\n
            if (iconEl) {\r\n
                iconEl.removeClass(btnVerticalAlign.options.icls);\r\n
                btnVerticalAlign.options.icls = !item.checked ? "btn-valign-bottom" : item.options.icls;\r\n
                iconEl.addClass(btnVerticalAlign.options.icls);\r\n
            }\r\n
            this._state.valign = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellVertAlign(!item.checked ? "bottom" : item.value);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Vertical Align");\r\n
        },\r\n
        onVerticalAlign: function (type, btn, e) {\r\n
            this._state.valign = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellVertAlign(!btn.pressed ? "bottom" : type);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Vertical align");\r\n
        },\r\n
        onMergeCellsMenu: function (menu, item) {\r\n
            var me = this;\r\n
            function doMergeCells(how) {\r\n
                me._state.merge = undefined;\r\n
                me.api.asc_mergeCells(how);\r\n
                Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Merge");\r\n
            }\r\n
            if (me.api) {\r\n
                var merged = me.api.asc_getCellInfo().asc_getFlags().asc_getMerge();\r\n
                if (!merged && me.api.asc_mergeCellsDataLost(item.value)) {\r\n
                    Common.UI.warning({\r\n
                        msg: me.warnMergeLostData,\r\n
                        buttons: ["yes", "no"],\r\n
                        callback: function (btn) {\r\n
                            if (btn == "ok") {\r\n
                                doMergeCells(item.value);\r\n
                            } else {\r\n
                                me.toolbar.btnMerge.toggle(false, true);\r\n
                                Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                                Common.component.Analytics.trackEvent("ToolBar", "Merge");\r\n
                            }\r\n
                        }\r\n
                    });\r\n
                } else {\r\n
                    doMergeCells(item.value);\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Merge cells");\r\n
        },\r\n
        onWrap: function (btn, e) {\r\n
            this._state.wrap = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellTextWrap(btn.pressed);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Wrap");\r\n
        },\r\n
        onTextOrientationMenu: function (menu, item) {\r\n
            var angle = 0;\r\n
            switch (item.value) {\r\n
            case "countcw":\r\n
                angle = 45;\r\n
                break;\r\n
            case "clockwise":\r\n
                angle = -45;\r\n
                break;\r\n
            case "rotateup":\r\n
                angle = 90;\r\n
                break;\r\n
            case "rotatedown":\r\n
                angle = -90;\r\n
                break;\r\n
            }\r\n
            this._state.angle = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellAngle(angle);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Text orientation");\r\n
        },\r\n
        onInsertImageMenu: function (menu, item, e) {\r\n
            if (item.value === "file") {\r\n
                this.toolbar.fireEvent("insertimage", this.toolbar);\r\n
                if (this.api) {\r\n
                    this.api.asc_showImageFileDialog();\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Image");\r\n
            } else {\r\n
                var me = this;\r\n
                (new Common.Views.ImageFromUrlDialog({\r\n
                    handler: function (result, value) {\r\n
                        if (result == "ok") {\r\n
                            if (me.api) {\r\n
                                var checkUrl = value.replace(/\\s/g, "");\r\n
                                if (!_.isEmpty(checkUrl)) {\r\n
                                    me.toolbar.fireEvent("insertimage", me.toolbar);\r\n
                                    me.api.asc_addImageDrawingObject(checkUrl);\r\n
                  

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABM=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="19" aka="AAAAAAAAABM=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

                  Common.component.Analytics.trackEvent("ToolBar", "Image");\r\n
                                } else {\r\n
                                    Common.UI.warning({\r\n
                                        msg: this.textEmptyImgUrl\r\n
                                    });\r\n
                                }\r\n
                            }\r\n
                            Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                        }\r\n
                    }\r\n
                })).show();\r\n
            }\r\n
        },\r\n
        onHyperlink: function (btn) {\r\n
            var me = this;\r\n
            var win, props;\r\n
            if (me.api) {\r\n
                var wc = me.api.asc_getWorksheetsCount(),\r\n
                i = -1,\r\n
                items = [];\r\n
                while (++i < wc) {\r\n
                    if (!this.api.asc_isWorksheetHidden(i)) {\r\n
                        items.push({\r\n
                            displayValue: me.api.asc_getWorksheetName(i),\r\n
                            value: me.api.asc_getWorksheetName(i)\r\n
                        });\r\n
                    }\r\n
                }\r\n
                var handlerDlg = function (dlg, result) {\r\n
                    if (result == "ok") {\r\n
                        props = dlg.getSettings();\r\n
                        me.api.asc_insertHyperlink(props);\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                };\r\n
                var cell = me.api.asc_getCellInfo(),\r\n
                seltype = cell.asc_getFlags().asc_getSelectionType();\r\n
                props = cell.asc_getHyperlink();\r\n
                win = new SSE.Views.HyperlinkSettingsDialog({\r\n
                    handler: handlerDlg\r\n
                });\r\n
                win.show();\r\n
                win.setSettings({\r\n
                    sheets: items,\r\n
                    currentSheet: me.api.asc_getWorksheetName(me.api.asc_getActiveWorksheetIndex()),\r\n
                    props: props,\r\n
                    text: cell.asc_getText(),\r\n
                    isLock: cell.asc_getFlags().asc_getLockText(),\r\n
                    allowInternal: (seltype !== c_oAscSelectionType.RangeImage && seltype !== c_oAscSelectionType.RangeShape && seltype !== c_oAscSelectionType.RangeShapeText && seltype !== c_oAscSelectionType.RangeChart && seltype !== c_oAscSelectionType.RangeChartText)\r\n
                });\r\n
            }\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Add Hyperlink");\r\n
        },\r\n
        onInsertChart: function (btn) {\r\n
            if (!this.editMode) {\r\n
                return;\r\n
            }\r\n
            var me = this,\r\n
            info = me.api.asc_getCellInfo();\r\n
            if (info.asc_getFlags().asc_getSelectionType() != c_oAscSelectionType.RangeImage) {\r\n
                var win, props;\r\n
                if (me.api) {\r\n
                    props = me.api.asc_getChartObject();\r\n
                    if (props) {\r\n
                        var ischartedit = (me.toolbar.mode.isEditDiagram || info.asc_getFlags().asc_getSelectionType() == c_oAscSelectionType.RangeChart || info.asc_getFlags().asc_getSelectionType() == c_oAscSelectionType.RangeChartText);\r\n
                        (new SSE.Views.ChartSettingsDlg({\r\n
                            chartSettings: props,\r\n
                            api: me.api,\r\n
                            handler: function (result, value) {\r\n
                                if (result == "ok") {\r\n
                                    if (me.api) {\r\n
                                        (ischartedit) ? me.api.asc_editChartDrawingObject(value.chartSettings) : me.api.asc_addChartDrawingObject(value.chartSettings);\r\n
                                    }\r\n
                                }\r\n
                                Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                            }\r\n
                        })).show();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onInsertText: function (btn, e) {\r\n
            if (this.api) {\r\n
                this._addAutoshape(btn.pressed, "textRect");\r\n
            }\r\n
            if (this.toolbar.btnInsertShape.pressed) {\r\n
                this.toolbar.btnInsertShape.toggle(false, true);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, this.toolbar.btnInsertShape);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Add Text");\r\n
        },\r\n
        onInsertShapeHide: function (btn, e) {\r\n
            if (this.toolbar.btnInsertShape.pressed && !this._isAddingShape) {\r\n
                this.toolbar.btnInsertShape.toggle(false, true);\r\n
            }\r\n
            this._isAddingShape = false;\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        onSortType: function (type, btn) {\r\n
            if (this.api) {\r\n
                this.api.asc_sortColFilter(type, "");\r\n
            }\r\n
        },\r\n
        onAutoFilter: function (btn) {\r\n
            this._state.filter = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_addAutoFilter();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Auto filter");\r\n
        },\r\n
        onClearFilter: function (btn) {\r\n
            if (this.api) {\r\n
                this.api.asc_clearFilter();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Clear filter");\r\n
        },\r\n
        onNumberFormat: function (btn) {\r\n
            if (this.api) {\r\n
                this.api.asc_setCellFormat(btn.options.formatId);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Number Format");\r\n
        },\r\n
        onNumberFormatMenu: function (menu, item) {\r\n
            if (this.api) {\r\n
                this.api.asc_setCellFormat(item.value);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Number Format");\r\n
        },\r\n
        onDecrement: function (btn) {\r\n
            if (this.api) {\r\n
                this.api.asc_decreaseCellDigitNumbers();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Decrement");\r\n
        },\r\n
        onIncrement: function (btn) {\r\n
            if (this.api) {\r\n
                this.api.asc_increaseCellDigitNumbers();\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Increment");\r\n
        },\r\n
        onInsertFormulaMenu: function (menu, item, e) {\r\n
            if (this.api) {\r\n
                if (item.value === "more") {\r\n
                    var controller = this.getApplication().getController("FormulaDialog");\r\n
                    if (controller) {\r\n
                        this.api.asc_enableKeyEvents(false);\r\n
                        controller.showDialog();\r\n
                    }\r\n
                } else {\r\n
                    item.value = item.value || "SUM";\r\n
                    this.api.asc_insertFormula(item.value, true);\r\n
                    Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
                    Common.component.Analytics.trackEvent("ToolBar", "Insert formula");\r\n
                }\r\n
            }\r\n
        },\r\n
        onClearStyleMenu: function (menu, item, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_emptyCells(item.value);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Clear");\r\n
        },\r\n
        onCopyStyleToggle: function (btn, state, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_formatPainter(state ? 1 : 0);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            this.modeAlwaysSetStyle = state;\r\n
        },\r\n
        onCellInsertMenu: function (menu, item, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_insertCells(item.value);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Cell insert");\r\n
        },\r\n
        onCellDeleteMenu: function (menu, item, e) {\r\n
            if (this.api) {\r\n
                this.api.asc_deleteCells(item.value);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Cell delete");\r\n
        },\r\n
        onColorSchemaClick: function (menu, item) {\r\n
            if (this.api) {\r\n
                this.api.asc_ChangeColorScheme(item.value);\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Color Scheme");\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        onComboBlur: function () {\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        onFontNameSelect: function (combo, record) {\r\n
            if (this.api) {\r\n
                this.api.asc_setCellFontName(record.name);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Font Name");\r\n
        },\r\n
        onFontNameOpen: function (combo) {\r\n
            _.delay(function () {\r\n
                $("input", combo.cmpEl).select().focus();\r\n
            },\r\n
            10);\r\n
        },\r\n
        onFontSizeSelect: function (combo, record) {\r\n
            if (this.api) {\r\n
                this.api.asc_setCellFontSize(record.value);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
            Common.component.Analytics.trackEvent("ToolBar", "Font Size");\r\n
        },\r\n
        onFontSizeChanged: function (before, combo, record, e) {\r\n
            var value, me = this;\r\n
            if (before) {\r\n
                var item = combo.store.findWhere({\r\n
                    displayValue: record.value\r\n
                });\r\n
                if (!item) {\r\n
                    value = /^\\+?(\\d*\\.?\\d+)$|^\\+?(\\d+\\.?\\d*)$/.exec(record.value);\r\n
                    if (!value) {\r\n
                        value = this._getApiTextSize();\r\n
                        Common.UI.error({\r\n
                            msg: this.textFontSizeErr,\r\n
                            callback: function () {\r\n
                                _.defer(function (btn) {\r\n
                                    me.api.asc_enableKeyEvents(false);\r\n
                                    $("input", combo.cmpEl).focus();\r\n
                                });\r\n
                            }\r\n
                        });\r\n
                        combo.setRawValue(value);\r\n
                        e.preventDefault();\r\n
                        return false;\r\n
                    }\r\n
                }\r\n
            } else {\r\n
                value = parseFloat(record.value);\r\n
                value = value > 300 ? 300 : value < 1 ? 1 : Math.floor((value + 0.4) * 2) / 2;\r\n
                combo.setRawValue(value);\r\n
                if (this.api) {\r\n
                    this.api.asc_setCellFontSize(value);\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
            }\r\n
        },\r\n
        onFontSizeOpen: function (combo) {\r\n
            _.delay(function () {\r\n
                $("input", combo.cmpEl).select().focus();\r\n
            },\r\n
            10);\r\n
        },\r\n
        onAdvSettingsClick: function (btn, e) {\r\n
            this.toolbar.fireEvent("file:settings", this);\r\n
            btn.cmpEl.blur();\r\n
        },\r\n
        onZoomInClick: function (btn) {\r\n
            if (this.api) {\r\n
                var f = this.api.asc_getZoom() + 0.1;\r\n
                if (f > 0 && !(f > 2)) {\r\n
                    this.api.asc_setZoom(f);\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        onZoomOutClick: function (btn) {\r\n
            if (this.api) {\r\n
                var f = this.api.asc_getZoom() - 0.1;\r\n
                if (! (f < 0.5)) {\r\n
                    this.api.asc_setZoom(f);\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        onHideMenu: function (menu, item) {\r\n
            var params = {},\r\n
            option;\r\n
            switch (item.value) {\r\n
            case "title":\r\n
                params.title = item.checked;\r\n
                option = "sse-hidden-title";\r\n
                break;\r\n
            case "formula":\r\n
                params.formula = item.checked;\r\n
                option = "sse-hidden-formula";\r\n
                break;\r\n
            case "headings":\r\n
                params.headings = item.checked;\r\n
                break;\r\n
            case "gridlines":\r\n
                params.gridlines = item.checked;\r\n
                break;\r\n
            case "freezepanes":\r\n
                params.freezepanes = true;\r\n
                break;\r\n
            }\r\n
            this.hideElements(params);\r\n
            option && localStorage.setItem(option, item.checked);\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        onListStyleSelect: function (combo, record) {\r\n
            this._state.prstyle = undefined;\r\n
            if (this.api) {\r\n
                this.api.asc_setCellStyle(record.get("name"));\r\n
                Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
                Common.component.Analytics.trackEvent("ToolBar", "Style");\r\n
            }\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            var me = this;\r\n
            this.api.asc_registerCallback("asc_onShowChartDialog", _.bind(this.onApiChartDblClick, this));\r\n
            this.api.asc_registerCallback("asc_onCanUndoChanged", _.bind(this.onApiCanRevert, this, "undo"));\r\n
            this.api.asc_registerCallback("asc_onCanRedoChanged", _.bind(this.onApiCanRevert, this, "redo"));\r\n
            this.api.asc_registerCallback("asc_onEditCell", _.bind(this.onApiEditCell, this));\r\n
            this.api.asc_registerCallback("asc_onEndAddShape", _.bind(this.onApiEndAddShape, this));\r\n
            this.api.asc_registerCallback("asc_onZoomChanged", _.bind(this.onApiZoomChange, this));\r\n
            this.api.asc_registerCallback("asc_onSheetsChanged", _.bind(this.onApiSheetChanged, this));\r\n
            this.api.asc_registerCallback("asc_onStopFormatPainter", _.bind(this.onApiStyleChange, this));\r\n
            this.api.asc_registerCallback("asc_onUpdateSheetViewSettings", _.bind(this.onApiSheetChanged, this));\r\n
            Common.util.Shortcuts.delegateShortcuts({\r\n
                shortcuts: {\r\n
                    "command+l,ctrl+l": function (e) {\r\n
                        if (me.editMode && me.api.asc_getCellInfo().asc_getIsFormatTable() !== true) {\r\n
                            me._setTableFormat(me.toolbar.mnuTableTemplatePicker.store.at(23).get("name"));\r\n
                        }\r\n
                        return false;\r\n
                    },\r\n
                    "command+shift+l,ctrl+shift+l": function (e) {\r\n
                        me._state.filter = undefined;\r\n
                        if (me.editMode && me.api) {\r\n
                            me.api.asc_addAutoFilter();\r\n
                        }\r\n
                        return false;\r\n
                    },\r\n
                    "command+s,ctrl+s": function (e) {\r\n
                        me.onSave();\r\n
                        e.preventDefault();\r\n
                        e.stopPropagation();\r\n
                    },\r\n
                    "command+k,ctrl+k": function (e) {\r\n
                        if (me.editMode && !me.toolbar.mode.isEditDiagram && !me.api.isCellEdited) {\r\n
                            me.onHyperlink();\r\n
                        }\r\n
                        e.preventDefault();\r\n
                    }\r\n
                }\r\n
            });\r\n
            this.wrapOnSelectionChanged = _.bind(this.onApiSelectionChanged, this);\r\n
            this.api.asc_registerCallback("asc_onSelectionChanged", this.wrapOnSelectionChanged);\r\n
            this.onApiSelectionChanged(this.api.asc_getCellInfo());\r\n
            this.api.asc_registerCallback("asc_onEditorSelectionChanged", _.bind(this.onApiEditorSelectionChanged, this));\r\n
            this.attachToControlEvents();\r\n
            this.onApiSheetChanged();\r\n
            Common.NotificationCenter.on("cells:range", _.bind(this.onCellsRange, this));\r\n
        },\r\n
        onChangeViewMode: function (item, compact) {\r\n
            var me = this,\r\n
            toolbarFull = $("#id-toolbar-full"),\r\n
            toolbarShort = $("#id-toolbar-short");\r\n
            me.toolbar.isCompactView = compact;\r\n
            if (toolbarFull && toolbarShort) {\r\n
                me.api.asc_unregisterCallback("asc_onSelectionChanged", me.wrapOnSelectionChanged);\r\n
                if (compact) {\r\n
                    toolbarShort.css({\r\n
                        display: "table"\r\n
                    });\r\n
                    toolbarFull.css({\r\n
                        display: "none"\r\n
                    });\r\n
                    toolbarShort.parent().css({\r\n
                        height: "41px"\r\n
                    });\r\n
                    me.toolbar.rendererComponents("short");\r\n
                } else {\r\n
                    toolbarShort.css({\r\n
                        display: "none"\r\n
                    });\r\n
                    toolbarFull.css({\r\n
                        display: "table"\r\n
                    });\r\n
                    toolbarShort.parent().css({\r\n
                        height: "67px"\r\n
                    });\r\n
                    me.toolbar.rendererComponents("full");\r\n
                    _.defer(function () {\r\n
                        var listStylesVisible = (me.toolbar.listStyles.rendered);\r\n
                        if (me.toolbar.listStyles.menuPicker.store.length > 0 && listStylesVisible) {\r\n
                            me.toolbar.listStyles.fillComboView(me.toolbar.listStyles.menuPicker.getSelectedRec(), true);\r\n
                        }\r\n
                    },\r\n
                    100);\r\n
                }\r\n
                me._state.coauthdisable = undefined;\r\n
                me.api.asc_registerCallback("asc_onSelectionChanged", me.wrapOnSelectionChanged);\r\n
                me.onApiSelectionChanged(me.api.asc_getCellInfo());\r\n
                window.localStorage.setItem("sse-toolbar-compact", compact ? 1 : 0);\r\n
                Common.NotificationCenter.trigger("layout:changed", "toolbar");\r\n
            }\r\n
        },\r\n
        fillTableTemplates: function () {\r\n
            var me = this;\r\n
            function createPicker(element) {\r\n
                var picker = new Common.UI.DataView({\r\n
                    el: element,\r\n
                    store: me.getCollection("TableTemplates"),\r\n
                    itemTemplate: _.template(\'<div class="item-template"><img src="<%= imageUrl %>" id="<%= id %>"></div>\')\r\n
                });\r\n
                picker.on("item:click", function (picker, item, record) {\r\n
                    if (me.api) {\r\n
                        me._setTableFormat(record.get("name"));\r\n
                        Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                        Common.component.Analytics.trackEvent("ToolBar", "Table Templates");\r\n
                    }\r\n
                });\r\n
                if (picker.scroller) {\r\n
                    picker.scroller.update({});\r\n
                }\r\n
                return picker;\r\n
            }\r\n
            if (_.isUndefined(this.toolbar.mnuTableTemplatePicker)) {\r\n
                this.toolbar.mnuTableTemplatePicker = createPicker($("#id-toolbar-menu-table-templates"));\r\n
            }\r\n
            if (_.isUndefined(this.toolbar.mnuTableTemplatePickerShort)) {\r\n
                this.toolbar.mnuTableTemplatePickerShort = createPicker($("#id-toolbar-short-menu-table-templates"));\r\n
            }\r\n
        },\r\n
        onTableTplMenuOpen: function (cmp) {\r\n
            var scroller = this.toolbar.mnuTableTemplatePicker.scroller;\r\n
            if (scroller) {\r\n
                scroller.update();\r\n
                scroller.scrollTop(0);\r\n
            }\r\n
        },\r\n
        onApiInitTableTemplates: function (images) {\r\n
            var store = this.getCollection("TableTemplates");\r\n
            if (store) {\r\n
                var templates = [];\r\n
                _.each(images, function (item) {\r\n
                    templates.push({\r\n
                        name: item.asc_getName(),\r\n
                        caption: item.asc_getDisplayName(),\r\n
                        type: item.asc_getType(),\r\n
                        imageUrl: item.asc_getImage(),\r\n
                        allowSelected: false,\r\n
                        selected: false\r\n
                    });\r\n
                });\r\n
                store.reset();\r\n
                store.add(templates);\r\n
            }\r\n
            this.fillTableTemplates();\r\n
        },\r\n
        onApiInitEditorStyles: function (styles) {\r\n
            window.styles_loaded = false;\r\n
            var self = this,\r\n
            listStyles = self.toolbar.listStyles;\r\n
            if (!listStyles) {\r\n
                self.styles = styles;\r\n
                return;\r\n
            }\r\n
            var canvasDefaultStyles = document.createElement("canvas");\r\n
            canvasDefaultStyles.id = "bigimgdefaultstyles";\r\n
            var isDocStyles = styles.asc_getDocStylesImage().length > 0;\r\n
            var fillStyles = function () {\r\n
                listStyles.menuPicker.store.reset([]);\r\n
                var thumbWidth = styles.asc_getStyleThumbnailWidth(),\r\n
                thumbHeight = styles.asc_getStyleThumbnailHeight();\r\n
                var merged_array = styles.asc_getDefaultStyles();\r\n
                isDocStyles && (merged_array = merged_array.concat(styles.asc_getDocStyles()));\r\n
                var thumb = document.createElement("canvas");\r\n
                var ctx = thumb.getContext("2d");\r\n
                thumb.width = thumbWidth;\r\n
                thumb.height = thumbHeight;\r\n
                _.each(merged_array, function (style) {\r\n
                    ctx.clearRect(0, 0, thumbWidth, thumbHeight);\r\n
                    ctx.save();\r\n
                    ctx.translate(0, -style.asc_getThumbnailOffset() * thumbHeight);\r\n
                    ctx.drawImage(((style.asc_getType() == c_oAscStyleImage.Default) ? canvasDefaultStyles : canvasDocStyles), 0, 0);\r\n
                    ctx.restore();\r\n
                    listStyles.menuPicker.store.add({\r\n
                        imageUrl: thumb.toDataURL(),\r\n
                        name: style.asc_getName(),\r\n
                        uid: Common.UI.getId()\r\n
                    });\r\n
                });\r\n
                if (listStyles.menuPicker.store.length > 0 && listStyles.rendered) {\r\n
                    listStyles.fillComboView(listStyles.menuPicker.store.at(0), true);\r\n
                    listStyles.selectByIndex(0);\r\n
                }\r\n
                window.styles_loaded = true;\r\n
            };\r\n
            var imgDefaultStyles = new Image(),\r\n
            imgLoaded = 1;\r\n
            if (isDocStyles) {\r\n
                imgLoaded++;\r\n
                var canvasDocStyles = document.createElement("canvas");\r\n
                canvasDocStyles.id = "bigimgdocstyles";\r\n
                var imgDocStyles = new Image();\r\n
                imgDocStyles.onload = function () {\r\n
                    canvasDocStyles.width = imgDocStyles.width;\r\n
                    canvasDocStyles.height = imgDocStyles.height;\r\n
                    canvasDocStyles.getContext("2d").drawImage(imgDocStyles, 0, 0);\r\n
                    if (! (--imgLoaded > 0)) {\r\n
                        fillStyles();\r\n
                    }\r\n
                };\r\n
            }\r\n
            imgDefaultStyles.onload = function () {\r\n
                canvasDefaultStyles.width = imgDefaultStyles.width;\r\n
                canvasDefaultStyles.height = imgDefaultStyles.height;\r\n
                canvasDefaultStyles.getContext("2d").drawImage(imgDefaultStyles, 0, 0);\r\n
                if (! (--imgLoaded > 0)) {\r\n
                    fillStyles();\r\n
                }\r\n
            };\r\n
            imgDefaultStyles.src = styles.asc_getDefaultStylesImage();\r\n
            imgDocStyles && (imgDocStyles.src = styles.asc_getDocStylesImage());\r\n
        },\r\n
        onApiCoAuthoringDisconnect: function () {\r\n
            this.toolbar.setMode({\r\n
                isDisconnected: true\r\n
            });\r\n
            this.editMode = false;\r\n
        },\r\n
        onApiChartDblClick: function () {\r\n
            this.onInsertChart(this.btnInsertChart);\r\n
        },\r\n
        onApiCanRevert: function (which, can) {\r\n
            if (which == "undo") {\r\n
                if (this._state.can_undo !== can) {\r\n
                    this.toolbar.btnUndo.setDisabled(!can);\r\n
                    this._state.can_undo = can;\r\n
                }\r\n
            } else {\r\n
                if (this._state.can_redo !== can) {\r\n
                    this.toolbar.btnRedo.setDisabled(!can);\r\n
                    this._state.can_redo = can;\r\n
                }\r\n
            }\r\n
        },\r\n
        setDisabledComponents: function (components, disable) {\r\n
            _.each([].concat(components), function (component) {\r\n
                if (component.isDisabled() !== disable) {\r\n
                    component.setDisabled(disable);\r\n
                }\r\n
            });\r\n
        },\r\n
        onApiEditCell: function (state) {\r\n
            var toolbar = this.toolbar;\r\n
            if (toolbar.mode.isEditDiagram) {\r\n
                is_cell_edited = (state == c_oAscCellEditorState.editStart);\r\n
                toolbar.lockToolbar(SSE.enumLock.editCell, state == c_oAscCellEditorState.editStart, {\r\n
                    array: [toolbar.btnDecDecimal, toolbar.btnIncDecimal, toolbar.btnNumberFormat]\r\n
                });\r\n
            } else {\r\n
                if (state == c_oAscCellEditorState.editStart || state == c_oAscCellEditorState.editEnd) {\r\n
                    toolbar.lockToolbar(SSE.enumLock.editCell, state == c_oAscCellEditorState.editStart, {\r\n
                        array: [toolbar.btnClearStyle.menu.items[1], toolbar.btnClearStyle.menu.items[2], toolbar.btnClearStyle.menu.items[3], toolbar.btnClearStyle.menu.items[4], toolbar.mnuitemClearFilter],\r\n
                        merge: true,\r\n
                        clear: [SSE.enumLock.editFormula, SSE.enumLock.editText]\r\n
                    });\r\n
                    var is_cell_edited = (state == c_oAscCellEditorState.editStart);\r\n
                    (is_cell_edited) ? Common.util.Shortcuts.suspendEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+alt+h, ctrl+alt+h") : Common.util.Shortcuts.resumeEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+alt+h, ctrl+alt+h");\r\n
                    if (is_cell_edited) {\r\n
                        toolbar.listStyles.suspendEvents();\r\n
                        toolbar.listStyles.menuPicker.selectRecord(null);\r\n
                        toolbar.listStyles.resumeEvents();\r\n
                        this._state.prstyle = undefined;\r\n
                    }\r\n
                } else {\r\n
                    if (state == c_oAscCellEditorState.editText) {\r\n
                        var is_text = true,\r\n
                        is_formula = false;\r\n
                    } else {\r\n
                        if (state == c_oAscCellEditorState.editFormula) {\r\n
                            is_text = !(is_formula = true);\r\n
                        } else {\r\n
                            if (state == c_oAscCellEditorState.editEmptyCell) {\r\n
                                is_text = is_formula = false;\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    toolbar.lockToolbar(SSE.enumLock.editFormula, is_formula, {\r\n
                        array: [toolbar.cmbFontName, toolbar.cmbFontSize, toolbar.btnIncFontSize, toolbar.btnDecFontSize, toolbar.btnBold, toolbar.btnItalic, toolbar.btnUnderline, toolbar.btnTextColor]\r\n
                    });\r\n
                    toolbar.lockToolbar(SSE.enumLock.editText, is_text, {\r\n
                        array: [toolbar.btnInsertFormula]\r\n
                    });\r\n
                }\r\n
            }\r\n
            this._state.coauthdisable = undefined;\r\n
            this._state.selection_type = undefined;\r\n
            this.checkInsertAutoshape({\r\n
                action: "cancel"\r\n
            });\r\n
        },\r\n
        onApiZoomChange: function (zf, type) {\r\n
            switch (type) {\r\n
            case 1:\r\n
                case 2:\r\n
                case 0:\r\n
                default:\r\n
                $(".menu-zoom .zoom", this.toolbar.el).html(Math.floor((zf + 0.005) * 100) + "%");\r\n
            }\r\n
        },\r\n
        onApiSheetChanged: function () {\r\n
            if (this.api) {\r\n
                var params = this.api.asc_getSheetViewSettings(),\r\n
                menu = this.toolbar.btnShowMode.menu;\r\n
                if (menu) {\r\n
                    menu.items[3].setChecked(!params.asc_getShowRowColHeaders());\r\n
                    menu.items[4].setChecked(!params.asc_getShowGridLines());\r\n
                    menu.items[5].setChecked(params.asc_getIsFreezePane());\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiEditorSelectionChanged: function (fontobj) {\r\n
            if (!this.editMode) {\r\n
                return;\r\n
            }\r\n
            var toolbar = this.toolbar,\r\n
            val;\r\n
            var fontparam = fontobj.asc_getName();\r\n
            if (fontparam != toolbar.cmbFontName.getValue()) {\r\n
                Common.NotificationCenter.trigger("fonts:change", fontobj);\r\n
            }\r\n
            if (!toolbar.mode.isEditDiagram) {\r\n
                val = fontobj.asc_getBold();\r\n
                if (this._state.bold !== val) {\r\n
                    toolbar.btnBold.toggle(val === true, true);\r\n
                    this._state.bold = val;\r\n
                }\r\n
                val = fontobj.asc_getItalic();\r\n
                if (this._state.italic !== val) {\r\n
                    toolbar.btnItalic.toggle(val === true, true);\r\n
                    this._state.italic = val;\r\n
                }\r\n
                val = fontobj.asc_getUnderline();\r\n
                if (this._state.underline !== val) {\r\n
                    toolbar.btnUnderline.toggle(val === true, true);\r\n
                    this._state.underline = val;\r\n
                }\r\n
            }\r\n
            var str_size = fontobj.asc_getSize();\r\n
            if (toolbar.cmbFontSize.getValue() != str_size) {\r\n
                toolbar.cmbFontSize.setValue((str_size !== undefined) ? str_size : "");\r\n
            }\r\n
            var clr, color, fontColorPicker = this.toolbar.mnuTextColorPicker;\r\n
            if (!toolbar.btnTextColor.ischanged && !fontColorPicker.isDummy) {\r\n
                color = fontobj.asc_getColor();\r\n
                if (color) {\r\n
                    if (color.get_type() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                        clr = {\r\n
                            color: Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b()),\r\n
                            effectValue: color.get_value()\r\n
                        };\r\n
                    } else {\r\n
                        clr = Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b());\r\n
                    }\r\n
                }\r\n
                var type1 = typeof(clr),\r\n
                type2 = typeof(this._state.clrtext);\r\n
                if ((type1 !== type2) || (type1 == "object" && (clr.effectValue !== this._state.clrtext.effectValue || this._state.clrtext.color.indexOf(clr.color) < 0)) || (type1 != "object" && this._state.clrtext !== undefined && this._state.clrtext.indexOf(clr) < 0)) {\r\n
                    if (_.isObject(clr)) {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == clr.effectValue) {\r\n
                                fontColorPicker.select(clr, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            fontColorPicker.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        fontColorPicker.select(clr, true);\r\n
                    }\r\n
                    this._state.clrtext = clr;\r\n
                }\r\n
                this._state.clrtext_asccolor = color;\r\n
            }\r\n
        },\r\n
        onApiSelectionChanged: function (info) {\r\n
            if (!this.editMode) {\r\n
                return;\r\n
            }\r\n
            var selectionType = info.asc_getFlags().asc_getSelectionType();\r\n
            var coauth_disable = (!this.toolbar.mode.isEditDiagram) ? (info.asc_getLocked() === true) : false;\r\n
            if (this._disableEditOptions(selectionType, coauth_disable)) {\r\n
                return;\r\n
            }\r\n
            var me = this,\r\n
            toolbar = this.toolbar,\r\n
            fontobj = info.asc_getFont(),\r\n
            val;\r\n
            var fontparam = fontobj.asc_getName();\r\n
            if (fontparam != toolbar.cmbFontName.getValue()) {\r\n
                Common.NotificationCenter.trigger("fonts:change", fontobj);\r\n
            }\r\n
            if (!toolbar.mode.isEditDiagram) {\r\n
                val = fontobj.asc_getBold();\r\n
                if (this._state.bold !== val) {\r\n
                    toolbar.btnBold.toggle(val === true, true);\r\n
                    this._state.bold = val;\r\n
                }\r\n
                val = fontobj.asc_getItalic();\r\n
                if (this._state.italic !== val) {\r\n
                    toolbar.btnItalic.toggle(val === true, true);\r\n
                    this._state.italic = val;\r\n
                }\r\n
                val = fontobj.asc_getUnderline();\r\n
                if (this._state.underline !== val) {\r\n
                    toolbar.btnUnderline.toggle(val === true, true);\r\n
                    this._state.underline = val;\r\n
                }\r\n
            }\r\n
            var str_size = fontobj.asc_getSize();\r\n
            if (toolbar.cmbFontSize.getValue() != str_size) {\r\n
                toolbar.cmbFontSize.setValue((str_size !== undefined) ? str_size : "");\r\n
            }\r\n
            var clr, color, fontColorPicker = this.toolbar.mnuTextColorPicker,\r\n
            paragraphColorPicker = this.toolbar.mnuBackColorPicker;\r\n
            if (!toolbar.btnTextColor.ischanged && !fontColorPicker.isDummy) {\r\n
                color = fontobj.asc_getColor();\r\n
                if (color) {\r\n
                    if (color.get_type() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                        clr = {\r\n
                            color: Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b()),\r\n
                            effectValue: color.get_value()\r\n
                        };\r\n
                    } else {\r\n
                        clr = Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b());\r\n
                    }\r\n
                }\r\n
                var type1 = typeof(clr),\r\n
                type2 = typeof(this._state.clrtext);\r\n
                if ((type1 !== type2) || (type1 == "object" && (clr.effectValue !== this._state.clrtext.effectValue || this._state.clrtext.color.indexOf(clr.color) < 0)) || (type1 != "object" && this._state.clrtext !== undefined && this._state.clrtext.indexOf(clr) < 0)) {\r\n
                    if (_.isObject(clr)) {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == clr.effectValue) {\r\n
                                fontColorPicker.select(clr, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            fontColorPicker.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        fontColorPicker.select(clr, true);\r\n
                    }\r\n
                    this._state.clrtext = clr;\r\n
                }\r\n
                this._state.clrtext_asccolor = color;\r\n
            }\r\n
            if (!toolbar.btnBackColor.ischanged && !paragraphColorPicker.isDummy) {\r\n
                color = info.asc_getFill().asc_getColor();\r\n
                if (color) {\r\n
                    if (color.get_type() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                        clr = {\r\n
                            color: Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b()),\r\n
                            effectValue: color.get_value()\r\n
                        };\r\n
                    } else {\r\n
                        clr = Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b());\r\n
                    }\r\n
                } else {\r\n
                    clr = "transparent";\r\n
                }\r\n
                type1 = typeof(clr);\r\n
                type2 = typeof(this._state.clrback);\r\n
                if ((type1 !== type2) || (type1 == "object" && (clr.effectValue !== this._state.clrback.effectValue || this._state.clrback.color.indexOf(clr.color) < 0)) || (type1 != "object" && this._state.clrback !== undefined && this._state.clrback.indexOf(clr) < 0)) {\r\n
                    if (_.isObject(clr)) {\r\n
                        var isselected = false;\r\n
                        for (i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == clr.effectValue) {\r\n
                                paragraphColorPicker.select(clr, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            paragraphColorPicker.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        paragraphColorPicker.select(clr, true);\r\n
                    }\r\n
                    this._state.clrback = clr;\r\n
                }\r\n
                this._state.clrshd_asccolor = color;\r\n
            }\r\n
            if (selectionType == c_oAscSelectionType.RangeChart || selectionType == c_oAscSelectionType.RangeChartText) {\r\n
                return;\r\n
            }\r\n
            if (!toolbar.mode.isEditDiagram) {\r\n
                fontparam = info.asc_getHorAlign();\r\n
                if (this._state.pralign !== fontparam) {\r\n
                    this._state.pralign = fontparam;\r\n
                    var index = -1,\r\n
                    align;\r\n
                    switch (fontparam) {\r\n
                    case "left":\r\n
                        index = 0;\r\n
                        align = "btn-align-left";\r\n
                        break;\r\n
                    case "center":\r\n
                        index = 1;\r\n
                        align = "btn-align-center";\r\n
                        break;\r\n
                    case "right":\r\n
                        index = 2;\r\n
                        align = "btn-align-right";\r\n
                        break;\r\n
                    case "justify":\r\n
                        index = 3;\r\n
                        align = "btn-align-just";\r\n
                        break;\r\n
                    default:\r\n
                        index = -255;\r\n
                        align = "btn-align-left";\r\n
                        break;\r\n
                    }\r\n
                    if (! (index < 0)) {\r\n
                        toolbar.btnAlignRight.toggle(index === 2, true);\r\n
                        toolbar.btnAlignLeft.toggle(index === 0, true);\r\n
                        toolbar.btnAlignCenter.toggle(index === 1, true);\r\n
                        toolbar.btnAlignJust.toggle(index === 3, true);\r\n
                        toolbar.btnHorizontalAlign.menu.items[index].setChecked(true, false);\r\n
                    } else {\r\n
                        if (index == -255) {\r\n
                            toolbar.btnAlignRight.toggle(false, true);\r\n
                            toolbar.btnAlignLeft.toggle(false, true);\r\n
                            toolbar.btnAlignCenter.toggle(false, true);\r\n
                            toolbar.btnAlignJust.toggle(false, true);\r\n
                            this._clearChecked(toolbar.btnHorizontalAlign.menu);\r\n
                        }\r\n
                    }\r\n
                    var btnHorizontalAlign = this.toolbar.btnHorizontalAlign;\r\n
                    if (btnHorizontalAlign.rendered) {\r\n
                        var hIconEl = $(".btn-icon", btnHorizontalAlign.cmpEl);\r\n
                        if (hIconEl) {\r\n
                            hIconEl.removeClass(btnHorizontalAlign.options.icls);\r\n
                            btnHorizontalAlign.options.icls = align;\r\n
                            hIconEl.addClass(btnHorizontalAlign.options.icls);\r\n
                        }\r\n
                    }\r\n
                    toolbar.btnTextOrient.menu.items[1].setDisabled(fontparam == "justify");\r\n
                    toolbar.btnTextOrient.menu.items[2].setDisabled(fontparam == "justify");\r\n
                }\r\n
                fontparam = info.asc_getVertAlign();\r\n
                if (this._state.valign !== fontparam) {\r\n
                    this._state.valign = fontparam;\r\n
                    index = -1;\r\n
                    align = "";\r\n
                    switch (fontparam) {\r\n
                    case "top":\r\n
                        index = 0;\r\n
                        align = "btn-valign-top";\r\n
                        break;\r\n
                    case "center":\r\n
                        index = 1;\r\n
                        align = "btn-valign-middle";\r\n
                        break;\r\n
                    case "bottom":\r\n
                        index = 2;\r\n
                        align = "btn-valign-bottom";\r\n
                        break;\r\n
                    }\r\n
                    if (index > -1) {\r\n
                        toolbar.btnAlignTop.toggle(index === 0, true);\r\n
                        toolbar.btnAlignMiddle.toggle(index === 1, true);\r\n
                        toolbar.btnAlignBottom.toggle(index === 2, true);\r\n
                        toolbar.btnVerticalAlign.menu.items[index].setChecked(true, false);\r\n
                        var btnVerticalAlign = this.toolbar.btnVerticalAlign;\r\n
                        if (btnVerticalAlign.rendered) {\r\n
                            var vIconEl = $(".btn-icon", btnVerticalAlign.cmpEl);\r\n
                            if (vIconEl) {\r\n
                                vIconEl.removeClass(btnVerticalAlign.options.icls);\r\n
                                btnVerticalAlign.options.icls = align;\r\n
                                vIconEl.addClass(btnVerticalAlign.options.icls);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
                var need_disable = this._state.controlsdisabled.filters || (info.asc_getIsFormatTable() === true);\r\n
                toolbar.lockToolbar(SSE.enumLock.ruleMerge, need_disable, {\r\n
                    array: [toolbar.btnMerge]\r\n
                });\r\n
                val = info.asc_getFlags().asc_getMerge();\r\n
                if (this._state.merge !== val) {\r\n
                    toolbar.btnMerge.toggle(val === true, true);\r\n
                    this._state.merge = val;\r\n
                }\r\n
                val = info.asc_getIsAutoFilter();\r\n
                if (this._state.filter !== val) {\r\n
                    toolbar.btnSetAutofilter.toggle(val === true, true);\r\n
                    toolbar.mnuitemAutoFilter.setChecked(val === true, true);\r\n
                    this._state.filter = val;\r\n
                }\r\n
                need_disable = this._state.controlsdisabled.filters || (val === null);\r\n
                toolbar.lockToolbar(SSE.enumLock.ruleFilter, need_disable, {\r\n
                    array: [toolbar.btnSortDown, toolbar.btnSortUp, toolbar.mnuitemSortAZ, toolbar.mnuitemSortZA, toolbar.btnTableTemplate, toolbar.btnSetAutofilter, toolbar.mnuitemAutoFilter, toolbar.btnAutofilter]\r\n
                });\r\n
                need_disable = this._state.controlsdisabled.filters || (info.asc_getClearFilter() !== true);\r\n
                toolbar.lockToolbar(SSE.enumLock.ruleDelFilter, need_disable, {\r\n
                    array: [toolbar.btnClearAutofilter, toolbar.mnuitemClearFilter]\r\n
                });\r\n
                if (!toolbar.btnWrap.isDisabled()) {\r\n
                    val = info.asc_getFlags().asc_getWrapText();\r\n
                    if (this._state.wrap !== val) {\r\n
                        toolbar.btnWrap.toggle(val === true, true);\r\n
                        this._state.wrap = val;\r\n
                    }\r\n
                }\r\n
            }\r\n
            fontparam = toolbar.numFormatTypes[info.asc_getNumFormatType()];\r\n
            if (!fontparam) {\r\n
                fontparam = toolbar.numFormatTypes[1];\r\n
            }\r\n
            toolbar.btnNumberFormat.setCaption(fontparam);\r\n
            val = info.asc_getAngle();\r\n
            if (this._state.angle !== val) {\r\n
                this._clearChecked(toolbar.btnTextOrient.menu);\r\n
                switch (val) {\r\n
                case 45:\r\n
                    toolbar.btnTextOrient.menu.items[1].setChecked(true, true);\r\n
                    break;\r\n
                case -45:\r\n
                    toolbar.btnTextOrient.menu.items[2].setChecked(true, true);\r\n
                    break;\r\n
                case 90:\r\n
                    toolbar.btnTextOrient.menu.items[3].setChecked(true, true);\r\n
                    break;\r\n
                case -90:\r\n
                    toolbar.btnTextOrient.menu.items[4].setChecked(true, true);\r\n
                    break;\r\n
                default:\r\n
                    toolbar.btnTextOrient.menu.items[0].setChecked(true, true);\r\n
                    break;\r\n
                }\r\n
                this._state.angle = val;\r\n
            }\r\n
            val = info.asc_getStyleName();\r\n
            if (this._state.prstyle != val && !this.toolbar.listStyles.isDisabled()) {\r\n
                var listStyle = this.toolbar.listStyles,\r\n
                listStylesVisible = (listStyle.rendered);\r\n
                if (listStylesVisible) {\r\n
                    listStyle.suspendEvents();\r\n
                    var styleRec = listStyle.menuPicker.store.findWhere({\r\n
                        name: val\r\n
                    });\r\n
                    this._state.prstyle = (listStyle.menuPicker.store.length > 0) ? val : undefined;\r\n
                    listStyle.menuPicker.selectRecord(styleRec);\r\n
                    listStyle.resumeEvents();\r\n
                }\r\n
            }\r\n
            val = (selectionType == c_oAscSelectionType.RangeRow);\r\n
            if (this._state.controlsdisabled.rows !== val) {\r\n
                this._state.controlsdisabled.rows = val;\r\n
                toolbar.btnAddCell.menu.items[0].setDisabled(val);\r\n
                toolbar.btnAddCell.menu.items[3].setDisabled(val);\r\n
                toolbar.btnDeleteCell.menu.items[0].setDisabled(val);\r\n
                toolbar.btnDeleteCell.menu.items[3].setDisabled(val);\r\n
            }\r\n
            val = (selectionType == c_oAscSelectionType.RangeCol);\r\n
            if (this._state.controlsdisabled.cols !== val) {\r\n
                this._state.controlsdisabled.cols = val;\r\n
                toolbar.btnAddCell.menu.items[1].setDisabled(val);\r\n
                toolbar.btnAddCell.menu.items[2].setDisabled(val);\r\n
                toolbar.btnDeleteCell.menu.items[1].setDisabled(val);\r\n
                toolbar.btnDeleteCell.menu.items[2].setDisabled(val);\r\n
            }\r\n
        },\r\n
        onApiStyleChange: function () {\r\n
            this.toolbar.btnCopyStyle.toggle(false, true);\r\n
            this.modeAlwaysSetStyle = false;\r\n
        },\r\n
        updateThemeColors: function () {\r\n
            var updateColors = function (picker, defaultColor) {\r\n
                if (picker) {\r\n
                    var clr;\r\n
                    var effectcolors = Common.Utils.ThemeColor.getEffectColors();\r\n
                    for (var i = 0; i < effectcolors.length; i++) {\r\n
                        if (typeof(picker.currentColor) == "object" && clr === undefined && picker.currentColor.effectId == effectcolors[i].effectId) {\r\n
                            clr = effectcolors[i];\r\n
                        }\r\n
                    }\r\n
                    picker.updateColors(effectcolors, Common.Utils.ThemeColor.getStandartColors());\r\n
                    if (picker.currentColor === undefined) {\r\n
                        picker.currentColor = defaultColor;\r\n
                    } else {\r\n
                        if (clr !== undefined) {\r\n
                            picker.currentColor = clr;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            };\r\n
            updateColors(this.toolbar.mnuTextColorPicker, Common.Utils.ThemeColor.getStandartColors()[1]);\r\n
            if (this.toolbar.btnTextColor.currentColor === undefined) {\r\n
                this.toolbar.btnTextColor.currentColor = Common.Utils.ThemeColor.getStandartColors()[1];\r\n
            } else {\r\n
                this.toolbar.btnTextColor.currentColor = this.toolbar.mnuTextColorPicker.currentColor.color || this.toolbar.mnuTextColorPicker.currentColor;\r\n
            }\r\n
            $(".btn-color-value-line", this.toolbar.btnTextColor.cmpEl).css("background-color", "#" + this.toolbar.btnTextColor.currentColor);\r\n
            updateColors(this.toolbar.mnuBackColorPicker, Common.Utils.ThemeColor.getStandartColors()[3]);\r\n
            if (this.toolbar.btnBackColor.currentColor === undefined) {\r\n
                this.toolbar.btnBackColor.currentColor = Common.Utils.ThemeColor.getStandartColors()[3];\r\n
            } else {\r\n
                this.toolbar.btnBackColor.currentColor = this.toolbar.mnuBackColorPicker.currentColor.color || this.toolbar.mnuBackColorPicker.currentColor;\r\n
            }\r\n
            $(".btn-color-value-line", this.toolbar.btnBackColor.cmpEl).css("background-color", this.toolbar.btnBackColor.currentColor == "transparent" ? "transparent" : "#" + this.toolbar.btnBackColor.currentColor);\r\n
            if (this._state.clrtext_asccolor !== undefined || this._state.clrshd_asccolor !== undefined) {\r\n
                this._state.clrtext = undefined;\r\n
                this._state.clrback = undefined;\r\n
                this.onApiSelectionChanged(this.api.asc_getCellInfo());\r\n
            }\r\n
            this._state.clrtext_asccolor = undefined;\r\n
            this._state.clrshd_asccolor = undefined;\r\n
            updateColors(this.toolbar.mnuBorderColorPicker, Common.Utils.ThemeColor.getEffectColors()[1]);\r\n
            this.toolbar.btnBorders.options.borderscolor = this.toolbar.mnuBorderColorPicker.currentColor.color || this.toolbar.mnuBorderColorPicker.currentColor;\r\n
            $("#id-toolbar-mnu-item-border-color .menu-item-icon").css("border-color", "#" + this.toolbar.btnBorders.options.borderscolor);\r\n
        },\r\n
        hideElements: function (opts) {\r\n
            if (!_.isUndefined(opts.title)) {\r\n
                var headerView = this.getApplication().getController("Viewport").getView("Common.Views.Header");\r\n
                headerView && headerView.setVisible(!opts.title);\r\n
                Common.NotificationCenter.trigger("layout:changed", "header");\r\n
            }\r\n
            if (!_.isUndefined(opts.compact)) {\r\n
                this.onChangeViewMode(opts.compact);\r\n
            }\r\n
            if (!_.isUndefined(opts.formula)) {\r\n
                var cellEditor = this.getApplication().getController("CellEditor").getView("CellEditor");\r\n
                cellEditor && cellEditor.setVisible(!opts.formula);\r\n
                Common.NotificationCenter.trigger("layout:changed", "celleditor", opts.formula ? "hidden" : "showed");\r\n
            }\r\n
            if (!_.isUndefined(opts.headings)) {\r\n
                if (this.api) {\r\n
                    var current = this.api.asc_getSheetViewSettings();\r\n
                    current.asc_setShowRowColHeaders(!opts.headings);\r\n
                    this.api.asc_setSheetViewSettings(current);\r\n
                }\r\n
            }\r\n
            if (!_.isUndefined(opts.gridlines)) {\r\n
                if (this.api) {\r\n
                    current = this.api.asc_getSheetViewSettings();\r\n
                    current.asc_setShowGridLines(!opts.gridlines);\r\n
                    this.api.asc_setSheetViewSettings(current);\r\n
                }\r\n
            }\r\n
            if (!_.isUndefined(opts.freezepanes)) {\r\n
                if (this.api) {\r\n
                    this.api.asc_freezePane();\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar);\r\n
        },\r\n
        fillAutoShapes: function () {\r\n
            var me = this,\r\n
            shapesStore = this.getApplication().getCollection("ShapeGroups");\r\n
            for (var i = 0; i < shapesStore.length - 1; i++) {\r\n
                var shapeGroup = shapesStore.at(i);\r\n
                var menuItem = new Common.UI.MenuItem({\r\n
                    caption: shapeGroup.get("groupName"),\r\n
                    menu: new Common.UI.Menu({\r\n
                        menuAlign: "tl-tr",\r\n
                        items: [{\r\n
                            template: _.template(\'<div id="id-toolbar-menu-shapegroup\' + i + \'" class="menu-shape" style="width: \' + (shapeGroup.get("groupWidth") - 8) + \'px; margin-left: 5px;"></div>\')\r\n
                        }]\r\n
                    })\r\n
                });\r\n
                me.toolbar.btnInsertShape.menu.addItem(menuItem);\r\n
                var shapePicker = new Common.UI.DataView({\r\n
                    el: $("#id-toolbar-menu-shapegroup" + i),\r\n
                    store: shapeGroup.get("groupStore"),\r\n
                    itemTemplate: _.template(\'<div class="item-shape"><img src="<%= imageUrl %>" id="<%= id %>"></div>\')\r\n
                });\r\n
                shapePicker.on("item:click", function (picker, item, record) {\r\n
                    if (me.api) {\r\n
                        me._addAutoshape(true, record.get("data").shapeType);\r\n
                        me._isAddingShape = true;\r\n
                        if (me.toolbar.btnInsertText.pressed) {\r\n
                            me.toolbar.btnInsertText.toggle(false, true);\r\n
                        }\r\n
                        Common.NotificationCenter.trigger("edit:complete", me.toolbar, me.toolbar.btnInsertShape);\r\n
                        Common.component.Analytics.trackEvent("ToolBar", "Add Shape");\r\n
                    }\r\n
                });\r\n
            }\r\n
        },\r\n
        attachToControlEvents: function () {},\r\n
        onSheetChanged: function () {\r\n
            if (this.api) {\r\n
                var params = this.api.asc_getSheetViewSettings();\r\n
                var menu = this.getMenuHideOptions();\r\n
                if (menu) {\r\n
                    menu.items.getAt(3).setChecked(!params.asc_getShowRowColHeaders());\r\n
                    menu.items.getAt(4).setChecked(!params.asc_getShowGridLines());\r\n
                }\r\n
            }\r\n
        },\r\n
        _disableEditOptions: function (seltype, coauth_disable) {\r\n
            if (this.api.isCellEdited) {\r\n
                return true;\r\n
            }\r\n
            if (this.api.isRangeSelection) {\r\n
                return true;\r\n
            }\r\n
            if (this._state.selection_type === seltype && this._state.coauthdisable === coauth_disable) {\r\n
                return (seltype === c_oAscSelectionType.RangeImage);\r\n
            }\r\n
            var toolbar = this.toolbar,\r\n
            is_chart_text = seltype == c_oAscSelectionType.RangeChartText,\r\n
            is_chart = seltype == c_oAscSelectionType.RangeChart,\r\n
            is_shape_text = seltype == c_oAscSelectionType.RangeShapeText,\r\n
            is_shape = seltype == c_oAscSelectionType.RangeShape,\r\n
            is_image = seltype == c_oAscSelectionType.RangeImage,\r\n
            is_mode_2 = is_shape_text || is_shape || is_chart_text || is_chart;\r\n
            if (coauth_disable) {\r\n
                toolbar.lockToolbar(SSE.enumLock.coAuth, coauth_disable);\r\n
            } else {\r\n
                var _set = SSE.enumLock;\r\n
                var type = seltype;\r\n
                switch (seltype) {\r\n
                case c_oAscSelectionType.RangeImage:\r\n
                    type = _set.selImage;\r\n
                    break;\r\n
                case c_oAscSelectionType.RangeShape:\r\n
                    type = _set.selShape;\r\n
                    break;\r\n
                case c_oAscSelectionType.RangeShapeText:\r\n
                    type = _set.selShapeText;\r\n
                    break;\r\n
                case c_oAscSelectionType.RangeChart:\r\n
                    type = _set.selChart;\r\n
                    break;\r\n
                case c_oAscSelectionType.RangeChartText:\r\n
                    type = _set.selChartText;\r\n
                    break;\r\n
                }\r\n
                toolbar.lockToolbar(type, type != seltype, {\r\n
                    array: [toolbar.btnClearStyle.menu.items[1], toolbar.btnClearStyle.menu.items[2], toolbar.btnClearStyle.menu.items[3], toolbar.btnClearStyle.menu.items[4], toolbar.mnuitemSortAZ, toolbar.mnuitemSortZA, toolbar.mnuitemAutoFilter, toolbar.mnuitemClearFilter],\r\n
                    merge: true,\r\n
                    clear: [_set.selImage, _set.selChart, _set.selChartText, _set.selShape, _set.selShapeText, _set.coAuth]\r\n
                });\r\n
            }\r\n
            $("#ce-func-label").toggleClass("disabled", is_image || is_mode_2 || coauth_disable);\r\n
            this._state.controlsdisabled.filters = is_image || is_mode_2 || coauth_disable;\r\n
            if (is_image || is_mode_2 || coauth_disable) {\r\n
                toolbar.listStyles.suspendEvents();\r\n
                toolbar.listStyles.menuPicker.selectRecord(null);\r\n
                toolbar.listStyles.resumeEvents();\r\n
                this._state.prstyle = undefined;\r\n
            }\r\n
            this._state.selection_type = seltype;\r\n
            this._state.coauthdisable = coauth_disable;\r\n
            return is_image;\r\n
        },\r\n
        _getApiTextSize: function () {\r\n
            var cellInfo = this.api.asc_getCellInfo();\r\n
            return cellInfo ? cellInfo.asc_getFont().asc_getSize() : 12;\r\n
        },\r\n
        _clearChecked: function (menu) {\r\n
            _.each(menu.items, function (item) {\r\n
                if (item.setChecked) {\r\n
                    item.setChecked(false, true);\r\n
                }\r\n
            });\r\n
        },\r\n
        _setTableFormat: function (fmtname) {\r\n
            var me = this;\r\n
            if (me.api.isRangeSelection !== true) {\r\n
                if (me.api.asc_getAddFormatTableOptions() != false) {\r\n
                    var handlerDlg = function (dlg, result) {\r\n
                        if (result == "ok") {\r\n
                            me._state.filter = undefined;\r\n
                            me.api.asc_setSelectionDialogMode(c_oAscSelectionDialogType.None);\r\n
                            me.api.asc_addAutoFilter(fmtname, dlg.getSettings());\r\n
                        }\r\n
                        Common.NotificationCenter.trigger("edit:complete", me.toolbar);\r\n
                    };\r\n
                    var win = new SSE.Views.TableOptionsDialog({\r\n
                        handler: handlerDlg\r\n
                    });\r\n
                    win.show();\r\n
                    win.setSettings({\r\n
                        api: me.api\r\n
                    });\r\n
                } else {\r\n
                    me._state.filter = undefined;\r\n
                    me.api.asc_addAutoFilter(fmtname);\r\n
                }\r\n
            }\r\n
        },\r\n
        onHideMenus: function (e) {\r\n
            Common.NotificationCenter.trigger("edit:complete", this.toolbar, {\r\n
                restorefocus: true\r\n
            });\r\n
        },\r\n
        onSetupCopyStyleButton: function () {\r\n
            this.modeAlwaysSetStyle = false;\r\n
            var acsCopyFmtStyleState = {\r\n
                kOff: 0,\r\n
                kOn: 1,\r\n
                kMultiple: 2\r\n
            };\r\n
            var me = this;\r\n
            Common.NotificationCenter.on({\r\n
                "edit:complete": function () {\r\n
                    if (me.api && me.modeAlwaysSetStyle) {\r\n
                        me.api.asc_formatPainter(acsCopyFmtStyleState.kOff);\r\n
                        me.toolbar.btnCopyStyle.toggle(false, true);\r\n
                        me.modeAlwaysSetStyle = false;\r\n
                    }\r\n
                }\r\n
            });\r\n
            $(me.toolbar.btnCopyStyle.cmpEl).dblclick(function () {\r\n
                if (me.api) {\r\n
                    me.modeAlwaysSetStyle = true;\r\n
                    me.toolbar.btnCopyStyle.toggle(true, true);\r\n
                    me.api.asc_formatPainter(acsCopyFmtStyleState.kMultiple);\r\n
                }\r\n
            });\r\n
        },\r\n
        onCellsRange: function (status) {\r\n
            this.api.isRangeSelection = (status != c_oAscSelectionDialogType.None);\r\n
            this.onApiEditCell(this.api.isRangeSelection ? c_oAscCellEditorState.editStart : c_oAscCellEditorState.editEnd);\r\n
            var toolbar = this.toolbar;\r\n
            toolbar.lockToolbar(SSE.enumLock.selRange, this.api.isRangeSelection);\r\n
            this.setDisabledComponents([toolbar.btnUndo], this.api.isRangeSelection || !this.api.asc_getCanUndo());\r\n
            this.setDisabledComponents([toolbar.btnRedo], this.api.isRangeSelection || !this.api.asc_getCanRedo());\r\n
            this.onApiSelectionChanged(this.api.asc_getCellInfo());\r\n
        },\r\n
        DisableToolbar: function (disable) {\r\n
            var mask = $(".toolbar-mask");\r\n
            if (disable && mask.length > 0 || !disable && mask.length == 0) {\r\n
                return;\r\n
            }\r\n
            var toolbar = this.toolbar;\r\n
            toolbar.$el.find(".toolbar").toggleClass("masked", disable);\r\n
            this.toolbar.lockToolbar(SSE.enumLock.menuFileOpen, disable, {\r\n
                array: [toolbar.btnShowMode]\r\n
            });\r\n
            if (disable) {\r\n
                mask = $("<div class=\'toolbar-mask\'>").appendTo(toolbar.$el);\r\n
                var left = toolbar.isCompactView ? 75 : (toolbar.mode.nativeApp ? 80 : 48);\r\n
                mask.css("left", left + "px");\r\n
                mask.css("right", (toolbar.isCompactView ? 0 : 45) + "px");\r\n
                Common.util.Shortcuts.suspendEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+alt+h, ctrl+alt+h");\r\n
            } else {\r\n
                mask.remove();\r\n
                Common.util.Shortcuts.resumeEvents("command+l, ctrl+l, command+shift+l, ctrl+shift+l, command+k, ctrl+k, command+alt+h, ctrl+alt+h");\r\n
            }\r\n
        },\r\n
        textEmptyImgUrl: "You need to specify image URL.",\r\n
        warnMergeLostData: "Operation will can destroy data in the selected cells.<br>Continue?",\r\n
        textWarning : "Warning",\r\n
        textFontSizeErr: "The entered value must be more than 0",\r\n
        textCancel: "Cancel"\r\n
    });\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/StatusBar.template\',[],function () { return \'\\r\\n<div class="statusbar">\\r\\n    <div id="status-tabs-scroll" class="status-group">\\r\\n        <button id="status-btn-tabfirst" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-tab-first">&nbsp;</span></button>\\r\\n        <button id="status-btn-tabback" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-tab-back">&nbsp;</span></button>\\r\\n        <button id="status-btn-tabnext" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-tab-next">&nbsp;</span></button>\\r\\n        <button id="status-btn-tablast" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-tab-last">&nbsp;</span></button>\\r\\n    </div>\\r\\n    <div id="status-addtabs-box" class="status-group">\\r\\n        <button id="status-btn-addtab" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-zoom-up">&nbsp;</span></button>\\r\\n    </div>\\r\\n    <div id="status-zoom-box" class="status-group">\\r\\n        <div class="separator short" />\\r\\n        <button id="status-btn-zoomdown" type="button" class="btn small btn-toolbar btn-toolbar-default"><span class="btn-icon btn-zoom-down">&nbsp;</span></button>\\r\\n        <div class="cnt-zoom">\\r\\n            <div class="dropdown-toggle" data-toggle="dropdown">\\r\\n                <label id="status-label-zoom" class="status-label">Zoom 100%</label>\\r\\n            </div>\\r\\n        </div>\\r\\n        <button id="status-btn-zoomup" type="button" class="btn small btn-toolbar btn-toolbar-default" style="margin-right:40px;"><span class="btn-icon btn-zoom-up">&nbsp;</span></button>\\r\\n    </div>\\r\\n    <!

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABQ=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="20" aka="AAAAAAAAABQ=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

-- /** coauthoring begin **/ -->\\r\\n    <div id="status-users-box" class="status-group" style="display:none;">\\r\\n        <div class="separator short" />\\r\\n        <div id="status-users-block" style="display:inline-block; cursor:pointer; margin-left: 12px;">\\r\\n            <span id="status-users-icon" />\\r\\n            <label id="status-users-count" class="status-label">3</label>\\r\\n        </div>\\r\\n    </div>\\r\\n    <!-- /** coauthoring end **/ -->\\r\\n    <div id="status-math-box" class="status-group">\\r\\n        <div class="separator short" style="margin-right: 12px;" />\\r\\n        <label id="status-math-average" class="status-label">AVERAGE: 10</label>\\r\\n        <label id="status-math-count" class="status-label">COUNT: 3</label>\\r\\n        <label id="status-math-sum" class="status-label">SUM: 5</label>\\r\\n    </div>\\r\\n    <div id="status-sheets-bar-box">\\r\\n        <div id="status-sheets-bar" class="status-group">\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Tab\',["common/main/lib/component/BaseView"], function (base) {\r\n
    var Tab = function (opts) {\r\n
        this.active = false;\r\n
        this.label = "Tab";\r\n
        this.cls = "";\r\n
        this.template = _.template([\'<li class="<% if(active){ %>active<% } %> <% if(cls.length){%><%= cls %><%}%>" data-label="<%= label %>">\', "<a><%- label %></a>", "</li>"].join(""));\r\n
        this.initialize.call(this, opts);\r\n
        return this;\r\n
    };\r\n
    _.extend(Tab.prototype, {\r\n
        initialize: function (options) {\r\n
            _.extend(this, options);\r\n
        },\r\n
        render: function () {\r\n
            var el = this.template(this);\r\n
            this.$el = $(el);\r\n
            this.rendered = true;\r\n
            this.disable(this.disabled);\r\n
            return this;\r\n
        },\r\n
        isActive: function () {\r\n
            return this.$el.hasClass("active");\r\n
        },\r\n
        activate: function () {\r\n
            if (!this.$el.hasClass("active")) {\r\n
                this.$el.addClass("active");\r\n
            }\r\n
        },\r\n
        deactivate: function () {\r\n
            this.$el.removeClass("active");\r\n
        },\r\n
        on: function () {\r\n
            this.$el.on.apply(this, arguments);\r\n
        },\r\n
        disable: function (val) {\r\n
            this.disabled = val;\r\n
            if (this.rendered) {\r\n
                if (val && !this.$el.hasClass("disabled")) {\r\n
                    this.$el.addClass("disabled");\r\n
                } else {\r\n
                    this.$el.removeClass("disabled");\r\n
                }\r\n
            }\r\n
        },\r\n
        addClass: function (cls) {\r\n
            if (cls.length && !this.$el.hasClass(cls)) {\r\n
                this.$el.addClass(cls);\r\n
            }\r\n
        },\r\n
        removeClass: function (cls) {\r\n
            if (cls.length && this.$el.hasClass(cls)) {\r\n
                this.$el.removeClass(cls);\r\n
            }\r\n
        },\r\n
        hasClass: function (cls) {\r\n
            return this.$el.hasClass(cls);\r\n
        },\r\n
        setCaption: function (text) {\r\n
            this.$el.find("> a").text(text);\r\n
        }\r\n
    });\r\n
    Common.UI.Tab = Tab;\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/component/TabBar\',["common/main/lib/component/BaseView", "common/main/lib/component/Tab"], function () {\r\n
    var Events = {\r\n
        bind: function () {\r\n
            if (!this.o) {\r\n
                this.o = $({});\r\n
            }\r\n
            this.o.on.apply(this.o, arguments);\r\n
        },\r\n
        unbind: function () {\r\n
            if (this.o) {\r\n
                this.o.off.apply(this.o, arguments);\r\n
            }\r\n
        },\r\n
        trigger: function () {\r\n
            if (!this.o) {\r\n
                this.o = $({});\r\n
            }\r\n
            this.o.trigger.apply(this.o, arguments);\r\n
        }\r\n
    };\r\n
    var StateManager = function (options) {\r\n
        this.initialize.call(this, options);\r\n
    };\r\n
    _.extend(StateManager.prototype, Events);\r\n
    StateManager.prototype.initialize = function (options) {\r\n
        this.bar = options.bar;\r\n
    };\r\n
    StateManager.prototype.attach = function (tab) {\r\n
        tab.changeState = $.proxy(function () {\r\n
            this.trigger("tab:change", tab);\r\n
            this.bar.$el.find("ul > li.active").removeClass("active");\r\n
            tab.activate();\r\n
            this.bar.trigger("tab:changed", this.bar, this.bar.tabs.indexOf(tab), tab);\r\n
        },\r\n
        this);\r\n
        var dragHelper = new(function () {\r\n
            return {\r\n
                bounds: [],\r\n
                drag: undefined,\r\n
                calculateBounds: function () {\r\n
                    var me = this,\r\n
                    length = me.bar.tabs.length,\r\n
                    barBounds = me.bar.$bar.get(0).getBoundingClientRect();\r\n
                    if (barBounds) {\r\n
                        me.bounds = [];\r\n
                        me.scrollLeft = me.bar.$bar.scrollLeft();\r\n
                        me.bar.scrollX = this.scrollLeft;\r\n
                        for (var i = 0; i < length; ++i) {\r\n
                            this.bounds.push(me.bar.tabs[i].$el.get(0).getBoundingClientRect());\r\n
                        }\r\n
                        me.tabBarLeft = me.bounds[0].left;\r\n
                        me.tabBarRight = me.bounds[length - 1].right;\r\n
                        me.tabBarRight = Math.min(me.tabBarRight, barBounds.right - 1);\r\n
                    }\r\n
                },\r\n
                setAbsTabs: function () {\r\n
                    var me = this,\r\n
                    tab = null,\r\n
                    length = this.bounds.length;\r\n
                    for (var i = 0; i < length; ++i) {\r\n
                        tab = me.bar.tabs[i].$el;\r\n
                        tab.css("position", "absolute");\r\n
                        tab.css("left", (me.bounds[i].left - me.tabBarLeft - this.scrollLeft) + "px");\r\n
                        if (tab.hasClass("active")) {\r\n
                            tab.css("top", "1px");\r\n
                        } else {\r\n
                            tab.css("top", "0px");\r\n
                        }\r\n
                    }\r\n
                },\r\n
                updatePositions: function () {\r\n
                    this.drag.place = undefined;\r\n
                    var i, tabBound, center, place = -1,\r\n
                    next = -this.scrollLeft,\r\n
                    tabsCount = this.bounds.length,\r\n
                    dragBound = this.drag.tab.$el.get(0).getBoundingClientRect();\r\n
                    if (this.drag.moveX - this.drag.mouseX > 0) {\r\n
                        for (i = tabsCount - 1; i >= 0; --i) {\r\n
                            tabBound = this.bounds[i];\r\n
                            center = (tabBound.right + tabBound.left) * 0.5;\r\n
                            if (dragBound.left < center && center < dragBound.right) {\r\n
                                place = i;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (-1 === place) {\r\n
                            for (i = tabsCount - 1; i >= 0; --i) {\r\n
                                tabBound = dragBound;\r\n
                                center = (tabBound.right + tabBound.left) * 0.5;\r\n
                                if (this.bounds[i].left < center && center < this.bounds[i].right) {\r\n
                                    place = i;\r\n
                                    break;\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    } else {\r\n
                        for (i = 0; i < tabsCount; ++i) {\r\n
                            tabBound = this.bounds[i];\r\n
                            center = (tabBound.right + tabBound.left) * 0.5;\r\n
                            if (dragBound.left < center && center < dragBound.right) {\r\n
                                place = i;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (-1 === place) {\r\n
                            for (i = 0; i < tabsCount; ++i) {\r\n
                                tabBound = dragBound;\r\n
                                center = (tabBound.right + tabBound.left) * 0.5;\r\n
                                if (this.bounds[i].left < center && center < this.bounds[i].right) {\r\n
                                    place = i;\r\n
                                    break;\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    if (-1 !== place) {\r\n
                        this.drag.place = place;\r\n
                        for (i = 0; i < tabsCount; ++i) {\r\n
                            if (i === place) {\r\n
                                if (place < this.drag.index) {\r\n
                                    next += this.drag.tabWidth;\r\n
                                }\r\n
                            }\r\n
                            if (place > this.drag.index) {\r\n
                                if (i === place + 1) {\r\n
                                    next += this.drag.tabWidth;\r\n
                                }\r\n
                            }\r\n
                            if (i !== this.drag.index) {\r\n
                                this.bar.tabs[i].$el.css("left", next + "px");\r\n
                            } else {\r\n
                                if (this.drag.index === place) {\r\n
                                    next += this.drag.tabWidth;\r\n
                                }\r\n
                                continue;\r\n
                            }\r\n
                            next += this.bounds[i].width;\r\n
                        }\r\n
                    }\r\n
                },\r\n
                setHook: function (e, bar, tab) {\r\n
                    var me = this;\r\n
                    function dragComplete() {\r\n
                        if (!_.isUndefined(me.drag)) {\r\n
                            me.drag.tab.$el.css("z-index", "");\r\n
                            var tab = null;\r\n
                            for (var i = me.bar.tabs.length - 1; i >= 0; --i) {\r\n
                                tab = me.bar.tabs[i].$el;\r\n
                                if (tab) {\r\n
                                    tab.css("top", "");\r\n
                                    tab.css("position", "");\r\n
                                    tab.css("left", "");\r\n
                                }\r\n
                            }\r\n
                            if (!_.isUndefined(me.drag.place)) {\r\n
                                me.bar.trigger("tab:move", me.drag.index, me.drag.place);\r\n
                                me.bar.$bar.scrollLeft(me.scrollLeft);\r\n
                                me.bar.scrollX = undefined;\r\n
                            } else {\r\n
                                me.bar.trigger("tab:move", me.drag.index);\r\n
                                me.bar.$bar.scrollLeft(me.scrollLeft);\r\n
                                me.bar.scrollX = undefined;\r\n
                            }\r\n
                            me.drag = undefined;\r\n
                        }\r\n
                    }\r\n
                    function dragMove(e) {\r\n
                        if (!_.isUndefined(me.drag)) {\r\n
                            me.drag.moveX = e.clientX;\r\n
                            var leftPos = Math.max(e.clientX - me.drag.anchorX - me.tabBarLeft - me.scrollLeft, 0);\r\n
                            leftPos = Math.min(leftPos, me.tabBarRight - me.tabBarLeft - me.drag.tabWidth - me.scrollLeft);\r\n
                            me.drag.tab.$el.css("left", leftPos + "px");\r\n
                            me.drag.tab.$el.css("z-index", "100");\r\n
                            me.updatePositions();\r\n
                        }\r\n
                    }\r\n
                    function dragDropText(e) {\r\n
                        e.preventDefault();\r\n
                    }\r\n
                    if (!_.isUndefined(bar) && !_.isUndefined(tab) && bar.tabs.length > 1) {\r\n
                        var index = bar.tabs.indexOf(tab);\r\n
                        me.bar = bar;\r\n
                        me.drag = {\r\n
                            tab: tab,\r\n
                            index: index\r\n
                        };\r\n
                        this.calculateBounds();\r\n
                        this.setAbsTabs();\r\n
                        me.drag.moveX = e.clientX;\r\n
                        me.drag.mouseX = e.clientX;\r\n
                        me.drag.anchorX = e.clientX - this.bounds[index].left;\r\n
                        me.drag.tabWidth = this.bounds[index].width;\r\n
                        document.addEventListener("dragstart", dragDropText);\r\n
                        $(document).on("mousemove", dragMove);\r\n
                        $(document).on("mouseup", function (e) {\r\n
                            dragComplete(e);\r\n
                            $(document).off("mouseup", dragComplete);\r\n
                            $(document).off("mousemove", dragMove);\r\n
                            document.removeEventListener("dragstart", dragDropText);\r\n
                        });\r\n
                    }\r\n
                }\r\n
            };\r\n
        });\r\n
        tab.$el.on({\r\n
            click: $.proxy(function () {\r\n
                if (!tab.disabled && !tab.$el.hasClass("active")) {\r\n
                    if (tab.control == "manual") {\r\n
                        this.bar.trigger("tab:manual", this.bar, this.bar.tabs.indexOf(tab), tab);\r\n
                    } else {\r\n
                        tab.changeState();\r\n
                    }\r\n
                }\r\n
            },\r\n
            this),\r\n
            dblclick: $.proxy(function () {\r\n
                this.trigger("tab:dblclick", this, this.tabs.indexOf(tab), tab);\r\n
            },\r\n
            this.bar),\r\n
            contextmenu: $.proxy(function () {\r\n
                this.trigger("tab:contextmenu", this, this.tabs.indexOf(tab), tab);\r\n
            },\r\n
            this.bar),\r\n
            mousedown: $.proxy(function (e) {\r\n
                if (this.bar.options.draggable && !_.isUndefined(dragHelper) && (3 !== e.which)) {\r\n
                    if (!tab.isLockTheDrag) {\r\n
                        dragHelper.setHook(e, this.bar, tab);\r\n
                    }\r\n
                }\r\n
            },\r\n
            this)\r\n
        });\r\n
    };\r\n
    StateManager.prototype.detach = function (tab) {\r\n
        tab.$el.off();\r\n
    };\r\n
    Common.UI.TabBar = Common.UI.BaseView.extend({\r\n
        config: {\r\n
            placement: "top",\r\n
            items: [],\r\n
            draggable: false\r\n
        },\r\n
        tabs: [],\r\n
        template: _.template(\'<ul class="nav nav-tabs <%= placement %>" />\'),\r\n
        initialize: function (options) {\r\n
            _.extend(this.config, options);\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            this.saved = [];\r\n
        },\r\n
        render: function () {\r\n
            this.$el.html(this.template(this.config));\r\n
            this.$bar = this.$el.find("ul");\r\n
            var addEvent = function (elem, type, fn) {\r\n
                elem.addEventListener ? elem.addEventListener(type, fn, false) : elem.attachEvent("on" + type, fn);\r\n
            };\r\n
            var eventname = (/Firefox/i.test(navigator.userAgent)) ? "DOMMouseScroll" : "mousewheel";\r\n
            addEvent(this.$bar[0], eventname, _.bind(this._onMouseWheel, this));\r\n
            this.manager = new StateManager({\r\n
                bar: this\r\n
            });\r\n
            this.insert(-1, this.config.items);\r\n
            this.insert(-1, this.saved);\r\n
            delete this.saved;\r\n
            this.rendered = true;\r\n
            return this;\r\n
        },\r\n
        _onMouseWheel: function (e) {\r\n
            var hidden = this.checkInvisible(true),\r\n
            forward = ((e.detail && -e.detail) || e.wheelDelta) > 0;\r\n
            if (forward) {\r\n
                if (hidden.last) {\r\n
                    this.setTabVisible("forward");\r\n
                }\r\n
            } else {\r\n
                if (hidden.first) {\r\n
                    this.setTabVisible("backward");\r\n
                }\r\n
            }\r\n
        },\r\n
        add: function (tabs) {\r\n
            return this.insert(-1, tabs) > 0;\r\n
        },\r\n
        insert: function (index, tabs) {\r\n
            var count = 0;\r\n
            if (tabs) {\r\n
                if (! (tabs instanceof Array)) {\r\n
                    tabs = [tabs];\r\n
                }\r\n
                if (tabs.length) {\r\n
                    count = tabs.length;\r\n
                    if (this.rendered) {\r\n
                        var me = this,\r\n
                        tab;\r\n
                        if (index < 0 || index > me.tabs.length) {\r\n
                            for (var i = 0; i < tabs.length; i++) {\r\n
                                tab = new Common.UI.Tab(tabs[i]);\r\n
                                me.$bar.append(tab.render().$el);\r\n
                                me.tabs.push(tab);\r\n
                                me.manager.attach(tab);\r\n
                            }\r\n
                        } else {\r\n
                            for (i = tabs.length; i-->0;) {\r\n
                                tab = new Common.UI.Tab(tabs[i]);\r\n
                                if (index === 0) {\r\n
                                    me.$bar.prepend(tab.render().$el);\r\n
                                    me.tabs.unshift(tab);\r\n
                                } else {\r\n
                                    me.$bar.find("li:nth-child(" + index + ")").before(tab.render().$el);\r\n
                                    me.tabs.splice(index, 0, tab);\r\n
                                }\r\n
                                me.manager.attach(tab);\r\n
                            }\r\n
                        }\r\n
                    } else {\r\n
                        this.saved.push(tabs);\r\n
                    }\r\n
                    this.checkInvisible();\r\n
                }\r\n
            }\r\n
            return count;\r\n
        },\r\n
        remove: function (index) {\r\n
            if (index >= 0 && index < this.tabs.length) {\r\n
                var tab = this.tabs.splice(index, 1)[0];\r\n
                this.manager.detach(tab);\r\n
                tab.$el.remove();\r\n
                this.checkInvisible();\r\n
            }\r\n
        },\r\n
        empty: function (suppress) {\r\n
            var me = this;\r\n
            this.tabs.forEach(function (tab) {\r\n
                me.manager.detach(tab);\r\n
            });\r\n
            this.$bar.empty();\r\n
            me.tabs = [];\r\n
            this.checkInvisible(suppress);\r\n
        },\r\n
        setActive: function (t) {\r\n
            if (t instanceof Common.UI.Tab) {\r\n
                tab = t;\r\n
            } else {\r\n
                if (typeof t == "number") {\r\n
                    if (t >= 0 && t < this.tabs.length) {\r\n
                        var tab = this.tabs[t];\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (tab && tab.control != "manual" && !tab.disabled && !tab.$el.hasClass("active")) {\r\n
                tab.changeState();\r\n
            }\r\n
            this.checkInvisible();\r\n
        },\r\n
        getActive: function (iselem) {\r\n
            return iselem ? this.$bar.find("> li.active") : this.$bar.find("> li.active").index();\r\n
        },\r\n
        getAt: function (index) {\r\n
            return (index >= 0 && index < this.tabs.length) ? this.tabs[index] : undefined;\r\n
        },\r\n
        getCount: function () {\r\n
            return this.tabs.length;\r\n
        },\r\n
        addClass: function (cls) {\r\n
            if (cls.length && !this.$bar.hasClass(cls)) {\r\n
                this.$bar.addClass(cls);\r\n
            }\r\n
        },\r\n
        removeClass: function (cls) {\r\n
            if (cls.length && this.$bar.hasClass(cls)) {\r\n
                this.$bar.removeClass(cls);\r\n
            }\r\n
        },\r\n
        hasClass: function (cls) {\r\n
            return this.$bar.hasClass(cls);\r\n
        },\r\n
        setTabVisible: function (index, suppress) {\r\n
            if (index <= 0 || index == "first") {\r\n
                this.$bar.scrollLeft(0);\r\n
                this.checkInvisible(suppress);\r\n
            } else {\r\n
                if (index >= (this.tabs.length - 1) || index == "last") {\r\n
                    var left = this.tabs[this.tabs.length - 1].$el.position().left;\r\n
                    this.$bar.scrollLeft(left);\r\n
                    this.checkInvisible(suppress);\r\n
                } else {\r\n
                    var rightbound = this.$bar.width();\r\n
                    if (index == "forward") {\r\n
                        var tab, right;\r\n
                        for (var i = 0; i < this.tabs.length; i++) {\r\n
                            tab = this.tabs[i].$el;\r\n
                            right = tab.position().left + parseInt(tab.css("width"));\r\n
                            if (right > rightbound) {\r\n
                                this.$bar.scrollLeft(this.$bar.scrollLeft() + (right - rightbound) + 20);\r\n
                                this.checkInvisible(suppress);\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                    } else {\r\n
                        if (index == "backward") {\r\n
                            for (i = this.tabs.length; i-->0;) {\r\n
                                tab = this.tabs[i].$el;\r\n
                                left = tab.position().left;\r\n
                                if (left < 0) {\r\n
                                    this.$bar.scrollLeft(this.$bar.scrollLeft() + left - 26);\r\n
                                    this.checkInvisible(suppress);\r\n
                                    break;\r\n
                                }\r\n
                            }\r\n
                        } else {\r\n
                            if (typeof index == "number") {\r\n
                                tab = this.tabs[index].$el;\r\n
                                left = tab.position().left;\r\n
                                right = left + parseInt(tab.css("width"));\r\n
                                if (left < 0) {\r\n
                                    this.$bar.scrollLeft(this.$bar.scrollLeft() + left - 26);\r\n
                                    this.checkInvisible(suppress);\r\n
                                } else {\r\n
                                    if (right > rightbound) {\r\n
                                        this.$bar.scrollLeft(this.$bar.scrollLeft() + (right - rightbound) + 20);\r\n
                                        this.checkInvisible(suppress);\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        checkInvisible: function (suppress) {\r\n
            var result = {\r\n
                first: !this.isTabVisible(0),\r\n
                last: !this.isTabVisible(this.tabs.length - 1)\r\n
            }; ! suppress && this.fireEvent("tab:invisible", this, result);\r\n
            return result;\r\n
        },\r\n
        hasInvisible: function () {\r\n
            var _left_bound_ = this.$bar.offset().left,\r\n
            _right_bound_ = _left_bound_ + this.$bar.width();\r\n
            for (var i = this.tabs.length; i-->0;) {\r\n
                if (!this.isTabVisible(i, _left_bound_, _right_bound_)) {\r\n
                    return true;\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        isTabVisible: function (index) {\r\n
            var leftbound = arguments[1] || this.$bar.offset().left,\r\n
            rightbound = arguments[2] || (leftbound + this.$bar.width()),\r\n
            left,\r\n
            right,\r\n
            tab,\r\n
            rect;\r\n
            if (index < this.tabs.length && index >= 0) {\r\n
                tab = this.tabs[index].$el;\r\n
                rect = tab.get(0).getBoundingClientRect();\r\n
                left = rect.left;\r\n
                right = rect.right;\r\n
                return ! (left < leftbound) && !(right > rightbound);\r\n
            }\r\n
            return false;\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/Statusbar\',["text!spreadsheeteditor/main/app/template/StatusBar.template", "tip", "common/main/lib/component/TabBar", "common/main/lib/component/Menu", "common/main/lib/component/Window", "common/main/lib/component/ThemeColorPalette"], function (template) {\r\n
    if (SSE.Views.Statusbar) {\r\n
        var RenameDialog = SSE.Views.Statusbar.RenameDialog;\r\n
        var CopyDialog = SSE.Views.Statusbar.CopyDialog;\r\n
    }\r\n
    SSE.Views.Statusbar = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#statusbar",\r\n
        template: _.template(template),\r\n
        events: function () {\r\n
            return {\r\n
                "click #status-btn-tabfirst": _.bind(this.onBtnTabScroll, this, "first"),\r\n
                "click #status-btn-tabback": _.bind(this.onBtnTabScroll, this, "backward"),\r\n
                "click #status-btn-tabnext": _.bind(this.onBtnTabScroll, this, "forward"),\r\n
                "click #status-btn-tablast": _.bind(this.onBtnTabScroll, this, "last")\r\n
            };\r\n
        },\r\n
        api: undefined,\r\n
        initialize: function () {},\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            var me = this;\r\n
            this.editMode = false;\r\n
            this.btnZoomDown = new Common.UI.Button({\r\n
                el: $("#status-btn-zoomdown", this.el),\r\n
                hint: this.tipZoomOut + " (Ctrl+-)",\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.btnZoomUp = new Common.UI.Button({\r\n
                el: $("#status-btn-zoomup", this.el),\r\n
                hint: this.tipZoomIn + " (Ctrl++)",\r\n
                hintAnchor: "top-right"\r\n
            });\r\n
            this.btnScrollFirst = new Common.UI.Button({\r\n
                el: $("#status-btn-tabfirst", this.el),\r\n
                hint: this.tipFirst,\r\n
                disabled: true,\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.btnScrollBack = new Common.UI.Button({\r\n
                el: $("#status-btn-tabback", this.el),\r\n
                hint: this.tipPrev,\r\n
                disabled: true,\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.btnScrollNext = new Common.UI.Button({\r\n
                el: $("#status-btn-tabnext", this.el),\r\n
                hint: this.tipNext,\r\n
                disabled: true,\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.btnScrollLast = new Common.UI.Button({\r\n
                el: $("#status-btn-tablast", this.el),\r\n
                hint: this.tipLast,\r\n
                disabled: true,\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.btnAddWorksheet = new Common.UI.Button({\r\n
                el: $("#status-btn-addtab", this.el),\r\n
                hint: this.tipAddTab,\r\n
                disabled: true,\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.cntZoom = new Common.UI.Button({\r\n
                el: $(".cnt-zoom", this.el),\r\n
                hint: this.tipZoomFactor,\r\n
                hintAnchor: "top"\r\n
            });\r\n
            this.cntZoom.cmpEl.on({\r\n
                "show.bs.dropdown": function () {\r\n
                    _.defer(function () {\r\n
                        me.api.asc_enableKeyEvents(false);\r\n
                        me.cntZoom.cmpEl.find("ul").focus();\r\n
                    },\r\n
                    100);\r\n
                },\r\n
                "hide.bs.dropdown": function () {\r\n
                    _.defer(function () {\r\n
                        me.api.asc_enableKeyEvents(true);\r\n
                    },\r\n
                    100);\r\n
                }\r\n
            });\r\n
            this.zoomMenu = new Common.UI.Menu({\r\n
                style: "margin-top:-5px;",\r\n
                menuAlign: "bl-tl",\r\n
                items: [{\r\n
                    caption: "50%",\r\n
                    value: 50\r\n
                },\r\n
                {\r\n
                    caption: "75%",\r\n
                    value: 75\r\n
                },\r\n
                {\r\n
                    caption: "100%",\r\n
                    value: 100\r\n
                },\r\n
                {\r\n
                    caption: "125%",\r\n
                    value: 125\r\n
                },\r\n
                {\r\n
                    caption: "150%",\r\n
                    value: 150\r\n
                },\r\n
                {\r\n
                    caption: "175%",\r\n
                    value: 175\r\n
                },\r\n
                {\r\n
                    caption: "200%",\r\n
                    value: 200\r\n
                }]\r\n
            });\r\n
            this.zoomMenu.render($(".cnt-zoom", this.el));\r\n
            this.zoomMenu.cmpEl.attr({\r\n
                tabindex: -1\r\n
            });\r\n
            this.labelZoom = $("#status-label-zoom", this.$el);\r\n
            this.panelUsers = $("#status-users-box", this.el);\r\n
            this.panelUsers.find("#status-users-block").on("click", _.bind(this.onUsersClick, this));\r\n
            this.tabBarBox = $("#status-sheets-bar-box", this.el);\r\n
            this.tabbar = new Common.UI.TabBar({\r\n
                el: "#status-sheets-bar",\r\n
                placement: "bottom",\r\n
                draggable: false\r\n
            }).render();\r\n
            this.tabbar.on({\r\n
                "tab:invisible": _.bind(this.onTabInvisible, this),\r\n
                "tab:changed": _.bind(this.onSheetChanged, this),\r\n
                "tab:contextmenu": _.bind(this.onTabMenu, this),\r\n
                "tab:dblclick": _.bind(function () {\r\n
                    if (me.editMode && (me.rangeSelectionMode !== c_oAscSelectionDialogType.Chart) && (me.rangeSelectionMode !== c_oAscSelectionDialogType.FormatTable)) {\r\n
                        me.fireEvent("sheet:changename");\r\n
                    }\r\n
                },\r\n
                this),\r\n
                "tab:move": _.bind(function (tabIndex, index) {\r\n
                    me.tabBarScroll = {\r\n
                        scrollLeft: me.tabbar.scrollX\r\n
                    };\r\n
                    if (_.isUndefined(index) || tabIndex === index) {\r\n
                        return;\r\n
                    }\r\n
                    if (tabIndex < index) {\r\n
                        ++index;\r\n
                    }\r\n
                    me.fireEvent("sheet:move", [false, true, tabIndex, index]);\r\n
                },\r\n
                this)\r\n
            });\r\n
            var menuHiddenItems = new Common.UI.Menu({\r\n
                menuAlign: "tl-tr"\r\n
            });\r\n
            menuHiddenItems.on("item:click", function (obj, item, e) {\r\n
                me.fireEvent("show:hidden", [me, item.value]);\r\n
            });\r\n
            var menuColorItems = new Common.UI.Menu({\r\n
                menuAlign: "tl-tr",\r\n
                cls: "color-tab",\r\n
                items: [{\r\n
                    template: _.template(\'<div id="id-tab-menu-color" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                },\r\n
                {\r\n
                    template: _.template(\'<a id="id-tab-menu-new-color" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                }]\r\n
            });\r\n
            function dummyCmp() {\r\n
                return {\r\n
                    isDummy: true,\r\n
                    on: function () {}\r\n
                };\r\n
            }\r\n
            me.mnuTabColor = dummyCmp();\r\n
            this.tabMenu = new Common.UI.Menu({\r\n
                menuAlign: "bl-tl",\r\n
                items: [{\r\n
                    caption: this.itemInsert,\r\n
                    value: "ins"\r\n
                },\r\n
                {\r\n
                    caption: this.itemDelete,\r\n
                    value: "del"\r\n
                },\r\n
                {\r\n
                    caption: this.itemRename,\r\n
                    value: "ren"\r\n
                },\r\n
                {\r\n
                    caption: this.itemCopy,\r\n
                    value: "copy"\r\n
                },\r\n
                {\r\n
                    caption: this.itemMove,\r\n
                    value: "move"\r\n
                },\r\n
                {\r\n
                    caption: this.itemHide,\r\n
                    value: "hide"\r\n
                },\r\n
                {\r\n
                    caption: this.itemHidden,\r\n
                    menu: menuHiddenItems\r\n
                },\r\n
                {\r\n
                    caption: this.itemTabColor,\r\n
                    menu: menuColorItems\r\n
                }]\r\n
            }).on("render:after", function (btn) {\r\n
                var colorVal = $(\'<div class="btn-color-value-line"></div>\');\r\n
                $("button:first-child", btn.cmpEl).append(colorVal);\r\n
                colorVal.css("background-color", btn.currentColor || "transparent");\r\n
                me.mnuTabColor = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#id-tab-menu-color"),\r\n
                    dynamiccolors: 10,\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "transparent", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
                me.mnuTabColor.on("select", function (picker, color) {\r\n
                    me.fireEvent("sheet:setcolor", [color]);\r\n
                });\r\n
            });\r\n
            this.tabbar.$el.append(\'<div class="menu-backdrop" data-toggle="dropdown" style="width:0; height:0;"/>\');\r\n
            this.tabMenu.render(this.tabbar.$el);\r\n
            this.tabMenu.on("show:after", _.bind(this.onTabMenuAfterShow, this));\r\n
            this.tabMenu.on("hide:after", _.bind(this.onTabMenuAfterHide, this));\r\n
            this.tabMenu.on("item:click", _.bind(this.onTabMenuClick, this));\r\n
            this.boxMath = $("#status-math-box", this.el);\r\n
            this.labelSum = $("#status-math-sum", this.boxMath);\r\n
            this.labelCount = $("#status-math-count", this.boxMath);\r\n
            this.labelAverage = $("#status-math-average", this.boxMath);\r\n
            this.boxMath.hide();\r\n
            this.boxZoom = $("#status-zoom-box", this.el);\r\n
            this.boxZoom.find(".separator").css("border-left-color", "transparent");\r\n
            return this;\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.asc_registerCallback("asc_onSheetsChanged", _.bind(this.update, this));\r\n
            return this;\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = _.extend({},\r\n
            this.mode, mode);\r\n
            this.btnAddWorksheet.setVisible(this.mode.isEdit);\r\n
            this.btnAddWorksheet.setDisabled(this.mode.isDisconnected);\r\n
        },\r\n
        setVisible: function (visible) {\r\n
            visible ? this.show() : this.hide();\r\n
        },\r\n
        update: function () {\r\n
            var me = this;\r\n
            this.fireEvent("updatesheetsinfo", this);\r\n
            this.tabbar.empty(true);\r\n
            this.tabMenu.items[6].menu.removeAll();\r\n
            this.tabMenu.items[6].hide();\r\n
            this.btnAddWorksheet.setDisabled(true);\r\n
            if (this.api) {\r\n
                var wc = this.api.asc_getWorksheetsCount(),\r\n
                i = -1;\r\n
                var hidentems = [],\r\n
                items = [],\r\n
                tab,\r\n
                locked;\r\n
                var sindex = this.api.asc_getActiveWorksheetIndex();\r\n
                while (++i < wc) {\r\n
                    locked = me.api.asc_isWorksheetLockedOrDeleted(i);\r\n
                    tab = {\r\n
                        sheetindex: i,\r\n
                        active: sindex == i,\r\n
                        label: me.api.asc_getWorksheetName(i),\r\n
                        cls: locked ? "coauth-locked" : "",\r\n
                        isLockTheDrag: locked\r\n
                    };\r\n
                    this.api.asc_isWorksheetHidden(i) ? hidentems.push(tab) : items.push(tab);\r\n
                }\r\n
                if (hidentems.length) {\r\n
                    hidentems.forEach(function (item) {\r\n
                        me.tabMenu.items[6].menu.addItem(new Common.UI.MenuItem({\r\n
                            style: "white-space: pre-wrap",\r\n
                            caption: Common.Utils.String.htmlEncode(item.label),\r\n
                            value: item.sheetindex\r\n
                        }));\r\n
                    });\r\n
                    this.tabMenu.items[6].show();\r\n
                }\r\n
                this.tabbar.add(items);\r\n
                if (!_.isUndefined(this.tabBarScroll)) {\r\n
                    this.tabbar.$bar.scrollLeft(this.tabBarScroll.scrollLeft);\r\n
                    this.tabBarScroll = undefined;\r\n
                } else {\r\n
                    this.tabbar.setTabVisible("last");\r\n
                }\r\n
                this.btnAddWorksheet.setDisabled(me.mode.isDisconnected || me.api.asc_isWorkbookLocked());\r\n
                $("#status-label-zoom").text(Common.Utils.String.format(this.zoomText, Math.floor((this.api.asc_getZoom() + 0.005) * 100)));\r\n
                me.fireEvent("sheet:updateColors", [true]);\r\n
            }\r\n
        },\r\n
        setMathInfo: function (info) {\r\n
            if (info.count > 1) {\r\n
                if (!this.boxMath.is(":visible")) {\r\n
                    this.boxMath.show();\r\n
                }\r\n
                this.labelCount.text(this.textCount + ": " + info.count);\r\n
                this.labelSum.text((info.sum && info.sum.length) ? (this.textSum + ": " + info.sum) : "");\r\n
                this.labelAverage.text((info.average && info.average.length) ? (this.textAverage + ": " + info.average) : "");\r\n
            } else {\r\n
                if (this.boxMath.is(":visible")) {\r\n
                    this.boxMath.hide();\r\n
                }\r\n
            }\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                me.onTabInvisible(undefined, me.tabbar.checkInvisible(true));\r\n
            },\r\n
            30);\r\n
        },\r\n
        onUsersClick: function () {\r\n
            this.fireEvent("click:users", this);\r\n
        },\r\n
        onSheetChanged: function (o, index, tab) {\r\n
            this.api.asc_showWorksheet(tab.sheetindex);\r\n
            if (this.hasTabInvisible && !this.tabbar.isTabVisible(index)) {\r\n
                this.tabbar.setTabVisible(index);\r\n
            }\r\n
            this.fireEvent("sheet:changed", [this, tab.sheetindex]);\r\n
            this.fireEvent("sheet:updateColors", [true]);\r\n
            Common.NotificationCenter.trigger("comments:updatefilter", {\r\n
                property: "uid",\r\n
                value: new RegExp("^(doc_|sheet" + this.api.asc_getActiveWorksheetId() + "_)")\r\n
            },\r\n
            false);\r\n
        },\r\n
        onTabMenu: function (o, index, tab) {\r\n
            if (this.mode.isEdit && (this.rangeSelectionMode !== c_oAscSelectionDialogType.Chart) && (this.rangeSelectionMode !== c_oAscSelectionDialogType.FormatTable)) {\r\n
                if (tab && tab.sheetindex >= 0) {\r\n
                    var rect = tab.$el.get(0).getBoundingClientRect(),\r\n
                    childPos = tab.$el.offset(),\r\n
                    parentPos = tab.$el.parent().offset();\r\n
                    if (!tab.isActive()) {\r\n
                        this.tabbar.setActive(tab);\r\n
                    }\r\n
                    var issheetlocked = this.api.asc_isWorksheetLockedOrDeleted(tab.sheetindex),\r\n
                    isdoclocked = this.api.asc_isWorkbookLocked();\r\n
                    this.tabMenu.items[0].setDisabled(isdoclocked);\r\n
                    this.tabMenu.items[1].setDisabled(issheetlocked);\r\n
                    this.tabMenu.items[2].setDisabled(issheetlocked);\r\n
                    this.tabMenu.items[3].setDisabled(issheetlocked);\r\n
                    this.tabMenu.items[4].setDisabled(issheetlocked);\r\n
                    this.tabMenu.items[5].setDisabled(issheetlocked);\r\n
                    this.tabMenu.items[6].setDisabled(isdoclocked);\r\n
                    this.tabMenu.items[7].setDisabled(issheetlocked);\r\n
                    this.api.asc_closeCellEditor();\r\n
                    this.api.asc_enableKeyEvents(false);\r\n
                    this.tabMenu.atposition = (function () {\r\n
                        return {\r\n
                            top: rect.top,\r\n
                            left: rect.left - parentPos.left - 2\r\n
                        };\r\n
                    })();\r\n
                    this.tabMenu.hide();\r\n
                    this.tabMenu.show();\r\n
                }\r\n
            }\r\n
        },\r\n
        onTabMenuAfterShow: function (obj) {\r\n
            if (obj.atposition) {\r\n
                obj.setOffset(obj.atposition.left);\r\n
            }\r\n
            this.enableKeyEvents = true;\r\n
        },\r\n
        onTabMenuAfterHide: function () {\r\n
            if (!_.isUndefined(this.enableKeyEvents)) {\r\n
                if (this.api) {\r\n
                    this.api.asc_enableKeyEvents(this.enableKeyEvents);\r\n
                }\r\n
                this.enableKeyEvents = undefined;\r\n
            }\r\n
        },\r\n
        onTabMenuClick: function (o, item) {\r\n
            if (item && this.api) {\r\n
                this.enableKeyEvents = (item.value === "ins" || item.value === "hide");\r\n
            }\r\n
        },\r\n
        onTabInvisible: function (obj, opts) {\r\n
            if (this.btnScrollFirst.isDisabled() !== (!opts.first)) {\r\n
                this.btnScrollFirst.setDisabled(!opts.first);\r\n
                this.btnScrollBack.setDisabled(!opts.first);\r\n
            }\r\n
            if (this.btnScrollNext.isDisabled() !== (!opts.last)) {\r\n
                this.btnScrollNext.setDisabled(!opts.last);\r\n
                this.btnScrollLast.setDisabled(!opts.last);\r\n
            }\r\n
            this.hasTabInvisible = opts.first || opts.last;\r\n
        },\r\n
        onBtnTabScroll: function (action, e) {\r\n
            this.tabbar.setTabVisible(action);\r\n
        },\r\n
        updateTabbarBorders: function () {\r\n
            var right = parseInt(this.boxZoom.css("width")),\r\n
            visible = false;\r\n
            if (this.boxMath.is(":visible")) {\r\n
                right += parseInt(this.boxMath.css("width"));\r\n
                visible = true;\r\n
            }\r\n
            if (this.panelUsers.is(":visible")) {\r\n
                right += parseInt(this.panelUsers.css("width"));\r\n
                visible = true;\r\n
            }\r\n
            this.boxZoom.find(".separator").css("border-left-color", visible ? "" : "transparent");\r\n
            this.tabBarBox.css("right", right + "px");\r\n
        },\r\n
        changeViewMode: function (edit) {\r\n
            if (edit) {\r\n
                this.tabBarBox.css("left", "152px");\r\n
            } else {\r\n
                this.tabBarBox.css("left", "");\r\n
            }\r\n
            this.tabbar.options.draggable = edit;\r\n
            this.editMode = edit;\r\n
        },\r\n
        tipZoomIn: "Zoom In",\r\n
        tipZoomOut: "Zoom Out",\r\n
        tipZoomFactor: "Magnification",\r\n
        tipFirst: "First Sheet",\r\n
        tipLast: "Last Sheet",\r\n
        tipPrev: "Previous Sheet",\r\n
        tipNext: "Next Sheet",\r\n
        tipAddTab: "Add Worksheet",\r\n
        itemInsert: "Insert",\r\n
        itemDelete: "Delete",\r\n
        itemRename: "Rename",\r\n
        itemCopy: "Copy",\r\n
        itemMove: "Move",\r\n
        itemHide: "Hide",\r\n
        itemHidden: "Hidden",\r\n
        itemTabColor: "Tab Color",\r\n
        textThemeColors: "Theme Colors",\r\n
        textStandartColors: "Standart Colors",\r\n
        textNoColor: "No Color",\r\n
        textNewColor: "Add New Custom Color",\r\n
        zoomText: "Zoom {0}%",\r\n
        textSum: "SUM",\r\n
        textCount: "COUNT",\r\n
        textAverage: "AVERAGE"\r\n
    },\r\n
    SSE.Views.Statusbar || {}));\r\n
    SSE.Views.Statusbar.RenameDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            header: false,\r\n
            width: 280,\r\n
            cls: "modal-dlg"\r\n
        },\r\n
        template: \'<div class="box">\' + \'<div class="input-row">\' + "<label><%= label %></label>" + "</div>" + \'<div class="input-row" id="txt-sheet-name" />\' + "</div>" + \'<div class="footer right">\' + \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;"><%= btns.ok %></button>\' + \'<button class="btn normal dlg-btn" result="cancel"><%= btns.cancel %></button>\' + "</div>",\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, options || {},\r\n
            {\r\n
                label: this.labelSheetName,\r\n
                btns: {\r\n
                    ok: this.okButtonText,\r\n
                    cancel: this.cancelButtonText\r\n
                }\r\n
            });\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var $window = this.getChild();\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            this.txtName = new Common.UI.InputField({\r\n
                el: $window.find("#txt-sheet-name"),\r\n
                style: "width:100%;",\r\n
                value: this.options.current,\r\n
                allowBlank: false,\r\n
                validation: _.bind(this.nameValidator, this)\r\n
            });\r\n
            if (this.txtName) {\r\n
                this.txtName.$el.find("input").attr("maxlength", 31);\r\n
                this.txtName.$el.on("keypress", "input[type=text]", _.bind(this.onNameKeyPress, this));\r\n
            }\r\n
        },\r\n
        show: function (x, y) {\r\n
            Common.UI.Window.prototype.show.apply(this, arguments);\r\n
            var edit = this.txtName.$el.find("input");\r\n
            _.delay(function (me) {\r\n
                edit.focus();\r\n
                edit.select();\r\n
            },\r\n
            100, this);\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            this.doClose(event.currentTarget.attributes["result"].value);\r\n
        },\r\n
        doClose: function (res) {\r\n
            if (res == "ok") {\r\n
                if (this.txtName.checkValidate() !== true) {\r\n
                    _.delay(function (me) {\r\n
                        me.txtName.focus();\r\n
                    },\r\n
                    100, this);\r\n
                    return;\r\n
                }\r\n
            }\r\n
            if (this.options.handler) {\r\n
                this.options.handler.call(this, res, this.txtName.getValue());\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onNameKeyPress: function (e) {\r\n
            if (e.keyCode == Common.UI.Keys.RETURN) {\r\n
                this.doClose("ok");\r\n
            }\r\n
        },\r\n
        nameValidator: function (value) {\r\n
            if (this.options.names) {\r\n
                var testval = value.toLowerCase();\r\n
                for (var i = this.options.names.length - 1; i >= 0; --i) {\r\n
                    if (this.options.names[i] === testval) {\r\n
                        return this.errNameExists;\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (value.length > 2 && value[0] == \'"\' && value[value.length - 1] == \'"\') {\r\n
                return true;\r\n
            }\r\n
            if (!/[:\\\\\\/\\*\\?\\[\\]\\\']/.test(value)) {\r\n
                return true;\r\n
            }\r\n
            return this.errNameWrongChar;\r\n
        },\r\n
        errNameExists: "Worksheet with such name already exist.",\r\n
        errNameWrongChar: "A sheet name cannot contains characters: \\\\, /, *, ?, [, ], :",\r\n
        labelSheetName: "Sheet Name"\r\n
    },\r\n
    RenameDialog || {}));\r\n
    SSE.Views.Statusbar.CopyDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 270,\r\n
            height: 300,\r\n
            cls: "modal-dlg"\r\n
        },\r\n
        template: \'<div class="box">\' + \'<div class="input-row">\' + "<label><%= label %></label>" + "</div>" + \'<div id="status-list-names" style="height: 170px;"/>\' + "</div>" + \'<div class="footer center">\' + \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;"><%= btns.ok %></button>\' + \'<button class="btn normal dlg-btn" result="cancel"><%= btns.cancel %></button>\' + "</div>",\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, options || {},\r\n
            {\r\n
                label: options.ismove ? this.textMoveBefore : this.textCopyBefore,\r\n
                btns: {\r\n
                    ok: this.okButtonText,\r\n
                    cancel: this.cancelButtonText\r\n
                }\r\n
            });\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var $window = this.getChild();\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            var pages = [];\r\n
            this.options.names.forEach(function (item) {\r\n
                pages.push(new Common.UI.DataViewModel(item));\r\n
            },\r\n
            this);\r\n
            if (pages.length) {\r\n
                pages.push(new Common.UI.DataViewModel({\r\n
                    value: this.options.ismove ? this.itemMoveToEnd : this.itemCopyToEnd,\r\n
                    inindex: -255\r\n
                }));\r\n
            }\r\n
            this.listNames = new Common.UI.ListView({\r\n
                el: $("#status-list-names", $window),\r\n
                store: new Common.UI.DataViewStore(pages),\r\n
                itemTemplate: _.template(\'<div id="<%= id %>" class="list-item" style="pointer-events:none;"><%= Common.Utils.String.htmlEncode(value) %></div>\')\r\n
            });\r\n
            this.listNames.selectByIndex(0);\r\n
            this.listNames.on("entervalue", _.bind(this.onPrimary, this));\r\n
            this.listNames.on("item:dblclick", _.bind(this.onPrimary, this));\r\n
            this.mask = $(".modals-mask");\r\n
            this.mask.on("mousedown", _.bind(this.onUpdateFocus, this));\r\n
        },\r\n
        show: function (x, y) {\r\n
            Common.UI.Window.prototype.show.apply(this, arguments);\r\n
            _.delay(function (me) {\r\n
                me.listNames.$el.find(".listview").focus();\r\n
            },\r\n
            100, this);\r\n
        },\r\n
        hide: function () {\r\n
            Common.UI.Window.prototype.hide.apply(this, arguments);\r\n
            this.mask.off("mousedown", _.bind(this.onUpdateFocus, this));\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            var active = this.listNames.getSelectedRec();\r\n
            if (this.options.handler) {\r\n
                this.options.handler.call(this, event.currentTarget.attributes["result"].value, active[0].get("inindex"));\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onPrimary: function () {\r\n
            if (this.options.handler) {\r\n
                this.options.handler.call(this, "ok", this.listNames.getSelectedRec()[0].get("inindex"));\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        onUpdateFocus: function () {\r\n
            _.delay(function (me) {\r\n
                me.listNames.$el.find(".listview").focus();\r\n
            },\r\n
            100, this);\r\n
        },\r\n
        itemCopyToEnd: "(Copy to end)",\r\n
        itemMoveToEnd: "(Move to end)",\r\n
        textCopyBefore: "Copy before sheet",\r\n
        textMoveBefore: "Move before sheet"\r\n
    },\r\n
    CopyDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/Statusbar\',["core", "spreadsheeteditor/main/app/view/Statusbar"], function () {\r\n
    SSE.Controllers.Statusbar = Backbone.Controller.extend(_.extend({\r\n
        models: [],\r\n
        collections: [],\r\n
        views: ["Statusbar"],\r\n
        initialize: function () {\r\n
            this.addListeners({\r\n
                "Statusbar": {\r\n
                    "show:hidden": _.bind(function (obj, index) {\r\n
                        this.hideWorksheet(false, index);\r\n
                    },\r\n
                    this),\r\n
                    "sheet:changename": _.bind(function () {\r\n
                        th

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABU=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="21" aka="AAAAAAAAABU=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

is.api.asc_closeCellEditor();\r\n
                        this.renameWorksheet();\r\n
                    },\r\n
                    this),\r\n
                    "sheet:setcolor": _.bind(this.setWorksheetColor, this),\r\n
                    "sheet:updateColors": _.bind(this.updateTabsColors, this),\r\n
                    "sheet:move": _.bind(this.moveWorksheet, this)\r\n
                }\r\n
            });\r\n
            var me = this;\r\n
            Common.util.Shortcuts.delegateShortcuts({\r\n
                shortcuts: {\r\n
                    "alt+pageup": function (e) {\r\n
                        me.moveCurrentTab(-1);\r\n
                        e.preventDefault();\r\n
                        e.stopPropagation();\r\n
                    },\r\n
                    "alt+pagedown": function (e) {\r\n
                        me.moveCurrentTab(1);\r\n
                        e.preventDefault();\r\n
                        e.stopPropagation();\r\n
                    }\r\n
                }\r\n
            });\r\n
        },\r\n
        events: function () {\r\n
            return {\r\n
                "click #status-btn-zoomdown": _.bind(this.zoomDocument, this, "down"),\r\n
                "click #status-btn-zoomup": _.bind(this.zoomDocument, this, "up"),\r\n
                "click .cnt-zoom": _.bind(this.onZoomShow, this)\r\n
            };\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.statusbar = this.createView("Statusbar").render();\r\n
            this.statusbar.$el.css("z-index", 10);\r\n
            this.statusbar.labelZoom.css("min-width", 70);\r\n
            this.statusbar.zoomMenu.on("item:click", _.bind(this.menuZoomClick, this));\r\n
            this.bindViewEvents(this.statusbar, this.events);\r\n
            $("#id-tab-menu-new-color").on("click", _.bind(this.onNewBorderColor, this));\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.asc_registerCallback("asc_onZoomChanged", _.bind(this.onZoomChange, this));\r\n
            this.api.asc_registerCallback("asc_onSelectionMathChanged", _.bind(this.onApiMathChanged, this));\r\n
            this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onApiDisconnect, this));\r\n
            Common.NotificationCenter.on("api:disconnect", _.bind(this.onApiDisconnect, this));\r\n
            this.api.asc_registerCallback("asc_onUpdateTabColor", _.bind(this.onApiUpdateTabColor, this));\r\n
            this.api.asc_registerCallback("asc_onEditCell", _.bind(this.onApiEditCell, this));\r\n
            this.api.asc_registerCallback("asc_onWorkbookLocked", _.bind(this.onWorkbookLocked, this));\r\n
            this.api.asc_registerCallback("asc_onWorksheetLocked", _.bind(this.onWorksheetLocked, this));\r\n
            this.api.asc_registerCallback("asc_onAuthParticipantsChanged", _.bind(this.onApiUsersChanged, this));\r\n
            this.api.asc_registerCallback("asc_onParticipantsChanged", _.bind(this.onApiUsersChanged, this));\r\n
            this.api.asc_coAuthoringGetUsers();\r\n
            this.statusbar.setApi(api);\r\n
        },\r\n
        zoomDocument: function (d, e) {\r\n
            switch (d) {\r\n
            case "up":\r\n
                var f = this.api.asc_getZoom() + 0.1; ! (f > 2) && this.api.asc_setZoom(f);\r\n
                break;\r\n
            case "down":\r\n
                f = this.api.asc_getZoom() - 0.1; ! (f < 0.5) && this.api.asc_setZoom(f);\r\n
                break;\r\n
            }\r\n
        },\r\n
        menuZoomClick: function (menu, item) {\r\n
            this.api.asc_setZoom(item.value / 100);\r\n
        },\r\n
        onZoomChange: function (percent, type) {\r\n
            this.statusbar.labelZoom.text(Common.Utils.String.format(this.zoomText, Math.floor((percent + 0.005) * 100)));\r\n
        },\r\n
        onApiDisconnect: function () {\r\n
            this.statusbar.setMode({\r\n
                isDisconnected: true\r\n
            });\r\n
            this.statusbar.update();\r\n
        },\r\n
        onWorkbookLocked: function (locked) {\r\n
            this.statusbar.tabbar[locked ? "addClass" : "removeClass"]("coauth-locked");\r\n
            this.statusbar.btnAddWorksheet.setDisabled(locked || this.statusbar.rangeSelectionMode == c_oAscSelectionDialogType.Chart || this.statusbar.rangeSelectionMode == c_oAscSelectionDialogType.FormatTable);\r\n
            var item, i = this.statusbar.tabbar.getCount();\r\n
            while (i-->0) {\r\n
                item = this.statusbar.tabbar.getAt(i);\r\n
                if (item.sheetindex >= 0) {} else {\r\n
                    item.disable(locked);\r\n
                }\r\n
            }\r\n
        },\r\n
        onWorksheetLocked: function (index, locked) {\r\n
            var count = this.statusbar.tabbar.getCount(),\r\n
            tab;\r\n
            for (var i = count; i-->0;) {\r\n
                tab = this.statusbar.tabbar.getAt(i);\r\n
                if (index == tab.sheetindex) {\r\n
                    tab[locked ? "addClass" : "removeClass"]("coauth-locked");\r\n
                    tab.isLockTheDrag = locked || (this.statusbar.rangeSelectionMode == c_oAscSelectionDialogType.FormatTable);\r\n
                    break;\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiUsersChanged: function (users) {\r\n
            var editusers = [];\r\n
            _.each(users, function (item) {\r\n
                if (!item.asc_getView()) {\r\n
                    editusers.push(item);\r\n
                }\r\n
            });\r\n
            var length = _.size(editusers);\r\n
            var panel = this.statusbar.panelUsers;\r\n
            panel[length > 1 ? "show" : "hide"]();\r\n
            this.statusbar.updateTabbarBorders();\r\n
            var ttblock = panel.find("#status-users-block");\r\n
            if (ttblock.data("bs.tooltip")) {\r\n
                ttblock.removeData("bs.tooltip");\r\n
            }\r\n
            if (length > 1) {\r\n
                panel.find("#status-users-count").text(length);\r\n
                var tip = this.tipUsers + "<br/><br/>",\r\n
                i = 0;\r\n
                for (var n in editusers) {\r\n
                    tip += "\\n" + Common.Utils.String.htmlEncode(editusers[n].asc_getUserName());\r\n
                    if (++i > 3) {\r\n
                        break;\r\n
                    }\r\n
                }\r\n
                if (length > 4) {\r\n
                    tip += "<br/>" + this.tipMoreUsers.replace("%1", length - 4);\r\n
                    tip += "<br/><br/>" + this.tipShowUsers;\r\n
                }\r\n
                ttblock.tooltip({\r\n
                    title: tip,\r\n
                    html: true,\r\n
                    placement: "top"\r\n
                });\r\n
            }\r\n
        },\r\n
        onApiMathChanged: function (info) {\r\n
            this.statusbar.setMathInfo({\r\n
                count: info.asc_getCount(),\r\n
                average: info.asc_getAverage(),\r\n
                sum: info.asc_getSum()\r\n
            });\r\n
            this.statusbar.updateTabbarBorders();\r\n
        },\r\n
        onApiEditCell: function (state) {\r\n
            var disable = state != c_oAscCellEditorState.editEnd;\r\n
            this.statusbar.btnZoomUp.setDisabled(disable);\r\n
            this.statusbar.btnZoomDown.setDisabled(disable);\r\n
            this.statusbar.labelZoom[disable ? "addClass" : "removeClass"]("disabled");\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            this.statusbar.$el.css("z-index", "");\r\n
            this.statusbar.tabMenu.on("item:click", _.bind(this.onTabMenu, this));\r\n
            this.statusbar.btnAddWorksheet.on("click", _.bind(this.onAddWorksheetClick, this));\r\n
            Common.NotificationCenter.on("window:resize", _.bind(this.onWindowResize, this));\r\n
            Common.NotificationCenter.on("cells:range", _.bind(this.onRangeDialogMode, this));\r\n
        },\r\n
        onWindowResize: function (area) {\r\n
            this.statusbar.onTabInvisible(undefined, this.statusbar.tabbar.checkInvisible(true));\r\n
        },\r\n
        onRangeDialogMode: function (mode) {\r\n
            var islocked = this.statusbar.tabbar.hasClass("coauth-locked"),\r\n
            currentIdx = this.api.asc_getActiveWorksheetIndex();\r\n
            this.statusbar.btnAddWorksheet.setDisabled(islocked || mode != c_oAscSelectionDialogType.None);\r\n
            var item, i = this.statusbar.tabbar.getCount();\r\n
            while (i-->0) {\r\n
                item = this.statusbar.tabbar.getAt(i);\r\n
                if (item.sheetindex !== currentIdx) {\r\n
                    item.disable(mode == c_oAscSelectionDialogType.FormatTable);\r\n
                }\r\n
                item.isLockTheDrag = (item.hasClass("coauth-locked") || (mode != c_oAscSelectionDialogType.None));\r\n
            }\r\n
            this.statusbar.rangeSelectionMode = mode;\r\n
        },\r\n
        onTabMenu: function (obj, item, e) {\r\n
            switch (item.value) {\r\n
            case "ins":\r\n
                this.api.asc_insertWorksheet(this.createSheetName());\r\n
                break;\r\n
            case "del":\r\n
                this.deleteWorksheet();\r\n
                break;\r\n
            case "ren":\r\n
                this.renameWorksheet();\r\n
                break;\r\n
            case "copy":\r\n
                this.moveWorksheet(false);\r\n
                break;\r\n
            case "move":\r\n
                this.moveWorksheet(true);\r\n
                break;\r\n
            case "hide":\r\n
                this.hideWorksheet(true);\r\n
                break;\r\n
            }\r\n
        },\r\n
        createSheetName: function () {\r\n
            var items = [],\r\n
            wc = this.api.asc_getWorksheetsCount();\r\n
            while (wc--) {\r\n
                items.push(this.api.asc_getWorksheetName(wc).toLowerCase());\r\n
            }\r\n
            var index = 0,\r\n
            name;\r\n
            while (++index < 1000) {\r\n
                name = this.strSheet + index;\r\n
                if (items.indexOf(name.toLowerCase()) < 0) {\r\n
                    break;\r\n
                }\r\n
            }\r\n
            return name;\r\n
        },\r\n
        createCopyName: function (orig) {\r\n
            var wc = this.api.asc_getWorksheetsCount(),\r\n
            names = [];\r\n
            while (wc--) {\r\n
                names.push(this.api.asc_getWorksheetName(wc).toLowerCase());\r\n
            }\r\n
            var re = /^(.*)\\((\\d)\\)$/.exec(orig);\r\n
            var first = re ? re[1] : orig + " ";\r\n
            var index = 1,\r\n
            name;\r\n
            while (++index < 1000) {\r\n
                name = first + "(" + index + ")";\r\n
                if (names.indexOf(name.toLowerCase()) < 0) {\r\n
                    break;\r\n
                }\r\n
            }\r\n
            return name;\r\n
        },\r\n
        deleteWorksheet: function () {\r\n
            var me = this;\r\n
            if (this.statusbar.tabbar.tabs.length == 1) {\r\n
                Common.UI.warning({\r\n
                    msg: this.errorLastSheet\r\n
                });\r\n
            } else {\r\n
                Common.UI.warning({\r\n
                    msg: this.warnDeleteSheet,\r\n
                    buttons: ["ok", "cancel"],\r\n
                    callback: function (btn) {\r\n
                        if (btn == "ok" && !me.api.asc_deleteWorksheet()) {\r\n
                            _.delay(function () {\r\n
                                Common.UI.error({\r\n
                                    msg: me.errorRemoveSheet\r\n
                                });\r\n
                            },\r\n
                            10);\r\n
                        }\r\n
                    }\r\n
                });\r\n
            }\r\n
        },\r\n
        hideWorksheet: function (hide, index) {\r\n
            if (hide) {\r\n
                this.statusbar.tabbar.tabs.length == 1 ? Common.UI.warning({\r\n
                    msg: this.errorLastSheet\r\n
                }) : this.api["asc_hideWorksheet"](index);\r\n
            } else {\r\n
                this.api["asc_showWorksheet"](index);\r\n
                this.loadTabColor(index);\r\n
            }\r\n
        },\r\n
        renameWorksheet: function () {\r\n
            var me = this;\r\n
            var wc = me.api.asc_getWorksheetsCount(),\r\n
            items = [];\r\n
            if (wc > 0) {\r\n
                var sindex = me.api.asc_getActiveWorksheetIndex();\r\n
                if (me.api.asc_isWorksheetLockedOrDeleted(sindex)) {\r\n
                    return;\r\n
                }\r\n
                while (wc--) {\r\n
                    if (sindex !== wc) {\r\n
                        items.push(me.api.asc_getWorksheetName(wc).toLowerCase());\r\n
                    }\r\n
                }\r\n
                var tab = me.statusbar.tabbar.tabs[this.statusbar.tabbar.getActive()];\r\n
                var top = me.statusbar.$el.position().top - 115,\r\n
                left = tab.$el.offset().left;\r\n
                var current = me.api.asc_getWorksheetName(me.api.asc_getActiveWorksheetIndex());\r\n
                (new SSE.Views.Statusbar.RenameDialog({\r\n
                    current: current,\r\n
                    names: items,\r\n
                    handler: function (btn, s) {\r\n
                        if (btn == "ok" && s != current) {\r\n
                            me.api.asc_renameWorksheet(s);\r\n
                            tab.setCaption(s);\r\n
                            me.statusbar.fireEvent("updatesheetsinfo", me.statusbar);\r\n
                        }\r\n
                        me.api.asc_enableKeyEvents(true);\r\n
                    }\r\n
                })).show(left, top);\r\n
            }\r\n
        },\r\n
        moveWorksheet: function (cut, silent, index, destPos) {\r\n
            var me = this;\r\n
            var wc = me.api.asc_getWorksheetsCount(),\r\n
            items = [],\r\n
            i = -1;\r\n
            while (++i < wc) {\r\n
                if (!this.api.asc_isWorksheetHidden(i)) {\r\n
                    items.push({\r\n
                        value: me.api.asc_getWorksheetName(i),\r\n
                        inindex: i\r\n
                    });\r\n
                }\r\n
            }\r\n
            if (!_.isUndefined(silent)) {\r\n
                me.api.asc_showWorksheet(items[index].inindex);\r\n
                Common.NotificationCenter.trigger("comments:updatefilter", {\r\n
                    property: "uid",\r\n
                    value: new RegExp("^(doc_|sheet" + this.api.asc_getActiveWorksheetId() + "_)")\r\n
                });\r\n
                if (!_.isUndefined(destPos)) {\r\n
                    me.api.asc_moveWorksheet(items.length === destPos ? wc : items[destPos].inindex);\r\n
                }\r\n
                return;\r\n
            } (new SSE.Views.Statusbar.CopyDialog({\r\n
                title: cut ? me.statusbar.itemMove : me.statusbar.itemCopy,\r\n
                ismove: cut,\r\n
                names: items,\r\n
                handler: function (btn, i) {\r\n
                    if (btn == "ok") {\r\n
                        if (cut) {\r\n
                            me.api.asc_moveWorksheet(i == -255 ? wc : i);\r\n
                        } else {\r\n
                            var new_text = me.createCopyName(me.api.asc_getWorksheetName(me.api.asc_getActiveWorksheetIndex()));\r\n
                            me.api.asc_copyWorksheet(i == -255 ? wc : i, new_text);\r\n
                        }\r\n
                    }\r\n
                    me.api.asc_enableKeyEvents(true);\r\n
                }\r\n
            })).show();\r\n
        },\r\n
        onAddWorksheetClick: function (o, index, opts) {\r\n
            if (this.api) {\r\n
                this.api.asc_closeCellEditor();\r\n
                this.api.asc_addWorksheet(this.createSheetName());\r\n
                Common.NotificationCenter.trigger("comments:updatefilter", {\r\n
                    property: "uid",\r\n
                    value: new RegExp("^(doc_|sheet" + this.api.asc_getActiveWorksheetId() + "_)")\r\n
                },\r\n
                false);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this.statusbar);\r\n
        },\r\n
        selectTab: function (sheetindex) {\r\n
            if (this.api) {\r\n
                var hidden = this.api.asc_isWorksheetHidden(sheetindex);\r\n
                if (!hidden) {\r\n
                    var tab = _.findWhere(this.statusbar.tabbar.tabs, {\r\n
                        sheetindex: sheetindex\r\n
                    });\r\n
                    if (tab) {\r\n
                        this.statusbar.tabbar.setActive(tab);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        moveCurrentTab: function (direction) {\r\n
            if (this.api) {\r\n
                var indTab = 0,\r\n
                tabBar = this.statusbar.tabbar,\r\n
                index = this.api.asc_getActiveWorksheetIndex(),\r\n
                length = tabBar.tabs.length;\r\n
                this.statusbar.tabMenu.hide();\r\n
                this.api.asc_closeCellEditor();\r\n
                for (var i = 0; i < length; ++i) {\r\n
                    if (tabBar.tabs[i].sheetindex === index) {\r\n
                        indTab = i;\r\n
                        if (direction > 0) {\r\n
                            indTab++;\r\n
                            if (indTab >= length) {\r\n
                                indTab = 0;\r\n
                            }\r\n
                        } else {\r\n
                            indTab--;\r\n
                            if (indTab < 0) {\r\n
                                indTab = length - 1;\r\n
                            }\r\n
                        }\r\n
                        tabBar.setActive(indTab);\r\n
                        this.api.asc_showWorksheet(tabBar.getAt(indTab).sheetindex);\r\n
                        break;\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiUpdateTabColor: function (index) {\r\n
            this.loadTabColor(index);\r\n
        },\r\n
        setWorksheetColor: function (color) {\r\n
            if (this.api) {\r\n
                var sindex = this.api.asc_getActiveWorksheetIndex();\r\n
                var tab = _.findWhere(this.statusbar.tabbar.tabs, {\r\n
                    sheetindex: sindex\r\n
                });\r\n
                if (tab) {\r\n
                    if ("transparent" === color) {\r\n
                        this.api.asc_setWorksheetTabColor(sindex, null);\r\n
                        tab.$el.find("a").css("box-shadow", "");\r\n
                    } else {\r\n
                        var asc_clr = Common.Utils.ThemeColor.getRgbColor(color);\r\n
                        if (asc_clr) {\r\n
                            this.api.asc_setWorksheetTabColor(sindex, asc_clr);\r\n
                            this.setTabLineColor(tab, asc_clr);\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        updateThemeColors: function () {\r\n
            var updateColors = function (picker, defaultColorIndex) {\r\n
                if (picker) {\r\n
                    var clr, effectcolors = Common.Utils.ThemeColor.getEffectColors();\r\n
                    for (var i = 0; i < effectcolors.length; ++i) {\r\n
                        if (typeof(picker.currentColor) == "object" && clr === undefined && picker.currentColor.effectId == effectcolors[i].effectId) {\r\n
                            clr = effectcolors[i];\r\n
                        }\r\n
                    }\r\n
                    picker.updateColors(effectcolors, Common.Utils.ThemeColor.getStandartColors());\r\n
                    if (picker.currentColor === undefined) {\r\n
                        picker.currentColor = effectcolors[defaultColorIndex];\r\n
                    } else {\r\n
                        if (clr !== undefined) {\r\n
                            picker.currentColor = clr;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            };\r\n
            if (this.statusbar) {\r\n
                updateColors(this.statusbar.mnuTabColor, 1);\r\n
            }\r\n
        },\r\n
        onNewBorderColor: function () {\r\n
            if (this.statusbar && this.statusbar.mnuTabColor) {\r\n
                this.statusbar.mnuTabColor.addNewColor();\r\n
            }\r\n
        },\r\n
        updateTabsColors: function (updateCurrentColor) {\r\n
            var i = -1,\r\n
            tabind = -1,\r\n
            color = null,\r\n
            clr = null,\r\n
            ishidden = false,\r\n
            wc = this.api.asc_getWorksheetsCount(),\r\n
            sindex = this.api.asc_getActiveWorksheetIndex();\r\n
            if (!_.isUndefined(updateCurrentColor)) {\r\n
                var toolbarController = this.application.getController("Toolbar");\r\n
                if (toolbarController) {\r\n
                    this.statusbar.mnuTabColor.updateCustomColors();\r\n
                    color = this.api.asc_getWorksheetTabColor(sindex);\r\n
                    if (color) {\r\n
                        if (color.get_type() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                            clr = {\r\n
                                color: Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b()),\r\n
                                effectValue: color.get_value()\r\n
                            };\r\n
                        } else {\r\n
                            clr = Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b());\r\n
                        }\r\n
                    }\r\n
                    if (_.isObject(clr)) {\r\n
                        var isselected = false;\r\n
                        for (i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] === clr.effectValue) {\r\n
                                this.statusbar.mnuTabColor.select(clr, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            this.statusbar.mnuTabColor.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        this.statusbar.mnuTabColor.select(clr || "transparent", true);\r\n
                    }\r\n
                }\r\n
            }\r\n
            i = -1;\r\n
            while (++i < wc) {\r\n
                ++tabind;\r\n
                ishidden = this.api.asc_isWorksheetHidden(i);\r\n
                if (ishidden) {\r\n
                    --tabind;\r\n
                }\r\n
                if (!ishidden) {\r\n
                    this.setTabLineColor(this.statusbar.tabbar.getAt(tabind), this.api.asc_getWorksheetTabColor(i));\r\n
                }\r\n
            }\r\n
        },\r\n
        loadTabColor: function (sheetindex) {\r\n
            if (this.api) {\r\n
                if (!this.api.asc_isWorksheetHidden(sheetindex)) {\r\n
                    var tab = _.findWhere(this.statusbar.tabbar.tabs, {\r\n
                        sheetindex: sheetindex\r\n
                    });\r\n
                    if (tab) {\r\n
                        this.setTabLineColor(tab, this.api.asc_getWorksheetTabColor(sheetindex));\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        setTabLineColor: function (tab, color) {\r\n
            if (tab) {\r\n
                if (null !== color) {\r\n
                    color = "#" + Common.Utils.ThemeColor.getHexColor(color.get_r(), color.get_g(), color.get_b());\r\n
                } else {\r\n
                    color = "";\r\n
                }\r\n
                if (color.length) {\r\n
                    if (!tab.isActive()) {\r\n
                        color = "0px 3px 0 " + Common.Utils.RGBColor(color).toRGBA(0.7) + " inset";\r\n
                    } else {\r\n
                        color = "0px 3px 0 " + color + " inset";\r\n
                    }\r\n
                    tab.$el.find("a").css("box-shadow", color);\r\n
                } else {\r\n
                    tab.$el.find("a").css("box-shadow", "");\r\n
                }\r\n
            }\r\n
        },\r\n
        onZoomShow: function (e) {\r\n
            if (e.target.classList.contains("disabled")) {\r\n
                return false;\r\n
            }\r\n
        },\r\n
        tipUsers: "Document is in the collaborative editing mode.",\r\n
        tipMoreUsers: "and %1 users.",\r\n
        tipShowUsers: "To see all users click the icon below.",\r\n
        zoomText: "Zoom {0}%",\r\n
        errorLastSheet: "Workbook must have at least one visible worksheet.",\r\n
        errorRemoveSheet: "Can\'t delete the worksheet.",\r\n
        warnDeleteSheet: "The worksheet maybe has data. Proceed operation?",\r\n
        strSheet : "Sheet"\r\n
    },\r\n
    SSE.Controllers.Statusbar || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/RightMenu.template\',[],function () { return \'<div id="view-right-menu" class="tool-menu right">\\n    <div class="right-panel">\\n        <div id="id-shape-settings" class="settings-panel">\\n        </div>\\n        <div id="id-image-settings" class="settings-panel">\\n        </div>\\n        <!-- /** proprietary begin **/ -->\\n        <div id="id-chart-settings" class="settings-panel">\\n        </div>\\n        <!-- /** proprietary end **/ -->\\n        <div id="id-paragraph-settings" class="settings-panel">\\n        </div>\\n    </div>\\n    <div class="tool-menu-btns">\\n        <div class="ct-btn-category arrow-left" />\\n        <button id="id-right-menu-shape" class="btn btn-category arrow-left" content-target="id-shape-settings"><span class="btn-icon btn-menu-shape">&nbsp;</span></button>\\n        <button id="id-right-menu-image" class="btn btn-category arrow-left" content-target="id-image-settings"><span class="btn-icon btn-menu-image">&nbsp;</span></button>\\n        <!-- /** proprietary begin **/ -->\\n        <button id="id-right-menu-chart" class="btn btn-category arrow-left" content-target="id-chart-settings"><span class="btn-icon btn-menu-chart">&nbsp;</span></button>\\n        <!-- /** proprietary end **/ -->\\n        <button id="id-right-menu-text" class="btn btn-category arrow-left" content-target="id-paragraph-settings"><span class="btn-icon btn-menu-text">&nbsp;</span></button>\\n    </div>\\n</div>\';});\n
\n
\n
define(\'text!spreadsheeteditor/main/app/template/ParagraphSettings.template\',[],function () { return \'<table cols="2">\\r\\n    <tr>\\r\\n        <td colspan=2>\\r\\n            <label class="header"><%= scope.strParagraphSpacing %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" width="50%">\\r\\n            <label class="input-label"><%= scope.textAt %></label>\\r\\n            <div id="paragraph-combo-line-rule" style="width: 85px;"></div>\\r\\n        </td>\\r\\n        <td class="padding-small" width="50%">\\r\\n            <label class="input-label"><%= scope.textAt %></label>\\r\\n            <div id="paragraph-spin-line-height"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" width="50%">\\r\\n            <label class="input-label"><%= scope.strSpacingBefore %></label>\\r\\n            <div id="paragraph-spin-spacing-before"></div>\\r\\n        </td>\\r\\n        <td class="padding-small" width="50%">\\r\\n            <label class="input-label"><%= scope.strSpacingAfter %></label>\\r\\n            <div id="paragraph-spin-spacing-after"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" colspan=2>\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td align="center" colspan=2>\\r\\n            <label class="link" id="paragraph-advanced-link"><%= scope.textAdvanced %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="finish-cell"></tr>\\r\\n</table>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 var c_paragraphLinerule = {\r\n
    LINERULE_LEAST: 0,\r\n
    LINERULE_AUTO: 1,\r\n
    LINERULE_EXACT: 2\r\n
};\r\n
define(\'spreadsheeteditor/main/app/view/ParagraphSettings\',["text!spreadsheeteditor/main/app/template/ParagraphSettings.template", "jquery", "underscore", "backbone", "common/main/lib/component/ComboBox", "common/main/lib/component/MetricSpinner", "spreadsheeteditor/main/app/view/ParagraphSettingsAdvanced"], function (menuTemplate, $, _, Backbone) {\r\n
    SSE.Views.ParagraphSettings = Backbone.View.extend(_.extend({\r\n
        el: "#id-paragraph-settings",\r\n
        template: _.template(menuTemplate),\r\n
        events: {},\r\n
        options: {\r\n
            alias: "ParagraphSettings"\r\n
        },\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            this._initSettings = true;\r\n
            this._state = {\r\n
                LineRuleIdx: 1,\r\n
                LineHeight: 1.5,\r\n
                LineSpacingBefore: 0,\r\n
                LineSpacingAfter: 0.35,\r\n
                DisabledControls: false\r\n
            };\r\n
            this.spinners = [];\r\n
            this.lockedControls = [];\r\n
            this._locked = false;\r\n
            this.render();\r\n
            this._arrLineRule = [{\r\n
                displayValue: this.textAtLeast,\r\n
                defaultValue: 5,\r\n
                value: c_paragraphLinerule.LINERULE_LEAST,\r\n
                minValue: 0.03,\r\n
                step: 0.01,\r\n
                defaultUnit: "cm"\r\n
            },\r\n
            {\r\n
                displayValue: this.textAuto,\r\n
                defaultValue: 1,\r\n
                value: c_paragraphLinerule.LINERULE_AUTO,\r\n
                minValue: 0.5,\r\n
                step: 0.01,\r\n
                defaultUnit: ""\r\n
            },\r\n
            {\r\n
                displayValue: this.textExact,\r\n
                defaultValue: 5,\r\n
                value: c_paragraphLinerule.LINERULE_EXACT,\r\n
                minValue: 0.03,\r\n
                step: 0.01,\r\n
                defaultUnit: "cm"\r\n
            }];\r\n
            this.cmbLineRule = new Common.UI.ComboBox({\r\n
                el: $("#paragraph-combo-line-rule"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 85px;",\r\n
                editable: false,\r\n
                data: this._arrLineRule\r\n
            });\r\n
            this.cmbLineRule.setValue(this._arrLineRule[this._state.LineRuleIdx].value);\r\n
            this.lockedControls.push(this.cmbLineRule);\r\n
            this.numLineHeight = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraph-spin-line-height"),\r\n
                step: 0.01,\r\n
                width: 85,\r\n
                value: "1.5",\r\n
                defaultUnit: "",\r\n
                maxValue: 132,\r\n
                minValue: 0.5\r\n
            });\r\n
            this.lockedControls.push(this.numLineHeight);\r\n
            this.numSpacingBefore = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraph-spin-spacing-before"),\r\n
                step: 0.1,\r\n
                width: 85,\r\n
                value: "0 cm",\r\n
                defaultUnit: "cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0,\r\n
                allowAuto: true,\r\n
                autoText: this.txtAutoText\r\n
            });\r\n
            this.spinners.push(this.numSpacingBefore);\r\n
            this.lockedControls.push(this.numSpacingBefore);\r\n
            this.numSpacingAfter = new Common.UI.MetricSpinner({\r\n
                el: $("#paragraph-spin-spacing-after"),\r\n
                step: 0.1,\r\n
                width: 85,\r\n
                value: "0.35 cm",\r\n
                defaultUnit: "cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0,\r\n
                allowAuto: true,\r\n
                autoText: this.txtAutoText\r\n
            });\r\n
            this.spinners.push(this.numSpacingAfter);\r\n
            this.lockedControls.push(this.numSpacingAfter);\r\n
            this.numLineHeight.on("change", _.bind(this.onNumLineHeightChange, this));\r\n
            this.numSpacingBefore.on("change", _.bind(this.onNumSpacingBeforeChange, this));\r\n
            this.numSpacingAfter.on("change", _.bind(this.onNumSpacingAfterChange, this));\r\n
            this.cmbLineRule.on("selected", _.bind(this.onLineRuleSelect, this));\r\n
            this.cmbLineRule.on("hide:after", _.bind(this.onHideMenus, this));\r\n
            $(this.el).on("click", "#paragraph-advanced-link", _.bind(this.openAdvancedSettings, this));\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            this.linkAdvanced = $("#paragraph-advanced-link");\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            if (this.api) {\r\n
                this.api.asc_registerCallback("asc_onParaSpacingLine", _.bind(this._onLineSpacing, this));\r\n
            }\r\n
            return this;\r\n
        },\r\n
        onNumLineHeightChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this.cmbLineRule.getRawValue() === "") {\r\n
                return;\r\n
            }\r\n
            var type = c_paragraphLinerule.LINERULE_AUTO;\r\n
            if (this.api) {\r\n
                this.api.asc_putPrLineSpacing(this.cmbLineRule.getValue(), (this.cmbLineRule.getValue() == c_paragraphLinerule.LINERULE_AUTO) ? field.getNumberValue() : Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onNumSpacingBeforeChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this.api) {\r\n
                var num = field.getNumberValue();\r\n
                if (num < 0) {\r\n
                    this.api.asc_putLineSpacingBeforeAfter(0, -1);\r\n
                } else {\r\n
                    this.api.asc_putLineSpacingBeforeAfter(0, Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onNumSpacingAfterChange: function (field, newValue, oldValue, eOpts) {\r\n
            if (this.api) {\r\n
                var num = field.getNumberValue();\r\n
                if (num < 0) {\r\n
                    this.api.asc_putLineSpacingBeforeAfter(1, -1);\r\n
                } else {\r\n
                    this.api.asc_putLineSpacingBeforeAfter(1, Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onLineRuleSelect: function (combo, record) {\r\n
            if (this.api) {\r\n
                this.api.asc_putPrLineSpacing(record.value, record.defaultValue);\r\n
            }\r\n
            this.numLineHeight.setDefaultUnit(this._arrLineRule[record.value].defaultUnit);\r\n
            this.numLineHeight.setMinValue(this._arrLineRule[record.value].minValue);\r\n
            this.numLineHeight.setStep(this._arrLineRule[record.value].step);\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        _onLineSpacing: function (value) {\r\n
            var linerule = value.asc_getLineRule();\r\n
            var line = value.asc_getLine();\r\n
            if (this._state.LineRuleIdx !== linerule) {\r\n
                this.cmbLineRule.setValue((linerule !== null) ? this._arrLineRule[linerule].value : "");\r\n
                this.numLineHeight.setMinValue(this._arrLineRule[(linerule !== null) ? linerule : 1].minValue);\r\n
                this.numLineHeight.setDefaultUnit(this._arrLineRule[(linerule !== null) ? linerule : 1].defaultUnit);\r\n
                this.numLineHeight.setStep(this._arrLineRule[(linerule !== null) ? linerule : 1].step);\r\n
                this._state.LineRuleIdx = linerule;\r\n
            }\r\n
            if (Math.abs(this._state.LineHeight - line) > 0.001 || (this._state.LineHeight === null || line === null) && (this._state.LineHeight !== line)) {\r\n
                var val = "";\r\n
                if (linerule == c_paragraphLinerule.LINERULE_AUTO) {\r\n
                    val = line;\r\n
                } else {\r\n
                    if (linerule !== null && line !== null) {\r\n
                        val = Common.Utils.Metric.fnRecalcFromMM(line);\r\n
                    }\r\n
                }\r\n
                this.numLineHeight.setValue((val !== null) ? val : "", true);\r\n
                this._state.LineHeight = line;\r\n
            }\r\n
        },\r\n
        ChangeSettings: function (prop) {\r\n
            if (this._initSettings) {\r\n
                this.createDelayedElements();\r\n
                this._initSettings = false;\r\n
            }\r\n
            this.disableControls(this._locked);\r\n
            if (prop) {\r\n
                var Spacing = {\r\n
                    Line: prop.asc_getSpacing().asc_getLine(),\r\n
                    Before: prop.asc_getSpacing().asc_getBefore(),\r\n
                    After: prop.asc_getSpacing().asc_getAfter(),\r\n
                    LineRule: prop.asc_getSpacing().asc_getLineRule()\r\n
                };\r\n
                if (this._state.LineRuleIdx !== Spacing.LineRule) {\r\n
                    this.cmbLineRule.setValue((Spacing.LineRule !== null) ? this._arrLineRule[Spacing.LineRule].value : "");\r\n
                    this.numLineHeight.setMinValue(this._arrLineRule[(Spacing.LineRule !== null) ? Spacing.LineRule : 1].minValue);\r\n
                    this.numLineHeight.setDefaultUnit(this._arrLineRule[(Spacing.LineRule !== null) ? Spacing.LineRule : 1].defaultUnit);\r\n
                    this.numLineHeight.setStep(this._arrLineRule[(Spacing.LineRule !== null) ? Spacing.LineRule : 1].step);\r\n
                    this._state.LineRuleIdx = Spacing.LineRule;\r\n
                }\r\n
                if (Math.abs(this._state.LineHeight - Spacing.Line) > 0.001 || (this._state.LineHeight === null || Spacing.Line === null) && (this._state.LineHeight !== Spacing.Line)) {\r\n
                    var val = "";\r\n
                    if (Spacing.LineRule == c_paragraphLinerule.LINERULE_AUTO) {\r\n
                        val = Spacing.Line;\r\n
                    } else {\r\n
                        if (Spacing.LineRule !== null && Spacing.Line !== null) {\r\n
                            val = Common.Utils.Metric.fnRecalcFromMM(Spacing.Line);\r\n
                        }\r\n
                    }\r\n
                    this.numLineHeight.setValue((val !== null) ? val : "", true);\r\n
                    this._state.LineHeight = Spacing.Line;\r\n
                }\r\n
                if (Math.abs(this._state.LineSpacingBefore - Spacing.Before) > 0.001 || (this._state.LineSpacingBefore === null || Spacing.Before === null) && (this._state.LineSpacingBefore !== Spacing.Before)) {\r\n
                    this.numSpacingBefore.setValue((Spacing.Before !== null) ? ((Spacing.Before < 0) ? Spacing.Before : Common.Utils.Metric.fnRecalcFromMM(Spacing.Before)) : "", true);\r\n
                    this._state.LineSpacingBefore = Spacing.Before;\r\n
                }\r\n
                if (Math.abs(this._state.LineSpacingAfter - Spacing.After) > 0.001 || (this._state.LineSpacingAfter === null || Spacing.After === null) && (this._state.LineSpacingAfter !== Spacing.After)) {\r\n
                    this.numSpacingAfter.setValue((Spacing.After !== null) ? ((Spacing.After < 0) ? Spacing.After : Common.Utils.Metric.fnRecalcFromMM(Spacing.After)) : "", true);\r\n
                    this._state.LineSpacingAfter = Spacing.After;\r\n
                }\r\n
            }\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.01 : 1);\r\n
                }\r\n
            }\r\n
            this._arrLineRule[2].defaultUnit = this._arrLineRule[0].defaultUnit = Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()];\r\n
            this._arrLineRule[2].minValue = this._arrLineRule[0].minValue = parseFloat(Common.Utils.Metric.fnRecalcFromMM(0.3).toFixed(2));\r\n
            this._arrLineRule[2].step = this._arrLineRule[0].step = (Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm) ? 0.01 : 1;\r\n
            if (this._state.LineRuleIdx !== null) {\r\n
                this.numLineHeight.setDefaultUnit(this._arrLineRule[this._state.LineRuleIdx].defaultUnit);\r\n
                this.numLineHeight.setStep(this._arrLineRule[this._state.LineRuleIdx].step);\r\n
            }\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            this.updateMetricUnit();\r\n
        },\r\n
        openAdvancedSettings: function (e) {\r\n
            if (this.linkAdvanced.hasClass("disabled")) {\r\n
                return;\r\n
            }\r\n
            var me = this;\r\n
            var win;\r\n
            if (me.api && !this._locked) {\r\n
                var selectedElements = me.api.asc_getGraphicObjectProps();\r\n
                if (selectedElements && selectedElements.length > 0) {\r\n
                    var elType, elValue;\r\n
                    for (var i = selectedElements.length - 1; i >= 0; i--) {\r\n
                        elType = selectedElements[i].asc_getObjectType();\r\n
                        elValue = selectedElements[i].asc_getObjectValue();\r\n
                        if (c_oAscTypeSelectElement.Paragraph == elType) {\r\n
                            (new SSE.Views.ParagraphSettingsAdvanced({\r\n
                                paragraphProps: elValue,\r\n
                                api: me.api,\r\n
                                handler: function (result, value) {\r\n
                                    if (result == "ok") {\r\n
                                        if (me.api) {\r\n
                                            me.borderAdvancedProps = value.borderProps;\r\n
                                            me.api.asc_setGraphicObjectProps(value.paragraphProps);\r\n
                                        }\r\n
                                    }\r\n
                                    Common.NotificationCenter.trigger("edit:complete", me);\r\n
                                }\r\n
                            })).show();\r\n
                            break;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onHideMenus: function (e) {\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        setLocked: function (locked) {\r\n
            this._locked = locked;\r\n
        },\r\n
        disableControls: function (disable) {\r\n
            if (this._state.DisabledControls !== disable) {\r\n
                this._state.DisabledControls = disable;\r\n
                _.each(this.lockedControls, function (item) {\r\n
                    item.setDisabled(disable);\r\n
                });\r\n
                this.linkAdvanced.toggleClass("disabled", disable);\r\n
            }\r\n
        },\r\n
        strParagraphSpacing: "Spacing",\r\n
        strLineHeight: "Line Spacing",\r\n
        strSpacingBefore: "Before",\r\n
        strSpacingAfter: "After",\r\n
        textAuto: "Multiple",\r\n
        textAtLeast: "At least",\r\n
        textExact: "Exactly",\r\n
        textAdvanced: "Show advanced settings",\r\n
        textAt: "At",\r\n
        txtAutoText: "Auto"\r\n
    },\r\n
    SSE.Views.ParagraphSettings || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/ImageSettings.template\',[],function () { return \'<table cols="3">\\r\\n    <tr>\\r\\n        <td colspan=3>\\r\\n            <label class="header"><%= scope.textSize %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" width="88px">\\r\\n            <label class="input-label"><%= scope.textWidth %></label>\\r\\n            <div id="image-spin-width"></div>\\r\\n        </td>\\r\\n        <td class="padding-small" width="28px" style="vertical-align: bottom;">\\r\\n            <div id="image-button-ratio"></div>\\r\\n        </td>\\r\\n        <td class="padding-small" width="88px">\\r\\n            <label class="input-label"><%= scope.textHeight %></label>\\r\\n            <div id="image-spin-height"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n</table>\\r\\n<table cols="2">\\r\\n    <tr>\\r\\n        <td class="padding-small" colspan=2>\\r\\n            <button type="button" class="btn btn-text-default" id="image-button-original-size" style="width:100px;"><%= scope.textOriginalSize %></button>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" colspan=2>\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td colspan=2>\\r\\n            <label class="header"><%= scope.textInsert %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td width="50%">\\r\\n            <button type="button" class="btn btn-text-default" id="image-button-from-file" style="width:85px;"><%= scope.textFromFile %></button>\\r\\n        </td>\\r\\n        <td width="50%">\\r\\n            <button type="button" class="btn btn-text-default" id="image-button-from-url" style="width:85px;"><%= scope.textFromUrl %></button>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="finish-cell"></tr>\\r\\n</table>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/ImageSettings\',["text!spreadsheeteditor/main/app/template/ImageSettings.template", "jquery", "underscore", "backbone", "common/main/lib/component/Button", "common/main/lib/component/MetricSpinner", "common/main/lib/view/ImageFromUrlDialog"], function (menuTemplate, $, _, Backbone) {\r\n
    SSE.Views.ImageSettings = Backbone.View.extend(_.extend({\r\n
        el: "#id-image-settings",\r\n
        template: _.template(menuTemplate),\r\n
        events: {},\r\n
        options: {\r\n
            alias: "ImageSettings"\r\n
        },\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            this._initSettings = true;\r\n
            this._nRatio = 1;\r\n
            this._state = {\r\n
                Width: 0,\r\n
                Height: 0,\r\n
                DisabledControls: false\r\n
            };\r\n
            this.spinners = [];\r\n
            this.lockedControls = [];\r\n
            this._locked = false;\r\n
            this._noApply = false;\r\n
            this.render();\r\n
            this.spnWidth = new Common.UI.MetricSpinner({\r\n
                el: $("#image-spin-width"),\r\n
                step: 0.1,\r\n
                width: 78,\r\n
                defaultUnit: "cm",\r\n
                value: "3 cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnWidth);\r\n
            this.lockedControls.push(this.spnWidth);\r\n
            this.spnHeight = new Common.UI.MetricSpinner({\r\n
                el: $("#image-spin-height"),\r\n
                step: 0.1,\r\n
                width: 78,\r\n
                defaultUnit: "cm",\r\n
                value: "3 cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnHeight);\r\n
            this.lockedControls.push(this.spnHeight);\r\n
            this.btnRatio = new Common.UI.Button({\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "advanced-btn-ratio",\r\n
                style: "margin-bottom: 1px;",\r\n
                enableToggle: true,\r\n
                hint: this.textKeepRatio\r\n
            });\r\n
            this.btnRatio.render($("#image-button-ratio"));\r\n
            this.lockedControls.push(this.btnRatio);\r\n
            var value = window.localStorage.getItem("sse-settings-imageratio");\r\n
            if (value === null || parseInt(value) == 1) {\r\n
                this.btnRatio.toggle(true);\r\n
            }\r\n
            this.btnRatio.on("click", _.bind(function (btn, e) {\r\n
                if (btn.pressed && this.spnHeight.getNumberValue() > 0) {\r\n
                    this._nRatio = this.spnWidth.getNumberValue() / this.spnHeight.getNumberValue();\r\n
                }\r\n
                window.localStorage.setItem("sse-settings-imageratio", (btn.pressed) ? 1 : 0);\r\n
            },\r\n
            this));\r\n
            this.btnOriginalSize = new Common.UI.Button({\r\n
                el: $("#image-button-original-size")\r\n
            });\r\n
            this.lockedControls.push(this.btnOriginalSize);\r\n
            this.btnInsertFromFile = new Common.UI.Button({\r\n
                el: $("#image-button-from-file")\r\n
            });\r\n
            this.lockedControls.push(this.btnInsertFromFile);\r\n
            this.btnInsertFromUrl = new Common.UI.Button({\r\n
                el: $("#image-button-from-url")\r\n
            });\r\n
            this.lockedControls.push(this.btnInsertFromUrl);\r\n
            this.spnWidth.on("change", _.bind(this.onWidthChange, this));\r\n
            this.spnHeight.on("change", _.bind(this.onHeightChange, this));\r\n
            this.btnOriginalSize.on("click", _.bind(this.setOriginalSize, this));\r\n
            this.btnInsertFromFile.on("click", _.bind(function (btn) {\r\n
                if (this.api) {\r\n
                    this.api.asc_changeImageFromFile();\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this);\r\n
            },\r\n
            this));\r\n
            this.btnInsertFromUrl.on("click", _.bind(this.insertFromUrl, this));\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                scope: this\r\n
            }));\r\n
        },\r\n
        setApi: function (api) {\r\n
            if (api == undefined) {\r\n
                return;\r\n
            }\r\n
            this.api = api;\r\n
            return this;\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.1 : 1);\r\n
                }\r\n
            }\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            this.updateMetricUnit();\r\n
        },\r\n
        ChangeSettings: function (props) {\r\n
            if (this._initSettings) {\r\n
                this.createDelayedElements();\r\n
                this._initSettings = false;\r\n
            }\r\n
            this.disableControls(this._locked);\r\n
            if (props) {\r\n
                var value = props.asc_getWidth();\r\n
                if (Math.abs(this._state.Width - value) > 0.001 || (this._state.Width === null || value === null) && (this._state.Width !== value)) {\r\n
                    this.spnWidth.setValue((value !== null) ? Common.Utils.Metric.fnRecalcFromMM(value) : "", true);\r\n
                    this._state.Width = value;\r\n
                }\r\n
                value = props.asc_getHeight();\r\n
                if (Math.abs(this._state.Height - value) > 0.001 || (this._state.Height === null || value === null) && (this._state.Height !== value)) {\r\n
                    this.spnHeight.setValue((value !== null) ? Common.Utils.Metric.fnRecalcFromMM(value) : "", true);\r\n
                    this._state.Height = value;\r\n
                }\r\n
                if (props.asc_getHeight() > 0) {\r\n
                    this._nRatio = props.asc_getWidth() / props.asc_getHeight();\r\n
                }\r\n
                this.btnOriginalSize.setDisabled(props.asc_getImageUrl() === null || props.asc_getImageUrl() === undefined || this._locked);\r\n
            }\r\n
        },\r\n
        onWidthChange: function (field, newValue, oldValue, eOpts) {\r\n
            var w = field.getNumberValue();\r\n
            var h = this.spnHeight.getNumberValue();\r\n
            if (this.btnRatio.pressed) {\r\n
                h = w / this._nRatio;\r\n
                if (h > this.spnHeight.options.maxValue) {\r\n
                    h = this.spnHeight.options.maxValue;\r\n
                    w = h * this._nRatio;\r\n
                    this.spnWidth.setValue(w, true);\r\n
                }\r\n
                this.spnHeight.setValue(h, true);\r\n
            }\r\n
            if (this.api) {\r\n
                var props = new Asc.asc_CImgProperty();\r\n
                props.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(w));\r\n
                props.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(h));\r\n
                this.api.asc_setGraphicObjectProps(props);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onHeightChange: function (field, newValue, oldValue, eOpts) {\r\n
            var h = field.getNumberValue(),\r\n
            w = this.spnWidth.getNumberValue();\r\n
            if (this.btnRatio.pressed) {\r\n
                w = h * this._nRatio;\r\n
                if (w > this.spnWidth.options.maxValue) {\r\n
                    w = this.spnWidth.options.maxValue;\r\n
                    h = w / this._nRatio;\r\n
                    this.spnHeight.setValue(h, true);\r\n
                }\r\n
                this.spnWidth.setValue(w, true);\r\n
            }\r\n
            if (this.api) {\r\n
                var props = new Asc.asc_CImgProperty();\r\n
                props.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(w));\r\n
                props.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(h));\r\n
                this.api.asc_setGraphicObjectProps(props);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        setOriginalSize: function () {\r\n
            if (this.api) {\r\n
                var imgsize = this.api.asc_getOriginalImageSize();\r\n
                var w = imgsize.asc_getImageWidth();\r\n
                var h = imgsize.asc_getImageHeight();\r\n
                var properties = new Asc.asc_CImgProperty();\r\n
                properties.asc_putWidth(w);\r\n
                properties.asc_putHeight(h);\r\n
                this.api.asc_setGraphicObjectProps(properties);\r\n
                Common.NotificationCenter.trigger("edit:complete", this);\r\n
            }\r\n
        },\r\n
        insertFromUrl: function () {\r\n
            var me = this;\r\n
            (new Common.Views.ImageFromUrlDialog({\r\n
                handler: function (result, value) {\r\n
                    if (result == "ok") {\r\n
                        if (me.api) {\r\n
                            var checkUrl = value.replace(/ /g, "");\r\n
                            if (!_.isEmpty(checkUrl)) {\r\n
                                var props = new Asc.asc_CImgProperty();\r\n
                                props.asc_putImageUrl(checkUrl);\r\n
                                me.api.asc_setGraphicObjectProps(props);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me);\r\n
                }\r\n
            })).show();\r\n
        },\r\n
        setLocked: function (locked) {\r\n
            this._locked = locked;\r\n
        },\r\n
        disableControls: function (disable) {\r\n
            if (this._state.DisabledControls !== disable) {\r\n
                this._state.DisabledControls = disable;\r\n
                _.each(this.lockedControls, function (item) {\r\n
                    item.setDisabled(disable);\r\n
                });\r\n
            }\r\n
        },\r\n
        textKeepRatio: "Constant Proportions",\r\n
        textSize: "Size",\r\n
        textWidth: "Width",\r\n
        textHeight: "Height",\r\n
        textOriginalSize: "Default Size",\r\n
        textInsert: "Insert Image",\r\n
        textFromUrl: "From URL",\r\n
        textFromFile: "From File"\r\n
    },\r\n
    SSE.Views.ImageSettings || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/ChartSettings.template\',[],function () { return \'<table cols="3">\\r\\n    <tr>\\r\\n        <td colspan=3>\\r\\n            <label class="header"><%= scope.textSize %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" width="88px">\\r\\n            <label class="input-label"><%= scope.textWidth %></label>\\r\\n            <div id="chart-spin-width"></div>\\r\\n        </td>\\r\\n        <td class="padding-small" width="28px" style="vertical-align: bottom;">\\r\\n            <div id="chart-button-ratio"></div>\\r\\n        </td>\\r\\n        <td class="padding-small" width="88px">\\r\\n            <label class="input-label"><%= scope.textHeight %></label>\\r\\n            <div id="chart-spin-height"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n</table>\\r\\n<table cols="2">\\r\\n    <tr>\\r\\n        <td class="padding-small" colspan=2>\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td colspan=2>\\r\\n            <label class="header"><%= scope.textChartType %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small">\\r\\n            <div id="chart-button-type" style=""></div>\\r\\n        </td>\\r\\n        <td class="padding-small">\\r\\n            <div id="chart-button-style" style=""></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small" colspan=2>\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td align="center" colspan=2>\\r\\n            <label class="link" id="chart-advanced-link"><%= scope.textAdvanced %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="finish-cell"></tr>\\r\\n</table>\';});\n
\n
\n
define(\'text!spreadsheeteditor/main/app/template/ChartSettingsDlg.template\',[],function () { return \'<div id="id-chart-settings-dlg-style" class="settings-panel active">\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="">\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <label class="header"><%= scope.textType %></label>\\r\\n                    <div id="chart-dlg-button-type" style="margin-right: 15px;"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                    <label class="header"><%= scope.textStyle %></label>\\r\\n                    <div id="chart-dlg-button-style" style=""></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"></div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 >\\r\\n                    <label class="header"><%= scope.textDataRange %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small" width="200">\\r\\n                    <div id="chart-dlg-txt-range" class="input-row" style="margin-right: 10px;"></div>\\r\\n                </td>\\r\\n                <td class="padding-small" style="text-align: right;">\\r\\n                    <button type="button" class="btn btn-text-default" id="chart-dlg-btn-data" style="min-width: 100px;"><%= scope.textSelectData %></button>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textDataSeries %></label>\\r\\n                    <div id="chart-dlg-combo-range" class="input-group-nr" style="width:120px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-chart-settings-dlg-layout" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textChartTitle %></label>\\r\\n                    <div id="chart-dlg-combo-chart-title" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label" style="margin-left: 15px;"><%= scope.textLegendPos %></label>\\r\\n                    <div id="chart-dlg-combo-legend-pos" class="input-group-nr" style="margin-left: 15px;" />\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textHorTitle %></label>\\r\\n                    <div id="chart-dlg-combo-hor-title" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label" style="margin-left: 15px;"><%= scope.textVertTitle %></label>\\r\\n                    <div id="chart-dlg-combo-vert-title" class="input-group-nr" style="margin-left: 15px;" />\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textHorGrid %></label>\\r\\n                    <div id="chart-dlg-combo-hor-grid" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label" style="margin-left: 15px;"><%= scope.textVertGrid %></label>\\r\\n                    <div id="chart-dlg-combo-vert-grid" class="input-group-nr" style="margin-left: 15px;" />\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textDataLabels %></label>\\r\\n                    <div id="chart-dlg-combo-data-labels" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td rowspan="2" class="padding-small">\\r\\n                    <div id="chart-dlg-check-series" style="margin: 20px 0 9px 15px;"></div>\\r\\n                    <div id="chart-dlg-check-category" style="margin: 0 0 9px 15px;"></div>\\r\\n                    <div id="chart-dlg-check-value" style="margin: 0 0 5px 15px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textSeparator %></label>\\r\\n                    <div id="chart-dlg-txt-separator" class="input-row" />\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label id="chart-dlg-label-lines" class="input-label"><%= scope.textLines %></label>\\r\\n                    <div id="chart-dlg-combo-lines" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-small" style="vertical-align: bottom;">\\r\\n                    <div id="chart-dlg-check-markers" style="margin: 0 0 4px 15px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-chart-settings-dlg-vert" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <table cols="3" style="width: 100%">\\r\\n            <tr>\\r\\n                <td colspan="3">\\r\\n                    <label class="header  padding-small"><%= scope.textAxisOptions %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small" width="100">\\r\\n                    <label class="input-label"><%= scope.textMinValue %></label>\\r\\n                </td>\\r\\n                <td class="padding-small" width="115" style="padding-right: 10px;">\\r\\n                    <div id="chart-dlg-combo-mintype"></div>\\r\\n                </td>\\r\\n                <td class="padding-small" width="90">\\r\\n                  

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABY=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="22" aka="AAAAAAAAABY=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

  <div id="chart-dlg-input-min-value"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large" width="100">\\r\\n                    <label class="input-label"><%= scope.textMaxValue %></label>\\r\\n                </td>\\r\\n                <td class="padding-large" width="115" style="padding-right: 10px;">\\r\\n                    <div id="chart-dlg-combo-maxtype"></div>\\r\\n                </td>\\r\\n                <td class="padding-large" width="90">\\r\\n                    <div id="chart-dlg-input-max-value"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large" width="100">\\r\\n                    <label class="input-label"><%= scope.textAxisCrosses %></label>\\r\\n                </td>\\r\\n                <td class="padding-large" width="115" style="padding-right: 10px;">\\r\\n                    <div id="chart-dlg-combo-v-crosstype"></div>\\r\\n                </td>\\r\\n                <td class="padding-large" width="90">\\r\\n                    <div id="chart-dlg-input-v-axis-crosses"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="1" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label"><%= scope.textUnits %></label>\\r\\n                    <div id="chart-dlg-combo-units" class="input-group-nr" style="width:140px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <div id="chart-dlg-check-v-reverse"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"></div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textTickOptions %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label"><%= scope.textMajorType %></label>\\r\\n                    <div id="chart-dlg-combo-v-major-type" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label" style="margin-left: 15px;"><%= scope.textMinorType %></label>\\r\\n                    <div id="chart-dlg-combo-v-minor-type" class="input-group-nr" style="margin-left: 15px;" />\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"></div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="1" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="header"><%= scope.textLabelOptions %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td>\\r\\n                    <label class="input-label"><%= scope.textLabelPos %></label>\\r\\n                    <div id="chart-dlg-combo-v-label-pos" class="input-group-nr" style="width:140px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-chart-settings-dlg-hor" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <table cols="3" style="width: 100%">\\r\\n            <tr>\\r\\n                <td colspan="3">\\r\\n                    <label class="header  padding-small"><%= scope.textAxisOptions %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small" width="100">\\r\\n                    <label class="input-label"><%= scope.textAxisCrosses %></label>\\r\\n                </td>\\r\\n                <td class="padding-small" width="115" style="padding-right: 10px;">\\r\\n                    <div id="chart-dlg-combo-h-crosstype"></div>\\r\\n                </td>\\r\\n                <td class="padding-small" width="90">\\r\\n                    <div id="chart-dlg-input-h-axis-crosses"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="1" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td class="padding-large" width="140">\\r\\n                    <label class="input-label"><%= scope.textAxisPos %></label>\\r\\n                    <div id="chart-dlg-combo-axis-pos" class="input-group-nr" style="width:140px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large">\\r\\n                    <div id="chart-dlg-check-h-reverse"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"></div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textTickOptions %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small" width="140">\\r\\n                    <label class="input-label"><%= scope.textMajorType %></label>\\r\\n                    <div id="chart-dlg-combo-h-major-type" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label" style="margin-left: 15px;"><%= scope.textMinorType %></label>\\r\\n                    <div id="chart-dlg-combo-h-minor-type" class="input-group-nr" style="margin-left: 15px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td width="100%" colspan="2">\\r\\n                    <label class="input-label"><%= scope.textMarksInterval %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large" width="140">\\r\\n                    <div id="chart-dlg-input-marks-interval"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"></div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textLabelOptions %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small" width="140">\\r\\n                    <label class="input-label"><%= scope.textLabelPos %></label>\\r\\n                    <div id="chart-dlg-combo-h-label-pos" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label" style="margin-left: 15px;"><%= scope.textLabelDist %></label>\\r\\n                    <div id="chart-dlg-input-label-dist" style="margin-left: 15px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td width="100%" colspan="2">\\r\\n                    <label class="input-label"><%= scope.textLabelInterval %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td width="140">\\r\\n                    <div id="chart-dlg-combo-label-int" class="input-group-nr"></div>\\r\\n                </td>\\r\\n                <td style="vertical-align: bottom;">\\r\\n                    <div id="chart-dlg-input-label-int" style="margin-left: 15px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'spreadsheeteditor/main/app/view/CellRangeDialog\',["common/main/lib/component/InputField", "common/main/lib/component/Window"], function () {\r\n
    SSE.Views.CellRangeDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 350,\r\n
            cls: "modal-dlg",\r\n
            modal: false\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.txtTitle\r\n
            },\r\n
            options);\r\n
            this.template = [\'<div class="box">\', \'<div id="id-dlg-cell-range" class="input-row" style="margin-bottom: 5px;"></div>\', "</div>", \'<div class="footer right">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + this.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + this.cancelButtonText + "</button>", "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var $window = this.getChild(),\r\n
            me = this;\r\n
            me.inputRange = new Common.UI.InputField({\r\n
                el: $("#id-dlg-cell-range"),\r\n
                name: "range",\r\n
                style: "width: 100%;",\r\n
                allowBlank: false,\r\n
                blankError: this.txtEmpty,\r\n
                validateOnChange: true\r\n
            });\r\n
            $window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            me.inputRange.cmpEl.find("input").on("keypress", _.bind(this.onKeyPress, this));\r\n
            this.on("close", _.bind(this.onClose, this));\r\n
        },\r\n
        onPrimary: function () {\r\n
            this._handleInput("ok");\r\n
            return false;\r\n
        },\r\n
        setSettings: function (settings) {\r\n
            var me = this;\r\n
            this.inputRange.setValue(settings.range ? settings.range : "");\r\n
            if (settings.api) {\r\n
                me.api = settings.api;\r\n
                me.api.asc_setSelectionDialogMode(c_oAscSelectionDialogType.Chart, settings.range ? settings.range : "");\r\n
                me.api.asc_registerCallback("asc_onSelectionRangeChanged", _.bind(me.onApiRangeChanged, me));\r\n
                Common.NotificationCenter.trigger("cells:range", c_oAscSelectionDialogType.Chart);\r\n
            }\r\n
            me.inputRange.validation = function (value) {\r\n
                var isvalid = me.api.asc_checkDataRange(c_oAscSelectionDialogType.Chart, value, false);\r\n
                return (isvalid == c_oAscError.ID.DataRangeError) ? me.txtInvalidRange : true;\r\n
            };\r\n
        },\r\n
        getSettings: function () {\r\n
            return this.inputRange.getValue();\r\n
        },\r\n
        onApiRangeChanged: function (info) {\r\n
            this.inputRange.setValue(info);\r\n
            if (this.inputRange.cmpEl.hasClass("error")) {\r\n
                this.inputRange.cmpEl.removeClass("error");\r\n
            }\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            this._handleInput(event.currentTarget.attributes["result"].value);\r\n
        },\r\n
        onClose: function (event) {\r\n
            if (this.api) {\r\n
                this.api.asc_setSelectionDialogMode(c_oAscSelectionDialogType.None);\r\n
            }\r\n
            Common.NotificationCenter.trigger("cells:range", c_oAscSelectionDialogType.None);\r\n
        },\r\n
        onKeyPress: function (event) {\r\n
            if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                this._handleInput("ok");\r\n
            }\r\n
        },\r\n
        _handleInput: function (state) {\r\n
            if (this.options.handler) {\r\n
                if (state == "ok") {\r\n
                    if (this.inputRange.checkValidate() !== true) {\r\n
                        return;\r\n
                    }\r\n
                }\r\n
                this.options.handler.call(this, this, state);\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        txtTitle: "Select Data Range",\r\n
        textCancel: "Cancel",\r\n
        txtEmpty: "This field is required",\r\n
        txtInvalidRange: "ERROR! Invalid cells range",\r\n
        errorMaxRows: "ERROR! The maximum number of data series per chart is 255."\r\n
    },\r\n
    SSE.Views.CellRangeDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/ChartSettingsDlg\',["text!spreadsheeteditor/main/app/template/ChartSettingsDlg.template", "common/main/lib/view/AdvancedSettingsWindow", "common/main/lib/component/CheckBox", "common/main/lib/component/InputField", "spreadsheeteditor/main/app/view/CellRangeDialog"], function (contentTemplate) {\r\n
    SSE.Views.ChartSettingsDlg = Common.Views.AdvancedSettingsWindow.extend(_.extend({\r\n
        options: {\r\n
            contentWidth: 320,\r\n
            height: 535,\r\n
            toggleGroup: "chart-settings-dlg-group"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle,\r\n
                items: [{\r\n
                    panelId: "id-chart-settings-dlg-style",\r\n
                    panelCaption: this.textTypeData\r\n
                },\r\n
                {\r\n
                    panelId: "id-chart-settings-dlg-layout",\r\n
                    panelCaption: this.textLayout\r\n
                },\r\n
                {\r\n
                    panelId: "id-chart-settings-dlg-vert",\r\n
                    panelCaption: this.textVertAxis\r\n
                },\r\n
                {\r\n
                    panelId: "id-chart-settings-dlg-hor",\r\n
                    panelCaption: this.textHorAxis\r\n
                }],\r\n
                contentTemplate: _.template(contentTemplate)({\r\n
                    scope: this\r\n
                })\r\n
            },\r\n
            options);\r\n
            this.options.handler = function (result, value) {\r\n
                if (result != "ok" || this.isRangeValid()) {\r\n
                    if (options.handler) {\r\n
                        options.handler.call(this, result, value);\r\n
                    }\r\n
                    return;\r\n
                }\r\n
                return true;\r\n
            };\r\n
            Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this, this.options);\r\n
            this._state = {\r\n
                ChartStyle: 1,\r\n
                ChartType: c_oAscChartTypeSettings.barNormal\r\n
            };\r\n
            this._noApply = true;\r\n
            this.api = this.options.api;\r\n
            this.chartSettings = this.options.chartSettings;\r\n
            this.vertAxisProps = null;\r\n
            this.horAxisProps = null;\r\n
            this.currentAxisProps = null;\r\n
            this.dataRangeValid = "";\r\n
        },\r\n
        render: function () {\r\n
            Common.Views.AdvancedSettingsWindow.prototype.render.call(this);\r\n
            var me = this;\r\n
            var $window = this.getChild();\r\n
            this.btnChartType = new Common.UI.Button({\r\n
                cls: "btn-large-dataview",\r\n
                iconCls: "item-chartlist bar-normal",\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "width: 330px;",\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-chart-dlg-menu-type" class="menu-insertchart"  style="margin: 5px 5px 5px 10px;"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnChartType.on("render:after", function (btn) {\r\n
                me.mnuChartTypePicker = new Common.UI.DataView({\r\n
                    el: $("#id-chart-dlg-menu-type"),\r\n
                    parentMenu: btn.menu,\r\n
                    restoreHeight: 411,\r\n
                    groups: new Common.UI.DataViewGroupStore([{\r\n
                        id: "menu-chart-group-bar",\r\n
                        caption: me.textColumn\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-line",\r\n
                        caption: me.textLine\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-pie",\r\n
                        caption: me.textPie\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-hbar",\r\n
                        caption: me.textBar\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-area",\r\n
                        caption: me.textArea\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-scatter",\r\n
                        caption: me.textPoint\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-stock",\r\n
                        caption: me.textStock\r\n
                    }]),\r\n
                    store: new Common.UI.DataViewStore([{\r\n
                        group: "menu-chart-group-bar",\r\n
                        type: c_oAscChartTypeSettings.barNormal,\r\n
                        iconCls: "column-normal",\r\n
                        selected: true\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-bar",\r\n
                        type: c_oAscChartTypeSettings.barStacked,\r\n
                        iconCls: "column-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-bar",\r\n
                        type: c_oAscChartTypeSettings.barStackedPer,\r\n
                        iconCls: "column-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-line",\r\n
                        type: c_oAscChartTypeSettings.lineNormal,\r\n
                        iconCls: "line-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-line",\r\n
                        type: c_oAscChartTypeSettings.lineStacked,\r\n
                        iconCls: "line-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-line",\r\n
                        type: c_oAscChartTypeSettings.lineStackedPer,\r\n
                        iconCls: "line-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-pie",\r\n
                        type: c_oAscChartTypeSettings.pie,\r\n
                        iconCls: "pie-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-pie",\r\n
                        type: c_oAscChartTypeSettings.doughnut,\r\n
                        iconCls: "pie-doughnut"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-hbar",\r\n
                        type: c_oAscChartTypeSettings.hBarNormal,\r\n
                        iconCls: "bar-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-hbar",\r\n
                        type: c_oAscChartTypeSettings.hBarStacked,\r\n
                        iconCls: "bar-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-hbar",\r\n
                        type: c_oAscChartTypeSettings.hBarStackedPer,\r\n
                        iconCls: "bar-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-area",\r\n
                        type: c_oAscChartTypeSettings.areaNormal,\r\n
                        iconCls: "area-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-area",\r\n
                        type: c_oAscChartTypeSettings.areaStacked,\r\n
                        iconCls: "area-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-area",\r\n
                        type: c_oAscChartTypeSettings.areaStackedPer,\r\n
                        iconCls: "area-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-scatter",\r\n
                        type: c_oAscChartTypeSettings.scatter,\r\n
                        iconCls: "point-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-stock",\r\n
                        type: c_oAscChartTypeSettings.stock,\r\n
                        iconCls: "stock-normal"\r\n
                    }]),\r\n
                    itemTemplate: _.template(\'<div id="<%= id %>" class="item-chartlist <%= iconCls %>"></div>\')\r\n
                });\r\n
            });\r\n
            this.btnChartType.render($("#chart-dlg-button-type"));\r\n
            this.mnuChartTypePicker.on("item:click", _.bind(this.onSelectType, this, this.btnChartType));\r\n
            this.btnChartStyle = new Common.UI.Button({\r\n
                cls: "btn-large-dataview",\r\n
                iconCls: "item-wrap",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-chart-dlg-menu-style" style="width: 245px; margin: 0 5px;"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnChartStyle.on("render:after", function (btn) {\r\n
                me.mnuChartStylePicker = new Common.UI.DataView({\r\n
                    el: $("#id-chart-dlg-menu-style"),\r\n
                    parentMenu: btn.menu,\r\n
                    style: "max-height: 411px;",\r\n
                    store: new Common.UI.DataViewStore(),\r\n
                    itemTemplate: _.template(\'<div id="<%= id %>" class="item-wrap" style="background-image: url(<%= imageUrl %>); background-position: 0 0;"></div>\')\r\n
                });\r\n
                if (me.btnChartStyle.menu) {\r\n
                    me.btnChartStyle.menu.on("show:after", function () {\r\n
                        me.mnuChartStylePicker.scroller.update({\r\n
                            alwaysVisibleY: true\r\n
                        });\r\n
                    });\r\n
                }\r\n
            });\r\n
            this.btnChartStyle.render($("#chart-dlg-button-style"));\r\n
            this.mnuChartStylePicker.on("item:click", _.bind(this.onSelectStyle, this, this.btnChartStyle));\r\n
            this.cmbDataDirect = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-range"),\r\n
                menuStyle: "min-width: 120px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: 0,\r\n
                    displayValue: this.textDataRows\r\n
                },\r\n
                {\r\n
                    value: 1,\r\n
                    displayValue: this.textDataColumns\r\n
                }]\r\n
            });\r\n
            this.txtDataRange = new Common.UI.InputField({\r\n
                el: $("#chart-dlg-txt-range"),\r\n
                name: "range",\r\n
                style: "width: 100%;",\r\n
                allowBlank: true,\r\n
                blankError: this.txtEmpty,\r\n
                validateOnChange: true\r\n
            });\r\n
            this.btnSelectData = new Common.UI.Button({\r\n
                el: $("#chart-dlg-btn-data")\r\n
            });\r\n
            this.btnSelectData.on("click", _.bind(this.onSelectData, this));\r\n
            this.cmbChartTitle = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-chart-title"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscChartTitleShowSettings.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartTitleShowSettings.overlay,\r\n
                    displayValue: this.textOverlay\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartTitleShowSettings.noOverlay,\r\n
                    displayValue: this.textNoOverlay\r\n
                }]\r\n
            });\r\n
            this.cmbLegendPos = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-legend-pos"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscChartLegendShowSettings.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartLegendShowSettings.bottom,\r\n
                    displayValue: this.textLegendBottom\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartLegendShowSettings.top,\r\n
                    displayValue: this.textLegendTop\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartLegendShowSettings.right,\r\n
                    displayValue: this.textLegendRight\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartLegendShowSettings.left,\r\n
                    displayValue: this.textLegendLeft\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartLegendShowSettings.leftOverlay,\r\n
                    displayValue: this.textLeftOverlay\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartLegendShowSettings.rightOverlay,\r\n
                    displayValue: this.textRightOverlay\r\n
                }]\r\n
            });\r\n
            this.cmbHorTitle = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-hor-title"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscChartHorAxisLabelShowSettings.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartHorAxisLabelShowSettings.noOverlay,\r\n
                    displayValue: this.textNoOverlay\r\n
                }]\r\n
            });\r\n
            this.cmbVertTitle = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-vert-title"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscChartVertAxisLabelShowSettings.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartVertAxisLabelShowSettings.rotated,\r\n
                    displayValue: this.textRotated\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartVertAxisLabelShowSettings.horizontal,\r\n
                    displayValue: this.textHorizontal\r\n
                }]\r\n
            });\r\n
            this.cmbHorGrid = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-hor-grid"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscGridLinesSettings.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscGridLinesSettings.major,\r\n
                    displayValue: this.textMajor\r\n
                },\r\n
                {\r\n
                    value: c_oAscGridLinesSettings.minor,\r\n
                    displayValue: this.textMinor\r\n
                },\r\n
                {\r\n
                    value: c_oAscGridLinesSettings.majorMinor,\r\n
                    displayValue: this.textMajorMinor\r\n
                }]\r\n
            });\r\n
            this.cmbVertGrid = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-vert-grid"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscGridLinesSettings.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscGridLinesSettings.major,\r\n
                    displayValue: this.textMajor\r\n
                },\r\n
                {\r\n
                    value: c_oAscGridLinesSettings.minor,\r\n
                    displayValue: this.textMinor\r\n
                },\r\n
                {\r\n
                    value: c_oAscGridLinesSettings.majorMinor,\r\n
                    displayValue: this.textMajorMinor\r\n
                }]\r\n
            });\r\n
            this.cmbDataLabels = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-data-labels"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscChartDataLabelsPos.none,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartDataLabelsPos.ctr,\r\n
                    displayValue: this.textCenter\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartDataLabelsPos.inBase,\r\n
                    displayValue: this.textInnerBottom\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartDataLabelsPos.inEnd,\r\n
                    displayValue: this.textInnerTop\r\n
                },\r\n
                {\r\n
                    value: c_oAscChartDataLabelsPos.outEnd,\r\n
                    displayValue: this.textOuterTop\r\n
                }]\r\n
            });\r\n
            this.cmbDataLabels.on("selected", _.bind(me.onSelectDataLabels, this));\r\n
            this.txtSeparator = new Common.UI.InputField({\r\n
                el: $("#chart-dlg-txt-separator"),\r\n
                name: "range",\r\n
                style: "width: 100%;",\r\n
                allowBlank: true,\r\n
                blankError: this.txtEmpty\r\n
            });\r\n
            this.chSeriesName = new Common.UI.CheckBox({\r\n
                el: $("#chart-dlg-check-series"),\r\n
                labelText: this.textSeriesName\r\n
            });\r\n
            this.chCategoryName = new Common.UI.CheckBox({\r\n
                el: $("#chart-dlg-check-category"),\r\n
                labelText: this.textCategoryName\r\n
            });\r\n
            this.chValue = new Common.UI.CheckBox({\r\n
                el: $("#chart-dlg-check-value"),\r\n
                labelText: this.textValue\r\n
            });\r\n
            this.cmbLines = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-lines"),\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: 0,\r\n
                    displayValue: this.textNone\r\n
                },\r\n
                {\r\n
                    value: 1,\r\n
                    displayValue: this.textStraight\r\n
                },\r\n
                {\r\n
                    value: 2,\r\n
                    displayValue: this.textSmooth\r\n
                }]\r\n
            });\r\n
            this.chMarkers = new Common.UI.CheckBox({\r\n
                el: $("#chart-dlg-check-markers"),\r\n
                labelText: this.textMarkers\r\n
            });\r\n
            this.lblLines = $("#chart-dlg-label-lines");\r\n
            this.cmbMinType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-mintype"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 100px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textAuto,\r\n
                    value: c_oAscValAxisRule.auto\r\n
                },\r\n
                {\r\n
                    displayValue: this.textFixed,\r\n
                    value: c_oAscValAxisRule.fixed\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMinValRule(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnMinValue = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-min-value"),\r\n
                maxValue: 1000000,\r\n
                minValue: -1000000,\r\n
                step: 0.1,\r\n
                defaultUnit: "",\r\n
                defaultValue: 0,\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                this.cmbMinType.suspendEvents();\r\n
                this.cmbMinType.setValue(c_oAscValAxisRule.fixed);\r\n
                this.cmbMinType.resumeEvents();\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMinValRule(c_oAscValAxisRule.fixed);\r\n
                    this.currentAxisProps.putMinVal(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbMaxType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-maxtype"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 100px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textAuto,\r\n
                    value: c_oAscValAxisRule.auto\r\n
                },\r\n
                {\r\n
                    displayValue: this.textFixed,\r\n
                    value: c_oAscValAxisRule.fixed\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMaxValRule(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnMaxValue = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-max-value"),\r\n
                maxValue: 1000000,\r\n
                minValue: -1000000,\r\n
                step: 0.1,\r\n
                defaultUnit: "",\r\n
                defaultValue: 0,\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                this.cmbMaxType.suspendEvents();\r\n
                this.cmbMaxType.setValue(c_oAscValAxisRule.fixed);\r\n
                this.cmbMaxType.resumeEvents();\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMaxValRule(c_oAscValAxisRule.fixed);\r\n
                    this.currentAxisProps.putMaxVal(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbVCrossType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-v-crosstype"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 100px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textAuto,\r\n
                    value: c_oAscCrossesRule.auto\r\n
                },\r\n
                {\r\n
                    displayValue: this.textValue,\r\n
                    value: c_oAscCrossesRule.value\r\n
                },\r\n
                {\r\n
                    displayValue: this.textMinValue,\r\n
                    value: c_oAscCrossesRule.minValue\r\n
                },\r\n
                {\r\n
                    displayValue: this.textMaxValue,\r\n
                    value: c_oAscCrossesRule.maxValue\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putCrossesRule(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnVAxisCrosses = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-v-axis-crosses"),\r\n
                maxValue: 1000000,\r\n
                minValue: -1000000,\r\n
                step: 0.1,\r\n
                defaultUnit: "",\r\n
                defaultValue: 0,\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                this.cmbVCrossType.suspendEvents();\r\n
                this.cmbVCrossType.setValue(c_oAscCrossesRule.value);\r\n
                this.cmbVCrossType.resumeEvents();\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putCrossesRule(c_oAscCrossesRule.value);\r\n
                    this.currentAxisProps.putCrosses(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbUnits = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-units"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscValAxUnits.none\r\n
                },\r\n
                {\r\n
                    displayValue: this.textHundreds,\r\n
                    value: c_oAscValAxUnits.HUNDREDS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textThousands,\r\n
                    value: c_oAscValAxUnits.THOUSANDS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textTenThousands,\r\n
                    value: c_oAscValAxUnits.TEN_THOUSANDS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textHundredThousands,\r\n
                    value: c_oAscValAxUnits.HUNDRED_THOUSANDS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textMillions,\r\n
                    value: c_oAscValAxUnits.MILLIONS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textTenMillions,\r\n
                    value: c_oAscValAxUnits.TEN_MILLIONS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textHundredMil,\r\n
                    value: c_oAscValAxUnits.HUNDRED_MILLIONS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textBillions,\r\n
                    value: c_oAscValAxUnits.BILLIONS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textTrillions,\r\n
                    value: c_oAscValAxUnits.TRILLIONS\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putDispUnitsRule(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.chVReverse = new Common.UI.CheckBox({\r\n
                el: $("#chart-dlg-check-v-reverse"),\r\n
                labelText: this.textReverse\r\n
            }).on("change", _.bind(function (checkbox, state) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putInvertValOrder(state == "checked");\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbVMajorType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-v-major-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscTickMark.TICK_MARK_NONE\r\n
                },\r\n
                {\r\n
                    displayValue: this.textCross,\r\n
                    value: c_oAscTickMark.TICK_MARK_CROSS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textIn,\r\n
                    value: c_oAscTickMark.TICK_MARK_IN\r\n
                },\r\n
                {\r\n
                    displayValue: this.textOut,\r\n
                    value: c_oAscTickMark.TICK_MARK_OUT\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMajorTickMark(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbVMinorType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-v-minor-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscTickMark.TICK_MARK_NONE\r\n
                },\r\n
                {\r\n
                    displayValue: this.textCross,\r\n
                    value: c_oAscTickMark.TICK_MARK_CROSS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textIn,\r\n
                    value: c_oAscTickMark.TICK_MARK_IN\r\n
                },\r\n
                {\r\n
                    displayValue: this.textOut,\r\n
                    value: c_oAscTickMark.TICK_MARK_OUT\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMinorTickMark(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbVLabelPos = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-v-label-pos"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE\r\n
                },\r\n
                {\r\n
                    displayValue: this.textLow,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW\r\n
                },\r\n
                {\r\n
                    displayValue: this.textHigh,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH\r\n
                },\r\n
                {\r\n
                    displayValue: this.textNextToAxis,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putTickLabelsPos(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbHCrossType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-h-crosstype"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 100px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textAuto,\r\n
                    value: c_oAscCrossesRule.auto\r\n
                },\r\n
                {\r\n
                    displayValue: this.textValue,\r\n
                    value: c_oAscCrossesRule.value\r\n
                },\r\n
                {\r\n
                    displayValue: this.textMinValue,\r\n
                    value: c_oAscCrossesRule.minValue\r\n
                },\r\n
                {\r\n
                    displayValue: this.textMaxValue,\r\n
                    value: c_oAscCrossesRule.maxValue\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putCrossesRule(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnHAxisCrosses = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-h-axis-crosses"),\r\n
                maxValue: 1000000,\r\n
                minValue: -1000000,\r\n
                step: 0.1,\r\n
                defaultUnit: "",\r\n
                defaultValue: 0,\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                this.cmbHCrossType.suspendEvents();\r\n
                this.cmbHCrossType.setValue(c_oAscCrossesRule.value);\r\n
                this.cmbHCrossType.resumeEvents();\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putCrossesRule(c_oAscCrossesRule.value);\r\n
                    this.currentAxisProps.putCrosses(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbAxisPos = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-axis-pos"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textOnTickMarks,\r\n
                    value: c_oAscLabelsPosition.byDivisions\r\n
                },\r\n
                {\r\n
                    displayValue: this.textBetweenTickMarks,\r\n
                    value: c_oAscLabelsPosition.betweenDivisions\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putLabelsPosition(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.chHReverse = new Common.UI.CheckBox({\r\n
                el: $("#chart-dlg-check-h-reverse"),\r\n
                labelText: this.textReverse\r\n
            }).on("change", _.bind(function (checkbox, state) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putInvertCatOrder(state == "checked");\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbHMajorType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-h-major-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscTickMark.TICK_MARK_NONE\r\n
                },\r\n
                {\r\n
                    displayValue: this.textCross,\r\n
                    value: c_oAscTickMark.TICK_MARK_CROSS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textIn,\r\n
                    value: c_oAscTickMark.TICK_MARK_IN\r\n
                },\r\n
                {\r\n
                    displayValue: this.textOut,\r\n
                    value: c_oAscTickMark.TICK_MARK_OUT\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMajorTickMark(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbHMinorType = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-h-minor-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscTickMark.TICK_MARK_NONE\r\n
                },\r\n
                {\r\n
                    displayValue: this.textCross,\r\n
                    value: c_oAscTickMark.TICK_MARK_CROSS\r\n
                },\r\n
                {\r\n
                    displayValue: this.textIn,\r\n
                    value: c_oAscTickMark.TICK_MARK_IN\r\n
                },\r\n
                {\r\n
                    displayValue: this.textOut,\r\n
                    value: c_oAscTickMark.TICK_MARK_OUT\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putMinorTickMark(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnMarksInterval = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-marks-interval"),\r\n
                width: 140,\r\n
                maxValue: 1000000,\r\n
                minValue: 1,\r\n
                step: 1,\r\n
                defaultUnit: "",\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putIntervalBetweenTick(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbHLabelPos = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-h-label-pos"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textNone,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_NONE\r\n
                },\r\n
                {\r\n
                    displayValue: this.textLow,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_LOW\r\n
                },\r\n
                {\r\n
                    displayValue: this.textHigh,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_HIGH\r\n
                },\r\n
                {\r\n
                    displayValue: this.textNextToAxis,\r\n
                    value: c_oAscTickLabelsPos.TICK_LABEL_POSITION_NEXT_TO\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putTickLabelsPos(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnLabelDist = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-label-dist"),\r\n
                width: 140,\r\n
                maxValue: 1000,\r\n
                minValue: 0,\r\n
                step: 1,\r\n
                defaultUnit: "",\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putLabelsAxisDistance(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnLabelInterval = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-dlg-input-label-int"),\r\n
                width: 140,\r\n
                maxValue: 1000000,\r\n
                minValue: 1,\r\n
                step: 1,\r\n
                defaultUnit: "",\r\n
                value: ""\r\n
            }).on("change", _.bind(function (field, newValue, oldValue) {\r\n
                this.cmbLabelInterval.suspendEvents();\r\n
                this.cmbLabelInterval.setValue(c_oAscBetweenLabelsRule.manual);\r\n
                this.cmbLabelInterval.resumeEvents();\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putIntervalBetweenLabelsRule(c_oAscBetweenLabelsRule.manual);\r\n
                    this.currentAxisProps.putIntervalBetweenLabels(field.getNumberValue());\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.cmbLabelInterval = new Common.UI.ComboBox({\r\n
                el: $("#chart-dlg-combo-label-int"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 140px;",\r\n
                editable: false,\r\n
                data: [{\r\n
                    displayValue: this.textAuto,\r\n
                    value: c_oAscBetweenLabelsRule.auto\r\n
                },\r\n
                {\r\n
                    displayValue: this.textManual,\r\n
                    value: c_oAscBetweenLabelsRule.manual\r\n
                }]\r\n
            }).on("selected", _.bind(function (combo, record) {\r\n
                if (this.currentAxisProps) {\r\n
                    this.currentAxisProps.putIntervalBetweenLabelsRule(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.btnsCategory[2].on("click", _.bind(this.onVCategoryClick, this));\r\n
            this.btnsCategory[3].on("click", _.bind(this.onHCategoryClick, this));\r\n
            this.afterRender();\r\n
        },\r\n
        afterRender: function () {\r\n
            if (this.api) {\r\n
                this.updateChartStyles(this.api.asc_getChartPreviews(this._state.ChartType));\r\n
            }\r\n
            this._setDefaults(this.chartSettings);\r\n
        },\r\n
        onSelectType: function (btn, picker, itemView, record) {\r\n
            if (this._noApply) {\r\n
                return;\r\n
            }\r\n
            var rawData = {},\r\n
            isPickerSelect = _.isFunction(record.toJSON);\r\n
            if (isPickerSelect) {\r\n
                if (record.get("selected")) {\r\n
                    rawData = record.toJSON();\r\n
                } else {\r\n
                    return;\r\n
                }\r\n
            } else {\r\n
                rawData = record;\r\n
            }\r\n
            this.btnChartType.setIconCls("item-chartlist " + rawData.iconCls);\r\n
            this.updateChartStyles(this.api.asc_getChartPreviews(rawData.type));\r\n
            this.updateAxisProps(rawData.type, true);\r\n
            this.chartSettings.changeType(rawData.type);\r\n
            this.vertAxisProps = this.chartSettings.getVertAxisProps();\r\n
            this.horAxisProps = this.chartSettings.getHorAxisProps();\r\n
        },\r\n
        updateAxisProps: function (type, isDefault) {\r\n
            var value = (type == c_oAscChartTypeSettings.lineNormal || type == c_oAscChartTypeSettings.lineStacked || type == c_oAscChartTypeSettings.lineStackedPer || type == c_oAscChartTypeSettings.scatter);\r\n
            this.chMarkers.setVisible(value);\r\n
            this.cmbLines.setVisible(value);\r\n
            this.lblLines.toggleClass("hidden", !value);\r\n
            value = (type == c_oAscChartTypeSettings.pie || type == c_oAscChartTypeSettings.doughnut);\r\n
            this.btnsCategory[2].setDisabled(value);\r\n
            this.btnsCategory[3].setDisabled(value);\r\n
            this.cmbHorTitle.setDisabled(value);\r\n
            this.cmbVertTitle.setDisabled(value);\r\n
            this.cmbHorGrid.setDisabled(value);\r\n
            this.cmbVertGrid.setDisabled(value);\r\n
            value = (type == c_oAscChartTypeSettings.hBarNormal || type == c_oAscChartTypeSettings.hBarStacked || type == c_oAscChartTypeSettings.hBarStackedPer);\r\n
            this.btnsCategory[2].options.contentTarget = (value) ? "id-chart-settings-dlg-hor" : "id-chart-settings-dlg-vert";\r\n
            this.btnsCategory[3].options.contentTarget = (value || type == c_oAscChartTypeSettings.scatter) ? "id-chart-settings-dlg-vert" : "id-chart-settings-dlg-hor";\r\n
            if (isDefault) {\r\n
                if (value) {\r\n
                    this.cmbHorGrid.setValue(c_oAscGridLinesSettings.none);\r\n
                    this.cmbVertGrid.setValue(c_oAscGridLinesSettings.major);\r\n
                } else {\r\n
                    if (type == c_oAscChartTypeSettings.scatter) {\r\n
                        this.cmbHorGrid.setValue(c_oAscGridLinesSettings.major);\r\n
                        this.cmbVertGrid.setValue(c_oAscGridLinesSettings.major);\r\n
                        this.chMarkers.setValue(true, true);\r\n
                        this.cmbLines.setValue(0);\r\n
                    } else {\r\n
                        if (type == c_oAscChartTypeSettings.barNormal || type == c_oAscChartTypeSettings.barStacked || type == c_oAscChartTypeSettings.barStackedPer || type == c_oAscChartTypeSettings.lineNormal || type == c_oAscChartTypeSettings.lineStacked || type == c_oAscChartTypeSettings.lineStackedPer || type == c_oAscChartTypeSettings.areaNormal || type == c_oAscChartTypeSettings.areaStacked || type == c_oAscChartTypeSettings.areaStackedPer || type == c_oAscChartTypeSettings.stock) {\r\n
                            this.cmbHorGrid.setValue(c_oAscGridLinesSettings.major);\r\n
                            this.cmbVertGrid.setValue(c_oAscGridLinesSettings.none);\r\n
                            if (type == c_oAscChartTypeSettings.lineNormal || type == c_oAscChartTypeSettings.lineStacked || type == c_oAscChartTypeSettings.lineStackedPer) {\r\n
                                this.chMarkers.setValue(false, true);\r\n
                                this.cmbLines.setValue(1);\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onVCategoryClick: function () {\r\n
            (this.vertAxisProps.getAxisType() == c_oAscAxisType.val) ? this.fillVProps(this.vertAxisProps) : this.fillHProps(this.vertAxisProps);\r\n
        },\r\n
        onHCategoryClick: function () {\r\n
            (this.horAxisProps.getAxisType() == c_oAscAxisType.val) ? this.fillVProps(this.horAxisProps) : this.fillHProps(this.horAxisProps);\r\n
        },\r\n
        fillVProps: function (props) {\r\n
            if (props.getAxisType() !== c_oAscAxisType.val) {\r\n
                return;\r\n
            }\r\n
            var value = props.getMinValRule();\r\n
            this.cmbMinType.setValue(value);\r\n
            this.spnMinValue.setValue((value === c_oAscValAxisRule.fixed) ? props.getMinVal() : "", true);\r\n
            value = props.getMaxValRule();\r\n
            this.cmbMaxType.setValue(value);\r\n
            this.spnMaxValue.setValue((value === c_oAscValAxisRule.fixed) ? props.getMaxVal() : "", true);\r\n
            value = props.getCrossesRule();\r\n
            this.cmbVCrossType.setValue(value);\r\n
            this.spnVAxisCrosses.setValue((value === c_oAscCrossesRule.value) ? props.getCrosses() : "", true);\r\n
            this.cmbUnits.setValue(props.getDispUnitsRule());\r\n
            this.chVReverse.setValue(props.getInvertValOrder(), true);\r\n
            this.cmbVMajorType.setValue(props.getMajorTickMark());\r\n
            this.cmbVMinorType.setValue(props.getMinorTickMark());\r\n
            this.cmbVLabelPos.setValue(props.getTickLabelsPos());\r\n
            this.currentAxisProps = props;\r\n
        },\r\n
        fillHProps: function (props) {\r\n
            if (props.getAxisType() !== c_oAscAxisType.cat) {\r\n
                return;\r\n
            }\r\n
            var value = props.getCrossesRule();\r\n
            this.cmbHCrossType.setValue(value);\r\n
            this.spnHAxisCrosses.setValue((value === c_oAscCrossesRule.value) ? props.getCrosses() : "", true);\r\n
            this.cmbAxisPos.setValue(props.getLabelsPosition());\r\n
            this.chHReverse.setValue(props.getInvertCatOrder(), true);\r\n
            this.cmbHMajorType.setValue(props.getMajorTickMark());\r\n
            this.cmbHMinorType.setValue(props.getMinorTickMark());\r\n
            this.spnMarksInterval.setValue(props.getIntervalBetweenTick(), true);\r\n
            this.cmbHLabelPos.setValue(props.getTickLabelsPos());\r\n
            this.spnLabelDist.setValue(props.getLabelsAxisDistance(), true);\r\n
            value = props.getIntervalBetweenLabelsRule();\r\n
            this.cmbLabelInterval.setValue(value);\r\n
            this.spnLabelInterval.setValue((value === c_oAscBetweenLabelsRule.manual) ? props.getIntervalBetweenLabels() : "", true);\r\n
            this.currentAxisProps = props;\r\n
        },\r\n
        onSelectStyle: function (btn, picker, itemView, record) {\r\n
            if (this._noApply) {\r\n
                return;\r\n
            }\r\n
            var rawData = {},\r\n
            isPickerSelect = _.isFunction(record.toJSON);\r\n
            if (isPickerSelect) {\r\n
                if (record.get("selected")) {\r\n
                    rawData = record.toJSON();\r\n
                } else {\r\n
                    return;\r\n
                }\r\n
            } else {\r\n
                rawData = record;\r\n
            }\r\n
            var style = "url(" + rawData.imageUrl + ")";\r\n
            var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
            btnIconEl.css("background-image", style);\r\n
            this._state.ChartStyle = rawData.data;\r\n
        },\r\n
        updateChartStyles: function (styles) {\r\n
            var me = this;\r\n
            if (styles && styles.length > 0) {\r\n
                var stylesStore = this.mnuChartStylePicker.store;\r\n
                if (stylesStore) {\r\n
                    var stylearray = [],\r\n
                    selectedIdx = -1,\r\n
                    selectedUrl;\r\n
                    _.each(styles, function (item, index) {\r\n
                        stylearray.push({\r\n
                            imageUrl: item.asc_getImageUrl(),\r\n
                            data: item.asc_getStyle(),\r\n
                            tip: me.textStyle + " " + item.asc_getStyle()\r\n
                        });\r\n
                        if (me._state.ChartStyle == item.asc_getStyle()) {\r\n
                            selectedIdx = index;\r\n
                            selectedUrl = item.asc_getImageUrl();\r\n
                        }\r\n
                    });\r\n
                    stylesStore.reset(stylearray, {\r\n
                        silent: false\r\n
                    });\r\n
                }\r\n
            }\r\n
            this.mnuChartStylePicker.selectByIndex(selectedIdx, true);\r\n
            if (selectedIdx >= 0 && this.btnChartStyle.cmpEl) {\r\n
                var style = "url(" + selectedUrl + ")";\r\n
                var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
                btnIconEl.css("background-image", style);\r\n
            }\r\n
        },\r\n
        _setDefaults: function (props) {\r\n
            var me = this;\r\n
            if (props) {\r\n
                this.chartSettings = props;\r\n
                this._state.ChartType = props.getType();\r\n
                this._noApply = true;\r\n
                var record = this.mnuChartTypePicker.store.findWhere({\r\n
                    type: this._state.ChartType\r\n
                });\r\n
                this.mnuChartTypePicker.selectRecord(record, true);\r\n
                if (record) {\r\n
                    this.btnChartType.setIconCls("item-chartlist " + record.get("iconCls"));\r\n
                }\r\n
                this.updateChartStyles(this.api.asc_getChartPreviews(this._state.ChartType));\r\n
                this._noApply = false;\r\n
                this._state.ChartStyle = props.getStyle();\r\n
                record = this.mnuChartStylePicker.store.findWhere({\r\n
                    data: this._state.ChartStyle\r\n
                });\r\n
                this.mnuChartStylePicker.selectRecord(record, true);\r\n
                if (record) {\r\n
                    var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
                    btnIconEl.css("background-image", "url(" + record.get("imageUrl") + ")");\r\n
                }\r\n
                var value = props.getRange();\r\n
                this.txtDataRange.setValue((value) ? value : "");\r\n
                this.dataRangeValid = value;\r\n
                this.txtDataRange.validation = function (value) {\r\n
                    if (_.isEmpty(value)) {\r\n
                        if (!me.cmbDataDirect.isDisabled()) {\r\n
                            me.cmbDataDirect.setDisabled(true);\r\n
                        }\r\n
                        return true;\r\n
                    }\r\n
                    if (me.cmbDataDirect.isDisabled()) {\r\n
                        me.cmbDataDirect.setDisabled(false);\r\n
                    }\r\n
                    var isvalid = me.api.asc_checkDataRange(c_oAscSelectionDialogType.Chart, value, false);\r\n
                    return (isvalid == c_oAscError.ID.DataRangeError) ? me.textInvalidRange : true;\r\n
                };\r\n
                this.cmbDataDirect.setDisabled(value === null)

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABc=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="23" aka="AAAAAAAAABc=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

;\r\n
                this.cmbDataDirect.setValue(props.getInColumns() ? 1 : 0);\r\n
                this.cmbChartTitle.setValue(props.getTitle());\r\n
                this.cmbLegendPos.setValue(props.getLegendPos());\r\n
                this.cmbHorTitle.setValue(props.getHorAxisLabel());\r\n
                this.cmbVertTitle.setValue(props.getVertAxisLabel());\r\n
                this.cmbHorGrid.setValue(props.getHorGridLines());\r\n
                this.cmbVertGrid.setValue(props.getVertGridLines());\r\n
                this.cmbDataLabels.setValue(props.getDataLabelsPos());\r\n
                this.onSelectDataLabels(this.cmbDataLabels, {\r\n
                    value: props.getDataLabelsPos()\r\n
                });\r\n
                this.chSeriesName.setValue(this.chartSettings.getShowSerName(), true);\r\n
                this.chCategoryName.setValue(this.chartSettings.getShowCatName(), true);\r\n
                this.chValue.setValue(this.chartSettings.getShowVal(), true);\r\n
                value = props.getSeparator();\r\n
                this.txtSeparator.setValue((value) ? value : "");\r\n
                value = (this._state.ChartType == c_oAscChartTypeSettings.lineNormal || this._state.ChartType == c_oAscChartTypeSettings.lineStacked || this._state.ChartType == c_oAscChartTypeSettings.lineStackedPer || this._state.ChartType == c_oAscChartTypeSettings.scatter);\r\n
                this.chMarkers.setVisible(value);\r\n
                this.cmbLines.setVisible(value);\r\n
                this.lblLines.toggleClass("hidden", !value);\r\n
                if (value) {\r\n
                    this.chMarkers.setValue(this.chartSettings.getShowMarker(), true);\r\n
                    this.cmbLines.setValue(props.getLine() ? (props.getSmooth() ? 2 : 1) : 0);\r\n
                }\r\n
                this.vertAxisProps = props.getVertAxisProps();\r\n
                this.horAxisProps = props.getHorAxisProps();\r\n
                this.updateAxisProps(this._state.ChartType);\r\n
            }\r\n
        },\r\n
        getSettings: function () {\r\n
            var value, type = this.mnuChartTypePicker.getSelectedRec()[0].get("type");\r\n
            this.chartSettings.putType(type);\r\n
            this.chartSettings.putStyle(this._state.ChartStyle);\r\n
            this.chartSettings.putInColumns(this.cmbDataDirect.getValue() == 1);\r\n
            this.chartSettings.putRange(this.txtDataRange.getValue());\r\n
            this.chartSettings.putTitle(this.cmbChartTitle.getValue());\r\n
            this.chartSettings.putLegendPos(this.cmbLegendPos.getValue());\r\n
            this.chartSettings.putHorAxisLabel(this.cmbHorTitle.getValue());\r\n
            this.chartSettings.putVertAxisLabel(this.cmbVertTitle.getValue());\r\n
            this.chartSettings.putHorGridLines(this.cmbHorGrid.getValue());\r\n
            this.chartSettings.putVertGridLines(this.cmbVertGrid.getValue());\r\n
            this.chartSettings.putDataLabelsPos(this.cmbDataLabels.getValue());\r\n
            this.chartSettings.putShowSerName(this.chSeriesName.getValue() == "checked");\r\n
            this.chartSettings.putShowCatName(this.chCategoryName.getValue() == "checked");\r\n
            this.chartSettings.putShowVal(this.chValue.getValue() == "checked");\r\n
            this.chartSettings.putSeparator(_.isEmpty(this.txtSeparator.getValue()) ? " " : this.txtSeparator.getValue());\r\n
            this.chartSettings.putShowMarker(this.chMarkers.getValue() == "checked");\r\n
            value = (type == c_oAscChartTypeSettings.lineNormal || type == c_oAscChartTypeSettings.lineStacked || type == c_oAscChartTypeSettings.lineStackedPer || type == c_oAscChartTypeSettings.scatter);\r\n
            if (value) {\r\n
                value = this.cmbLines.getValue();\r\n
                this.chartSettings.putLine(value !== 0);\r\n
                if (value > 0) {\r\n
                    this.chartSettings.putSmooth(value == 2);\r\n
                }\r\n
            }\r\n
            this.chartSettings.putVertAxisProps(this.vertAxisProps);\r\n
            this.chartSettings.putHorAxisProps(this.horAxisProps);\r\n
            return {\r\n
                chartSettings: this.chartSettings\r\n
            };\r\n
        },\r\n
        isRangeValid: function () {\r\n
            var isvalid;\r\n
            if (!_.isEmpty(this.txtDataRange.getValue())) {\r\n
                isvalid = this.api.asc_checkDataRange(c_oAscSelectionDialogType.Chart, this.txtDataRange.getValue(), true, this.cmbDataDirect.getValue() == 0, this.mnuChartTypePicker.getSelectedRec()[0].get("type"));\r\n
                if (isvalid == c_oAscError.ID.No) {\r\n
                    return true;\r\n
                }\r\n
            } else {\r\n
                this.txtDataRange.showError([this.txtEmpty]);\r\n
            }\r\n
            this.btnsCategory[0].toggle(true);\r\n
            this.onCategoryClick(this.btnsCategory[0]);\r\n
            if (isvalid == c_oAscError.ID.StockChartError) {\r\n
                Common.UI.warning({\r\n
                    msg: this.errorStockChart\r\n
                });\r\n
            } else {\r\n
                if (isvalid == c_oAscError.ID.MaxDataSeriesError) {\r\n
                    Common.UI.warning({\r\n
                        msg: this.errorMaxRows\r\n
                    });\r\n
                } else {\r\n
                    this.txtDataRange.cmpEl.find("input").focus();\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onSelectData: function () {\r\n
            var me = this;\r\n
            if (me.api) {\r\n
                var handlerDlg = function (dlg, result) {\r\n
                    if (result == "ok") {\r\n
                        me.dataRangeValid = dlg.getSettings();\r\n
                        me.txtDataRange.setValue(me.dataRangeValid);\r\n
                        me.txtDataRange.checkValidate();\r\n
                    }\r\n
                };\r\n
                var win = new SSE.Views.CellRangeDialog({\r\n
                    handler: handlerDlg\r\n
                }).on("close", function () {\r\n
                    me.show();\r\n
                });\r\n
                var xy = me.$window.offset();\r\n
                me.hide();\r\n
                win.show(xy.left + 160, xy.top + 125);\r\n
                win.setSettings({\r\n
                    api: me.api,\r\n
                    isRows: (me.cmbDataDirect.getValue() == 0),\r\n
                    range: (!_.isEmpty(me.txtDataRange.getValue()) && (me.txtDataRange.checkValidate() == true)) ? me.txtDataRange.getValue() : me.dataRangeValid\r\n
                });\r\n
            }\r\n
        },\r\n
        onSelectDataLabels: function (obj, rec, e) {\r\n
            var disable = rec.value == c_oAscChartDataLabelsPos.none;\r\n
            this.chSeriesName.setDisabled(disable);\r\n
            this.chCategoryName.setDisabled(disable);\r\n
            this.chValue.setDisabled(disable);\r\n
            this.txtSeparator.setDisabled(disable);\r\n
        },\r\n
        show: function () {\r\n
            Common.Views.AdvancedSettingsWindow.prototype.show.apply(this, arguments);\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                me.txtDataRange.cmpEl.find("input").focus();\r\n
            },\r\n
            50);\r\n
        },\r\n
        textTitle: "Chart - Advanced Settings",\r\n
        textShowValues: "Display chart values",\r\n
        textShowBorders: "Display chart borders",\r\n
        textLine: "Line",\r\n
        textColumn: "Column",\r\n
        textBar: "Bar",\r\n
        textArea: "Area",\r\n
        textPie: "Pie",\r\n
        textPoint: "Point",\r\n
        textStock: "Stock",\r\n
        textDataRows: "in rows",\r\n
        textDataColumns: "in columns",\r\n
        textDisplayLegend: "Display Legend",\r\n
        textLegendBottom: "Bottom",\r\n
        textLegendTop: "Top",\r\n
        textLegendRight: "Right",\r\n
        textLegendLeft: "Left",\r\n
        textShowAxis: "Display Axis",\r\n
        textShowGrid: "Grid Lines",\r\n
        textDataRange: "Data Range",\r\n
        textChartTitle: "Chart Title",\r\n
        textXAxisTitle: "X Axis Title",\r\n
        textYAxisTitle: "Y Axis Title",\r\n
        txtEmpty: "This field is required",\r\n
        textInvalidRange: "ERROR! Invalid cells range",\r\n
        cancelButtonText: "Cancel",\r\n
        textTypeStyle: "Chart Type, Style &<br/>Data Range",\r\n
        textChartElementsLegend: "Chart Elements &<br/>Chart Legend",\r\n
        textLayout: "Layout",\r\n
        textLegendPos: "Legend",\r\n
        textHorTitle: "Horizontal Axis Title",\r\n
        textVertTitle: "Vertical Axis Title",\r\n
        textDataLabels: "Data Labels",\r\n
        textSeparator: "Data Labels Separator",\r\n
        textSeriesName: "Series Name",\r\n
        textCategoryName: "Category Name",\r\n
        textValue: "Value",\r\n
        textAxisOptions: "Axis Options",\r\n
        textMinValue: "Minimum Value",\r\n
        textMaxValue: "Maximum Value",\r\n
        textAxisCrosses: "Axis Crosses",\r\n
        textUnits: "Display Units",\r\n
        textTickOptions: "Tick Options",\r\n
        textMajorType: "Major Type",\r\n
        textMinorType: "Minor Type",\r\n
        textLabelOptions: "Label Options",\r\n
        textLabelPos: "Label Position",\r\n
        textReverse: "Values in reverse order",\r\n
        textVertAxis: "Vertical Axis",\r\n
        textHorAxis: "Horizontal Axis",\r\n
        textMarksInterval: "Interval between Marks",\r\n
        textLabelDist: "Axis Label Distance",\r\n
        textLabelInterval: "Interval between Labels",\r\n
        textAxisPos: "Axis Position",\r\n
        textLeftOverlay: "Left Overlay",\r\n
        textRightOverlay: "Right Overlay",\r\n
        textOverlay: "Overlay",\r\n
        textNoOverlay: "No Overlay",\r\n
        textRotated: "Rotated",\r\n
        textHorizontal: "Horizontal",\r\n
        textInnerBottom: "Inner Bottom",\r\n
        textInnerTop: "Inner Top",\r\n
        textOuterTop: "Outer Top",\r\n
        textNone: "None",\r\n
        textCenter: "Center",\r\n
        textFixed: "Fixed",\r\n
        textAuto: "Auto",\r\n
        textCross: "Cross",\r\n
        textIn: "In",\r\n
        textOut: "Out",\r\n
        textLow: "Low",\r\n
        textHigh: "High",\r\n
        textNextToAxis: "Next to axis",\r\n
        textHundreds: "Hundreds",\r\n
        textThousands: "Thousands",\r\n
        textTenThousands: "10 000",\r\n
        textHundredThousands: "100 000",\r\n
        textMillions: "Millions",\r\n
        textTenMillions: "10 000 000",\r\n
        textHundredMil: "100 000 000",\r\n
        textBillions: "Billions",\r\n
        textTrillions: "Trillions",\r\n
        textCustom: "Custom",\r\n
        textManual: "Manual",\r\n
        textBetweenTickMarks: "Between Tick Marks",\r\n
        textOnTickMarks: "On Tick Marks",\r\n
        textHorGrid: "Horizontal Gridlines",\r\n
        textVertGrid: "Vertical Gridlines",\r\n
        textLines: "Lines",\r\n
        textMarkers: "Markers",\r\n
        textMajor: "Major",\r\n
        textMinor: "Minor",\r\n
        textMajorMinor: "Major and Minor",\r\n
        textStraight: "Straight",\r\n
        textSmooth: "Smooth",\r\n
        textType: "Type",\r\n
        textTypeData: "Type & Data",\r\n
        textStyle: "Style",\r\n
        textSelectData: "Select Data",\r\n
        textDataSeries: "Data series",\r\n
        errorMaxRows: "ERROR! The maximum number of data series per chart is 255.",\r\n
        errorStockChart: "Incorrect row order. To build a stock chart place the data on the sheet in the following order:<br> opening price, max price, min price, closing price."\r\n
    },\r\n
    SSE.Views.ChartSettingsDlg || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/ChartSettings\',["text!spreadsheeteditor/main/app/template/ChartSettings.template", "jquery", "underscore", "backbone", "common/main/lib/component/Button", "common/main/lib/component/MetricSpinner", "spreadsheeteditor/main/app/view/ChartSettingsDlg"], function (menuTemplate, $, _, Backbone) {\r\n
    SSE.Views.ChartSettings = Backbone.View.extend(_.extend({\r\n
        el: "#id-chart-settings",\r\n
        template: _.template(menuTemplate),\r\n
        events: {},\r\n
        options: {\r\n
            alias: "ChartSettings"\r\n
        },\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            this._initSettings = true;\r\n
            this._state = {\r\n
                Width: 0,\r\n
                Height: 0,\r\n
                ChartStyle: 1,\r\n
                ChartType: -1,\r\n
                SeveralCharts: false,\r\n
                DisabledControls: false\r\n
            };\r\n
            this._nRatio = 1;\r\n
            this.spinners = [];\r\n
            this.lockedControls = [];\r\n
            this._locked = false;\r\n
            this._noApply = false;\r\n
            this._originalProps = null;\r\n
            this.render();\r\n
            this.btnChartType = new Common.UI.Button({\r\n
                cls: "btn-large-dataview",\r\n
                iconCls: "item-chartlist bar-normal",\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "width: 330px;",\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-chart-menu-type" class="menu-insertchart"  style="margin: 5px 5px 5px 10px;"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnChartType.on("render:after", function (btn) {\r\n
                me.mnuChartTypePicker = new Common.UI.DataView({\r\n
                    el: $("#id-chart-menu-type"),\r\n
                    parentMenu: btn.menu,\r\n
                    restoreHeight: 411,\r\n
                    groups: new Common.UI.DataViewGroupStore([{\r\n
                        id: "menu-chart-group-bar",\r\n
                        caption: me.textColumn\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-line",\r\n
                        caption: me.textLine\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-pie",\r\n
                        caption: me.textPie\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-hbar",\r\n
                        caption: me.textBar\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-area",\r\n
                        caption: me.textArea\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-scatter",\r\n
                        caption: me.textPoint\r\n
                    },\r\n
                    {\r\n
                        id: "menu-chart-group-stock",\r\n
                        caption: me.textStock\r\n
                    }]),\r\n
                    store: new Common.UI.DataViewStore([{\r\n
                        group: "menu-chart-group-bar",\r\n
                        type: c_oAscChartTypeSettings.barNormal,\r\n
                        iconCls: "column-normal",\r\n
                        selected: true\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-bar",\r\n
                        type: c_oAscChartTypeSettings.barStacked,\r\n
                        iconCls: "column-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-bar",\r\n
                        type: c_oAscChartTypeSettings.barStackedPer,\r\n
                        iconCls: "column-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-line",\r\n
                        type: c_oAscChartTypeSettings.lineNormal,\r\n
                        iconCls: "line-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-line",\r\n
                        type: c_oAscChartTypeSettings.lineStacked,\r\n
                        iconCls: "line-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-line",\r\n
                        type: c_oAscChartTypeSettings.lineStackedPer,\r\n
                        iconCls: "line-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-pie",\r\n
                        type: c_oAscChartTypeSettings.pie,\r\n
                        iconCls: "pie-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-pie",\r\n
                        type: c_oAscChartTypeSettings.doughnut,\r\n
                        iconCls: "pie-doughnut"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-hbar",\r\n
                        type: c_oAscChartTypeSettings.hBarNormal,\r\n
                        iconCls: "bar-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-hbar",\r\n
                        type: c_oAscChartTypeSettings.hBarStacked,\r\n
                        iconCls: "bar-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-hbar",\r\n
                        type: c_oAscChartTypeSettings.hBarStackedPer,\r\n
                        iconCls: "bar-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-area",\r\n
                        type: c_oAscChartTypeSettings.areaNormal,\r\n
                        iconCls: "area-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-area",\r\n
                        type: c_oAscChartTypeSettings.areaStacked,\r\n
                        iconCls: "area-stack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-area",\r\n
                        type: c_oAscChartTypeSettings.areaStackedPer,\r\n
                        iconCls: "area-pstack"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-scatter",\r\n
                        type: c_oAscChartTypeSettings.scatter,\r\n
                        iconCls: "point-normal"\r\n
                    },\r\n
                    {\r\n
                        group: "menu-chart-group-stock",\r\n
                        type: c_oAscChartTypeSettings.stock,\r\n
                        iconCls: "stock-normal"\r\n
                    }]),\r\n
                    itemTemplate: _.template(\'<div id="<%= id %>" class="item-chartlist <%= iconCls %>"></div>\')\r\n
                });\r\n
            });\r\n
            this.btnChartType.render($("#chart-button-type"));\r\n
            this.mnuChartTypePicker.on("item:click", _.bind(this.onSelectType, this, this.btnChartType));\r\n
            this.lockedControls.push(this.btnChartType);\r\n
            this.btnChartStyle = new Common.UI.Button({\r\n
                cls: "btn-large-dataview",\r\n
                iconCls: "item-wrap",\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tr-br",\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-chart-menu-style" style="width: 245px; margin: 0 5px;"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnChartStyle.on("render:after", function (btn) {\r\n
                me.mnuChartStylePicker = new Common.UI.DataView({\r\n
                    el: $("#id-chart-menu-style"),\r\n
                    style: "max-height: 411px;",\r\n
                    parentMenu: btn.menu,\r\n
                    store: new Common.UI.DataViewStore(),\r\n
                    itemTemplate: _.template(\'<div id="<%= id %>" class="item-wrap" style="background-image: url(<%= imageUrl %>); background-position: 0 0;"></div>\')\r\n
                });\r\n
                if (me.btnChartStyle.menu) {\r\n
                    me.btnChartStyle.menu.on("show:after", function () {\r\n
                        me.mnuChartStylePicker.scroller.update({\r\n
                            alwaysVisibleY: true\r\n
                        });\r\n
                    });\r\n
                }\r\n
            });\r\n
            this.btnChartStyle.render($("#chart-button-style"));\r\n
            this.mnuChartStylePicker.on("item:click", _.bind(this.onSelectStyle, this, this.btnChartStyle));\r\n
            this.lockedControls.push(this.btnChartStyle);\r\n
            this.spnWidth = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-spin-width"),\r\n
                step: 0.1,\r\n
                width: 78,\r\n
                defaultUnit: "cm",\r\n
                value: "3 cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnWidth);\r\n
            this.lockedControls.push(this.spnWidth);\r\n
            this.spnHeight = new Common.UI.MetricSpinner({\r\n
                el: $("#chart-spin-height"),\r\n
                step: 0.1,\r\n
                width: 78,\r\n
                defaultUnit: "cm",\r\n
                value: "3 cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnHeight);\r\n
            this.lockedControls.push(this.spnHeight);\r\n
            this.spnWidth.on("change", _.bind(this.onWidthChange, this));\r\n
            this.spnHeight.on("change", _.bind(this.onHeightChange, this));\r\n
            this.btnRatio = new Common.UI.Button({\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "advanced-btn-ratio",\r\n
                style: "margin-bottom: 1px;",\r\n
                enableToggle: true,\r\n
                hint: this.textKeepRatio\r\n
            });\r\n
            this.btnRatio.render($("#chart-button-ratio"));\r\n
            this.lockedControls.push(this.btnRatio);\r\n
            var value = window.localStorage.getItem("sse-settings-chartratio");\r\n
            if (value !== null && parseInt(value) == 1) {\r\n
                this.btnRatio.toggle(true);\r\n
            }\r\n
            this.btnRatio.on("click", _.bind(function (btn, e) {\r\n
                if (btn.pressed && this.spnHeight.getNumberValue() > 0) {\r\n
                    this._nRatio = this.spnWidth.getNumberValue() / this.spnHeight.getNumberValue();\r\n
                }\r\n
                window.localStorage.setItem("sse-settings-chartratio", (btn.pressed) ? 1 : 0);\r\n
            },\r\n
            this));\r\n
            $(this.el).on("click", "#chart-advanced-link", _.bind(this.openAdvancedSettings, this));\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            this.linkAdvanced = $("#chart-advanced-link");\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            if (this.api) {\r\n
                this.api.asc_registerCallback("asc_onUpdateChartStyles", _.bind(this._onUpdateChartStyles, this));\r\n
            }\r\n
            return this;\r\n
        },\r\n
        ChangeSettings: function (props) {\r\n
            if (this._initSettings) {\r\n
                this.createDelayedElements();\r\n
                this._initSettings = false;\r\n
            }\r\n
            this.disableControls(this._locked);\r\n
            if (this.api && props && props.asc_getChartProperties()) {\r\n
                this._originalProps = new Asc.asc_CImgProperty(props);\r\n
                this._noApply = true;\r\n
                this.chartProps = props.asc_getChartProperties();\r\n
                var value = props.asc_getSeveralCharts() || this._locked;\r\n
                if (this._state.SeveralCharts !== value) {\r\n
                    this.linkAdvanced.toggleClass("disabled", value);\r\n
                    this._state.SeveralCharts = value;\r\n
                }\r\n
                value = props.asc_getSeveralChartTypes();\r\n
                if (this._state.SeveralCharts && value) {\r\n
                    this.btnChartType.setIconCls("");\r\n
                    this._state.ChartType = null;\r\n
                } else {\r\n
                    var type = this.chartProps.getType();\r\n
                    if (this._state.ChartType !== type) {\r\n
                        var record = this.mnuChartTypePicker.store.findWhere({\r\n
                            type: type\r\n
                        });\r\n
                        this.mnuChartTypePicker.selectRecord(record, true);\r\n
                        if (record) {\r\n
                            this.btnChartType.setIconCls("item-chartlist " + record.get("iconCls"));\r\n
                        }\r\n
                        this.updateChartStyles(this.api.asc_getChartPreviews(type));\r\n
                        this._state.ChartType = type;\r\n
                    }\r\n
                }\r\n
                value = props.asc_getSeveralChartStyles();\r\n
                if (this._state.SeveralCharts && value) {\r\n
                    var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
                    btnIconEl.css("background-image", "none");\r\n
                    this.mnuChartStylePicker.selectRecord(null, true);\r\n
                    this._state.ChartStyle = null;\r\n
                } else {\r\n
                    value = this.chartProps.getStyle();\r\n
                    if (this._state.ChartStyle !== value) {\r\n
                        var record = this.mnuChartStylePicker.store.findWhere({\r\n
                            data: value\r\n
                        });\r\n
                        this.mnuChartStylePicker.selectRecord(record, true);\r\n
                        if (record) {\r\n
                            var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
                            btnIconEl.css("background-image", "url(" + record.get("imageUrl") + ")");\r\n
                        }\r\n
                        this._state.ChartStyle = value;\r\n
                    }\r\n
                }\r\n
                this._noApply = false;\r\n
                value = props.asc_getWidth();\r\n
                if (Math.abs(this._state.Width - value) > 0.001 || (this._state.Width === null || value === null) && (this._state.Width !== value)) {\r\n
                    this.spnWidth.setValue((value !== null) ? Common.Utils.Metric.fnRecalcFromMM(value) : "", true);\r\n
                    this._state.Width = value;\r\n
                }\r\n
                value = props.asc_getHeight();\r\n
                if (Math.abs(this._state.Height - value) > 0.001 || (this._state.Height === null || value === null) && (this._state.Height !== value)) {\r\n
                    this.spnHeight.setValue((value !== null) ? Common.Utils.Metric.fnRecalcFromMM(value) : "", true);\r\n
                    this._state.Height = value;\r\n
                }\r\n
                if (props.asc_getHeight() > 0) {\r\n
                    this._nRatio = props.asc_getWidth() / props.asc_getHeight();\r\n
                }\r\n
            }\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.1 : 1);\r\n
                }\r\n
            }\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            this.updateMetricUnit();\r\n
        },\r\n
        onWidthChange: function (field, newValue, oldValue, eOpts) {\r\n
            var w = field.getNumberValue();\r\n
            var h = this.spnHeight.getNumberValue();\r\n
            if (this.btnRatio.pressed) {\r\n
                h = w / this._nRatio;\r\n
                if (h > this.spnHeight.options.maxValue) {\r\n
                    h = this.spnHeight.options.maxValue;\r\n
                    w = h * this._nRatio;\r\n
                    this.spnWidth.setValue(w, true);\r\n
                }\r\n
                this.spnHeight.setValue(h, true);\r\n
            }\r\n
            if (this.api) {\r\n
                var props = new Asc.asc_CImgProperty();\r\n
                props.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(w));\r\n
                props.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(h));\r\n
                this.api.asc_setGraphicObjectProps(props);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onHeightChange: function (field, newValue, oldValue, eOpts) {\r\n
            var h = field.getNumberValue(),\r\n
            w = this.spnWidth.getNumberValue();\r\n
            if (this.btnRatio.pressed) {\r\n
                w = h * this._nRatio;\r\n
                if (w > this.spnWidth.options.maxValue) {\r\n
                    w = this.spnWidth.options.maxValue;\r\n
                    h = w / this._nRatio;\r\n
                    this.spnHeight.setValue(h, true);\r\n
                }\r\n
                this.spnWidth.setValue(w, true);\r\n
            }\r\n
            if (this.api) {\r\n
                var props = new Asc.asc_CImgProperty();\r\n
                props.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(w));\r\n
                props.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(h));\r\n
                this.api.asc_setGraphicObjectProps(props);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        openAdvancedSettings: function () {\r\n
            if (this.linkAdvanced.hasClass("disabled")) {\r\n
                return;\r\n
            }\r\n
            var me = this;\r\n
            var win, props;\r\n
            if (me.api) {\r\n
                props = me.api.asc_getChartObject();\r\n
                if (props) {\r\n
                    (new SSE.Views.ChartSettingsDlg({\r\n
                        chartSettings: props,\r\n
                        api: me.api,\r\n
                        handler: function (result, value) {\r\n
                            if (result == "ok") {\r\n
                                if (me.api) {\r\n
                                    me.api.asc_editChartDrawingObject(value.chartSettings);\r\n
                                }\r\n
                            }\r\n
                            Common.NotificationCenter.trigger("edit:complete", me);\r\n
                        }\r\n
                    })).show();\r\n
                }\r\n
            }\r\n
        },\r\n
        onSelectType: function (btn, picker, itemView, record) {\r\n
            if (this._noApply) {\r\n
                return;\r\n
            }\r\n
            var rawData = {},\r\n
            isPickerSelect = _.isFunction(record.toJSON);\r\n
            if (isPickerSelect) {\r\n
                if (record.get("selected")) {\r\n
                    rawData = record.toJSON();\r\n
                } else {\r\n
                    return;\r\n
                }\r\n
            } else {\r\n
                rawData = record;\r\n
            }\r\n
            this.btnChartType.setIconCls("item-chartlist " + rawData.iconCls);\r\n
            this._state.ChartType = -1;\r\n
            if (this.api && !this._noApply && this.chartProps) {\r\n
                var props = new Asc.asc_CImgProperty();\r\n
                this.chartProps.changeType(rawData.type);\r\n
                props.asc_putChartProperties(this.chartProps);\r\n
                this.api.asc_setGraphicObjectProps(props);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onSelectStyle: function (btn, picker, itemView, record) {\r\n
            if (this._noApply) {\r\n
                return;\r\n
            }\r\n
            var rawData = {},\r\n
            isPickerSelect = _.isFunction(record.toJSON);\r\n
            if (isPickerSelect) {\r\n
                if (record.get("selected")) {\r\n
                    rawData = record.toJSON();\r\n
                } else {\r\n
                    return;\r\n
                }\r\n
            } else {\r\n
                rawData = record;\r\n
            }\r\n
            var style = "url(" + rawData.imageUrl + ")";\r\n
            var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
            btnIconEl.css("background-image", style);\r\n
            if (this.api && !this._noApply && this.chartProps) {\r\n
                var props = new Asc.asc_CImgProperty();\r\n
                this.chartProps.putStyle(rawData.data);\r\n
                props.asc_putChartProperties(this.chartProps);\r\n
                this.api.asc_setGraphicObjectProps(props);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        _onUpdateChartStyles: function () {\r\n
            if (this.api && this._state.ChartType !== null && this._state.ChartType > -1) {\r\n
                this.updateChartStyles(this.api.asc_getChartPreviews(this._state.ChartType));\r\n
            }\r\n
        },\r\n
        updateChartStyles: function (styles) {\r\n
            var me = this;\r\n
            if (styles && styles.length > 0) {\r\n
                var stylesStore = this.mnuChartStylePicker.store;\r\n
                if (stylesStore) {\r\n
                    var stylearray = [],\r\n
                    selectedIdx = -1,\r\n
                    selectedUrl;\r\n
                    _.each(styles, function (item, index) {\r\n
                        stylearray.push({\r\n
                            imageUrl: item.asc_getImageUrl(),\r\n
                            data: item.asc_getStyle(),\r\n
                            tip: me.textStyle + " " + item.asc_getStyle()\r\n
                        });\r\n
                        if (me._state.ChartStyle == item.asc_getStyle()) {\r\n
                            selectedIdx = index;\r\n
                            selectedUrl = item.asc_getImageUrl();\r\n
                        }\r\n
                    });\r\n
                    stylesStore.reset(stylearray, {\r\n
                        silent: false\r\n
                    });\r\n
                }\r\n
            }\r\n
            this.mnuChartStylePicker.selectByIndex(selectedIdx, true);\r\n
            if (selectedIdx >= 0 && this.btnChartStyle.cmpEl) {\r\n
                var style = "url(" + selectedUrl + ")";\r\n
                var btnIconEl = this.btnChartStyle.cmpEl.find("span.btn-icon");\r\n
                btnIconEl.css("background-image", style);\r\n
            }\r\n
        },\r\n
        setLocked: function (locked) {\r\n
            this._locked = locked;\r\n
        },\r\n
        disableControls: function (disable) {\r\n
            if (this._state.DisabledControls !== disable) {\r\n
                this._state.DisabledControls = disable;\r\n
                _.each(this.lockedControls, function (item) {\r\n
                    item.setDisabled(disable);\r\n
                });\r\n
                this.linkAdvanced.toggleClass("disabled", disable);\r\n
            }\r\n
        },\r\n
        textKeepRatio: "Constant Proportions",\r\n
        textSize: "Size",\r\n
        textWidth: "Width",\r\n
        textHeight: "Height",\r\n
        textEditData: "Edit Data",\r\n
        textChartType: "Change Chart Type",\r\n
        textLine: "Line Chart",\r\n
        textColumn: "Column Chart",\r\n
        textBar: "Bar Chart",\r\n
        textArea: "Area Chart",\r\n
        textPie: "Pie Chart",\r\n
        textPoint: "Point Chart",\r\n
        textStock: "Stock Chart",\r\n
        textStyle: "Style",\r\n
        textAdvanced: "Show advanced settings"\r\n
    },\r\n
    SSE.Views.ChartSettings || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/ShapeSettings.template\',[],function () { return \'<table cols="1">\\r\\n    <tr>\\r\\n        <td>\\r\\n            <label class="header"><%= scope.strFill %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small">\\r\\n            <div id="shape-combo-fill-src" style="width: 100%;"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td>\\r\\n            <div id="shape-panel-color-fill" class="padding-small" style="width: 100%;">\\r\\n                <div id="shape-back-color-btn" style=""></div>\\r\\n            </div>\\r\\n            <div id="shape-panel-image-fill" class="settings-hidden padding-small" style="width: 100%;">\\r\\n                <table cols="2" style="width: 100%;">\\r\\n                <tr>\\r\\n                    <td class="padding-small" width="50%">\\r\\n                        <button type="button" class="btn btn-text-default" id="shape-button-from-file" style="width:90px;"><%= scope.textFromFile %></button>\\r\\n                    </td>\\r\\n                    <td class="padding-small" width="50%">\\r\\n                        <button type="button" class="btn btn-text-default" id="shape-button-from-url" style="width:90px;"><%= scope.textFromUrl %></button>\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr>\\r\\n                    <td style="vertical-align: top">\\r\\n                        <div id="shape-combo-fill-type" style="width: 90px;"></div>\\r\\n                    </td>\\r\\n                    <td rowspan="2">\\r\\n                        <div style="width: 90px; height: 80px; padding: 14px 20px; border: 1px solid #AFAFAF; border-radius: 2px; background: #ffffff;">\\r\\n                            <div id="shape-texture-img" style="width: 50px;height: 50px;"></div>\\r\\n                        </div>\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr>\\r\\n                    <td style="vertical-align: bottom">\\r\\n                        <label class="input-label" style=""><%= scope.textTexture %></label>\\r\\n                        <div id="shape-combo-fill-texture" style="width: 90px;"></div>\\r\\n                    </td>\\r\\n                </tr>\\r\\n            </table>\\r\\n            </div>\\r\\n            <div id="shape-panel-pattern-fill" class="settings-hidden padding-small" style="width: 100%;">\\r\\n                <label class="input-label" style="margin-top: 3px;"><%= scope.strPattern %></label>\\r\\n                <div id="shape-combo-pattern" style="width: 100%; height: 42px; margin-bottom: 8px;"></div>\\r\\n                <div style="width: 100%; height: 25px; margin-bottom: 8px;">\\r\\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strForeground %></label>\\r\\n                    <div id="shape-foreground-color-btn" style="display: inline-block; float:right;"></div>\\r\\n                </div>\\r\\n                <div style="width: 100%; height: 25px;">\\r\\n                    <label class="input-label" style="margin-top: 3px;"><%= scope.strBackground %></label>\\r\\n                    <div id="shape-background-color-btn" style="display: inline-block; float:right;"></div>\\r\\n                </div>\\r\\n            </div>\\r\\n            <div id="shape-panel-gradient-fill" class="settings-hidden padding-small" style="width: 100%;">\\r\\n                <div style="height:80px;">\\r\\n                    <div style="display: inline-block;">\\r\\n                        <label class="input-label" style=""><%= scope.textStyle %></label>\\r\\n                        <div id="shape-combo-grad-type" style="width: 90px;"></div>\\r\\n                    </div>\\r\\n                    <div style="display: inline-block;float: right;">\\r\\n                        <label class="input-label" style=""><%= scope.textDirection %></label>\\r\\n                        <div id="shape-button-direction" style=""></div>\\r\\n                    </div>\\r\\n                </div>\\r\\n                <label class="header" style="display:block;margin-bottom: 5px;"><%= scope.textGradient %></label>\\r\\n                <div style="display: inline-block; margin-top: 3px;">\\r\\n                    <div id="shape-slider-gradient" style="display: inline-block; vertical-align: middle;"></div>\\r\\n                </div>\\r\\n                <div id="shape-gradient-color-btn" style="display: inline-block;float: right;"></div>\\r\\n            </div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td>\\r\\n            <div class="padding-small" id="shape-panel-transparent-fill" style="width: 100%;">\\r\\n                <label class="header" style="display:block;"><%= scope.strTransparency %></label>\\r\\n                <div style="display: inline-block; margin-top: 3px;">\\r\\n                    <label id="shape-lbl-transparency-start">0</label>\\r\\n                    <div id="shape-slider-transparency" style="display: inline-block;margin: 0 4px; vertical-align: middle;"></div>\\r\\n                    <label id="shape-lbl-transparency-end">100</label>\\r\\n                </div>\\r\\n                <div id="shape-spin-transparency" style="display: inline-block;float: right;"></div>\\r\\n            </div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td class="padding-small">\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td>\\r\\n            <label class="header"><%= scope.strStroke %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr>\\r\\n        <td>\\r\\n        <div style="display:inline-block;width:100px;vertical-align: middle;">\\r\\n            <label class="input-label" style=""><%= scope.strSize %></label>\\r\\n            <div id="shape-combo-border-size" style="width: 93px;"></div>\\r\\n        </div>\\r\\n        <div style="display:inline-block;vertical-align: middle;">\\r\\n            <label class="input-label" style=""><%= scope.strColor %></label>\\r\\n            <div id="shape-border-color-btn" style=""></div>\\r\\n        </div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="shape-only">\\r\\n        <td class="padding-small"></td>\\r\\n    </tr>\\r\\n    <tr class="shape-only">\\r\\n        <td class="padding-small">\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="shape-only">\\r\\n        <td class="padding-small">\\r\\n            <label class="header" style="margin-top: 3px;"><%= scope.strChange %></label>\\r\\n            <div id="shape-btn-change" style="display: inline-block; float:right;"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="shape-only">\\r\\n        <td class="padding-small">\\r\\n            <div class="separator horizontal"></div>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="shape-only">\\r\\n        <td align="center">\\r\\n            <label class="link" id="shape-advanced-link"><%= scope.textAdvanced %></label>\\r\\n        </td>\\r\\n    </tr>\\r\\n    <tr class="finish-cell"></tr>\\r\\n</table>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ComboBorderSize\',["common/main/lib/component/ComboBox"], function () {\r\n
    Common.UI.BordersModel = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                value: null,\r\n
                displayValue: null,\r\n
                pxValue: null,\r\n
                id: Common.UI.getId(),\r\n
                offsety: undefined\r\n
            };\r\n
        }\r\n
    });\r\n
    Common.UI.BordersStore = Backbone.Collection.extend({\r\n
        model: Common.UI.BordersModel\r\n
    });\r\n
    Common.UI.ComboBorderSize = Common.UI.ComboBox.extend(_.extend({\r\n
        template: _.template([\'<div class="input-group combobox combo-border-size input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">\', \'<div class="form-control" style="<%= style %>"></div>\', \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>\', \'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">\', "<% _.each(items, function(item) { %>", \'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">\', "<span><%= item.displayValue %></span>", "<% if (item.offsety!==undefined) { %>", \'<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" align="right" style="background-position: 0 -<%= item.offsety %>px;">\', "<% } %>", "</a></li>", "<% }); %>", "</ul>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.ComboBox.prototype.initialize.call(this, _.extend({\r\n
                editable: false,\r\n
                store: new Common.UI.BordersStore(),\r\n
                data: [{\r\n
                    displayValue: this.txtNoBorders,\r\n
                    value: 0,\r\n
                    pxValue: 0\r\n
                },\r\n
                {\r\n
                    displayValue: "0.5 pt",\r\n
                    value: 0.5,\r\n
                    pxValue: 0.5,\r\n
                    offsety: 0\r\n
                },\r\n
                {\r\n
                    displayValue: "1 pt",\r\n
                    value: 1,\r\n
                    pxValue: 1,\r\n
                    offsety: 20\r\n
                },\r\n
                {\r\n
                    displayValue: "1.5 pt",\r\n
                    value: 1.5,\r\n
                    pxValue: 2,\r\n
                    offsety: 40\r\n
                },\r\n
                {\r\n
                    displayValue: "2.25 pt",\r\n
                    value: 2.25,\r\n
                    pxValue: 3,\r\n
                    offsety: 60\r\n
                },\r\n
                {\r\n
                    displayValue: "3 pt",\r\n
                    value: 3,\r\n
                    pxValue: 4,\r\n
                    offsety: 80\r\n
                },\r\n
                {\r\n
                    displayValue: "4.5 pt",\r\n
                    value: 4.5,\r\n
                    pxValue: 5,\r\n
                    offsety: 100\r\n
                },\r\n
                {\r\n
                    displayValue: "6 pt",\r\n
                    value: 6,\r\n
                    pxValue: 6,\r\n
                    offsety: 120\r\n
                }],\r\n
                menuStyle: "min-width: 150px;"\r\n
            },\r\n
            options));\r\n
        },\r\n
        render: function (parentEl) {\r\n
            Common.UI.ComboBox.prototype.render.call(this, parentEl);\r\n
            return this;\r\n
        },\r\n
        itemClicked: function (e) {\r\n
            var el = $(e.currentTarget).parent();\r\n
            this._selectedItem = this.store.findWhere({\r\n
                id: el.attr("id")\r\n
            });\r\n
            if (this._selectedItem) {\r\n
                $(".selected", $(this.el)).removeClass("selected");\r\n
                el.addClass("selected");\r\n
                this.updateFormControl(this._selectedItem);\r\n
                this.trigger("selected", this, _.extend({},\r\n
                this._selectedItem.toJSON()), e);\r\n
                e.preventDefault();\r\n
            }\r\n
        },\r\n
        updateFormControl: function (record) {\r\n
            var formcontrol = $(this.el).find(".form-control");\r\n
            if (record.get("value") > 0) {\r\n
                formcontrol[0].innerHTML = "";\r\n
                formcontrol.removeClass("text").addClass("image");\r\n
                formcontrol.css("background-position", "0 -" + record.get("offsety") + "px");\r\n
            } else {\r\n
                formcontrol[0].innerHTML = this.txtNoBorders;\r\n
                formcontrol.removeClass("image").addClass("text");\r\n
            }\r\n
        },\r\n
        setValue: function (value) {\r\n
            this._selectedItem = (value === null || value === undefined) ? undefined : _.find(this.store.models, function (item) {\r\n
                if (value < item.attributes.value + 0.01 && value > item.attributes.value - 0.01) {\r\n
                    return true;\r\n
                }\r\n
            });\r\n
            $(".selected", $(this.el)).removeClass("selected");\r\n
            if (this._selectedItem) {\r\n
                this.updateFormControl(this._selectedItem);\r\n
                $("#" + this._selectedItem.get("id"), $(this.el)).addClass("selected");\r\n
            } else {\r\n
                var formcontrol = $(this.el).find(".form-control");\r\n
                formcontrol[0].innerHTML = "";\r\n
                formcontrol.removeClass("image").addClass("text");\r\n
            }\r\n
        },\r\n
        txtNoBorders: "No Borders"\r\n
    },\r\n
    Common.UI.ComboBorderSize || {}));\r\n
    Common.UI.ComboBorderSizeEditable = Common.UI.ComboBox.extend(_.extend({\r\n
        template: _.template([\'<span class="input-group combobox combo-border-size-editable input-group-nr <%= cls %>" id="<%= id %>" style="<%= style %>">\', \'<input type="text" class="form-control">\', \'<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="caret"></span></button>\', \'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">\', "<% _.each(items, function(item) { %>", \'<li id="<%= item.id %>" data-value="<%= item.value %>"><a tabindex="-1" type="menuitem">\', "<span><%= item.displayValue %></span>", "<% if (item.offsety!==undefined) { %>", \'<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" align="right" style="background-position: 0 -<%= item.offsety %>px;">\', "<% } %>", "</a></li>", "<% }); %>", "</ul>", "</span>"].join("")),\r\n
        initialize: function (options) {\r\n
            this.txtNoBorders = options.txtNoBorders || this.txtNoBorders;\r\n
            Common.UI.ComboBox.prototype.initialize.call(this, _.extend({\r\n
                editable: true,\r\n
                store: new Common.UI.BordersStore(),\r\n
                data: [{\r\n
                    displayValue: this.txtNoBorders,\r\n
                    value: 0,\r\n
                    pxValue: 0\r\n
                },\r\n
                {\r\n
                    displayValue: "0.5 pt",\r\n
                    value: 0.5,\r\n
                    pxValue: 0.5,\r\n
                    offsety: 0\r\n
                },\r\n
                {\r\n
                    displayValue: "1 pt",\r\n
                    value: 1,\r\n
                    pxValue: 1,\r\n
                    offsety: 20\r\n
                },\r\n
                {\r\n
                    displayValue: "1.5 pt",\r\n
                    value: 1.5,\r\n
                    pxValue: 2,\r\n
                    offsety: 40\r\n
                },\r\n
                {\r\n
                    displayValue: "2.25 pt",\r\n
                    value: 2.25,\r\n
                    pxValue: 3,\r\n
                    offsety: 60\r\n
                },\r\n
                {\r\n
                    displayValue: "3 pt",\r\n
                    value: 3,\r\n
                    pxValue: 4,\r\n
                    offsety: 80\r\n
                },\r\n
                {\r\n
                    displayValue: "4.5 pt",\r\n
                    value: 4.5,\r\n
                    pxValue: 5,\r\n
                    offsety: 100\r\n
                },\r\n
                {\r\n
                    displayValue: "6 pt",\r\n
                    value: 6,\r\n
                    pxValue: 6,\r\n
                    offsety: 120\r\n
                }],\r\n
                menuStyle: "min-width: 150px;"\r\n
            },\r\n
            options));\r\n
        },\r\n
        render: function (parentEl) {\r\n
            Common.UI.ComboBox.prototype.render.call(this, parentEl);\r\n
            return this;\r\n
        },\r\n
        txtNoBorders: "No Borders"\r\n
    },\r\n
    Common.UI.ComboBorderSizeEditable || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/ColorButton\',["common/main/lib/component/Button"], function () {\r\n
    Common.UI.ColorButton = Common.UI.Button.extend({\r\n
        options: {\r\n
            hint: false,\r\n
            enableToggle: false\r\n
        },\r\n
        template: _.template([\'<div class="btn-group" id="<%= id %>">\', \'<button type="button" class="btn btn-color dropdown-toggle <%= cls %>" data-toggle="dropdown" style="<%= style %>">\', "<span>&nbsp;</span>", "</button>", "</div>"].join("")),\r\n
        setColor: function (color) {\r\n
            var border_color, clr, span = $(this.cmpEl).find("button span");\r\n
            this.color = color;\r\n
            if (color == "transparent") {\r\n
                border_color = "#BEBEBE";\r\n
                clr = color;\r\n
                span.addClass("transparent");\r\n
            } else {\r\n
                border_color = "transparent";\r\n
                clr = (typeof(color) == "object") ? "#" + color.color : "#" + color;\r\n
                span.removeClass("transparent");\r\n
            }\r\n
            span.css({\r\n
                "background-color": clr,\r\n
                "border-color": border_color\r\n
            });\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/Slider\',["common/main/lib/component/BaseView", "underscore"], function (base, _) {\r\n
    Common.UI.SingleSlider = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            width: 100,\r\n
            minValue: 0,\r\n
            maxValue: 100,\r\n
            step: 1,\r\n
            value: 100,\r\n
            enableKeyEvents: false\r\n
        },\r\n
        disabled: false,\r\n
        template: _.template([\'<div class="slider single-slider" style="">\', \'<div class="track">\', \'<div class="track-left"></div>\', \'<div class="track-center""></div>\', \'<div class="track-right" style=""></div>\', "</div>", \'<div class="thumb" style=""></div>\', "<% if (this.options.enableKeyEvents) { %>", \'<input type="text" style="position: absolute; top:-10px; width: 1px; height: 1px;">\', "<% } %>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            me.width = me.options.width;\r\n
            me.minValue = me.options.minValue;\r\n
            me.maxValue = me.options.maxValue;\r\n
            me.delta = 100 / (me.maxValue - me.minValue);\r\n
            me.step = me.options.step;\r\n
            if (me.options.el) {\r\n
                me.render();\r\n
            }\r\n
            this.setValue(me.options.value);\r\n
        },\r\n
        render: function (parentEl) {\r\n
            var me = this;\r\n
            if (!me.rendered) {\r\n
                this.cmpEl = $(this.template({}));\r\n
                if (parentEl) {\r\n
                    this.setElement(parentEl, false);\r\n
                    parentEl.html(this.cmpEl);\r\n
                } else {\r\n
                    $(this.el).html(this.cmpEl);\r\n
                }\r\n
            } else {\r\n
                this.cmpEl = $(this.el);\r\n
            }\r\n
            this.cmpEl.find(".track-center").width(me.options.width - 14);\r\n
            this.cmpEl.width(me.options.width);\r\n
            this.thumb = this.cmpEl.find(".thumb");\r\n
            var onMouseUp = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
                var pos = Math.max(0, Math.min(100, (Math.round((e.pageX - me.cmpEl.offset().left - me._dragstart) / me.width * 100))));\r\n
                me.setThumbPosition(pos);\r\n
                me.lastValue = me.value;\r\n
                me.value = pos / me.delta + me.minValue;\r\n
                me.thumb.removeClass("active");\r\n
                $(document).off("mouseup", onMouseUp);\r\n
                $(document).off("mousemove", onMouseMove);\r\n
                me._dragstart = undefined;\r\n
                me.trigger("changecomplete", me, me.value, me.lastValue);\r\n
            };\r\n
            var onMouseMove = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                if (me._dragstart === undefined) {\r\n
                    return;\r\n
                }\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
                var pos = Math.max(0, Math.min(100, (Math.round((e.pageX - me.cmpEl.offset().left - me._dragstart) / me.width * 100))));\r\n
                me.setThumbPosition(pos);\r\n
                me.lastValue = me.value;\r\n
                me.value = pos / me.delta + me.minValue;\r\n
                if (Math.abs(me.value - me.lastValue) > 0.001) {\r\n
                    me.trigger("change", me, me.value, me.lastValue);\r\n
                }\r\n
            };\r\n
            var onMouseDown = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                me._dragstart = e.pageX - me.thumb.offset().left - 7;\r\n
                me.thumb.addClass("active");\r\n
                $(document).on("mouseup", onMouseUp);\r\n
                $(document).on("mousemove", onMouseMove);\r\n
                if (me.options.enableKeyEvents) {\r\n
                    setTimeout(function () {\r\n
                        me.input.focus();\r\n
                    },\r\n
                    10);\r\n
                }\r\n
            };\r\n
            var onTrackMouseDown = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                var pos = Math.max(0, Math.min(100, (Math.round((e.pageX - me.cmpEl.offset().left) / me.width * 100))));\r\n
                me.setThumbPosition(pos);\r\n
                me.lastValue = me.value;\r\n
                me.value = pos / me.delta + me.minValue;\r\n
                me.trigger("change", me, me.value, me.lastValue);\r\n
                me.trigger("changecomplete", me, me.value, me.lastValue);\r\n
            };\r\n
            var updateslider;\r\n
            var moveThumb = function (increase) {\r\n
                me.lastValue = me.value;\r\n
                me.value = Math.max(me.minValue, Math.min(me.maxValue, me.value + ((increase) ? me.step : -me.step)));\r\n
                me.setThumbPosition(Math.round((me.value - me.minValue) * me.delta));\r\n
                me.trigger("change", me, me.value, me.lastValue);\r\n
            };\r\n
            var onKeyDown = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                if (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN || e.keyCode == Common.UI.Keys.LEFT || e.keyCode == Common.UI.Keys.RIGHT) {\r\n
                    e.preventDefault();\r\n
                    e.stopPropagation();\r\n
                    el.off("keydown", "input", onKeyDown);\r\n
                    updateslider = setInterval(_.bind(moveThumb, me, e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.RIGHT), 100);\r\n
                }\r\n
            };\r\n
            var onKeyUp = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                if (e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.DOWN || Common.UI.Keys.LEFT || Common.UI.Keys.RIGHT) {\r\n
                    e.stopPropagation();\r\n
                    e.preventDefault();\r\n
                    clearInterval(updateslider);\r\n
                    moveThumb(e.keyCode == Common.UI.Keys.UP || e.keyCode == Common.UI.Keys.RIGHT);\r\n
                    el.on("keydown", "input", onKeyDown);\r\n
                    me.trigger("changecomplete", me, me.value, me.lastValue);\r\n
                }\r\n
            };\r\n
            if (!me.rendered) {\r\n
                var el = me.cmpEl;\r\n
                el.on("mousedown", ".thumb", onMouseDown);\r\n
                el.on("mousedown", ".track", onTrackMouseDown);\r\n
                if (this.options.enableKeyEvents) {\r\n
                    el.on("keydown", "input", onKeyDown);\r\n
                    el.on("keyup", "input", onKeyUp);\r\n
                }\r\n
            }\r\n
            me.rendered = true;\r\n
            return this;\r\n
        },\r\n
        setThumbPosition: function (x) {\r\n
            this.thumb.css({\r\n
                left: x + "%"\r\n
            });\r\n
        },\r\n
        setValue: function (value) {\r\n
            this.lastValue = this.value;\r\n
            this.value = Math.max(this.minValue, Math.min(this.maxValue, value));\r\n
            this.setThumbPosition(Math.round((value - this.minValue) * this.delta));\r\n
        },\r\n
        getValue: function () {\r\n
            return this.value;\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            if (disabled !== this.disabled) {\r\n
                this.cmpEl.toggleClass("disabled", disabled);\r\n
            }\r\n
            this.disabled = disabled;\r\n
        }\r\n
    });\r\n
    Common.UI.MultiSlider = Common.UI.BaseView.extend({\r\n
        options: {\r\n
            width: 100,\r\n
            minValue: 0,\r\n
            maxValue: 100,\r\n
            values: [0, 100]\r\n
        },\r\n
        disabled: false,\r\n
        template: _.template([\'<div class="slider multi-slider">\', \'<div class="track">\', \'<div class="track-left"></div>\', \'<div class="track-center""></div>\', \'<div class="track-right" style=""></div>\', "</div>", "<% _.each(items, function(item) { %>", \'<div class="thumb" style=""></div>\', "<% }); %>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
          

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABg=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="24" aka="AAAAAAAAABg=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

  Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            var me = this,\r\n
            el = $(this.el);\r\n
            me.width = me.options.width;\r\n
            me.minValue = me.options.minValue;\r\n
            me.maxValue = me.options.maxValue;\r\n
            me.delta = 100 / (me.maxValue - me.minValue);\r\n
            me.thumbs = [];\r\n
            if (me.options.el) {\r\n
                me.render();\r\n
            }\r\n
        },\r\n
        render: function (parentEl) {\r\n
            var me = this;\r\n
            if (!me.rendered) {\r\n
                this.cmpEl = $(this.template({\r\n
                    items: this.options.values\r\n
                }));\r\n
                if (parentEl) {\r\n
                    this.setElement(parentEl, false);\r\n
                    parentEl.html(this.cmpEl);\r\n
                } else {\r\n
                    $(this.el).html(this.cmpEl);\r\n
                }\r\n
            } else {\r\n
                this.cmpEl = $(this.el);\r\n
            }\r\n
            var el = this.cmpEl;\r\n
            el.find(".track-center").width(me.options.width - 14);\r\n
            el.width(me.options.width);\r\n
            var onMouseUp = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
                var index = e.data,\r\n
                lastValue = me.thumbs[index].value,\r\n
                minValue = (index - 1 < 0) ? 0 : me.thumbs[index - 1].position,\r\n
                maxValue = (index + 1 < me.thumbs.length) ? me.thumbs[index + 1].position : 100,\r\n
                pos = Math.max(minValue, Math.min(maxValue, (Math.round((e.pageX - me.cmpEl.offset().left - me._dragstart) / me.width * 100)))),\r\n
                value = pos / me.delta + me.minValue;\r\n
                me.setThumbPosition(index, pos);\r\n
                me.thumbs[index].value = value;\r\n
                $(document).off("mouseup", onMouseUp);\r\n
                $(document).off("mousemove", onMouseMove);\r\n
                me._dragstart = undefined;\r\n
                me.trigger("changecomplete", me, value, lastValue);\r\n
            };\r\n
            var onMouseMove = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                if (me._dragstart === undefined) {\r\n
                    return;\r\n
                }\r\n
                e.preventDefault();\r\n
                e.stopPropagation();\r\n
                var index = e.data,\r\n
                lastValue = me.thumbs[index].value,\r\n
                minValue = (index - 1 < 0) ? 0 : me.thumbs[index - 1].position,\r\n
                maxValue = (index + 1 < me.thumbs.length) ? me.thumbs[index + 1].position : 100,\r\n
                pos = Math.max(minValue, Math.min(maxValue, (Math.round((e.pageX - me.cmpEl.offset().left - me._dragstart) / me.width * 100)))),\r\n
                value = pos / me.delta + me.minValue;\r\n
                me.setThumbPosition(index, pos);\r\n
                me.thumbs[index].value = value;\r\n
                if (Math.abs(value - lastValue) > 0.001) {\r\n
                    me.trigger("change", me, value, lastValue);\r\n
                }\r\n
            };\r\n
            var onMouseDown = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                var index = e.data,\r\n
                thumb = me.thumbs[index].thumb;\r\n
                me._dragstart = e.pageX - thumb.offset().left - thumb.width() / 2;\r\n
                me.setActiveThumb(index);\r\n
                _.each(me.thumbs, function (item, idx) {\r\n
                    (index == idx) ? item.thumb.css("z-index", 500) : item.thumb.css("z-index", "");\r\n
                });\r\n
                $(document).on("mouseup", null, index, onMouseUp);\r\n
                $(document).on("mousemove", null, index, onMouseMove);\r\n
            };\r\n
            var onTrackMouseDown = function (e) {\r\n
                if (me.disabled) {\r\n
                    return;\r\n
                }\r\n
                var pos = Math.max(0, Math.min(100, (Math.round((e.pageX - me.cmpEl.offset().left) / me.width * 100)))),\r\n
                index = findThumb(pos),\r\n
                lastValue = me.thumbs[index].value,\r\n
                value = pos / me.delta + me.minValue;\r\n
                me.setThumbPosition(index, pos);\r\n
                me.thumbs[index].value = value;\r\n
                me.trigger("change", me, value, lastValue);\r\n
                me.trigger("changecomplete", me, value, lastValue);\r\n
            };\r\n
            var findThumb = function (pos) {\r\n
                var nearest = 100,\r\n
                index = 0,\r\n
                len = me.thumbs.length,\r\n
                dist;\r\n
                for (var i = 0; i < len; i++) {\r\n
                    dist = Math.abs(me.thumbs[i].position - pos);\r\n
                    if (Math.abs(dist <= nearest)) {\r\n
                        var above = me.thumbs[i + 1];\r\n
                        var below = me.thumbs[i - 1];\r\n
                        if (below !== undefined && pos < below.position) {\r\n
                            continue;\r\n
                        }\r\n
                        if (above !== undefined && pos > above.position) {\r\n
                            continue;\r\n
                        }\r\n
                        index = i;\r\n
                        nearest = dist;\r\n
                    }\r\n
                }\r\n
                return index;\r\n
            };\r\n
            this.$thumbs = el.find(".thumb");\r\n
            _.each(this.$thumbs, function (item, index) {\r\n
                var thumb = $(item);\r\n
                me.thumbs.push({\r\n
                    thumb: thumb,\r\n
                    index: index\r\n
                });\r\n
                me.setValue(index, me.options.values[index]);\r\n
                thumb.on("mousedown", null, index, onMouseDown);\r\n
            });\r\n
            me.setActiveThumb(0, true);\r\n
            if (!me.rendered) {\r\n
                el.on("mousedown", ".track", onTrackMouseDown);\r\n
            }\r\n
            me.rendered = true;\r\n
            return this;\r\n
        },\r\n
        setActiveThumb: function (index, suspend) {\r\n
            this.currentThumb = index;\r\n
            this.$thumbs.removeClass("active");\r\n
            this.thumbs[index].thumb.addClass("active");\r\n
            if (suspend !== true) {\r\n
                this.trigger("thumbclick", this, index);\r\n
            }\r\n
        },\r\n
        setThumbPosition: function (index, x) {\r\n
            this.thumbs[index].position = x;\r\n
            this.thumbs[index].thumb.css({\r\n
                left: x + "%"\r\n
            });\r\n
        },\r\n
        setValue: function (index, value) {\r\n
            this.thumbs[index].value = Math.max(this.minValue, Math.min(this.maxValue, value));\r\n
            this.setThumbPosition(index, Math.round((value - this.minValue) * this.delta));\r\n
        },\r\n
        getValue: function (index) {\r\n
            return this.thumbs[index].value;\r\n
        },\r\n
        getValues: function () {\r\n
            var values = [];\r\n
            _.each(this.thumbs, function (thumb) {\r\n
                values.push(thumb.value);\r\n
            });\r\n
            return values;\r\n
        },\r\n
        setDisabled: function (disabled) {\r\n
            if (disabled !== this.disabled) {\r\n
                this.cmpEl.toggleClass("disabled", disabled);\r\n
            }\r\n
            this.disabled = disabled;\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/MultiSliderGradient\',["common/main/lib/component/Slider", "underscore"], function (base, _) {\r\n
    Common.UI.MultiSliderGradient = Common.UI.MultiSlider.extend({\r\n
        options: {\r\n
            width: 100,\r\n
            minValue: 0,\r\n
            maxValue: 100,\r\n
            values: [0, 100],\r\n
            colorValues: ["#000000", "#ffffff"],\r\n
            currentThumb: 0\r\n
        },\r\n
        disabled: false,\r\n
        template: _.template([\'<div class="slider multi-slider-gradient">\', \'<div class="track"></div>\', "<% _.each(items, function(item) { %>", \'<div class="thumb" style=""></div>\', "<% }); %>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            this.styleStr = "";\r\n
            if (Common.Utils.isChrome && Common.Utils.chromeVersion < 10 || Common.Utils.isSafari && Common.Utils.safariVersion < 5.1) {\r\n
                this.styleStr = "-webkit-gradient(linear, left top, right top, color-stop({1}%,{0}), color-stop({3}%,{2})); /* Chrome,Safari4+ */";\r\n
            } else {\r\n
                if (Common.Utils.isChrome || Common.Utils.isSafari) {\r\n
                    this.styleStr = "-webkit-linear-gradient(left, {0} {1}%, {2} {3}%)";\r\n
                } else {\r\n
                    if (Common.Utils.isGecko) {\r\n
                        this.styleStr = "-moz-linear-gradient(left, {0} {1}%, {2} {3}%)";\r\n
                    } else {\r\n
                        if (Common.Utils.isOpera && Common.Utils.operaVersion > 11) {\r\n
                            this.styleStr = "-o-linear-gradient(left, {0} {1}%, {2} {3}%)";\r\n
                        } else {\r\n
                            if (Common.Utils.isIE) {\r\n
                                this.styleStr = "-ms-linear-gradient(left, {0} {1}%, {2} {3}%)";\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            this.colorValues = this.options.colorValues;\r\n
            Common.UI.MultiSlider.prototype.initialize.call(this, options);\r\n
        },\r\n
        render: function (parentEl) {\r\n
            Common.UI.MultiSlider.prototype.render.call(this, parentEl);\r\n
            var me = this,\r\n
            style = "";\r\n
            me.trackEl = me.cmpEl.find(".track");\r\n
            for (var i = 0; i < me.thumbs.length; i++) {\r\n
                me.thumbs[i].thumb.on("dblclick", null, function () {\r\n
                    me.trigger("thumbdblclick", me);\r\n
                });\r\n
            }\r\n
            if (me.styleStr !== "") {\r\n
                style = Common.Utils.String.format(me.styleStr, me.colorValues[0], 0, me.colorValues[1], 100);\r\n
                me.trackEl.css("background", style);\r\n
            }\r\n
            if (Common.Utils.isIE) {\r\n
                style = Common.Utils.String.format("progid:DXImageTransform.Microsoft.gradient( startColorstr={0}, endColorstr={1},GradientType=1 )", me.colorValues[0], me.colorValues[1]);\r\n
                me.trackEl.css("filter", style);\r\n
            }\r\n
            style = Common.Utils.String.format("linear-gradient(to right, {0} {1}%, {2} {3}%)", me.colorValues[0], 0, me.colorValues[1], 100);\r\n
            me.trackEl.css("background", style);\r\n
            me.on("change", _.bind(me.changeGradientStyle, me));\r\n
        },\r\n
        setColorValue: function (color, index) {\r\n
            var ind = (index !== undefined) ? index : this.currentThumb;\r\n
            this.colorValues[ind] = color;\r\n
            this.changeGradientStyle();\r\n
        },\r\n
        getColorValue: function (index) {\r\n
            var ind = (index !== undefined) ? index : this.currentThumb;\r\n
            return this.colorValues[ind];\r\n
        },\r\n
        setValue: function (index, value) {\r\n
            Common.UI.MultiSlider.prototype.setValue.call(this, index, value);\r\n
            this.changeGradientStyle();\r\n
        },\r\n
        changeGradientStyle: function () {\r\n
            if (!this.rendered) {\r\n
                return;\r\n
            }\r\n
            var style;\r\n
            if (this.styleStr !== "") {\r\n
                style = Common.Utils.String.format(this.styleStr, this.colorValues[0], this.getValue(0), this.colorValues[1], this.getValue(1));\r\n
                this.trackEl.css("background", style);\r\n
            }\r\n
            if (Common.Utils.isIE) {\r\n
                style = Common.Utils.String.format("progid:DXImageTransform.Microsoft.gradient( startColorstr={0}, endColorstr={1},GradientType=1 )", this.colorValues[0], this.colorValues[1]);\r\n
                this.trackEl.css("filter", style);\r\n
            }\r\n
            style = Common.Utils.String.format("linear-gradient(to right, {0} {1}%, {2} {3}%)", this.colorValues[0], this.getValue(0), this.colorValues[1], this.getValue(1));\r\n
            this.trackEl.css("background", style);\r\n
        }\r\n
    });\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/ShapeSettingsAdvanced.template\',[],function () { return \'<div id="id-adv-shape-width" class="settings-panel active">\\r\\n    <div class="inner-content">\\r\\n    <table cols="3">\\r\\n        <tr>\\r\\n            <td width="108px">\\r\\n                <label class="input-label"><%= scope.textWidth %></label>\\r\\n                <div id="shape-advanced-spin-width"></div>\\r\\n            </td>\\r\\n            <td width="28px" style="vertical-align: bottom;">\\r\\n                <div id="shape-advanced-button-ratio"></div>\\r\\n            </td>\\r\\n            <td width="108px">\\r\\n                <label class="input-label"><%= scope.textHeight %></label>\\r\\n                <div id="shape-advanced-spin-height"></div>\\r\\n            </td>\\r\\n        </tr>\\r\\n    </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-adv-shape-shape" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textLineStyle %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-large" width="125px">\\r\\n                    <label class="input-label"><%= scope.textCapType %></label>\\r\\n                    <div id="shape-advanced-cap-type" style="width: 100px;"></div>\\r\\n                </td>\\r\\n                <td class="padding-large">\\r\\n                    <label class="input-label"><%= scope.textJoinType %></label>\\r\\n                    <div id="shape-advanced-join-type" style="width: 100px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"></div>\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td colspan=2 class="padding-small">\\r\\n                    <label class="header"><%= scope.textArrows %></label>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small" width="125px">\\r\\n                    <label class="input-label"><%= scope.textBeginStyle %></label>\\r\\n                    <div id="shape-advanced-begin-style" style="width: 100px;"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textEndStyle %></label>\\r\\n                    <div id="shape-advanced-end-style" style="width: 100px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textBeginSize %></label>\\r\\n                    <div id="shape-advanced-begin-size" style="width: 100px;"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textEndSize %></label>\\r\\n                    <div id="shape-advanced-end-size" style="width: 100px;"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\\r\\n<div id="id-adv-shape-margins" class="settings-panel">\\r\\n    <div class="inner-content">\\r\\n        <table cols="2" style="width: 100%;">\\r\\n            <tr>\\r\\n                <td class="padding-small" width="125px">\\r\\n                    <label class="input-label"><%= scope.textTop %></label>\\r\\n                    <div id="shape-margin-top"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textLeft %></label>\\r\\n                    <div id="shape-margin-left"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textBottom %></label>\\r\\n                    <div id="shape-margin-bottom"></div>\\r\\n                </td>\\r\\n                <td class="padding-small">\\r\\n                    <label class="input-label"><%= scope.textRight %></label>\\r\\n                    <div id="shape-margin-right"></div>\\r\\n                </td>\\r\\n            </tr>\\r\\n        </table>\\r\\n    </div>\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/ShapeSettingsAdvanced\',["text!spreadsheeteditor/main/app/template/ShapeSettingsAdvanced.template", "common/main/lib/view/AdvancedSettingsWindow", "common/main/lib/component/ComboBox", "common/main/lib/component/MetricSpinner"], function (contentTemplate) {\r\n
    SSE.Views.ShapeSettingsAdvanced = Common.Views.AdvancedSettingsWindow.extend(_.extend({\r\n
        options: {\r\n
            contentWidth: 300,\r\n
            height: 332,\r\n
            toggleGroup: "shape-adv-settings-group",\r\n
            sizeOriginal: {\r\n
                width: 0,\r\n
                height: 0\r\n
            },\r\n
            sizeMax: {\r\n
                width: 55.88,\r\n
                height: 55.88\r\n
            },\r\n
            properties: null\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle,\r\n
                items: [{\r\n
                    panelId: "id-adv-shape-width",\r\n
                    panelCaption: this.textSize\r\n
                },\r\n
                {\r\n
                    panelId: "id-adv-shape-shape",\r\n
                    panelCaption: this.textWeightArrows\r\n
                },\r\n
                {\r\n
                    panelId: "id-adv-shape-margins",\r\n
                    panelCaption: this.strMargins\r\n
                }],\r\n
                contentTemplate: _.template(contentTemplate)({\r\n
                    scope: this\r\n
                })\r\n
            },\r\n
            options);\r\n
            Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this, this.options);\r\n
            this.spinners = [];\r\n
            this.Margins = undefined;\r\n
            this._nRatio = 1;\r\n
            this._originalProps = this.options.shapeProps;\r\n
            this._changedProps = null;\r\n
        },\r\n
        render: function () {\r\n
            Common.Views.AdvancedSettingsWindow.prototype.render.call(this);\r\n
            var me = this;\r\n
            this.spnWidth = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-advanced-spin-width"),\r\n
                step: 0.1,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                value: "3 cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0\r\n
            });\r\n
            this.spnWidth.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this.btnRatio.pressed) {\r\n
                    var w = field.getNumberValue();\r\n
                    var h = w / this._nRatio;\r\n
                    if (h > this.spnHeight.options.maxValue) {\r\n
                        h = this.spnHeight.options.maxValue;\r\n
                        w = h * this._nRatio;\r\n
                        this.spnWidth.setValue(w, true);\r\n
                    }\r\n
                    this.spnHeight.setValue(h, true);\r\n
                }\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                    this._changedProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(this.spnHeight.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.spnWidth);\r\n
            this.spnHeight = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-advanced-spin-height"),\r\n
                step: 0.1,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                value: "3 cm",\r\n
                maxValue: 55.88,\r\n
                minValue: 0\r\n
            });\r\n
            this.spnHeight.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                var h = field.getNumberValue(),\r\n
                w = null;\r\n
                if (this.btnRatio.pressed) {\r\n
                    w = h * this._nRatio;\r\n
                    if (w > this.spnWidth.options.maxValue) {\r\n
                        w = this.spnWidth.options.maxValue;\r\n
                        h = w / this._nRatio;\r\n
                        this.spnHeight.setValue(h, true);\r\n
                    }\r\n
                    this.spnWidth.setValue(w, true);\r\n
                }\r\n
                if (this._changedProps) {\r\n
                    this._changedProps.asc_putHeight(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                    this._changedProps.asc_putWidth(Common.Utils.Metric.fnRecalcToMM(this.spnWidth.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.spnHeight);\r\n
            this.btnRatio = new Common.UI.Button({\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "advanced-btn-ratio",\r\n
                style: "margin-bottom: 1px;",\r\n
                enableToggle: true,\r\n
                hint: this.textKeepRatio\r\n
            });\r\n
            this.btnRatio.render($("#shape-advanced-button-ratio"));\r\n
            this.btnRatio.on("click", _.bind(function (btn, e) {\r\n
                if (btn.pressed && this.spnHeight.getNumberValue() > 0) {\r\n
                    this._nRatio = this.spnWidth.getNumberValue() / this.spnHeight.getNumberValue();\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spnMarginTop = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-margin-top"),\r\n
                step: 0.1,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                value: "0 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: 0\r\n
            });\r\n
            this.spnMarginTop.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                        this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                    }\r\n
                    if (this._changedProps.asc_getShapeProperties().asc_getPaddings() === null) {\r\n
                        this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings());\r\n
                    }\r\n
                    this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putTop(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.spnMarginTop);\r\n
            this.spnMarginBottom = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-margin-bottom"),\r\n
                step: 0.1,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                value: "0 cm",\r\n
                maxValue: 55.87,\r\n
                minValue: 0\r\n
            });\r\n
            this.spnMarginBottom.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                        this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                    }\r\n
                    if (this._changedProps.asc_getShapeProperties().asc_getPaddings() === null) {\r\n
                        this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings());\r\n
                    }\r\n
                    this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putBottom(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.spnMarginBottom);\r\n
            this.spnMarginLeft = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-margin-left"),\r\n
                step: 0.1,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                value: "0.19 cm",\r\n
                maxValue: 9.34,\r\n
                minValue: 0\r\n
            });\r\n
            this.spnMarginLeft.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                        this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                    }\r\n
                    if (this._changedProps.asc_getShapeProperties().asc_getPaddings() === null) {\r\n
                        this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings());\r\n
                    }\r\n
                    this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putLeft(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.spnMarginLeft);\r\n
            this.spnMarginRight = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-margin-right"),\r\n
                step: 0.1,\r\n
                width: 100,\r\n
                defaultUnit: "cm",\r\n
                value: "0.19 cm",\r\n
                maxValue: 9.34,\r\n
                minValue: 0\r\n
            });\r\n
            this.spnMarginRight.on("change", _.bind(function (field, newValue, oldValue, eOpts) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                        this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                    }\r\n
                    if (this._changedProps.asc_getShapeProperties().asc_getPaddings() === null) {\r\n
                        this._changedProps.asc_getShapeProperties().asc_putPaddings(new Asc.asc_CPaddings());\r\n
                    }\r\n
                    this._changedProps.asc_getShapeProperties().asc_getPaddings().asc_putRight(Common.Utils.Metric.fnRecalcToMM(field.getNumberValue()));\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.spinners.push(this.spnMarginRight);\r\n
            this._arrCapType = [{\r\n
                displayValue: this.textFlat,\r\n
                value: c_oAscLineCapType.Flat\r\n
            },\r\n
            {\r\n
                displayValue: this.textRound,\r\n
                value: c_oAscLineCapType.Round\r\n
            },\r\n
            {\r\n
                displayValue: this.textSquare,\r\n
                value: c_oAscLineCapType.Square\r\n
            }];\r\n
            this.cmbCapType = new Common.UI.ComboBox({\r\n
                el: $("#shape-advanced-cap-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 100px;",\r\n
                editable: false,\r\n
                data: this._arrCapType\r\n
            });\r\n
            this.cmbCapType.setValue(c_oAscLineCapType.Flat);\r\n
            this.cmbCapType.on("selected", _.bind(function (combo, record) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                        this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                    }\r\n
                    if (this._changedProps.asc_getShapeProperties().asc_getStroke() === null) {\r\n
                        this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke());\r\n
                    }\r\n
                    this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinecap(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            this._arrJoinType = [{\r\n
                displayValue: this.textRound,\r\n
                value: c_oAscLineJoinType.Round\r\n
            },\r\n
            {\r\n
                displayValue: this.textBevel,\r\n
                value: c_oAscLineJoinType.Bevel\r\n
            },\r\n
            {\r\n
                displayValue: this.textMiter,\r\n
                value: c_oAscLineJoinType.Miter\r\n
            }];\r\n
            this.cmbJoinType = new Common.UI.ComboBox({\r\n
                el: $("#shape-advanced-join-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 100px;",\r\n
                editable: false,\r\n
                data: this._arrJoinType\r\n
            });\r\n
            this.cmbJoinType.setValue(c_oAscLineJoinType.Round);\r\n
            this.cmbJoinType.on("selected", _.bind(function (combo, record) {\r\n
                if (this._changedProps) {\r\n
                    if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                        this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                    }\r\n
                    if (this._changedProps.asc_getShapeProperties().asc_getStroke() === null) {\r\n
                        this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke());\r\n
                    }\r\n
                    this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinejoin(record.value);\r\n
                }\r\n
            },\r\n
            this));\r\n
            var _arrStyles = [],\r\n
            _arrSize = [];\r\n
            for (var i = 0; i < 6; i++) {\r\n
                _arrStyles.push({\r\n
                    value: i,\r\n
                    offsetx: 80 * i + 10,\r\n
                    offsety: 0\r\n
                });\r\n
            }\r\n
            _arrStyles[0].type = c_oAscLineBeginType.None;\r\n
            _arrStyles[1].type = c_oAscLineBeginType.Triangle;\r\n
            _arrStyles[2].type = c_oAscLineBeginType.Arrow;\r\n
            _arrStyles[3].type = c_oAscLineBeginType.Stealth;\r\n
            _arrStyles[4].type = c_oAscLineBeginType.Diamond;\r\n
            _arrStyles[5].type = c_oAscLineBeginType.Oval;\r\n
            for (i = 0; i < 9; i++) {\r\n
                _arrSize.push({\r\n
                    value: i,\r\n
                    offsetx: 80 + 10,\r\n
                    offsety: 20 * (i + 1)\r\n
                });\r\n
            }\r\n
            _arrSize[0].type = c_oAscLineBeginSize.small_small;\r\n
            _arrSize[1].type = c_oAscLineBeginSize.small_mid;\r\n
            _arrSize[2].type = c_oAscLineBeginSize.small_large;\r\n
            _arrSize[3].type = c_oAscLineBeginSize.mid_small;\r\n
            _arrSize[4].type = c_oAscLineBeginSize.mid_mid;\r\n
            _arrSize[5].type = c_oAscLineBeginSize.mid_large;\r\n
            _arrSize[6].type = c_oAscLineBeginSize.large_small;\r\n
            _arrSize[7].type = c_oAscLineBeginSize.large_mid;\r\n
            _arrSize[8].type = c_oAscLineBeginSize.large_large;\r\n
            this.btnBeginStyle = new Common.UI.ComboBox({\r\n
                el: $("#shape-advanced-begin-style"),\r\n
                template: _.template([\'<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">\', \'<div class="form-control image" style="width: 100px;"></div>\', \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default"><span class="caret"></span></button>\', "</div>"].join(""))\r\n
            });\r\n
            (new Common.UI.Menu({\r\n
                style: "min-width: 105px;",\r\n
                items: [{\r\n
                    template: _.template(\'<div id="shape-advanced-menu-begin-style" style="width: 105px; margin: 0 5px;"></div>\')\r\n
                }]\r\n
            })).render($("#shape-advanced-begin-style"));\r\n
            this.mnuBeginStylePicker = new Common.UI.DataView({\r\n
                el: $("#shape-advanced-menu-begin-style"),\r\n
                parentMenu: me.btnBeginStyle.menu,\r\n
                store: new Common.UI.DataViewStore(_arrStyles),\r\n
                itemTemplate: _.template(\'<div id="<%= id %>" class="item-arrow" style="background-position: -<%= offsetx %>px -<%= offsety %>px;"></div>\')\r\n
            });\r\n
            this.mnuBeginStylePicker.on("item:click", _.bind(this.onSelectBeginStyle, this));\r\n
            this._selectStyleItem(this.btnBeginStyle, null);\r\n
            this.btnBeginSize = new Common.UI.ComboBox({\r\n
                el: $("#shape-advanced-begin-size"),\r\n
                template: _.template([\'<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">\', \'<div class="form-control image" style="width: 100px;"></div>\', \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default"><span class="caret"></span></button>\', "</div>"].join(""))\r\n
            });\r\n
            (new Common.UI.Menu({\r\n
                style: "min-width: 160px;",\r\n
                items: [{\r\n
                    template: _.template(\'<div id="shape-advanced-menu-begin-size" style="width: 160px; margin: 0 5px;"></div>\')\r\n
                }]\r\n
            })).render($("#shape-advanced-begin-size"));\r\n
            this.mnuBeginSizePicker = new Common.UI.DataView({\r\n
                el: $("#shape-advanced-menu-begin-size"),\r\n
                parentMenu: me.btnBeginSize.menu,\r\n
                store: new Common.UI.DataViewStore(_arrSize),\r\n
                itemTemplate: _.template(\'<div id="<%= id %>" class="item-arrow" style="background-position: -<%= offsetx %>px -<%= offsety %>px;"></div>\')\r\n
            });\r\n
            this.mnuBeginSizePicker.on("item:click", _.bind(this.onSelectBeginSize, this));\r\n
            this._selectStyleItem(this.btnBeginSize, null);\r\n
            for (i = 0; i < _arrStyles.length; i++) {\r\n
                _arrStyles[i].offsety += 200;\r\n
            }\r\n
            for (i = 0; i < _arrSize.length; i++) {\r\n
                _arrSize[i].offsety += 200;\r\n
            }\r\n
            this.btnEndStyle = new Common.UI.ComboBox({\r\n
                el: $("#shape-advanced-end-style"),\r\n
                template: _.template([\'<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">\', \'<div class="form-control image" style="width: 100px;"></div>\', \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default"><span class="caret"></span></button>\', "</div>"].join(""))\r\n
            });\r\n
            (new Common.UI.Menu({\r\n
                style: "min-width: 105px;",\r\n
                items: [{\r\n
                    template: _.template(\'<div id="shape-advanced-menu-end-style" style="width: 105px; margin: 0 5px;"></div>\')\r\n
                }]\r\n
            })).render($("#shape-advanced-end-style"));\r\n
            this.mnuEndStylePicker = new Common.UI.DataView({\r\n
                el: $("#shape-advanced-menu-end-style"),\r\n
                parentMenu: me.btnEndStyle.menu,\r\n
                store: new Common.UI.DataViewStore(_arrStyles),\r\n
                itemTemplate: _.template(\'<div id="<%= id %>" class="item-arrow" style="background-position: -<%= offsetx %>px -<%= offsety %>px;"></div>\')\r\n
            });\r\n
            this.mnuEndStylePicker.on("item:click", _.bind(this.onSelectEndStyle, this));\r\n
            this._selectStyleItem(this.btnEndStyle, null);\r\n
            this.btnEndSize = new Common.UI.ComboBox({\r\n
                el: $("#shape-advanced-end-size"),\r\n
                template: _.template([\'<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle combo-arrow-style"  data-toggle="dropdown">\', \'<div class="form-control image" style="width: 100px;"></div>\', \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default"><span class="caret"></span></button>\', "</div>"].join(""))\r\n
            });\r\n
            (new Common.UI.Menu({\r\n
                style: "min-width: 160px;",\r\n
                items: [{\r\n
                    template: _.template(\'<div id="shape-advanced-menu-end-size" style="width: 160px; margin: 0 5px;"></div>\')\r\n
                }]\r\n
            })).render($("#shape-advanced-end-size"));\r\n
            this.mnuEndSizePicker = new Common.UI.DataView({\r\n
                el: $("#shape-advanced-menu-end-size"),\r\n
                parentMenu: me.btnEndSize.menu,\r\n
                store: new Common.UI.DataViewStore(_arrSize),\r\n
                itemTemplate: _.template(\'<div id="<%= id %>" class="item-arrow" style="background-position: -<%= offsetx %>px -<%= offsety %>px;"></div>\')\r\n
            });\r\n
            this.mnuEndSizePicker.on("item:click", _.bind(this.onSelectEndSize, this));\r\n
            this._selectStyleItem(this.btnEndSize, null);\r\n
            this.afterRender();\r\n
        },\r\n
        afterRender: function () {\r\n
            this.updateMetricUnit();\r\n
            this._setDefaults(this._originalProps);\r\n
        },\r\n
        _setDefaults: function (props) {\r\n
            if (props && props.asc_getShapeProperties()) {\r\n
                var shapeprops = props.asc_getShapeProperties();\r\n
                this.spnWidth.setValue(Common.Utils.Metric.fnRecalcFromMM(props.asc_getWidth()).toFixed(2), true);\r\n
                this.spnHeight.setValue(Common.Utils.Metric.fnRecalcFromMM(props.asc_getHeight()).toFixed(2), true);\r\n
                if (props.asc_getHeight() > 0) {\r\n
                    this._nRatio = props.asc_getWidth() / props.asc_getHeight();\r\n
                }\r\n
                var value = window.localStorage.getItem("sse-settings-shaperatio");\r\n
                if (value !== null && parseInt(value) == 1) {\r\n
                    this.btnRatio.toggle(true);\r\n
                }\r\n
                this._setShapeDefaults(shapeprops);\r\n
                var margins = shapeprops.asc_getPaddings();\r\n
                if (margins) {\r\n
                    var val = margins.asc_getLeft();\r\n
                    this.spnMarginLeft.setValue((null !== val && undefined !== val) ? Common.Utils.Metric.fnRecalcFromMM(val) : "", true);\r\n
                    val = margins.asc_getTop();\r\n
                    this.spnMarginTop.setValue((null !== val && undefined !== val) ? Common.Utils.Metric.fnRecalcFromMM(val) : "", true);\r\n
                    val = margins.asc_getRight();\r\n
                    this.spnMarginRight.setValue((null !== val && undefined !== val) ? Common.Utils.Metric.fnRecalcFromMM(val) : "", true);\r\n
                    val = margins.asc_getBottom();\r\n
                    this.spnMarginBottom.setValue((null !== val && undefined !== val) ? Common.Utils.Metric.fnRecalcFromMM(val) : "", true);\r\n
                }\r\n
                this.btnsCategory[2].setDisabled(null === margins);\r\n
                this._changedProps = new Asc.asc_CImgProperty();\r\n
            }\r\n
        },\r\n
        getSettings: function () {\r\n
            window.localStorage.setItem("sse-settings-shaperatio", (this.btnRatio.pressed) ? 1 : 0);\r\n
            return {\r\n
                shapeProps: this._changedProps\r\n
            };\r\n
        },\r\n
        _setShapeDefaults: function (props) {\r\n
            if (props) {\r\n
                var stroke = props.asc_getStroke();\r\n
                if (stroke) {\r\n
                    var value = stroke.asc_getLinejoin();\r\n
                    for (var i = 0; i < this._arrJoinType.length; i++) {\r\n
                        if (value == this._arrJoinType[i].value) {\r\n
                            this.cmbJoinType.setValue(value);\r\n
                            break;\r\n
                        }\r\n
                    }\r\n
                    value = stroke.asc_getLinecap();\r\n
                    for (i = 0; i < this._arrCapType.length; i++) {\r\n
                        if (value == this._arrCapType[i].value) {\r\n
                            this.cmbCapType.setValue(value);\r\n
                            break;\r\n
                        }\r\n
                    }\r\n
                    var canchange = stroke.asc_getCanChangeArrows();\r\n
                    this.btnBeginStyle.setDisabled(!canchange);\r\n
                    this.btnEndStyle.setDisabled(!canchange);\r\n
                    this.btnBeginSize.setDisabled(!canchange);\r\n
                    this.btnEndSize.setDisabled(!canchange);\r\n
                    if (canchange) {\r\n
                        value = stroke.asc_getLinebeginsize();\r\n
                        var rec = this.mnuBeginSizePicker.store.findWhere({\r\n
                            type: value\r\n
                        });\r\n
                        if (rec) {\r\n
                            this._beginSizeIdx = rec.get("value");\r\n
                        } else {\r\n
                            this._beginSizeIdx = null;\r\n
                            this._selectStyleItem(this.btnBeginSize, null);\r\n
                        }\r\n
                        value = stroke.asc_getLinebeginstyle();\r\n
                        rec = this.mnuBeginStylePicker.store.findWhere({\r\n
                            type: value\r\n
                        });\r\n
                        if (rec) {\r\n
                            this.mnuBeginStylePicker.selectRecord(rec, true);\r\n
                            this._updateSizeArr(this.btnBeginSize, this.mnuBeginSizePicker, rec, this._beginSizeIdx);\r\n
                            this._selectStyleItem(this.btnBeginStyle, rec);\r\n
                        } else {\r\n
                            this._selectStyleItem(this.btnBeginStyle, null);\r\n
                        }\r\n
                        value = stroke.asc_getLineendsize();\r\n
                        rec = this.mnuEndSizePicker.store.findWhere({\r\n
                            type: value\r\n
                        });\r\n
                        if (rec) {\r\n
                            this._endSizeIdx = rec.get("value");\r\n
                        } else {\r\n
                            this._endSizeIdx = null;\r\n
                            this._selectStyleItem(this.btnEndSize, null);\r\n
                        }\r\n
                        value = stroke.asc_getLineendstyle();\r\n
                        rec = this.mnuEndStylePicker.store.findWhere({\r\n
                            type: value\r\n
                        });\r\n
                        if (rec) {\r\n
                            this.mnuEndStylePicker.selectRecord(rec, true);\r\n
                            this._updateSizeArr(this.btnEndSize, this.mnuEndSizePicker, rec, this._endSizeIdx);\r\n
                            this._selectStyleItem(this.btnEndStyle, rec);\r\n
                        } else {\r\n
                            this._selectStyleItem(this.btnEndStyle, null);\r\n
                        }\r\n
                    } else {\r\n
                        this._selectStyleItem(this.btnBeginStyle);\r\n
                        this._selectStyleItem(this.btnEndStyle);\r\n
                        this._selectStyleItem(this.btnBeginSize);\r\n
                        this._selectStyleItem(this.btnEndSize);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.01 : 1);\r\n
                }\r\n
            }\r\n
            this.sizeMax = {\r\n
                width: Common.Utils.Metric.fnRecalcFromMM(this.options.sizeMax.width * 10),\r\n
                height: Common.Utils.Metric.fnRecalcFromMM(this.options.sizeMax.height * 10)\r\n
            };\r\n
            if (this.options.sizeOriginal) {\r\n
                this.sizeOriginal = {\r\n
                    width: Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.width),\r\n
                    height: Common.Utils.Metric.fnRecalcFromMM(this.options.sizeOriginal.height)\r\n
                };\r\n
            }\r\n
        },\r\n
        _updateSizeArr: function (combo, picker, record, sizeidx) {\r\n
            if (record.get("value") > 0) {\r\n
                picker.store.each(function (rec) {\r\n
                    rec.set({\r\n
                        offsetx: record.get("value") * 80 + 10\r\n
                    });\r\n
                },\r\n
                this);\r\n
                combo.setDisabled(false);\r\n
                if (sizeidx !== null) {\r\n
                    picker.selectByIndex(sizeidx, true);\r\n
                    this._selectStyleItem(combo, picker.store.at(sizeidx));\r\n
                } else {\r\n
                    this._selectStyleItem(combo, null);\r\n
                }\r\n
            } else {\r\n
                this._selectStyleItem(combo, null);\r\n
                combo.setDisabled(true);\r\n
            }\r\n
        },\r\n
        _selectStyleItem: function (combo, record) {\r\n
            var formcontrol = $(combo.el).find(".form-control");\r\n
            formcontrol.css("background-position", ((record) ? (-record.get("offsetx") + 20) + "px" : "0") + " " + ((record) ? "-" + record.get("offsety") + "px" : "-30px"));\r\n
        },\r\n
        onSelectBeginStyle: function (picker, view, record) {\r\n
            if (this._changedProps) {\r\n
                if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                    this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                }\r\n
                if (this._changedProps.asc_getShapeProperties().asc_getStroke() === null) {\r\n
                    this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke());\r\n
                }\r\n
                this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinebeginstyle(record.get("type"));\r\n
            }\r\n
            if (this._beginSizeIdx === null || this._beginSizeIdx === undefined) {\r\n
                this._beginSizeIdx = 4;\r\n
            }\r\n
            this._updateSizeArr(this.btnBeginSize, this.mnuBeginSizePicker, record, this._beginSizeIdx);\r\n
            this._selectStyleItem(this.btnBeginStyle, record);\r\n
        },\r\n
        onSelectBeginSize: function (picker, view, record) {\r\n
            if (this._changedProps) {\r\n
                if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                    this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                }\r\n
                if (this._changedProps.asc_getShapeProperties().asc_getStroke() === null) {\r\n
                    this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke());\r\n
                }\r\n
                this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLinebeginsize(record.get("type"));\r\n
            }\r\n
            this._beginSizeIdx = record.get("value");\r\n
            this._selectStyleItem(this.btnBeginSize, record);\r\n
        },\r\n
        onSelectEndStyle: function (picker, view, record) {\r\n
            if (this._changedProps) {\r\n
                if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                    this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                }\r\n
                if (this._changedProps.asc_getShapeProperties().asc_getStroke() === null) {\r\n
                    this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke());\r\n
                }\r\n
                this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLineendstyle(record.get("type"));\r\n
            }\r\n
            if (this._endSizeIdx === null || this._endSizeIdx === undefined) {\r\n
                this._endSizeIdx = 4;\r\n
            }\r\n
            this._updateSizeArr(this.btnEndSize, this.mnuEndSizePicker, record, this._endSizeIdx);\r\n
            this._selectStyleItem(this.btnEndStyle, record);\r\n
        },\r\n
        onSelectEndSize: function (picker, view, record) {\r\n
            if (this._changedProps) {\r\n
                if (this._changedProps.asc_getShapeProperties() === null || this._changedProps.asc_getShapeProperties() === undefined) {\r\n
                    this._changedProps.asc_putShapeProperties(new Asc.asc_CShapeProperty());\r\n
                }\r\n
                if (this._changedProps.asc_getShapeProperties().asc_getStroke() === null) {\r\n
                    this._changedProps.asc_getShapeProperties().asc_putStroke(new Asc.asc_CStroke());\r\n
                }\r\n
                this._changedProps.asc_getShapeProperties().asc_getStroke().asc_putLineendsize(record.get("type"));\r\n
            }\r\n
            this._endSizeIdx = record.get("value");\r\n
            this._selectStyleItem(this.btnEndSize, record);\r\n
        },\r\n
        textTop: "Top",\r\n
        textLeft: "Left",\r\n
        textBottom: "Bottom",\r\n
        textRight: "Right",\r\n
        textSize: "Size",\r\n
        textWidth: "Width",\r\n
        textHeight: "Height",\r\n
        textKeepRatio: "Constant Proportions",\r\n
        cancelButtonText: "Cancel",\r\n
        okButtonText: "Ok",\r\n
        textTitle: "Shape - Advanced Settings",\r\n
        strMargins: "Text Padding",\r\n
        textRound: "Round",\r\n
        textMiter: "Miter",\r\n
        textSquare: "Square",\r\n
        textFlat: "Flat",\r\n
        textBevel: "Bevel",\r\n
        textArrows: "Arrows",\r\n
        textLineStyle: "Line Style",\r\n
        textCapType: "Cap Type",\r\n
        textJoinType: "Join Type",\r\n
        textBeginStyle: "Begin Style",\r\n
        textBeginSize: "Begin Size",\r\n
        textEndStyle: "End Style",\r\n
        textEndSize: "End Size",\r\n
        textWeightArrows: "Weights & Arrows"\r\n
    },\r\n
    SSE.Views.ShapeSettingsAdvanced || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/ShapeSettings\',["text!spreadsheeteditor/main/app/template/ShapeSettings.template", "jquery", "underscore", "backbone", "common/main/lib/component/ComboBox", "common/main/lib/component/ComboBorderSize", "common/main/lib/component/MetricSpinner", "common/main/lib/component/ThemeColorPalette", "common/main/lib/component/ColorButton", "common/main/lib/component/ComboDataView", "common/main/lib/component/Slider", "common/main/lib/component/MultiSliderGradient", "common/main/lib/view/ImageFromUrlDialog", "spreadsheeteditor/main/app/view/ShapeSettingsAdvanced"], function (menuTemplate, $, _, Backbone) {\r\n
    SSE.Views.ShapeSettings = Backbone.View.extend(_.extend({\r\n
        el: "#id-shape-settings",\r\n
        template: _.template(menuTemplate),\r\n
        events: {},\r\n
        options: {\r\n
            alias: "ShapeSettings"\r\n
        },\r\n
        initialize: function () {\r\n
            var me = this;\r\n
            this._initSettings = true;\r\n
            this._originalProps = null;\r\n
            this._noApply = true;\r\n
            this.imgprops = null;\r\n
            this._sendUndoPoint = true;\r\n
            this._sliderChanged = false;\r\n
            this._state = {\r\n
                Transparency: null,\r\n
                FillType: c_oAscFill.FILL_TYPE_SOLID,\r\n
                ShapeColor: "transparent",\r\n
                BlipFillType: c_oAscFillBlipType.STRETCH,\r\n
                StrokeType: c_oAscStrokeType.STROKE_COLOR,\r\n
                StrokeWidth: this._pt2mm(1),\r\n
                StrokeColor: "000000",\r\n
                FGColor: "000000",\r\n
                BGColor: "ffffff",\r\n
                GradColor: "000000",\r\n
                GradFillType: c_oAscFillGradType.GRAD_LINEAR,\r\n
                DisabledFillPanels: false,\r\n
                DisabledControls: false,\r\n
                HideShapeOnlySettings: false\r\n
            };\r\n
            this.lockedControls = [];\r\n
            this._locked = false;\r\n
            this.OriginalFillType = c_oAscFill.FILL_TYPE_SOLID;\r\n
            this.ShapeColor = {\r\n
                Value: 1,\r\n
                Color: "transparent"\r\n
            };\r\n
            this.BlipFillType = c_oAscFillBlipType.STRETCH;\r\n
            this.GradFillType = c_oAscFillGradType.GRAD_LINEAR;\r\n
            this.GradColor = {\r\n
                values: [0, 100],\r\n
                colors: ["000000", "ffffff"],\r\n
                currentIdx: 0\r\n
            };\r\n
            this.GradRadialDirectionIdx = 0;\r\n
            this.GradLinearDirectionType = 0;\r\n
            this.PatternFillType = 0;\r\n
            this.FGColor = {\r\n
                Value: 1,\r\n
                Color: "000000"\r\n
            };\r\n
            this.BGColor = {\r\n
                Value: 1,\r\n
                Color: "ffffff"\r\n
            };\r\n
            this.BorderColor = {\r\n
                Value: 1,\r\n
                Color: "transparent"\r\n
            };\r\n
            this.BorderSize = 0;\r\n
            this.textureNames = [this.txtCanvas, this.txtCarton, this.txtDarkFabric, this.txtGrain, this.txtGranite, this.txtGreyPaper, this.txtKnit, this.txtLeather, this.txtBrownPaper, this.txtPapyrus, this.txtWood];\r\n
            this.fillControls = [];\r\n
            this.render();\r\n
            this._arrFillSrc = [{\r\n
                displayValue: this.textColor,\r\n
                value: c_oAscFill.FILL_TYPE_SOLID\r\n
            },\r\n
            {\r\n
                displayValue: this.textGradientFill,\r\n
                value: c_oAscFill.FILL_TYPE_GRAD\r\n
            },\r\n
            {\r\n
                displayValue: this.textImageTexture,\r\n
                value: c_oAscFill.FILL_TYPE_BLIP\r\n
            },\r\n
            {\r\n
                displayValue: this.textPatternFill,\r\n
                value: c_oAscFill.FILL_TYPE_PATT\r\n
            },\r\n
            {\r\n
                displayValue: this.textNoFill,\r\n
                value: c_oAscFill.FILL_TYPE_NOFILL\r\n
            }];\r\n
            this.cmbFillSrc = new Common.UI.ComboBox({\r\n
                el: $("#shape-combo-fill-src"),\r\n
                cls: "input-group-nr",\r\n
                style: "width: 100%;",\r\n
                menuStyle: "min-width: 180px;",\r\n
                editable: false,\r\n
                data: this._arrFillSrc\r\n
            });\r\n
            this.cmbFillSrc.setValue(this._arrFillSrc[0].value);\r\n
            this.cmbFillSrc.on("selected", _.bind(this.onFillSrcSelect, this));\r\n
            this.fillControls.push(this.cmbFillSrc);\r\n
            this.btnBackColor = new Common.UI.ColorButton({\r\n
                style: "width:45px;",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="shape-back-color-menu" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="shape-back-color-new" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnBackColor.on("render:after", function (btn) {\r\n
                me.colorsBack = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#shape-back-color-menu"),\r\n
                    dynamiccolors: 10,\r\n
                    value: "transparent",\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
      

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABk=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="25" aka="AAAAAAAAABk=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

              {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "transparent", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
                me.colorsBack.on("select", _.bind(me.onColorsBackSelect, me));\r\n
            });\r\n
            this.btnBackColor.render($("#shape-back-color-btn"));\r\n
            this.btnBackColor.setColor("transparent");\r\n
            $(this.el).on("click", "#shape-back-color-new", _.bind(this.addNewColor, this, this.colorsBack, this.btnBackColor));\r\n
            this.fillControls.push(this.btnBackColor);\r\n
            this.cmbPattern = new Common.UI.ComboDataView({\r\n
                itemWidth: 28,\r\n
                itemHeight: 28,\r\n
                menuMaxHeight: 300,\r\n
                enableKeyEvents: true,\r\n
                cls: "combo-pattern"\r\n
            });\r\n
            this.cmbPattern.menuPicker.itemTemplate = this.cmbPattern.fieldPicker.itemTemplate = _.template([\'<div class="style" id="<%= id %>">\', \'<img src="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" class="combo-pattern-item" \', \'width="\' + this.cmbPattern.itemWidth + \'" height="\' + this.cmbPattern.itemHeight + \'" \', \'style="background-position: -<%= offsetx %>px -<%= offsety %>px;"/>\', "</div>"].join(""));\r\n
            this.cmbPattern.render($("#shape-combo-pattern"));\r\n
            this.cmbPattern.openButton.menu.cmpEl.css({\r\n
                "min-width": 178,\r\n
                "max-width": 178\r\n
            });\r\n
            this.cmbPattern.on("click", _.bind(this.onPatternSelect, this));\r\n
            this.cmbPattern.openButton.menu.on("show:after", function () {\r\n
                me.cmbPattern.menuPicker.scroller.update({\r\n
                    alwaysVisibleY: true\r\n
                });\r\n
            });\r\n
            this.fillControls.push(this.cmbPattern);\r\n
            this.btnFGColor = new Common.UI.ColorButton({\r\n
                style: "width:45px;",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="shape-foreground-color-menu" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="shape-foreground-color-new" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnFGColor.on("render:after", function (btn) {\r\n
                me.colorsFG = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#shape-foreground-color-menu"),\r\n
                    dynamiccolors: 10,\r\n
                    value: "000000",\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "3D55FE", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
                me.colorsFG.on("select", _.bind(me.onColorsFGSelect, me));\r\n
            });\r\n
            this.btnFGColor.render($("#shape-foreground-color-btn"));\r\n
            this.btnFGColor.setColor("000000");\r\n
            $(this.el).on("click", "#shape-foreground-color-new", _.bind(this.addNewColor, this, this.colorsFG, this.btnFGColor));\r\n
            this.fillControls.push(this.btnFGColor);\r\n
            this.btnBGColor = new Common.UI.ColorButton({\r\n
                style: "width:45px;",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="shape-background-color-menu" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="shape-background-color-new" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnBGColor.on("render:after", function (btn) {\r\n
                me.colorsBG = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#shape-background-color-menu"),\r\n
                    dynamiccolors: 10,\r\n
                    value: "ffffff",\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "3D55FE", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
                me.colorsBG.on("select", _.bind(me.onColorsBGSelect, me));\r\n
            });\r\n
            this.btnBGColor.render($("#shape-background-color-btn"));\r\n
            this.btnBGColor.setColor("ffffff");\r\n
            $(this.el).on("click", "#shape-background-color-new", _.bind(this.addNewColor, this, this.colorsBG, this.btnBGColor));\r\n
            this.fillControls.push(this.btnBGColor);\r\n
            this.btnInsertFromFile = new Common.UI.Button({\r\n
                el: $("#shape-button-from-file")\r\n
            });\r\n
            this.fillControls.push(this.btnInsertFromFile);\r\n
            this.btnInsertFromUrl = new Common.UI.Button({\r\n
                el: $("#shape-button-from-url")\r\n
            });\r\n
            this.fillControls.push(this.btnInsertFromUrl);\r\n
            this.btnInsertFromFile.on("click", _.bind(function (btn) {\r\n
                if (this.api) {\r\n
                    this.api.asc_changeShapeImageFromFile();\r\n
                }\r\n
                Common.NotificationCenter.trigger("edit:complete", this);\r\n
            },\r\n
            this));\r\n
            this.btnInsertFromUrl.on("click", _.bind(this.insertFromUrl, this));\r\n
            this._arrFillType = [{\r\n
                displayValue: this.textStretch,\r\n
                value: c_oAscFillBlipType.STRETCH\r\n
            },\r\n
            {\r\n
                displayValue: this.textTile,\r\n
                value: c_oAscFillBlipType.TILE\r\n
            }];\r\n
            this.cmbFillType = new Common.UI.ComboBox({\r\n
                el: $("#shape-combo-fill-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 90px;",\r\n
                editable: false,\r\n
                data: this._arrFillType\r\n
            });\r\n
            this.cmbFillType.setValue(this._arrFillType[0].value);\r\n
            this.cmbFillType.on("selected", _.bind(this.onFillTypeSelect, this));\r\n
            this.fillControls.push(this.cmbFillType);\r\n
            this.btnTexture = new Common.UI.ComboBox({\r\n
                el: $("#shape-combo-fill-texture"),\r\n
                template: _.template([\'<div class="input-group combobox combo-dataview-menu input-group-nr dropdown-toggle" tabindex="0" data-toggle="dropdown">\', \'<div class="form-control text" style="width: 90px;">\' + this.textSelectTexture + "</div>", \'<div style="display: table-cell;"></div>\', \'<button type="button" class="btn btn-default"><span class="caret"></span></button>\', "</div>"].join(""))\r\n
            });\r\n
            this.textureMenu = new Common.UI.Menu({\r\n
                items: [{\r\n
                    template: _.template(\'<div id="id-shape-menu-texture" style="width: 233px; margin: 0 5px;"></div>\')\r\n
                }]\r\n
            });\r\n
            this.textureMenu.render($("#shape-combo-fill-texture"));\r\n
            this.fillControls.push(this.btnTexture);\r\n
            this.numTransparency = new Common.UI.MetricSpinner({\r\n
                el: $("#shape-spin-transparency"),\r\n
                step: 1,\r\n
                width: 60,\r\n
                value: "100 %",\r\n
                defaultUnit: "%",\r\n
                maxValue: 100,\r\n
                minValue: 0\r\n
            });\r\n
            this.numTransparency.on("change", _.bind(this.onNumTransparencyChange, this));\r\n
            this.fillControls.push(this.numTransparency);\r\n
            this.sldrTransparency = new Common.UI.SingleSlider({\r\n
                el: $("#shape-slider-transparency"),\r\n
                width: 75,\r\n
                minValue: 0,\r\n
                maxValue: 100,\r\n
                value: 100\r\n
            });\r\n
            this.sldrTransparency.on("change", _.bind(this.onTransparencyChange, this));\r\n
            this.sldrTransparency.on("changecomplete", _.bind(this.onTransparencyChangeComplete, this));\r\n
            this.fillControls.push(this.sldrTransparency);\r\n
            this.lblTransparencyStart = $(this.el).find("#shape-lbl-transparency-start");\r\n
            this.lblTransparencyEnd = $(this.el).find("#shape-lbl-transparency-end");\r\n
            this._arrGradType = [{\r\n
                displayValue: this.textLinear,\r\n
                value: c_oAscFillGradType.GRAD_LINEAR\r\n
            },\r\n
            {\r\n
                displayValue: this.textRadial,\r\n
                value: c_oAscFillGradType.GRAD_PATH\r\n
            }];\r\n
            this.cmbGradType = new Common.UI.ComboBox({\r\n
                el: $("#shape-combo-grad-type"),\r\n
                cls: "input-group-nr",\r\n
                menuStyle: "min-width: 90px;",\r\n
                editable: false,\r\n
                data: this._arrGradType\r\n
            });\r\n
            this.cmbGradType.setValue(this._arrGradType[0].value);\r\n
            this.cmbGradType.on("selected", _.bind(this.onGradTypeSelect, this));\r\n
            this.fillControls.push(this.cmbGradType);\r\n
            this._viewDataLinear = [{\r\n
                offsetx: 0,\r\n
                offsety: 0,\r\n
                type: 45,\r\n
                subtype: -1,\r\n
                iconcls: "gradient-left-top"\r\n
            },\r\n
            {\r\n
                offsetx: 50,\r\n
                offsety: 0,\r\n
                type: 90,\r\n
                subtype: 4,\r\n
                iconcls: "gradient-top"\r\n
            },\r\n
            {\r\n
                offsetx: 100,\r\n
                offsety: 0,\r\n
                type: 135,\r\n
                subtype: 5,\r\n
                iconcls: "gradient-right-top"\r\n
            },\r\n
            {\r\n
                offsetx: 0,\r\n
                offsety: 50,\r\n
                type: 0,\r\n
                subtype: 6,\r\n
                iconcls: "gradient-left",\r\n
                cls: "item-gradient-separator",\r\n
                selected: true\r\n
            },\r\n
            {\r\n
                offsetx: 100,\r\n
                offsety: 50,\r\n
                type: 180,\r\n
                subtype: 1,\r\n
                iconcls: "gradient-right"\r\n
            },\r\n
            {\r\n
                offsetx: 0,\r\n
                offsety: 100,\r\n
                type: 315,\r\n
                subtype: 2,\r\n
                iconcls: "gradient-left-bottom"\r\n
            },\r\n
            {\r\n
                offsetx: 50,\r\n
                offsety: 100,\r\n
                type: 270,\r\n
                subtype: 3,\r\n
                iconcls: "gradient-bottom"\r\n
            },\r\n
            {\r\n
                offsetx: 100,\r\n
                offsety: 100,\r\n
                type: 225,\r\n
                subtype: 7,\r\n
                iconcls: "gradient-right-bottom"\r\n
            }];\r\n
            this._viewDataRadial = [{\r\n
                offsetx: 100,\r\n
                offsety: 150,\r\n
                type: 2,\r\n
                subtype: 5,\r\n
                iconcls: "gradient-radial-center"\r\n
            }];\r\n
            this.btnDirection = new Common.UI.Button({\r\n
                cls: "btn-large-dataview",\r\n
                iconCls: "item-gradient gradient-left",\r\n
                menu: new Common.UI.Menu({\r\n
                    style: "min-width: 60px;",\r\n
                    menuAlign: "tr-br",\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="id-shape-menu-direction" style="width: 175px; margin: 0 5px;"></div>\')\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnDirection.on("render:after", function (btn) {\r\n
                me.mnuDirectionPicker = new Common.UI.DataView({\r\n
                    el: $("#id-shape-menu-direction"),\r\n
                    parentMenu: btn.menu,\r\n
                    restoreHeight: 174,\r\n
                    store: new Common.UI.DataViewStore(me._viewDataLinear),\r\n
                    itemTemplate: _.template(\'<div id="<%= id %>" class="item-gradient" style="background-position: -<%= offsetx %>px -<%= offsety %>px;"></div>\')\r\n
                });\r\n
            });\r\n
            this.btnDirection.render($("#shape-button-direction"));\r\n
            this.mnuDirectionPicker.on("item:click", _.bind(this.onSelectGradient, this, this.btnDirection));\r\n
            this.fillControls.push(this.btnDirection);\r\n
            this.btnGradColor = new Common.UI.ColorButton({\r\n
                style: "width:45px;",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="shape-gradient-color-menu" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="shape-gradient-color-new" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnGradColor.on("render:after", function (btn) {\r\n
                me.colorsGrad = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#shape-gradient-color-menu"),\r\n
                    dynamiccolors: 10,\r\n
                    value: "000000",\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "3D55FE", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
                me.colorsGrad.on("select", _.bind(me.onColorsGradientSelect, me));\r\n
            });\r\n
            this.btnGradColor.render($("#shape-gradient-color-btn"));\r\n
            this.btnGradColor.setColor("000000");\r\n
            $(this.el).on("click", "#shape-gradient-color-new", _.bind(this.addNewColor, this, this.colorsGrad, this.btnGradColor));\r\n
            this.fillControls.push(this.btnGradColor);\r\n
            this.sldrGradient = new Common.UI.MultiSliderGradient({\r\n
                el: $("#shape-slider-gradient"),\r\n
                width: 125,\r\n
                minValue: 0,\r\n
                maxValue: 100,\r\n
                values: [0, 100]\r\n
            });\r\n
            this.sldrGradient.on("change", _.bind(this.onGradientChange, this));\r\n
            this.sldrGradient.on("changecomplete", _.bind(this.onGradientChangeComplete, this));\r\n
            this.sldrGradient.on("thumbclick", function (cmp, index) {\r\n
                me.GradColor.currentIdx = index;\r\n
                var color = me.GradColor.colors[me.GradColor.currentIdx];\r\n
                me.btnGradColor.setColor(color);\r\n
                me.colorsGrad.select(color, false);\r\n
            });\r\n
            this.sldrGradient.on("thumbdblclick", function (cmp) {\r\n
                me.btnGradColor.cmpEl.find("button").dropdown("toggle");\r\n
            });\r\n
            this.fillControls.push(this.sldrGradient);\r\n
            this.cmbBorderSize = new Common.UI.ComboBorderSizeEditable({\r\n
                el: $("#shape-combo-border-size"),\r\n
                style: "width: 93px;",\r\n
                txtNoBorders: this.txtNoBorders\r\n
            }).on("selected", _.bind(this.onBorderSizeSelect, this)).on("changed:before", _.bind(this.onBorderSizeChanged, this, true)).on("changed:after", _.bind(this.onBorderSizeChanged, this, false)).on("combo:blur", _.bind(this.onComboBlur, this, false));\r\n
            this.BorderSize = this.cmbBorderSize.store.at(2).get("value");\r\n
            this.cmbBorderSize.setValue(this.BorderSize);\r\n
            this.lockedControls.push(this.cmbBorderSize);\r\n
            this.btnBorderColor = new Common.UI.ColorButton({\r\n
                style: "width:45px;",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [{\r\n
                        template: _.template(\'<div id="shape-border-color-menu" style="width: 165px; height: 220px; margin: 10px;"></div>\')\r\n
                    },\r\n
                    {\r\n
                        template: _.template(\'<a id="shape-border-color-new" style="padding-left:12px;">\' + me.textNewColor + "</a>")\r\n
                    }]\r\n
                })\r\n
            });\r\n
            this.btnBorderColor.on("render:after", function (btn) {\r\n
                me.colorsBorder = new Common.UI.ThemeColorPalette({\r\n
                    el: $("#shape-border-color-menu"),\r\n
                    dynamiccolors: 10,\r\n
                    value: "000000",\r\n
                    colors: [me.textThemeColors, "-", {\r\n
                        color: "3366FF",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "0000FF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000090",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "660066",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "800000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "FF0000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FF6600",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFF00",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "CCFFCC",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "008000",\r\n
                        effectId: 4\r\n
                    },\r\n
                    "-", {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 3\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 4\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 5\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    {\r\n
                        color: "FFFFFF",\r\n
                        effectId: 2\r\n
                    },\r\n
                    {\r\n
                        color: "000000",\r\n
                        effectId: 1\r\n
                    },\r\n
                    "-", "--", "-", me.textStandartColors, "-", "3D55FE", "5301B3", "980ABD", "B2275F", "F83D26", "F86A1D", "F7AC16", "F7CA12", "FAFF44", "D6EF39", "-", "--"]\r\n
                });\r\n
                me.colorsBorder.on("select", _.bind(me.onColorsBorderSelect, me));\r\n
            });\r\n
            this.btnBorderColor.render($("#shape-border-color-btn"));\r\n
            this.btnBorderColor.setColor("000000");\r\n
            $(this.el).on("click", "#shape-border-color-new", _.bind(this.addNewColor, this, this.colorsBorder, this.btnBorderColor));\r\n
            this.lockedControls.push(this.btnBorderColor);\r\n
            this.btnChangeShape = new Common.UI.Button({\r\n
                cls: "btn-icon-default",\r\n
                iconCls: "btn-change-shape",\r\n
                menu: new Common.UI.Menu({\r\n
                    menuAlign: "tr-br",\r\n
                    cls: "menu-shapes",\r\n
                    items: []\r\n
                })\r\n
            });\r\n
            this.btnChangeShape.render($("#shape-btn-change"));\r\n
            this.lockedControls.push(this.btnChangeShape);\r\n
            $(this.el).on("click", "#shape-advanced-link", _.bind(this.openAdvancedSettings, this));\r\n
            this.FillColorContainer = $("#shape-panel-color-fill");\r\n
            this.FillImageContainer = $("#shape-panel-image-fill");\r\n
            this.FillPatternContainer = $("#shape-panel-pattern-fill");\r\n
            this.FillGradientContainer = $("#shape-panel-gradient-fill");\r\n
            this.TransparencyContainer = $("#shape-panel-transparent-fill");\r\n
            this.ShapeOnlySettings = $(".shape-only");\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            this.linkAdvanced = $("#shape-advanced-link");\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            if (this.api) {\r\n
                this.api.asc_setInterfaceDrawImagePlaceShape("shape-texture-img");\r\n
                this.api.asc_registerCallback("asc_onInitStandartTextures", _.bind(this.onInitStandartTextures, this));\r\n
            }\r\n
            return this;\r\n
        },\r\n
        onFillSrcSelect: function (combo, record) {\r\n
            this.ShowHideElem(record.value);\r\n
            switch (record.value) {\r\n
            case c_oAscFill.FILL_TYPE_SOLID:\r\n
                this._state.FillType = c_oAscFill.FILL_TYPE_SOLID;\r\n
                if (!this._noApply) {\r\n
                    var props = new Asc.asc_CShapeProperty();\r\n
                    var fill = new Asc.asc_CShapeFill();\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_SOLID);\r\n
                    fill.asc_putFill(new Asc.asc_CFillSolid());\r\n
                    fill.asc_getFill().asc_putColor(Common.Utils.ThemeColor.getRgbColor((this.ShapeColor.Color == "transparent") ? {\r\n
                        color: "4f81bd",\r\n
                        effectId: 24\r\n
                    } : this.ShapeColor.Color));\r\n
                    props.asc_putFill(fill);\r\n
                    this.imgprops.asc_putShapeProperties(props);\r\n
                    this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                }\r\n
                break;\r\n
            case c_oAscFill.FILL_TYPE_GRAD:\r\n
                this._state.FillType = c_oAscFill.FILL_TYPE_GRAD;\r\n
                if (!this._noApply) {\r\n
                    var props = new Asc.asc_CShapeProperty();\r\n
                    var fill = new Asc.asc_CShapeFill();\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_GRAD);\r\n
                    fill.asc_putFill(new Asc.asc_CFillGrad());\r\n
                    fill.asc_getFill().asc_putGradType(this.GradFillType);\r\n
                    if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                        fill.asc_getFill().asc_putLinearAngle(this.GradLinearDirectionType * 60000);\r\n
                        fill.asc_getFill().asc_putLinearScale(true);\r\n
                    }\r\n
                    if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_GRAD) {\r\n
                        fill.asc_getFill().asc_putPositions([this.GradColor.values[0] * 1000, this.GradColor.values[1] * 1000]);\r\n
                        fill.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]), Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])]);\r\n
                    }\r\n
                    props.asc_putFill(fill);\r\n
                    this.imgprops.asc_putShapeProperties(props);\r\n
                    this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                }\r\n
                break;\r\n
            case c_oAscFill.FILL_TYPE_BLIP:\r\n
                this._state.FillType = c_oAscFill.FILL_TYPE_BLIP;\r\n
                break;\r\n
            case c_oAscFill.FILL_TYPE_PATT:\r\n
                this._state.FillType = c_oAscFill.FILL_TYPE_PATT;\r\n
                if (!this._noApply) {\r\n
                    var props = new Asc.asc_CShapeProperty();\r\n
                    var fill = new Asc.asc_CShapeFill();\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_PATT);\r\n
                    fill.asc_putFill(new Asc.asc_CFillHatch());\r\n
                    fill.asc_getFill().asc_putPatternType(this.PatternFillType);\r\n
                    var fHexColor = Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color).get_color().get_hex();\r\n
                    var bHexColor = Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color).get_color().get_hex();\r\n
                    if (bHexColor === "ffffff" && fHexColor === "ffffff") {\r\n
                        fHexColor = {\r\n
                            color: "4f81bd",\r\n
                            effectId: 24\r\n
                        };\r\n
                    } else {\r\n
                        fHexColor = this.FGColor.Color;\r\n
                    }\r\n
                    fill.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(fHexColor));\r\n
                    fill.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color));\r\n
                    props.asc_putFill(fill);\r\n
                    this.imgprops.asc_putShapeProperties(props);\r\n
                    this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                }\r\n
                break;\r\n
            case c_oAscFill.FILL_TYPE_NOFILL:\r\n
                this._state.FillType = c_oAscFill.FILL_TYPE_NOFILL;\r\n
                if (!this._noApply) {\r\n
                    var props = new Asc.asc_CShapeProperty();\r\n
                    var fill = new Asc.asc_CShapeFill();\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_NOFILL);\r\n
                    fill.asc_putFill(null);\r\n
                    props.asc_putFill(fill);\r\n
                    this.imgprops.asc_putShapeProperties(props);\r\n
                    this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                }\r\n
                break;\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onColorsBackSelect: function (picker, color) {\r\n
            this.btnBackColor.setColor(color);\r\n
            this.ShapeColor = {\r\n
                Value: 1,\r\n
                Color: color\r\n
            };\r\n
            if (this.api && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                if (this.ShapeColor.Color == "transparent") {\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_NOFILL);\r\n
                    fill.asc_putFill(null);\r\n
                } else {\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_SOLID);\r\n
                    fill.asc_putFill(new Asc.asc_CFillSolid());\r\n
                    fill.asc_getFill().asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.ShapeColor.Color));\r\n
                }\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        addNewColor: function (picker, btn) {\r\n
            picker.addNewColor((typeof(btn.color) == "object") ? btn.color.color : btn.color);\r\n
        },\r\n
        onPatternSelect: function (combo, record) {\r\n
            if (this.api && !this._noApply) {\r\n
                this.PatternFillType = record.get("type");\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_PATT);\r\n
                fill.asc_putFill(new Asc.asc_CFillHatch());\r\n
                fill.asc_getFill().asc_putPatternType(this.PatternFillType);\r\n
                if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_PATT) {\r\n
                    fill.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color));\r\n
                    fill.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color));\r\n
                }\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onColorsFGSelect: function (picker, color) {\r\n
            this.btnFGColor.setColor(color);\r\n
            this.FGColor = {\r\n
                Value: 1,\r\n
                Color: color\r\n
            };\r\n
            if (this.api && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_PATT);\r\n
                fill.asc_putFill(new Asc.asc_CFillHatch());\r\n
                fill.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color));\r\n
                if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_PATT) {\r\n
                    fill.asc_getFill().asc_putPatternType(this.PatternFillType);\r\n
                    fill.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color));\r\n
                }\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onColorsBGSelect: function (picker, color) {\r\n
            this.btnBGColor.setColor(color);\r\n
            this.BGColor = {\r\n
                Value: 1,\r\n
                Color: color\r\n
            };\r\n
            if (this.api && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_PATT);\r\n
                fill.asc_putFill(new Asc.asc_CFillHatch());\r\n
                if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_PATT) {\r\n
                    fill.asc_getFill().asc_putPatternType(this.PatternFillType);\r\n
                    fill.asc_getFill().asc_putColorFg(Common.Utils.ThemeColor.getRgbColor(this.FGColor.Color));\r\n
                }\r\n
                fill.asc_getFill().asc_putColorBg(Common.Utils.ThemeColor.getRgbColor(this.BGColor.Color));\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onFillTypeSelect: function (combo, record) {\r\n
            this.BlipFillType = record.value;\r\n
            if (this.api && this._fromTextureCmb !== true && this.OriginalFillType == c_oAscFill.FILL_TYPE_BLIP) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_BLIP);\r\n
                fill.asc_putFill(new Asc.asc_CFillBlip());\r\n
                fill.asc_getFill().asc_putType(this.BlipFillType);\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onNumTransparencyChange: function (field, newValue, oldValue, eOpts) {\r\n
            this.sldrTransparency.setValue(field.getNumberValue(), true);\r\n
            if (this.api) {\r\n
                var num = field.getNumberValue();\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putTransparent(num * 2.55);\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onTransparencyChange: function (field, newValue, oldValue) {\r\n
            this._sliderChanged = newValue;\r\n
            this.numTransparency.setValue(newValue, true);\r\n
            if (this._sendUndoPoint) {\r\n
                this.api.setStartPointHistory();\r\n
                this._sendUndoPoint = false;\r\n
                this.updateslider = setInterval(_.bind(this._transparencyApplyFunc, this), 100);\r\n
            }\r\n
        },\r\n
        onTransparencyChangeComplete: function (field, newValue, oldValue) {\r\n
            clearInterval(this.updateslider);\r\n
            this._sliderChanged = newValue;\r\n
            this.api.setEndPointHistory();\r\n
            this._transparencyApplyFunc();\r\n
            this._sendUndoPoint = true;\r\n
        },\r\n
        _transparencyApplyFunc: function () {\r\n
            if (this._sliderChanged !== undefined) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putTransparent(this._sliderChanged * 2.55);\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                this._sliderChanged = undefined;\r\n
            }\r\n
        },\r\n
        onGradTypeSelect: function (combo, record) {\r\n
            this.GradFillType = record.value;\r\n
            if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                this.mnuDirectionPicker.store.reset(this._viewDataLinear);\r\n
                this.mnuDirectionPicker.cmpEl.width(175);\r\n
                this.mnuDirectionPicker.restoreHeight = 174;\r\n
                var record = this.mnuDirectionPicker.store.findWhere({\r\n
                    type: this.GradLinearDirectionType\r\n
                });\r\n
                this.mnuDirectionPicker.selectRecord(record, true);\r\n
                if (record) {\r\n
                    this.btnDirection.setIconCls("item-gradient " + record.get("iconcls"));\r\n
                } else {\r\n
                    this.btnDirection.setIconCls("");\r\n
                }\r\n
            } else {\r\n
                if (this.GradFillType == c_oAscFillGradType.GRAD_PATH) {\r\n
                    this.mnuDirectionPicker.store.reset(this._viewDataRadial);\r\n
                    this.mnuDirectionPicker.cmpEl.width(60);\r\n
                    this.mnuDirectionPicker.restoreHeight = 58;\r\n
                    this.mnuDirectionPicker.selectByIndex(this.GradRadialDirectionIdx, true);\r\n
                    if (this.GradRadialDirectionIdx >= 0) {\r\n
                        this.btnDirection.setIconCls("item-gradient " + this._viewDataRadial[this.GradRadialDirectionIdx].iconcls);\r\n
                    } else {\r\n
                        this.btnDirection.setIconCls("");\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (this.api && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_GRAD);\r\n
                fill.asc_putFill(new Asc.asc_CFillGrad());\r\n
                fill.asc_getFill().asc_putGradType(this.GradFillType);\r\n
                if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                    fill.asc_getFill().asc_putLinearAngle(this.GradLinearDirectionType * 60000);\r\n
                    fill.asc_getFill().asc_putLinearScale(true);\r\n
                }\r\n
                fill.asc_getFill().asc_putPositions([this.GradColor.values[0] * 1000, this.GradColor.values[1] * 1000]);\r\n
                fill.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]), Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])]);\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onSelectGradient: function (btn, picker, itemView, record) {\r\n
            if (this._noApply) {\r\n
        

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABo=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="26" aka="AAAAAAAAABo=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

        return;\r\n
            }\r\n
            var rawData = {},\r\n
            isPickerSelect = _.isFunction(record.toJSON);\r\n
            if (isPickerSelect) {\r\n
                if (record.get("selected")) {\r\n
                    rawData = record.toJSON();\r\n
                } else {\r\n
                    return;\r\n
                }\r\n
            } else {\r\n
                rawData = record;\r\n
            }\r\n
            this.btnDirection.setIconCls("item-gradient " + rawData.iconcls);\r\n
            (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) ? this.GradLinearDirectionType = rawData.type : this.GradRadialDirectionIdx = 0;\r\n
            if (this.api) {\r\n
                if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                    var props = new Asc.asc_CShapeProperty();\r\n
                    var fill = new Asc.asc_CShapeFill();\r\n
                    fill.asc_putType(c_oAscFill.FILL_TYPE_GRAD);\r\n
                    fill.asc_putFill(new Asc.asc_CFillGrad());\r\n
                    fill.asc_getFill().asc_putGradType(this.GradFillType);\r\n
                    fill.asc_getFill().asc_putLinearAngle(rawData.type * 60000);\r\n
                    fill.asc_getFill().asc_putLinearScale(true);\r\n
                    if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_GRAD) {\r\n
                        fill.asc_getFill().asc_putPositions([this.GradColor.values[0] * 1000, this.GradColor.values[1] * 1000]);\r\n
                        fill.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]), Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])]);\r\n
                    }\r\n
                    props.asc_putFill(fill);\r\n
                    this.imgprops.asc_putShapeProperties(props);\r\n
                    this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onColorsGradientSelect: function (picker, color) {\r\n
            this.btnGradColor.setColor(color);\r\n
            this.GradColor.colors[this.GradColor.currentIdx] = color;\r\n
            this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}", (typeof(color) == "object") ? color.color : color));\r\n
            if (this.api && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_GRAD);\r\n
                fill.asc_putFill(new Asc.asc_CFillGrad());\r\n
                fill.asc_getFill().asc_putGradType(this.GradFillType);\r\n
                fill.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]), Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])]);\r\n
                if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_GRAD) {\r\n
                    if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                        fill.asc_getFill().asc_putLinearAngle(this.GradLinearDirectionType * 60000);\r\n
                        fill.asc_getFill().asc_putLinearScale(true);\r\n
                    }\r\n
                    fill.asc_getFill().asc_putPositions([this.GradColor.values[0] * 1000, this.GradColor.values[1] * 1000]);\r\n
                }\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onGradientChange: function (slider, newValue, oldValue) {\r\n
            this.GradColor.values = slider.getValues();\r\n
            this._sliderChanged = true;\r\n
            if (this.api && !this._noApply) {\r\n
                if (this._sendUndoPoint) {\r\n
                    this.api.setStartPointHistory();\r\n
                    this._sendUndoPoint = false;\r\n
                    this.updateslider = setInterval(_.bind(this._gradientApplyFunc, this), 100);\r\n
                }\r\n
            }\r\n
        },\r\n
        onGradientChangeComplete: function (slider, newValue, oldValue) {\r\n
            clearInterval(this.updateslider);\r\n
            this._sliderChanged = true;\r\n
            this.api.setEndPointHistory();\r\n
            this._gradientApplyFunc();\r\n
            this._sendUndoPoint = true;\r\n
        },\r\n
        _gradientApplyFunc: function () {\r\n
            if (this._sliderChanged) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_GRAD);\r\n
                fill.asc_putFill(new Asc.asc_CFillGrad());\r\n
                fill.asc_getFill().asc_putGradType(this.GradFillType);\r\n
                fill.asc_getFill().asc_putPositions([this.GradColor.values[0] * 1000, this.GradColor.values[1] * 1000]);\r\n
                if (this.OriginalFillType !== c_oAscFill.FILL_TYPE_GRAD) {\r\n
                    if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                        fill.asc_getFill().asc_putLinearAngle(this.GradLinearDirectionType * 60000);\r\n
                        fill.asc_getFill().asc_putLinearScale(true);\r\n
                    }\r\n
                    fill.asc_getFill().asc_putColors([Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[0]), Common.Utils.ThemeColor.getRgbColor(this.GradColor.colors[1])]);\r\n
                }\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                this._sliderChanged = false;\r\n
            }\r\n
        },\r\n
        applyBorderSize: function (value) {\r\n
            value = parseFloat(value);\r\n
            value = isNaN(value) ? 0 : Math.max(0, Math.min(1584, value));\r\n
            this.BorderSize = value;\r\n
            if (this.api && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var stroke = new Asc.asc_CStroke();\r\n
                if (this.BorderSize < 0.01) {\r\n
                    stroke.asc_putType(c_oAscStrokeType.STROKE_NONE);\r\n
                    this._state.StrokeType = this._state.StrokeWidth = -1;\r\n
                } else {\r\n
                    stroke.asc_putType(c_oAscStrokeType.STROKE_COLOR);\r\n
                    if (this.BorderColor.Color == "transparent" || this.BorderColor.Color.color == "transparent") {\r\n
                        stroke.asc_putColor(Common.Utils.ThemeColor.getRgbColor({\r\n
                            color: "000000",\r\n
                            effectId: 29\r\n
                        }));\r\n
                    } else {\r\n
                        if (this._state.StrokeType == c_oAscStrokeType.STROKE_NONE || this._state.StrokeType === null) {\r\n
                            stroke.asc_putColor(Common.Utils.ThemeColor.getRgbColor(Common.Utils.ThemeColor.colorValue2EffectId(this.BorderColor.Color)));\r\n
                        }\r\n
                    }\r\n
                    stroke.asc_putWidth(this._pt2mm(this.BorderSize));\r\n
                }\r\n
                props.asc_putStroke(stroke);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
                Common.NotificationCenter.trigger("edit:complete", this);\r\n
            }\r\n
        },\r\n
        onComboBlur: function () {\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        onBorderSizeChanged: function (before, combo, record, e) {\r\n
            var me = this;\r\n
            if (before) {\r\n
                var value = parseFloat(record.value);\r\n
                if (! (/^\\s*(\\d*(\\.|,)?\\d+)\\s*(pt)?\\s*$/.exec(record.value)) || value < 0 || value > 1584) {\r\n
                    this._state.StrokeType = this._state.StrokeWidth = -1;\r\n
                    Common.UI.error({\r\n
                        msg: this.textBorderSizeErr,\r\n
                        callback: function () {\r\n
                            _.defer(function (btn) {\r\n
                                Common.NotificationCenter.trigger("edit:complete", me);\r\n
                            });\r\n
                        }\r\n
                    });\r\n
                }\r\n
            } else {\r\n
                this.applyBorderSize(record.value);\r\n
            }\r\n
        },\r\n
        onBorderSizeSelect: function (combo, record) {\r\n
            this.applyBorderSize(record.value);\r\n
        },\r\n
        onColorsBorderSelect: function (picker, color) {\r\n
            this.btnBorderColor.setColor(color);\r\n
            this.BorderColor = {\r\n
                Value: 1,\r\n
                Color: color\r\n
            };\r\n
            if (this.api && this.BorderSize > 0 && !this._noApply) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var stroke = new Asc.asc_CStroke();\r\n
                if (this.BorderSize < 0.01) {\r\n
                    stroke.asc_putType(c_oAscStrokeType.STROKE_NONE);\r\n
                } else {\r\n
                    stroke.asc_putType(c_oAscStrokeType.STROKE_COLOR);\r\n
                    stroke.asc_putColor(Common.Utils.ThemeColor.getRgbColor(this.BorderColor.Color));\r\n
                    stroke.asc_putWidth(this._pt2mm(this.BorderSize));\r\n
                }\r\n
                props.asc_putStroke(stroke);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        insertFromUrl: function () {\r\n
            var me = this;\r\n
            (new Common.Views.ImageFromUrlDialog({\r\n
                handler: function (result, value) {\r\n
                    if (result == "ok") {\r\n
                        if (me.api) {\r\n
                            var checkUrl = value.replace(/ /g, "");\r\n
                            if (!_.isEmpty(checkUrl)) {\r\n
                                if (me.BlipFillType !== null) {\r\n
                                    var props = new Asc.asc_CShapeProperty();\r\n
                                    var fill = new Asc.asc_CShapeFill();\r\n
                                    fill.asc_putType(c_oAscFill.FILL_TYPE_BLIP);\r\n
                                    fill.asc_putFill(new Asc.asc_CFillBlip());\r\n
                                    fill.asc_getFill().asc_putType(me.BlipFillType);\r\n
                                    fill.asc_getFill().asc_putUrl(checkUrl);\r\n
                                    props.asc_putFill(fill);\r\n
                                    me.imgprops.asc_putShapeProperties(props);\r\n
                                    me.api.asc_setGraphicObjectProps(me.imgprops);\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                    Common.NotificationCenter.trigger("edit:complete", me);\r\n
                }\r\n
            })).show();\r\n
        },\r\n
        openAdvancedSettings: function (e) {\r\n
            if (this.linkAdvanced.hasClass("disabled")) {\r\n
                return;\r\n
            }\r\n
            var me = this;\r\n
            var win;\r\n
            if (me.api && !this._locked) {\r\n
                var selectedElements = me.api.asc_getGraphicObjectProps();\r\n
                if (selectedElements && selectedElements.length > 0) {\r\n
                    var elType, elValue;\r\n
                    for (var i = selectedElements.length - 1; i >= 0; i--) {\r\n
                        elType = selectedElements[i].asc_getObjectType();\r\n
                        if (c_oAscTypeSelectElement.Image == elType) {\r\n
                            elValue = selectedElements[i].asc_getObjectValue();\r\n
                            (new SSE.Views.ShapeSettingsAdvanced({\r\n
                                shapeProps: elValue,\r\n
                                handler: function (result, value) {\r\n
                                    if (result == "ok") {\r\n
                                        if (me.api) {\r\n
                                            me.api.asc_setGraphicObjectProps(value.shapeProps);\r\n
                                        }\r\n
                                    }\r\n
                                    Common.NotificationCenter.trigger("edit:complete", me);\r\n
                                }\r\n
                            })).show();\r\n
                            break;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        ChangeSettings: function (props) {\r\n
            if (this._initSettings) {\r\n
                this.createDelayedElements();\r\n
            }\r\n
            this._initSettings = false;\r\n
            if (this.imgprops == null) {\r\n
                this.imgprops = new Asc.asc_CImgProperty();\r\n
            }\r\n
            if (props && props.asc_getShapeProperties()) {\r\n
                var shapeprops = props.asc_getShapeProperties();\r\n
                this._originalProps = shapeprops;\r\n
                this._noApply = true;\r\n
                this.disableControls(this._locked, !shapeprops.asc_getCanFill());\r\n
                this.hideShapeOnlySettings(shapeprops.asc_getFromChart());\r\n
                var rec = null;\r\n
                var fill = shapeprops.asc_getFill();\r\n
                var fill_type = fill.asc_getType();\r\n
                var color = null;\r\n
                var transparency = fill.asc_getTransparent();\r\n
                if (Math.abs(this._state.Transparency - transparency) > 0.001 || Math.abs(this.numTransparency.getNumberValue() - transparency) > 0.001 || (this._state.Transparency === null || transparency === null) && (this._state.Transparency !== transparency || this.numTransparency.getNumberValue() !== transparency)) {\r\n
                    if (transparency !== undefined) {\r\n
                        this.sldrTransparency.setValue((transparency === null) ? 100 : transparency / 255 * 100, true);\r\n
                        this.numTransparency.setValue(this.sldrTransparency.getValue(), true);\r\n
                    }\r\n
                    this._state.Transparency = transparency;\r\n
                }\r\n
                if (fill === null || fill_type === null) {\r\n
                    this.OriginalFillType = null;\r\n
                } else {\r\n
                    if (fill_type == c_oAscFill.FILL_TYPE_NOFILL) {\r\n
                        this.OriginalFillType = c_oAscFill.FILL_TYPE_NOFILL;\r\n
                    } else {\r\n
                        if (fill_type == c_oAscFill.FILL_TYPE_SOLID) {\r\n
                            fill = fill.asc_getFill();\r\n
                            color = fill.asc_getColor();\r\n
                            if (color) {\r\n
                                if (color.asc_getType() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                                    this.ShapeColor = {\r\n
                                        Value: 1,\r\n
                                        Color: {\r\n
                                            color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB()),\r\n
                                            effectValue: color.asc_getValue()\r\n
                                        }\r\n
                                    };\r\n
                                } else {\r\n
                                    this.ShapeColor = {\r\n
                                        Value: 1,\r\n
                                        Color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB())\r\n
                                    };\r\n
                                }\r\n
                            } else {\r\n
                                this.ShapeColor = {\r\n
                                    Value: 0,\r\n
                                    Color: "transparent"\r\n
                                };\r\n
                            }\r\n
                            this.OriginalFillType = c_oAscFill.FILL_TYPE_SOLID;\r\n
                            this.FGColor = (this.ShapeColor.Color !== "transparent") ? {\r\n
                                Value: 1,\r\n
                                Color: Common.Utils.ThemeColor.colorValue2EffectId(this.ShapeColor.Color)\r\n
                            } : {\r\n
                                Value: 1,\r\n
                                Color: "000000"\r\n
                            };\r\n
                            this.BGColor = {\r\n
                                Value: 1,\r\n
                                Color: "ffffff"\r\n
                            };\r\n
                        } else {\r\n
                            if (fill_type == c_oAscFill.FILL_TYPE_BLIP) {\r\n
                                fill = fill.asc_getFill();\r\n
                                this.BlipFillType = fill.asc_getType();\r\n
                                if (this._state.BlipFillType !== this.BlipFillType) {\r\n
                                    if (this.BlipFillType == c_oAscFillBlipType.STRETCH || this.BlipFillType == c_oAscFillBlipType.TILE) {\r\n
                                        this.cmbFillType.setValue(this.BlipFillType);\r\n
                                    } else {\r\n
                                        this.cmbFillType.setValue("");\r\n
                                    }\r\n
                                    this._state.BlipFillType = this.BlipFillType;\r\n
                                }\r\n
                                this.OriginalFillType = c_oAscFill.FILL_TYPE_BLIP;\r\n
                            } else {\r\n
                                if (fill_type == c_oAscFill.FILL_TYPE_PATT) {\r\n
                                    fill = fill.asc_getFill();\r\n
                                    this.PatternFillType = fill.asc_getPatternType();\r\n
                                    if (this._state.PatternFillType !== this.PatternFillType) {\r\n
                                        this.cmbPattern.suspendEvents();\r\n
                                        var rec = this.cmbPattern.menuPicker.store.findWhere({\r\n
                                            type: this.PatternFillType\r\n
                                        });\r\n
                                        this.cmbPattern.menuPicker.selectRecord(rec);\r\n
                                        this.cmbPattern.resumeEvents();\r\n
                                        this._state.PatternFillType = this.PatternFillType;\r\n
                                    }\r\n
                                    color = fill.asc_getColorFg();\r\n
                                    if (color) {\r\n
                                        if (color.asc_getType() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                                            this.FGColor = {\r\n
                                                Value: 1,\r\n
                                                Color: {\r\n
                                                    color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB()),\r\n
                                                    effectValue: color.asc_getValue()\r\n
                                                }\r\n
                                            };\r\n
                                        } else {\r\n
                                            this.FGColor = {\r\n
                                                Value: 1,\r\n
                                                Color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB())\r\n
                                            };\r\n
                                        }\r\n
                                    } else {\r\n
                                        this.FGColor = {\r\n
                                            Value: 1,\r\n
                                            Color: "000000"\r\n
                                        };\r\n
                                    }\r\n
                                    color = fill.asc_getColorBg();\r\n
                                    if (color) {\r\n
                                        if (color.asc_getType() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                                            this.BGColor = {\r\n
                                                Value: 1,\r\n
                                                Color: {\r\n
                                                    color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB()),\r\n
                                                    effectValue: color.asc_getValue()\r\n
                                                }\r\n
                                            };\r\n
                                        } else {\r\n
                                            this.BGColor = {\r\n
                                                Value: 1,\r\n
                                                Color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB())\r\n
                                            };\r\n
                                        }\r\n
                                    } else {\r\n
                                        this.BGColor = {\r\n
                                            Value: 1,\r\n
                                            Color: "ffffff"\r\n
                                        };\r\n
                                    }\r\n
                                    this.OriginalFillType = c_oAscFill.FILL_TYPE_PATT;\r\n
                                    this.ShapeColor = (this.FGColor.Color !== "transparent") ? {\r\n
                                        Value: 1,\r\n
                                        Color: Common.Utils.ThemeColor.colorValue2EffectId(this.FGColor.Color)\r\n
                                    } : {\r\n
                                        Value: 1,\r\n
                                        Color: "ffffff"\r\n
                                    };\r\n
                                } else {\r\n
                                    if (fill_type == c_oAscFill.FILL_TYPE_GRAD) {\r\n
                                        fill = fill.asc_getFill();\r\n
                                        var gradfilltype = fill.asc_getGradType();\r\n
                                        if (this._state.GradFillType !== gradfilltype || this.GradFillType !== gradfilltype) {\r\n
                                            this.GradFillType = gradfilltype;\r\n
                                            rec = undefined;\r\n
                                            if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR || this.GradFillType == c_oAscFillGradType.GRAD_PATH) {\r\n
                                                this.cmbGradType.setValue(this.GradFillType);\r\n
                                                rec = this.cmbGradType.store.findWhere({\r\n
                                                    value: this.GradFillType\r\n
                                                });\r\n
                                                this.onGradTypeSelect(this.cmbGradType, rec.attributes);\r\n
                                            } else {\r\n
                                                this.cmbGradType.setValue("");\r\n
                                                this.btnDirection.setIconCls("");\r\n
                                            }\r\n
                                            this._state.GradFillType = this.GradFillType;\r\n
                                        }\r\n
                                        if (this.GradFillType == c_oAscFillGradType.GRAD_LINEAR) {\r\n
                                            var value = Math.floor(fill.asc_getLinearAngle() / 60000);\r\n
                                            if (Math.abs(this.GradLinearDirectionType - value) > 0.001) {\r\n
                                                this.GradLinearDirectionType = value;\r\n
                                                var record = this.mnuDirectionPicker.store.findWhere({\r\n
                                                    type: value\r\n
                                                });\r\n
                                                this.mnuDirectionPicker.selectRecord(record, true);\r\n
                                                if (record) {\r\n
                                                    this.btnDirection.setIconCls("item-gradient " + record.get("iconcls"));\r\n
                                                } else {\r\n
                                                    this.btnDirection.setIconCls("");\r\n
                                                }\r\n
                                            }\r\n
                                        }\r\n
                                        var colors = fill.asc_getColors();\r\n
                                        if (colors && colors.length > 0) {\r\n
                                            color = colors[0];\r\n
                                            if (color) {\r\n
                                                if (color.asc_getType() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                                                    this.GradColor.colors[0] = {\r\n
                                                        color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB()),\r\n
                                                        effectValue: color.asc_getValue()\r\n
                                                    };\r\n
                                                    Common.Utils.ThemeColor.colorValue2EffectId(this.GradColor.colors[0]);\r\n
                                                } else {\r\n
                                                    this.GradColor.colors[0] = Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB());\r\n
                                                }\r\n
                                            } else {\r\n
                                                this.GradColor.colors[0] = "000000";\r\n
                                            }\r\n
                                            color = colors[1];\r\n
                                            if (color) {\r\n
                                                if (color.asc_getType() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                                                    this.GradColor.colors[1] = {\r\n
                                                        color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB()),\r\n
                                                        effectValue: color.asc_getValue()\r\n
                                                    };\r\n
                                                    Common.Utils.ThemeColor.colorValue2EffectId(this.GradColor.colors[1]);\r\n
                                                } else {\r\n
                                                    this.GradColor.colors[1] = Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB());\r\n
                                                }\r\n
                                            } else {\r\n
                                                this.GradColor.colors[1] = "ffffff";\r\n
                                            }\r\n
                                        }\r\n
                                        var positions = fill.asc_getPositions();\r\n
                                        if (positions && positions.length > 0) {\r\n
                                            var position = positions[0];\r\n
                                            if (position !== null) {\r\n
                                                position = position / 1000;\r\n
                                                this.GradColor.values[0] = position;\r\n
                                            }\r\n
                                            position = positions[1];\r\n
                                            if (position !== null) {\r\n
                                                position = position / 1000;\r\n
                                                this.GradColor.values[1] = position;\r\n
                                            }\r\n
                                        }\r\n
                                        this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}", (typeof(this.GradColor.colors[0]) == "object") ? this.GradColor.colors[0].color : this.GradColor.colors[0]), 0);\r\n
                                        this.sldrGradient.setColorValue(Common.Utils.String.format("#{0}", (typeof(this.GradColor.colors[1]) == "object") ? this.GradColor.colors[1].color : this.GradColor.colors[1]), 1);\r\n
                                        this.sldrGradient.setValue(0, this.GradColor.values[0]);\r\n
                                        this.sldrGradient.setValue(1, this.GradColor.values[1]);\r\n
                                        this.OriginalFillType = c_oAscFill.FILL_TYPE_GRAD;\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
                if (this._state.FillType !== this.OriginalFillType) {\r\n
                    this.cmbFillSrc.setValue((this.OriginalFillType === null) ? "" : this.OriginalFillType);\r\n
                    this._state.FillType = this.OriginalFillType;\r\n
                    this.ShowHideElem(this.OriginalFillType);\r\n
                }\r\n
                $(this.btnTexture.el).find(".form-control").prop("innerHTML", this.textSelectTexture);\r\n
                var type1 = typeof(this.ShapeColor.Color),\r\n
                type2 = typeof(this._state.ShapeColor);\r\n
                if ((type1 !== type2) || (type1 == "object" && (this.ShapeColor.Color.effectValue !== this._state.ShapeColor.effectValue || this._state.ShapeColor.color.indexOf(this.ShapeColor.Color.color) < 0)) || (type1 != "object" && this._state.ShapeColor.indexOf(this.ShapeColor.Color) < 0)) {\r\n
                    this.btnBackColor.setColor(this.ShapeColor.Color);\r\n
                    if (typeof(this.ShapeColor.Color) == "object") {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == this.ShapeColor.Color.effectValue) {\r\n
                                this.colorsBack.select(this.ShapeColor.Color, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            this.colorsBack.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        this.colorsBack.select(this.ShapeColor.Color, true);\r\n
                    }\r\n
                    this._state.ShapeColor = this.ShapeColor.Color;\r\n
                }\r\n
                var stroke = shapeprops.asc_getStroke();\r\n
                var strokeType = stroke.asc_getType();\r\n
                if (stroke) {\r\n
                    if (strokeType == c_oAscStrokeType.STROKE_COLOR) {\r\n
                        color = stroke.asc_getColor();\r\n
                        if (color) {\r\n
                            if (color.asc_getType() == c_oAscColor.COLOR_TYPE_SCHEME) {\r\n
                                this.BorderColor = {\r\n
                                    Value: 1,\r\n
                                    Color: {\r\n
                                        color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB()),\r\n
                                        effectValue: color.asc_getValue()\r\n
                                    }\r\n
                                };\r\n
                            } else {\r\n
                                this.BorderColor = {\r\n
                                    Value: 1,\r\n
                                    Color: Common.Utils.ThemeColor.getHexColor(color.asc_getR(), color.asc_getG(), color.asc_getB())\r\n
                                };\r\n
                            }\r\n
                        } else {\r\n
                            this.BorderColor = {\r\n
                                Value: 1,\r\n
                                Color: "transparent"\r\n
                            };\r\n
                        }\r\n
                    } else {\r\n
                        this.BorderColor = {\r\n
                            Value: 1,\r\n
                            Color: "transparent"\r\n
                        };\r\n
                    }\r\n
                } else {\r\n
                    strokeType = null;\r\n
                    this.BorderColor = {\r\n
                        Value: 0,\r\n
                        Color: "transparent"\r\n
                    };\r\n
                }\r\n
                type1 = typeof(this.BorderColor.Color);\r\n
                type2 = typeof(this._state.StrokeColor);\r\n
                if ((type1 !== type2) || (type1 == "object" && (this.BorderColor.Color.effectValue !== this._state.StrokeColor.effectValue || this._state.StrokeColor.color.indexOf(this.BorderColor.Color.color) < 0)) || (type1 != "object" && (this._state.StrokeColor.indexOf(this.BorderColor.Color) < 0 || typeof(this.btnBorderColor.color) == "object"))) {\r\n
                    this.btnBorderColor.setColor(this.BorderColor.Color);\r\n
                    if (typeof(this.BorderColor.Color) == "object") {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == this.BorderColor.Color.effectValue) {\r\n
                                this.colorsBorder.select(this.BorderColor.Color, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            this.colorsBorder.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        this.colorsBorder.select(this.BorderColor.Color, true);\r\n
                    }\r\n
                    this._state.StrokeColor = this.BorderColor.Color;\r\n
                }\r\n
                if (this._state.StrokeType !== strokeType || strokeType == c_oAscStrokeType.STROKE_COLOR) {\r\n
                    if (strokeType == c_oAscStrokeType.STROKE_COLOR) {\r\n
                        var w = stroke.asc_getWidth();\r\n
                        var check_value = (Math.abs(this._state.StrokeWidth - w) < 0.001) && !(/pt\\s*$/.test(this.cmbBorderSize.getRawValue()));\r\n
                        if (Math.abs(this._state.StrokeWidth - w) > 0.001 || check_value || (this._state.StrokeWidth === null || w === null) && (this._state.StrokeWidth !== w)) {\r\n
                            this._state.StrokeWidth = w;\r\n
                            if (w !== null) {\r\n
                                w = this._mm2pt(w);\r\n
                            }\r\n
                            var _selectedItem = (w === null) ? w : _.find(this.cmbBorderSize.store.models, function (item) {\r\n
                                if (w < item.attributes.value + 0.01 && w > item.attributes.value - 0.01) {\r\n
                                    return true;\r\n
                                }\r\n
                            });\r\n
                            if (_selectedItem) {\r\n
                                this.cmbBorderSize.selectRecord(_selectedItem);\r\n
                            } else {\r\n
                                this.cmbBorderSize.setValue((w !== null) ? parseFloat(w.toFixed(2)) + " pt" : "");\r\n
                            }\r\n
                            this.BorderSize = w;\r\n
                        }\r\n
                    } else {\r\n
                        if (strokeType == c_oAscStrokeType.STROKE_NONE) {\r\n
                            this._state.StrokeWidth = 0;\r\n
                            this.BorderSize = this.cmbBorderSize.store.at(0).get("value");\r\n
                            this.cmbBorderSize.setValue(this.BorderSize);\r\n
                        } else {\r\n
                            this._state.StrokeWidth = null;\r\n
                            this.BorderSize = -1;\r\n
                            this.cmbBorderSize.setValue(null);\r\n
                        }\r\n
                    }\r\n
                    this._state.StrokeType = strokeType;\r\n
                }\r\n
                type1 = typeof(this.FGColor.Color);\r\n
                type2 = typeof(this._state.FGColor);\r\n
                if ((type1 !== type2) || (type1 == "object" && (this.FGColor.Color.effectValue !== this._state.FGColor.effectValue || this._state.FGColor.color.indexOf(this.FGColor.Color.color) < 0)) || (type1 != "object" && this._state.FGColor.indexOf(this.FGColor.Color) < 0)) {\r\n
                    this.btnFGColor.setColor(this.FGColor.Color);\r\n
                    if (typeof(this.FGColor.Color) == "object") {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == this.FGColor.Color.effectValue) {\r\n
                                this.colorsFG.select(this.FGColor.Color, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            this.colorsFG.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        this.colorsFG.select(this.FGColor.Color, true);\r\n
                    }\r\n
                    this._state.FGColor = this.FGColor.Color;\r\n
                }\r\n
                type1 = typeof(this.BGColor.Color);\r\n
                type2 = typeof(this._state.BGColor);\r\n
                if ((type1 !== type2) || (type1 == "object" && (this.BGColor.Color.effectValue !== this._state.BGColor.effectValue || this._state.BGColor.color.indexOf(this.BGColor.Color.color) < 0)) || (type1 != "object" && this._state.BGColor.indexOf(this.BGColor.Color) < 0)) {\r\n
                    this.btnBGColor.setColor(this.BGColor.Color);\r\n
                    if (typeof(this.BGColor.Color) == "object") {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == this.BGColor.Color.effectValue) {\r\n
                                this.colorsBG.select(this.BGColor.Color, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            this.colorsBG.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        this.colorsBG.select(this.BGColor.Color, true);\r\n
                    }\r\n
                    this._state.BGColor = this.BGColor.Color;\r\n
                }\r\n
                color = this.GradColor.colors[this.GradColor.currentIdx];\r\n
                type1 = typeof(color);\r\n
                type2 = typeof(this._state.GradColor);\r\n
                if ((type1 !== type2) || (type1 == "object" && (color.effectValue !== this._state.GradColor.effectValue || this._state.GradColor.color.indexOf(color.color) < 0)) || (type1 != "object" && this._state.GradColor.indexOf(color) < 0)) {\r\n
                    this.btnGradColor.setColor(color);\r\n
                    if (typeof(color) == "object") {\r\n
                        var isselected = false;\r\n
                        for (var i = 0; i < 10; i++) {\r\n
                            if (Common.Utils.ThemeColor.ThemeValues[i] == color.effectValue) {\r\n
                                this.colorsGrad.select(color, true);\r\n
                                isselected = true;\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                        if (!isselected) {\r\n
                            this.colorsGrad.clearSelection();\r\n
                        }\r\n
                    } else {\r\n
                        this.colorsGrad.select(color, true);\r\n
                    }\r\n
                    this._state.GradColor = color;\r\n
                }\r\n
                this._noApply = false;\r\n
            }\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            var global_hatch_menu_map = [0, 1, 3, 2, 4, 53, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 49, 50, 51, 52];\r\n
            this.patternViewData = [];\r\n
            for (var i = 0; i < 13; i++) {\r\n
                for (var j = 0; j < 4; j++) {\r\n
                    var num = i * 4 + j;\r\n
                    this.patternViewData[num] = {\r\n
                        offsetx: j * 28,\r\n
                        offsety: i * 28,\r\n
                        type: global_hatch_menu_map[num]\r\n
                    };\r\n
                }\r\n
            }\r\n
            this.patternViewData.splice(this.patternViewData.length - 2, 2);\r\n
            for (var i = 0; i < this.patternViewData.length; i++) {\r\n
                this.patternViewData[i].id = Common.UI.getId();\r\n
            }\r\n
            this.cmbPattern.menuPicker.store.add(this.patternViewData);\r\n
            if (this.cmbPattern.menuPicker.store.length > 0) {\r\n
                this.cmbPattern.fillComboView(this.cmbPattern.menuPicker.store.at(0), true);\r\n
                this.PatternFillType = this.patternViewData[0].type;\r\n
            }\r\n
            this.fillAutoShapes();\r\n
            this.UpdateThemeColors();\r\n
        },\r\n
        onInitStandartTextures: function (texture) {\r\n
            var me = this;\r\n
            if (texture && texture.length > 0) {\r\n
                var texturearray = [];\r\n
                _.each(texture, function (item) {\r\n
                    texturearray.push({\r\n
                        imageUrl: item.asc_getImage(),\r\n
                        name: me.textureNames[item.asc_getId()],\r\n
                        type: item.asc_getId(),\r\n
                        selected: false\r\n
                    });\r\n
                });\r\n
                var mnuTexturePicker = new Common.UI.DataView({\r\n
                    el: $("#id-shape-menu-texture"),\r\n
                    parentMenu: me.textureMenu,\r\n
                    restoreHeight: 174,\r\n
                    store: new Common.UI.DataViewStore(texturearray),\r\n
                    itemTemplate: _.template(\'<div class="item-shape"><img src="<%= imageUrl %>" id="<%= id %>"></div>\')\r\n
                });\r\n
                mnuTexturePicker.on("item:click", _.bind(this.onSelectTexture, this));\r\n
                me.textureMenu.on("show:after", function (btn) {\r\n
                    mnuTexturePicker.deselectAll();\r\n
                });\r\n
            }\r\n
        },\r\n
        onSelectTexture: function (picker, view, record) {\r\n
            this._fromTextureCmb = true;\r\n
            this.cmbFillType.setValue(this._arrFillType[1].value);\r\n
            this._fromTextureCmb = false;\r\n
            if (this.api) {\r\n
                var props = new Asc.asc_CShapeProperty();\r\n
                var fill = new Asc.asc_CShapeFill();\r\n
                fill.asc_putType(c_oAscFill.FILL_TYPE_BLIP);\r\n
                fill.asc_putFill(new Asc.asc_CFillBlip());\r\n
                fill.asc_getFill().asc_putType(c_oAscFillBlipType.TILE);\r\n
                fill.asc_getFill().asc_putTextureId(record.get("type"));\r\n
                props.asc_putFill(fill);\r\n
                this.imgprops.asc_putShapeProperties(props);\r\n
                this.api.asc_setGraphicObjectProps(this.imgprops);\r\n
            }\r\n
            $(this.btnTexture.el).find(".form-control").prop("innerHTML", record.get("name"));\r\n
            Common.NotificationCenter.trigger("edit:complete", this);\r\n
        },\r\n
        fillAutoShapes: function () {\r\n
            var me = this,\r\n
            shapesStore = this.application.getCollection("ShapeGroups");\r\n
            var count = shapesStore.length;\r\n
            for (var i = 0; i < count; i++) {\r\n
                if (i == count - 2) {\r\n
                    continue;\r\n
                }\r\n
                var shapeGroup = shapesStore.at(i);\r\n
                var menuItem = new Common.UI.MenuItem({\r\n
                    caption: shapeGroup.get("groupName"),\r\n
                    menu: new Common.UI.Menu({\r\n
                        menuAlign: "tr-tl",\r\n
                        items: [{\r\n
                            template: _.template(\'<div id="id-shape-menu-shapegroup\' + i + \'" class="menu-shape" style="width: \' + (shapeGroup.get("groupWidth") - 8) + \'px; margin-left: 5px;"></div>\')\r\n
                        }]\r\n
                    })\r\n
                });\r\n
                me.btnChangeShape.menu.addItem(menuItem);\r\n
                var shapePicker = new Common.UI.DataView({\r\n
                    el: $("#id-shape-menu-shapegroup" + i),\r\n
                    store: shapeGroup.get("groupStore"),\r\n
                    itemTemplate: _.template(\'<div class="item-shape"><img src="<%= imageUrl %>" id="<%= id %>"></div>\')\r\n
                });\r\n
                shapePicker.on("item:click", function (picker, item, record) {\r\n
                    if (me.api) {\r\n
                        me.api.asc_changeShapeType(record.get("data").shapeType);\r\n
                        Common.NotificationCenter.trigger("edit:complete", me);\r\n
                    }\r\n
                });\r\n
            }\r\n
        },\r\n
        UpdateThemeColors: function () {\r\n
            this.colorsBorder.updateColors(Common.Utils.ThemeColor.getEffectColors(), Common.Utils.ThemeColor.getStandartColors());\r\n
            this.colorsBack.updateColors(Common.Utils.ThemeColor.getEffectColors(), Common.Utils.ThemeColor.getStandartColors());\r\n
            this.colorsFG.updateColors(Common.Utils.ThemeColor.getEffectColors(), Common.Utils.ThemeColor.getStandartColors());\r\n
            this.colorsBG.updateColors(Common.Utils.ThemeColor.getEffectColors(), Common.Utils.ThemeColor.getStandartColors());\r\n
            this.colorsGrad.updateColors(Common.Utils.ThemeColor.getEffectColors(), Common.Utils.ThemeColor.getStandartColors());\r\n
        },\r\n
        _pt2mm: function (value) {\r\n
            return (value * 25.4 / 72);\r\n
        },\r\n
        _mm2pt: function (value) {\r\n
            return (value * 72 / 25.4);\r\n
        },\r\n
        disableFillPanels: function (disable) {\r\n
            if (this._state.DisabledFillPanels !== disable) {\r\n
                this._state.DisabledFillPanels = disable;\r\n
                _.each(this.fillControls, function (item) {\r\n
                    item.setDisabled(disable);\r\n
                });\r\n
                this.lblTransparencyStart.toggleClass("disabled", disable);\r\n
                this.lblTransparencyEnd.toggleClass("disabled", disable);\r\n
            }\r\n
        },\r\n
        ShowHideElem: function (value) {\r\n
            this.FillColorContainer.toggleClass("settings-hidden", value !== c_oAscFill.FILL_TYPE_SOLID);\r\n
            this.FillImageContainer.toggleClass("settings-hidden", value !== c_oAscFill.FILL_TYPE_BLIP);\r\n
            this.FillPatternContainer.toggleClass("settings-hidden", value !== c_oAscFill.FILL_TYPE_PATT);\r\n
            this.FillGradientContainer.toggleClass("settings-hidden", value !== c_oAscFill.FILL_TYPE_GRAD);\r\n
            this.TransparencyContainer.toggleClass("settings-hidden", (value === c_oAscFill.FILL_TYPE_NOFILL || value === null));\r\n
        },\r\n
        setLocked: function (locked) {\r\n
            this._locked = locked;\r\n
        },\r\n
        disableControls: function (disable, disableFill) {\r\n
            this.disableFillPanels(disable || disableFill);\r\n
            if (this._state.DisabledControls !== disable) {\r\n
                this._state.DisabledControls = disable;\r\n
                _.each(this.lockedControls, function (item) {\r\n
                    item.setDisabled(disable);\r\n
                });\r\n
                this.linkAdvanced.toggleClass("disabled", disable);\r\n
            }\r\n
        },\r\n
        hideShapeOnlySettings: function (value) {\r\n
            if (this._state.HideShapeOnlySettings !== value) {\r\n
                this._state.HideShapeOnlySettings = value;\r\n
                this.ShapeOnlySettings.toggleClass("hidden", value == true);\r\n
            }\r\n
        },\r\n
        txtNoBorders: "No Line",\r\n
        strStroke: "Stroke",\r\n
        strColor: "Color",\r\n
        strSize: "Size",\r\n
        strChange: "Change Autoshape",\r\n
        strFill: "Fill",\r\n
        textColor: "Color Fill",\r\n
        textImageTexture: "Picture or Texture",\r\n
        textTexture: "From Texture",\r\n
        textFromUrl: "From URL",\r\n
        textFromFile: "From File",\r\n
        textStretch: "Stretch",\r\n
        textTile: "Tile",\r\n
        txtCanvas: "Canvas",\r\n
        txtCarton: "Carton",\r\n
        txtDarkFabric: "Dark Fabric",\r\n
        txtGrain: "Grain",\r\n
        txtGranite: "Granite",\r\n
        txtGreyPaper: "Grey Paper",\r\n
        txtKnit: "Knit",\r\n
        txtLeather: "Leather",\r\n
        txtBrownPaper: "Brown Paper",\r\n
        txtPapyrus: "Papyrus",\r\n
        txtWood: "Wood",\r\n
        textNewColor: "Add New Custom Color",\r\n
        textThemeColors: "Theme Colors",\r\n
        textStandartColors: "Standart Colors",\r\n
        textAdvanced: "Show advanced settings",\r\n
        strTransparency: "Opacity",\r\n
        textNoFill: "No Fill",\r\n
        textSelectTexture: "Select",\r\n
        textGradientFill: "Gradient Fill",\r\n
        textPatternFill: "Pattern",\r\n
        strBackground: "Background color",\r\n
        strForeground: "Foreground color",\r\n
        strPattern: "Pattern",\r\n
        textEmptyPattern: "No Pattern",\r\n
        textLinear: "Linear",\r\n
        textRadial: "Radial",\r\n
        textDirection: "Direction",\r\n
        textStyle: "Style",\r\n
        textGradient: "Gradient",\r\n
        textBorderSizeErr: "The entered value is incorrect.<br>Please enter a value between 0 pt and 1584 pt."\r\n
    },\r\n
    SSE.Views.ShapeSettings || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 var SCALE_MIN = 40;\r\n
var MENU_SCALE_PART = 260;\r\n
define(\'spreadsheeteditor/main/app/view/RightMenu\',["text!spreadsheeteditor/main/app/template/RightMenu.template", "jquery", "underscore", "backbone", "common/main/lib/component/Button", "common/main/lib/component/MetricSpinner", "common/main/lib/component/CheckBox", "spreadsheeteditor/main/app/view/ParagraphSettings", "spreadsheeteditor/main/app/view/ImageSettings", "spreadsheeteditor/main/app/view/ChartSettings", "spreadsheeteditor/main/app/view/ShapeSettings", "common/main/lib/component/Scroller"], function (menuTemplate, $, _, Backbone) {\r\n
    SSE.Views.RightMenu = Backbone.View.extend(_.extend({\r\n
        el: "#right-menu",\r\n
        template: _.template(menuTemplate),\r\n
        events: {},\r\n
        initialize: function () {\r\n
            this.minimizedMode = true;\r\n
            this.btnText = new Common.UI.Button({\r\n
                hint: this.txtParagraphSettings,\r\n
                asctype: c_oAscTypeSelectElement.Paragraph,\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "tabpanelbtnsGroup"\r\n
            });\r\n
            this.btnImage = new Common.UI.Button({\r\n
                hint: this.txtImageSettings,\r\n
                asctype: c_oAscTypeSelectElement.Image,\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "tabpanelbtnsGroup"\r\n
            });\r\n
            this.btnChart = new Common.UI.Button({\r\n
                hint: this.txtChartSettings,\r\n
                asctype: c_oAscTypeSelectElement.Chart,\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "tabpanelbtnsGroup"\r\n
            });\r\n
            this.btnShape = new Common.UI.Button({\r\n
                hint: this.txtShapeSettings,\r\n
                asctype: c_oAscTypeSelectElement.Shape,\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "tabpanelbtnsGroup"\r\n
            });\r\n
            this._settings = [];\r\n
            this._settings[c_oAscTypeSelectElement.Paragraph] = {\r\n
                panel: "id-paragraph-settings",\r\n
                btn: this.btnText\r\n
            };\r\n
            this._settings[c_oAscTypeSelectElement.Image] = {\r\n
                panel: "id-image-settings",\r\n
                btn: this.btnImage\r\n
            };\r\n
            this._settings[c_oAscTypeSelectElement.Shape] = {\r\n
                panel: "id-shape-settings",\r\n
                btn: this.btnShape\r\n
            };\r\n
            this._settings[c_oAscTypeSelectElement.Chart] = {\r\n
                panel: "id-chart-settings",\r\n
                btn: this.btnChart\r\n
            };\r\n
            return this;\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            this.trigger("render:before", this);\r\n
            el.css("width", "40px");\r\n
            el.css("z-index", 101);\r\n
            el.show();\r\n
            el.html(this.template({}));\r\n
            this.btnText.el = $("#id-right-menu-text");\r\n
            this.btnText.render();\r\n
            this.btnImage.el = $("#id-right-menu-image");\r\n
            this.btnImage.render();\r\n
            this.btnChart.el = $("#id-right-menu-chart");\r\n
            this.btnChart.render();\r\n
            this.btnShape.el = $("#id-right-menu-shape");\r\n
            this.btnShape.render();\r\n
            this.btnText.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.btnImage.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.btnChart.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.btnShape.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.paragraphSettings = new SSE.Views.ParagraphSettings();\r\n
            this.imageSettings = new SSE.Views.ImageSettings();\r\n
            this.chartSettings = new SSE.Views.ChartSettings();\r\n
            this.shapeSettings = new SSE.Views.ShapeSettings();\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el).find(".right-panel"),\r\n
                    suppressScrollX: true,\r\n
                    useKeyboard: false\r\n
                });\r\n
            }\r\n
            this.trigger("render:after", this);\r\n
            return this;\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.paragraphSettings.setApi(api);\r\n
            this.imageSettings.setApi(api);\r\n
            this.chartSettings.setApi(api);\r\n
            this.shapeSettings.setApi(api);\r\n
        },\r\n
        setMode: function (mode) {},\r\n
        onBtnMenuClick: function (btn, e) {\r\n
            var target_pane = $("#" + this._settings[btn.options.asctype].panel);\r\n
            var target_pane_parent = target_pane.parent();\r\n
            if (btn.pressed) {\r\n
                if (this.minimizedMode) {\r\n
                    $(this.el).width(MENU_SCALE_PART);\r\n
                    target_pane_parent.css("display", "inline-block");\r\n
                    this.minimizedMode = false;\r\n
                    window.localStorage.setItem("sse-hidden-right-settings", 0);\r\n
                }\r\n
                target_pane_parent.find("> .active").removeClass("active");\r\n
                target_pane.addClass("active");\r\n
                if (this.scroller) {\r\n
                    this.scroller.scrollTop(0);\r\n
                }\r\n
            } else {\r\n
                target_pane_parent.css("display", "none");\r\n
                $(this.el).width(SCALE_MIN);\r\n
                this.minimizedMode = true;\r\n
                window.localStorage.setItem("sse-hidden-right-settings", 1);\r\n
            }\r\n
            this.fireEvent("rightmenuclick", [this, btn.options.asctype, this.minimizedMode]);\r\n
        },\r\n
        SetActivePane: function (type, open) {\r\n
            if (this.minimizedMode && open !== true || this._settings[type] === undefined) {\r\n
                return;\r\n
            }\r\n
            if (this.minimizedMode) {\r\n
                this._settings[type].btn.toggle(true, false);\r\n
                this._settings[type].btn.trigger("click", this._settings[type].btn);\r\n
            } else {\r\n
                var target_pane = $("#" + this._settings[type].panel);\r\n
                if (!target_pane.hasClass("active")) {\r\n
                    target_pane.parent().find("> .active").removeClass("active");\r\n
                    target_pane.addClass("active");\r\n
                    if (this.scroller) {\r\n
                        this.scroller.update();\r\n
                    }\r\n
                }\r\n
                if (!this._settings[type].btn.isActive()) {\r\n
                    this._settings[type].btn.toggle(true, false);\r\n
                }\r\n
            }\r\n
        },\r\n
        GetActivePane: function () {\r\n
            return (this.minimizedMode) ? null : $(".settings-panel.active")[0].id;\r\n
        },\r\n
        SetDisabled: function (id, disabled, all) {\r\n
            if (all) {\r\n
                this.paragraphSettings.disableControls(disabled);\r\n
                this.shapeSettings.disableControls(disabled);\r\n
                this.imageSettings.disableControls(disabled);\r\n
                this.chartSettings.disableControls(disabled);\r\n
            } else {\r\n
                var cmp = $("#" + id);\r\n
                if (disabled !== cmp.hasClass("disabled")) {\r\n
                    cmp.toggleClass("disabled", disabled);\r\n
                    (disabled) ? cmp.attr({\r\n
                        disabled: disabled\r\n
                    }) : cmp.removeAttr("disabled");\r\n
                }\r\n
            }\r\n
        },\r\n
        clearSelection: function () {\r\n
            var target_pane = $(".right-panel");\r\n
            target_pane.find("> .active").removeClass("active");\r\n
            _.each(this._settings, function (item) {\r\n
                if (item.btn.isActive()) {\r\n
                    item.btn.toggle(false, true);\r\n
                }\r\n
            });\r\n
            target_pane.css("display", "none");\r\n
            $(this.el).width(SCALE_MIN);\r\n
            this.minimizedMode = true;\r\n
            window.localStorage.setItem("sse-hidden-right-settings", 1);\r\n
            Common.NotificationCenter.trigger("layout:changed", "rightmenu");\r\n
        },\r\n
        txtParagraphSettings: "Paragraph Settings",\r\n
        txtImageSettings: "Image Settings",\r\n
        txtShapeSettings: "Shape Settings",\r\n
        txtChartSettings: "Chart Settings"\r\n
    },\r\n
    SSE.Views.RightMenu || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/RightMenu\',["core", "spreadsheeteditor/main/app/view/RightMenu"], function () {\r\n
    SSE.Controllers.RightMenu = Backbone.Controller.extend({\r\n
        models: [],\r\n
        collections: [],\r\n
        views: ["RightMenu"],\r\n
        initialize: function () {\r\n
            this.editMode = true;\r\n
            this._state = {};\r\n
            this.addListeners({\r\n
                "RightMenu": {\r\n
                    "rightmenuclick": this.onRightMenuClick\r\n
                }\r\n
            });\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.rightmenu = this.createView("RightMenu");\r\n
            this.rightmenu.on("render:after", _.bind(this.onRightMenuAfterRender, this));\r\n
        },\r\n
        onRightMenuAfterRender: function (rightMenu) {\r\n
            rightMenu.shapeSettings.application = this.getApplication();\r\n
            this._settings = [];\r\n
            this._settings[c_oAscTypeSelectElement.Paragraph] = {\r\n
                panelId: "id-paragraph-settings",\r\n
                panel: rightMenu.paragraphSettings,\r\n
                btn: rightMenu.btnText,\r\n
                hidden: 1,\r\n
                locked: false\r\n
            };\r\n
            this._settings[c_oAscTypeSelectElement.Image] = {\r\n
                panelId: "id-image-settings",\r\n
                panel: rightMenu.imageSettings,\r\n
                btn: rightMenu.btnImage,\r\n
                hidden: 1,\r\n
                locked: false\r\n
            };\r\n
            this._settings[c_oAscTypeSelectElement.Shape] = {\r\n
                panelId: "id-shape-settings",\r\n
                panel: rightMenu.shapeSettings,\r\n
                btn: rightMenu.btnShape,\r\n
                hidden: 1,\r\n
                locked: false\r\n
            };\r\n
            this._settings[c_oAscTypeSelectElement.Chart] = {\r\n
                panelId: "id-chart-settings",\r\n
                panel: rightMenu.chartSettings,\r\n
                btn: rightMenu.btnChart,\r\n
                hidden: 1,\r\n
                locked: false\r\n
            };\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onCoAuthoringDisconnect, this));\r\n
            Common.NotificationCenter.on("api:disconnect", _.bind(this.onCoAuthoringDisconnect, this));\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.editMode = mode.isEdit;\r\n
        },\r\n
        onRightMenuClick: function (menu, type, minimized) {\r\n
            if (!minimized && this.editMode) {\r\n
                var panel = this._settings[type].panel;\r\n
                var props = this._settings[type].props;\r\n
                if (props && panel) {\r\n
                    panel.ChangeSettings.call(panel, props);\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("layout:changed", "rightmenu");\r\n
            Common.NotificationCenter.trigger("edit:complete", this.rightmenu);\r\n
        },\r\n
        onSelectionChanged: function (info) {\r\n
            var SelectedObjects = [],\r\n
            selectType = info.asc_getFlags().asc_getSelectionType();\r\n
            if (selectType == c_oAscSelectionType.RangeImage || selectType == c_oAscSelectionType.RangeShape || selectType == c_oAscSelectionType.RangeChart || selectType == c_oAscSelectionType.RangeChartText || selectType == c_oAscSelectionType.RangeShapeText) {\r\n
                SelectedObjects = this.api.asc_getGraphicObjectProps();\r\n
            }\r\n
            if (SelectedObjects.length <= 0 && !this.rightmenu.minimizedMode) {\r\n
                this.rightmenu.clearSelection();\r\n
            }\r\n
            this.onFocusObject(SelectedObjects);\r\n
            var need_disable = info.asc_getLocked(),\r\n
            me = this;\r\n
            if (this._state.prevDisabled != need_disable) {\r\n
                this._state.prevDisabled = need_disable;\r\n
                _.each(this._settings, function (item) {\r\n
                    item.panel.setLocked(need_disable);\r\n
                });\r\n
            }\r\n
        },\r\n
        onFocusObject: function (SelectedObjects) {\r\n
            if (!this.editMode) {\r\n
                return;\r\n
            }\r\n
            for (var i = 0; i < this._settings.length; ++i) {\r\n
                if (this._settings[i]) {\r\n
                    this._settings[i].hidden =

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABs=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="27" aka="AAAAAAAAABs=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

 1;\r\n
                    this._settings[i].locked = false;\r\n
                }\r\n
            }\r\n
            for (i = 0; i < SelectedObjects.length; ++i) {\r\n
                var type = SelectedObjects[i].asc_getObjectType();\r\n
                if (type >= this._settings.length || this._settings[type] === undefined) {\r\n
                    continue;\r\n
                }\r\n
                var value = SelectedObjects[i].asc_getObjectValue();\r\n
                if (type == c_oAscTypeSelectElement.Image) {\r\n
                    if (value.asc_getChartProperties() !== null) {\r\n
                        type = c_oAscTypeSelectElement.Chart;\r\n
                    } else {\r\n
                        if (value.asc_getShapeProperties() !== null) {\r\n
                            type = c_oAscTypeSelectElement.Shape;\r\n
                        }\r\n
                    }\r\n
                }\r\n
                this._settings[type].props = value;\r\n
                this._settings[type].hidden = 0;\r\n
                this._settings[type].locked = value.asc_getLocked();\r\n
            }\r\n
            var lastactive = -1,\r\n
            currentactive, priorityactive = -1;\r\n
            for (i = 0; i < this._settings.length; ++i) {\r\n
                var pnl = this._settings[i];\r\n
                if (pnl === undefined) {\r\n
                    continue;\r\n
                }\r\n
                if (pnl.hidden) {\r\n
                    if (!pnl.btn.isDisabled()) {\r\n
                        pnl.btn.setDisabled(true);\r\n
                    }\r\n
                    if (this.rightmenu.GetActivePane() == pnl.panelId) {\r\n
                        currentactive = -1;\r\n
                    }\r\n
                } else {\r\n
                    if (pnl.btn.isDisabled()) {\r\n
                        pnl.btn.setDisabled(false);\r\n
                    }\r\n
                    lastactive = i;\r\n
                    if (pnl.needShow) {\r\n
                        pnl.needShow = false;\r\n
                        priorityactive = i;\r\n
                    } else {\r\n
                        if (this.rightmenu.GetActivePane() == pnl.panelId) {\r\n
                            currentactive = i;\r\n
                        }\r\n
                    }\r\n
                    pnl.panel.setLocked(pnl.locked);\r\n
                }\r\n
            }\r\n
            if (!this.rightmenu.minimizedMode) {\r\n
                var active;\r\n
                if (priorityactive > -1) {\r\n
                    active = priorityactive;\r\n
                } else {\r\n
                    if (lastactive >= 0 && currentactive < 0) {\r\n
                        active = lastactive;\r\n
                    } else {\r\n
                        if (currentactive >= 0) {\r\n
                            active = currentactive;\r\n
                        }\r\n
                    }\r\n
                }\r\n
                if (active !== undefined) {\r\n
                    this.rightmenu.SetActivePane(active);\r\n
                    this._settings[active].panel.ChangeSettings.call(this._settings[active].panel, this._settings[active].props);\r\n
                }\r\n
            }\r\n
            this._settings[c_oAscTypeSelectElement.Image].needShow = false;\r\n
            this._settings[c_oAscTypeSelectElement.Chart].needShow = false;\r\n
        },\r\n
        onCoAuthoringDisconnect: function () {\r\n
            if (this.rightmenu) {\r\n
                this.rightmenu.SetDisabled("", true, true);\r\n
            }\r\n
            this.setMode({\r\n
                isEdit: false\r\n
            });\r\n
        },\r\n
        onInsertImage: function () {\r\n
            this._settings[c_oAscTypeSelectElement.Image].needShow = true;\r\n
        },\r\n
        onInsertChart: function () {\r\n
            this._settings[c_oAscTypeSelectElement.Chart].needShow = true;\r\n
        },\r\n
        onInsertShape: function () {\r\n
            this._settings[c_oAscTypeSelectElement.Shape].needShow = true;\r\n
        },\r\n
        UpdateThemeColors: function () {\r\n
            this.rightmenu.shapeSettings.UpdateThemeColors();\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            this.rightmenu.paragraphSettings.updateMetricUnit();\r\n
            this.rightmenu.chartSettings.updateMetricUnit();\r\n
            this.rightmenu.imageSettings.updateMetricUnit();\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            var me = this;\r\n
            if (this.api) {\r\n
                this.api.asc_registerCallback("asc_onFocusObject", _.bind(this.onFocusObject, this));\r\n
                this.api.asc_registerCallback("asc_onSelectionChanged", _.bind(this.onSelectionChanged, this));\r\n
                this.api.asc_registerCallback("asc_doubleClickOnObject", _.bind(this.onDoubleClickOnObject, this));\r\n
            }\r\n
        },\r\n
        onDoubleClickOnObject: function (obj) {\r\n
            if (!this.editMode) {\r\n
                return;\r\n
            }\r\n
            var type = obj.asc_getObjectType();\r\n
            if (type >= this._settings.length || this._settings[type] === undefined) {\r\n
                return;\r\n
            }\r\n
            var value = obj.asc_getObjectValue();\r\n
            if (type == c_oAscTypeSelectElement.Image) {\r\n
                if (value.asc_getChartProperties() !== null) {\r\n
                    type = c_oAscTypeSelectElement.Chart;\r\n
                } else {\r\n
                    if (value.asc_getShapeProperties() !== null) {\r\n
                        type = c_oAscTypeSelectElement.Shape;\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (type !== c_oAscTypeSelectElement.Paragraph) {\r\n
                this.rightmenu.SetActivePane(type, true);\r\n
                this._settings[type].panel.ChangeSettings.call(this._settings[type].panel, this._settings[type].props);\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 (function (global) {\r\n
    var k, _handlers = {},\r\n
    _mods = {\r\n
        16: false,\r\n
        18: false,\r\n
        17: false,\r\n
        91: false\r\n
    },\r\n
    _scope = "all",\r\n
    _MODIFIERS = {\r\n
        "â‡§": 16,\r\n
        shift: 16,\r\n
        "âŒ¥": 18,\r\n
        alt: 18,\r\n
        option: 18,\r\n
        "âŒƒ": 17,\r\n
        ctrl: 17,\r\n
        control: 17,\r\n
        "âŒ˜": 91,\r\n
        command: 91\r\n
    },\r\n
    _MAP = {\r\n
        backspace: 8,\r\n
        tab: 9,\r\n
        clear: 12,\r\n
        enter: 13,\r\n
        "return": 13,\r\n
        esc: 27,\r\n
        escape: 27,\r\n
        space: 32,\r\n
        left: 37,\r\n
        up: 38,\r\n
        right: 39,\r\n
        down: 40,\r\n
        del: 46,\r\n
        "delete": 46,\r\n
        home: 36,\r\n
        end: 35,\r\n
        pageup: 33,\r\n
        pagedown: 34,\r\n
        ",": 188,\r\n
        ".": 190,\r\n
        "/": 191,\r\n
        "`": 192,\r\n
        "-": 189,\r\n
        "=": 187,\r\n
        ";": 186,\r\n
        "\'": 222,\r\n
        "[": 219,\r\n
        "]": 221,\r\n
        "\\\\": 220\r\n
    },\r\n
    code = function (x) {\r\n
        return _MAP[x] || x.toUpperCase().charCodeAt(0);\r\n
    },\r\n
    _downKeys = [];\r\n
    var locked;\r\n
    for (k = 1; k < 20; k++) {\r\n
        _MAP["f" + k] = 111 + k;\r\n
    }\r\n
    function index(array, item) {\r\n
        var i = array.length;\r\n
        while (i--) {\r\n
            if (array[i] === item) {\r\n
                return i;\r\n
            }\r\n
        }\r\n
        return -1;\r\n
    }\r\n
    function compareArray(a1, a2) {\r\n
        if (a1.length != a2.length) {\r\n
            return false;\r\n
        }\r\n
        for (var i = 0; i < a1.length; i++) {\r\n
            if (a1[i] !== a2[i]) {\r\n
                return false;\r\n
            }\r\n
        }\r\n
        return true;\r\n
    }\r\n
    var modifierMap = {\r\n
        16: "shiftKey",\r\n
        18: "altKey",\r\n
        17: "ctrlKey",\r\n
        91: "metaKey"\r\n
    };\r\n
    function updateModifierKey(event) {\r\n
        for (k in _mods) {\r\n
            _mods[k] = event[modifierMap[k]];\r\n
        }\r\n
    }\r\n
    function dispatch(event) {\r\n
        var key, handler, k, i, modifiersMatch, scope;\r\n
        key = event.keyCode;\r\n
        if (index(_downKeys, key) == -1) {\r\n
            _downKeys.push(key);\r\n
        }\r\n
        if (key == 93 || key == 224) {\r\n
            key = 91;\r\n
        }\r\n
        if (key in _mods) {\r\n
            _mods[key] = true;\r\n
            for (k in _MODIFIERS) {\r\n
                if (_MODIFIERS[k] == key) {\r\n
                    assignKey[k] = true;\r\n
                }\r\n
            }\r\n
            return;\r\n
        }\r\n
        updateModifierKey(event);\r\n
        if (!assignKey.filter.call(this, event)) {\r\n
            return;\r\n
        }\r\n
        if (! (key in _handlers)) {\r\n
            return;\r\n
        }\r\n
        scope = getScope();\r\n
        for (i = 0; i < _handlers[key].length; i++) {\r\n
            handler = _handlers[key][i];\r\n
            if (handler.scope == scope || handler.scope == "all") {\r\n
                modifiersMatch = handler.mods.length > 0;\r\n
                for (k in _mods) {\r\n
                    if ((!_mods[k] && index(handler.mods, +k) > -1) || (_mods[k] && index(handler.mods, +k) == -1)) {\r\n
                        modifiersMatch = false;\r\n
                    }\r\n
                }\r\n
                if ((handler.mods.length == 0 && !_mods[16] && !_mods[18] && !_mods[17] && !_mods[91]) || modifiersMatch) {\r\n
                    if (locked === true || handler.locked || handler.method(event, handler) === false) {\r\n
                        if (event.preventDefault) {\r\n
                            event.preventDefault();\r\n
                        } else {\r\n
                            event.returnValue = false;\r\n
                        }\r\n
                        if (event.stopPropagation) {\r\n
                            event.stopPropagation();\r\n
                        }\r\n
                        if (event.cancelBubble) {\r\n
                            event.cancelBubble = true;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
    function clearModifier(event) {\r\n
        var key = event.keyCode,\r\n
        k, i = index(_downKeys, key);\r\n
        if (i >= 0) {\r\n
            _downKeys.splice(i, 1);\r\n
        }\r\n
        if (key == 93 || key == 224) {\r\n
            key = 91;\r\n
        }\r\n
        if (key in _mods) {\r\n
            _mods[key] = false;\r\n
            for (k in _MODIFIERS) {\r\n
                if (_MODIFIERS[k] == key) {\r\n
                    assignKey[k] = false;\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
    function resetModifiers() {\r\n
        for (k in _mods) {\r\n
            _mods[k] = false;\r\n
        }\r\n
        for (k in _MODIFIERS) {\r\n
            assignKey[k] = false;\r\n
        }\r\n
    }\r\n
    function assignKey(key, scope, method) {\r\n
        var keys, mods;\r\n
        keys = getKeys(key);\r\n
        if (method === undefined) {\r\n
            method = scope;\r\n
            scope = "all";\r\n
        }\r\n
        for (var i = 0; i < keys.length; i++) {\r\n
            mods = [];\r\n
            key = keys[i].split("+");\r\n
            if (key.length > 1) {\r\n
                mods = getMods(key);\r\n
                key = [key[key.length - 1]];\r\n
            }\r\n
            key = key[0];\r\n
            key = code(key);\r\n
            if (! (key in _handlers)) {\r\n
                _handlers[key] = [];\r\n
            }\r\n
            _handlers[key].push({\r\n
                shortcut: keys[i],\r\n
                scope: scope,\r\n
                method: method,\r\n
                key: keys[i],\r\n
                mods: mods\r\n
            });\r\n
        }\r\n
    }\r\n
    function unbindKey(key, scope) {\r\n
        var multipleKeys, keys, mods = [],\r\n
        i,\r\n
        j,\r\n
        obj;\r\n
        multipleKeys = getKeys(key);\r\n
        for (j = 0; j < multipleKeys.length; j++) {\r\n
            keys = multipleKeys[j].split("+");\r\n
            if (keys.length > 1) {\r\n
                mods = getMods(keys);\r\n
                key = keys[keys.length - 1];\r\n
            }\r\n
            key = code(key);\r\n
            if (scope === undefined) {\r\n
                scope = getScope();\r\n
            }\r\n
            if (!_handlers[key]) {\r\n
                return;\r\n
            }\r\n
            for (i in _handlers[key]) {\r\n
                obj = _handlers[key][i];\r\n
                if (obj.scope === scope && compareArray(obj.mods, mods)) {\r\n
                    _handlers[key][i] = {};\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
    function isPressed(keyCode) {\r\n
        if (typeof(keyCode) == "string") {\r\n
            keyCode = code(keyCode);\r\n
        }\r\n
        return index(_downKeys, keyCode) != -1;\r\n
    }\r\n
    function getPressedKeyCodes() {\r\n
        return _downKeys.slice(0);\r\n
    }\r\n
    function filter(event) {\r\n
        var tagName = (event.target || event.srcElement).tagName;\r\n
        return ! (tagName == "INPUT" || tagName == "SELECT" || tagName == "TEXTAREA");\r\n
    }\r\n
    for (k in _MODIFIERS) {\r\n
        assignKey[k] = false;\r\n
    }\r\n
    function setScope(scope) {\r\n
        _scope = scope || "all";\r\n
    }\r\n
    function getScope() {\r\n
        return _scope || "all";\r\n
    }\r\n
    function deleteScope(scope) {\r\n
        var key, handlers, i;\r\n
        for (key in _handlers) {\r\n
            handlers = _handlers[key];\r\n
            for (i = 0; i < handlers.length;) {\r\n
                if (handlers[i].scope === scope) {\r\n
                    handlers.splice(i, 1);\r\n
                } else {\r\n
                    i++;\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
    function getKeys(key) {\r\n
        var keys;\r\n
        key = key.replace(/\\s/g, "");\r\n
        keys = key.split(",");\r\n
        if ((keys[keys.length - 1]) == "") {\r\n
            keys[keys.length - 2] += ",";\r\n
        }\r\n
        return keys;\r\n
    }\r\n
    function getMods(key) {\r\n
        var mods = key.slice(0, key.length - 1);\r\n
        for (var mi = 0; mi < mods.length; mi++) {\r\n
            mods[mi] = _MODIFIERS[mods[mi]];\r\n
        }\r\n
        return mods;\r\n
    }\r\n
    function addEvent(object, event, method) {\r\n
        if (object.addEventListener) {\r\n
            object.addEventListener(event, method, false);\r\n
        } else {\r\n
            if (object.attachEvent) {\r\n
                object.attachEvent("on" + event, function () {\r\n
                    method(window.event);\r\n
                });\r\n
            }\r\n
        }\r\n
    }\r\n
    addEvent(document, "keydown", function (event) {\r\n
        dispatch(event);\r\n
    });\r\n
    addEvent(document, "keyup", clearModifier);\r\n
    addEvent(window, "focus", resetModifiers);\r\n
    var previousKey = global.key;\r\n
    function noConflict() {\r\n
        var k = global.key;\r\n
        global.key = previousKey;\r\n
        return k;\r\n
    }\r\n
    function setKeyOptions(key, scope, option, value) {\r\n
        var keys, mods = [],\r\n
        i,\r\n
        obj;\r\n
        var multipleKeys = getKeys(key);\r\n
        for (var j = multipleKeys.length; j--;) {\r\n
            keys = multipleKeys[j].split("+");\r\n
            if (keys.length > 1) {\r\n
                mods = getMods(keys);\r\n
                key = keys[keys.length - 1];\r\n
            }\r\n
            key = code(key);\r\n
            if (scope === undefined) {\r\n
                scope = getScope();\r\n
            }\r\n
            if (_handlers[key]) {\r\n
                for (i in _handlers[key]) {\r\n
                    obj = _handlers[key][i];\r\n
                    if (obj.scope === scope && compareArray(obj.mods, mods)) {\r\n
                        _handlers[key][i][option] = value;\r\n
                    }\r\n
                }\r\n
            }\r\n
        }\r\n
    }\r\n
    function suspend(key, scope) {\r\n
        key ? setKeyOptions(key, scope, "locked", true) : (locked = true);\r\n
    }\r\n
    function resume(key, scope) {\r\n
        key ? setKeyOptions(key, scope, "locked", false) : (locked = false);\r\n
    }\r\n
    global.key = assignKey;\r\n
    global.key.setScope = setScope;\r\n
    global.key.getScope = getScope;\r\n
    global.key.deleteScope = deleteScope;\r\n
    global.key.filter = filter;\r\n
    global.key.isPressed = isPressed;\r\n
    global.key.getPressedKeyCodes = getPressedKeyCodes;\r\n
    global.key.noConflict = noConflict;\r\n
    global.key.unbind = unbindKey;\r\n
    global.key.suspend = suspend;\r\n
    global.key.resume = resume;\r\n
    if (typeof module !== "undefined") {\r\n
        module.exports = key;\r\n
    }\r\n
})(this);\n
define("keymaster", function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.util = Common.util || {};\r\n
define(\'common/main/lib/util/Shortcuts\',["backbone", "keymaster"], function (Backbone) {\r\n
    var Shortcuts = function (options) {\r\n
        this.cid = _.uniqueId("shortcuts");\r\n
        this.initialize.apply(this, arguments);\r\n
        return this;\r\n
    };\r\n
    _.extend(Shortcuts.prototype, Backbone.Events, {\r\n
        initialize: function () {\r\n
            window.key.filter = function (event) {\r\n
                return true;\r\n
            };\r\n
            Common.NotificationCenter.on({\r\n
                "modal:show": function (e) {\r\n
                    window.key.suspend();\r\n
                },\r\n
                "modal:close": function (e) {\r\n
                    window.key.resume();\r\n
                },\r\n
                "modal:hide": function (e) {\r\n
                    window.key.resume();\r\n
                }\r\n
            });\r\n
        },\r\n
        delegateShortcuts: function (options) {\r\n
            if (!options || !options.shortcuts) {\r\n
                return;\r\n
            }\r\n
            this.removeShortcuts(options);\r\n
            var callback, match, method, scope, shortcut, shortcutKey;\r\n
            var _results = [];\r\n
            for (shortcut in options.shortcuts) {\r\n
                callback = options.shortcuts[shortcut];\r\n
                if (!_.isFunction(callback)) {\r\n
                    method = options[callback];\r\n
                    if (!method) {\r\n
                        throw new Error("Method " + callback + " does not exist");\r\n
                    }\r\n
                } else {\r\n
                    method = callback;\r\n
                }\r\n
                match = shortcut.match(/^(\\S+)\\s*(.*)$/);\r\n
                shortcutKey = match[1];\r\n
                scope = match[2].length ? match[2] : "all";\r\n
                method = _.bind(method, this);\r\n
                _results.push(window.key(shortcutKey, scope, method));\r\n
            }\r\n
        },\r\n
        removeShortcuts: function (options) {\r\n
            if (!options || !options.shortcuts) {\r\n
                return;\r\n
            }\r\n
            var match, scope, shortcut, shortcutKey;\r\n
            var _results = [];\r\n
            for (shortcut in options.shortcuts) {\r\n
                match = shortcut.match(/^(\\S+)\\s*(.*)$/);\r\n
                shortcutKey = match[1];\r\n
                scope = match[2].length ? match[2] : "all";\r\n
                window.key.unbind(shortcutKey, scope);\r\n
            }\r\n
        },\r\n
        suspendEvents: function (key, scope) {\r\n
            window.key.suspend(key, scope);\r\n
        },\r\n
        resumeEvents: function (key, scope) {\r\n
            window.key.resume(key, scope);\r\n
        }\r\n
    });\r\n
    Shortcuts.extend = Backbone.View.extend;\r\n
    Common.util.Shortcuts = new Shortcuts;\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/LeftMenu.template\',[],function () { return \'<div id="view-left-menu" class="tool-menu left">\\r\\n    <div class="tool-menu-btns">\\r\\n        <button id="left-btn-file" class="btn btn-category" content-target="left-panel-file"><span class="btn-icon btn-menu-file">&nbsp;</span></button>\\r\\n        <button id="left-btn-search" class="btn btn-category" content-target=""><span class="btn-icon btn-menu-search">&nbsp;</span></button>\\r\\n        <!-- /** coauthoring begin **/ -->\\r\\n        <button id="left-btn-comments" class="btn btn-category" content-target="left-panel-comments"><span class="btn-icon btn-menu-comments">&nbsp;</span></button>\\r\\n        <button id="left-btn-chat" class="btn btn-category" content-target="left-panel-chat"><span class="btn-icon btn-menu-chat">&nbsp;</span></button>\\r\\n        <!-- /** coauthoring end **/ -->\\r\\n        <button id="left-btn-support" class="btn btn-category" content-target=""><span class="btn-icon btn-menu-support">&nbsp;</span></button>\\r\\n        <button id="left-btn-about" class="btn btn-category" content-target=""><span class="btn-icon btn-menu-about">&nbsp;</span></button>\\r\\n    </div>\\r\\n    <div class="left-panel" style="">\\r\\n        <!-- /** coauthoring begin **/ -->\\r\\n        <div id="left-panel-comments" class="" style="display: none;" />\\r\\n        <div id="left-panel-chat" class="" style="display: none;" />\\r\\n        <!-- /** coauthoring end **/ -->\\r\\n    </div>\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/view/About\',["common/main/lib/component/BaseView", "common/main/lib/component/Scroller"], function () {\r\n
    Common.Views.About = Common.UI.BaseView.extend(_.extend({\r\n
        menu: undefined,\r\n
        options: {\r\n
            alias: "Common.Views.About"\r\n
        },\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.txtVersionNum = "3.0";\r\n
            this.txtAscMail = "support@onlyoffice.com";\r\n
            this.txtAscTelNum = "+371 660-16425";\r\n
            this.txtAscUrl = "www.onlyoffice.com";\r\n
            this.txtAscName = "Ascensio System SIA";\r\n
            this.template = _.template([\'<table id="id-about-licensor-logo" cols="1" style="width: 100%; margin-top: 20px;">\', "<tr>", \'<td align="center"><div class="asc-about-office"/></td>\', "</tr>", "<tr>", \'<td align="center"><label class="asc-about-version">\' + options.appName.toUpperCase() + "</label></td>", "</tr>", "<tr>", \'<td align="center"><label class="asc-about-version">\' + this.txtVersion + this.txtVersionNum + "</label></td>", "</tr>", "</table>", \'<table id="id-about-licensor-info" cols="3" style="width: 100%;" class="margin-bottom">\', "<tr>", \'<td colspan="3" align="center" style="padding: 20px 0 10px 0;"><label class="asc-about-companyname">\' + this.txtAscName + "</label></td>", "</tr>", "<tr>", \'<td colspan="3" align="center" class="padding-small">\', \'<label class="asc-about-desc-name">\' + this.txtAddress + "</label>", \'<label class="asc-about-desc">\' + this.txtAscAddress + "</label>", "</td>", "</tr>", "<tr>", \'<td colspan="3" align="center" class="padding-small">\', \'<label class="asc-about-desc-name">\' + this.txtMail + "</label>", \'<a href="mailto:\' + this.txtAscMail + \'">\' + this.txtAscMail + "</a>", "</td>", "</tr>", "<tr>", \'<td colspan="3" align="center" class="padding-small">\', \'<label class="asc-about-desc-name">\' + this.txtTel + "</label>", \'<label class="asc-about-desc">\' + this.txtAscTelNum + "</label>", "</td>", "</tr>", "<tr>", \'<td colspan="3" align="center">\', \'<a href="http://\' + this.txtAscUrl + \'" target="_blank">\' + this.txtAscUrl + "</a>", "</td>", "</tr>", "</table>", \'<table id="id-about-licensee-info" cols="1" style="width: 100%; margin-top: 20px;" class="hidden margin-bottom"><tbody>\', "<tr>", \'<td align="center" class="padding-small"><div id="id-about-company-logo"/></td>\', "</tr>", "<tr>", \'<td align="center"><label class="asc-about-version">\' + options.appName.toUpperCase() + "</label></td>", "</tr>", "<tr>", \'<td align="center"><label style="padding-bottom: 29px;" class="asc-about-version">\' + this.txtVersion + this.txtVersionNum + "</label></td>", "</tr>", "<tr>", \'<td align="center" class="padding-small">\', \'<label class="asc-about-companyname" id="id-about-company-name"></label>\', "</td>", "</tr>", "<tr>", \'<td align="center" class="padding-small">\', \'<label class="asc-about-desc-name">\' + this.txtAddress + "</label>", \'<label class="asc-about-desc" id="id-about-company-address"></label>\', "</td>", "</tr>", "<tr>", \'<td align="center" class="padding-small">\', \'<label class="asc-about-desc-name">\' + this.txtMail + "</label>", \'<a href="mailto:" id="id-about-company-mail"></a>\', "</td>", "</tr>", "<tr>", \'<td align="center" class="padding-small">\', \'<a href="" target="_blank" id="id-about-company-url"></a>\', "</td>", "</tr>", "<tr>", \'<td align="center">\', \'<label class="asc-about-lic" id="id-about-company-lic"></label>\', "</td>", "</tr>", "</table>", \'<table id="id-about-licensor-short" cols="1" style="width: 100%; margin-top: 31px;" class="hidden"><tbody>\', "<tr>", \'<td style="width:50%;"><div class="separator horizontal short left"/></td>\', \'<td align="center"><label class="asc-about-header">\' + this.txtPoweredBy + "</label></td>", \'<td style="width:50%;"><div class="separator horizontal short"/></td>\', "</tr>", "<tr>", \'<td colspan="3" align="center" style="padding: 9px 0 10px;"><label class="asc-about-companyname">\' + this.txtAscName + "</label></td>", "</tr>", "<tr>", \'<td colspan="3" align="center">\', \'<a href="http://\' + this.txtAscUrl + \'" target="_blank">\' + this.txtAscUrl + "</a>", "</td>", "</tr>", "</table>"].join(""));\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            el.addClass("about-dlg");\r\n
            this.cntLicenseeInfo = $("#id-about-licensee-info");\r\n
            this.cntLicensorInfo = $("#id-about-licensor-info");\r\n
            this.divCompanyLogo = $("#id-about-company-logo");\r\n
            this.lblCompanyName = $("#id-about-company-name");\r\n
            this.lblCompanyAddress = $("#id-about-company-address");\r\n
            this.lblCompanyMail = $("#id-about-company-mail");\r\n
            this.lblCompanyUrl = $("#id-about-company-url");\r\n
            this.lblCompanyLic = $("#id-about-company-lic");\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        setLicInfo: function (data) {\r\n
            if (data && typeof(data) == "object" && typeof(data.customer) == "object") {\r\n
                var customer = data.customer;\r\n
                $("#id-about-licensor-logo").addClass("hidden");\r\n
                $("#id-about-licensor-short").removeClass("hidden");\r\n
                this.cntLicensorInfo.addClass("hidden");\r\n
                this.cntLicenseeInfo.removeClass("hidden");\r\n
                this.cntLicensorInfo.removeClass("margin-bottom");\r\n
                var value = customer.name;\r\n
                value && value.length ? this.lblCompanyName.text(value) : this.lblCompanyName.parents("tr").addClass("hidden");\r\n
                value = customer.address;\r\n
                value && value.length ? this.lblCompanyAddress.text(value) : this.lblCompanyAddress.parents("tr").addClass("hidden");\r\n
                (value = customer.mail) && value.length ? this.lblCompanyMail.attr("href", "mailto:" + value).text(value) : this.lblCompanyMail.parents("tr").addClass("hidden");\r\n
                if ((value = customer.www) && value.length) {\r\n
                    var http = !/^https?:\\/{2}/i.test(value) ? "http://": "";\r\n
                    this.lblCompanyUrl.attr("href", http + value).text(value);\r\n
                } else {\r\n
                    this.lblCompanyUrl.parents("tr").addClass("hidden");\r\n
                } (value = customer.info) && value.length ? this.lblCompanyLic.text(value) : this.lblCompanyLic.parents("tr").addClass("hidden");\r\n
                (value = customer.logo) && value.length ? this.divCompanyLogo.html(\'<img src="\' + value + \'" />\') : this.divCompanyLogo.parents("tr").addClass("hidden");\r\n
            } else {\r\n
                this.cntLicenseeInfo.addClass("hidden");\r\n
                this.cntLicensorInfo.addClass("margin-bottom");\r\n
            }\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this, arguments);\r\n
            this.fireEvent("show", this);\r\n
        },\r\n
        hide: function () {\r\n
            Common.UI.BaseView.prototype.hide.call(this, arguments);\r\n
            this.fireEvent("hide", this);\r\n
        },\r\n
        txtPoweredBy: "Powered by",\r\n
        txtVersion: "Version ",\r\n
        txtLicensor: "LICENSOR",\r\n
        txtLicensee: "LICENSEE",\r\n
        txtAddress: "address: ",\r\n
        txtAscAddress: "Lubanas st. 125a-25, Riga, Latvia, EU, LV-1021",\r\n
        txtMail: "email: ",\r\n
        txtTel: "tel.: "\r\n
    },\r\n
    Common.Views.About || {}));\r\n
});\n
\n
define(\'text!common/main/lib/template/Comments.template\',[],function () { return \'<% if (!hide) { %>\\r\\n    <div id="<%= id %>" class="user-comment-item">\\r\\n\\r\\n        <!-- comment block -->\\r\\n\\r\\n        <div class="user-name"><%=scope.getUserName(username)%></div>\\r\\n        <div class="user-date"><%=date%></div>\\r\\n        <div class="user-quote"><%=scope.getFixedQuote(quote)%></div>\\r\\n        <% if (!editText) { %>\\r\\n            <div class="user-message text-select" data-can-copy="true"><%=scope.pickLink(comment)%></div>\\r\\n        <% } else { %>\\r\\n            <div class="inner-edit-ct">\\r\\n                <textarea class="msg-reply"><%=comment%></textarea>\\r\\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change">textEdit</button>\\r\\n                <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\\r\\n            </div>\\r\\n        <% } %>\\r\\n\\r\\n        <!-- replys elements -->\\r\\n\\r\\n        <% if (replys.length) { %>\\r\\n            <div class="reply-arrow "></div>\\r\\n            <% _.each(replys, function (item) { %>\\r\\n                <div class="reply-item-ct">\\r\\n                    <div class="user-name"><%=scope.getFixedQuote(item.get("username"))%></div>\\r\\n                    <div class="user-date"><%=item.get("date")%></div>\\r\\n                    <% if (!item.get("editText")) { %>\\r\\n                        <div class="user-message text-select" data-can-copy="true"><%=scope.pickLink(item.get("reply"))%></div>\\r\\n                            <div class="btns-reply-ct">\\r\\n                            <div class="btn-edit" data-value="<%=item.get("id")%>"></div>\\r\\n                            <div class="btn-delete" data-value="<%=item.get("id")%>"></div>\\r\\n                        </div>\\r\\n                    <% } else { %>\\r\\n                        <div class="inner-edit-ct">\\r\\n                            <textarea class="msg-reply textarea-fix"><%=item.get("reply")%></textarea>\\r\\n                            <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change">textEdit</button>\\r\\n                            <button class="btn normal dlg-btn btn-inner-close">textClose</button>\\r\\n                        </div>\\r\\n                    <% } %>\\r\\n                </div>\\r\\n            <% }); %>\\r\\n        <% } %>\\r\\n\\r\\n        <!-- add reply button -->\\r\\n\\r\\n        <% if (!showReply) { %>\\r\\n            <% if (replys.length) { %>\\r\\n                <label class="user-reply" style="margin-left: 20px; margin-top: 5px;" role="presentation" tabindex="-1">textAddReply</label>\\r\\n            <% } else { %>\\r\\n                <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\\r\\n            <% } %>\\r\\n        <% } %>\\r\\n\\r\\n        <!-- edit buttons -->\\r\\n\\r\\n        <% if (!editText && !lock) { %>\\r\\n            <div class="edit-ct">\\r\\n                <div class="btn-edit"></div>\\r\\n                <div class="btn-delete"></div>\\r\\n                <% if (resolved) { %>\\r\\n                <div class="resolve-ct-check" style="float:left;">\\r\\n                    <div class="resolved"></div>\\r\\n                    <div class="btn-resolve-check">textResolved</div>\\r\\n                <% } else { %>\\r\\n                <div class="resolve-ct" style="float:left;">\\r\\n                    <div class="btn-resolve">textResolve</div>\\r\\n                <% } %>\\r\\n                </div>\\r\\n            </div>\\r\\n        <% } %>\\r\\n\\r\\n        <!-- reply -->\\r\\n\\r\\n        <% if (showReply) { %>\\r\\n            <div class="reply-ct">\\r\\n                <textarea class="msg-reply" placeholder="textAddReply"></textarea>\\r\\n                <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change">textReply</button>\\r\\n                <button class="btn normal dlg-btn btn-close">textClose</button>\\r\\n            </div>\\r\\n        <% } %>\\r\\n        <% if (lock) { %>\\r\\n            <div class="lock-area"></div>\\r\\n            <div class="lock-author"><%=lockuserid%></div>\\r\\n        <% } %>\\r\\n        <% if (!last) { %>\\r\\n            <div class="separator-cmt"></div>\\r\\n        <% } %>\\r\\n    </div>\\r\\n<% } %>\\r\\n\';});\n
\n
\n
define(\'text!common/main/lib/template/CommentsPanel.template\',[],function () { return \'<div id="comments-box">\\r\\n    <div id="comments-messages"/>\\r\\n    <div id="comments-add-link-ct">\\r\\n        <label id="comment-btn-new" class="btn"><%=textAddCommentToDoc%></label>\\r\\n    </div>\\r\\n    <div id="comments-new-comment-ct" style="display: none;">\\r\\n        <div id="comments-inner-ct">\\r\\n            <textarea id="comment-msg-new" placeholder="<%=textEnterCommentHint%>"/>\\r\\n            <button id="comment-btn-add" class="btn normal dlg-btn primary"><%=textAddComment%></button>\\r\\n            <button id="comment-btn-cancel" class="btn normal dlg-btn"><%=textCancel%></button>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\';});\n
\n
\n
define(\'text!common/main/lib/template/CommentsPopover.template\',[],function () { return \'<div id="<%=id%>" class="user-comment-item">\\r\\n\\r\\n    <!-- comment block -->\\r\\n\\r\\n    <div class="user-name"><%=scope.getUserName(username)%></div>\\r\\n    <div class="user-date"><%=date%></div>\\r\\n    <% if (!editTextInPopover || hint) { %>\\r\\n        <div class="user-message"><%=scope.pickLink(comment)%></div>\\r\\n    <% } else { %>\\r\\n        <div class="inner-edit-ct">\\r\\n            <textarea class="msg-reply"><%=comment%></textarea>\\r\\n            <% if (hideAddReply) { %>\\r\\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textAdd</button>\\r\\n            <% } else { %>\\r\\n                <button class="btn normal dlg-btn primary btn-inner-edit" id="id-comments-change-popover">textEdit</button>\\r\\n            <% } %>\\r\\n            <button class="btn normal dlg-btn btn-inner-close">textCancel</button>\\r\\n        </div>\\r\\n    <% } %>\\r\\n\\r\\n    <!-- replys elements -->\\r\\n\\r\\n    <% if (replys.length) { %>\\r\\n        <div class="reply-arrow "></div>\\r\\n        <% _.each(replys, function (item) { %>\\r\\n            <div class="reply-item-ct">\\r\\n                <div class="user-name"><%=scope.getFixedQuote(item.get("username"))%></div>\\r\\n                <div class="user-date"><%=item.get("date")%></div>\\r\\n                <% if (!item.get("editTextInPopover")) { %>\\r\\n                    <div class="user-message"><%=scope.pickLink(item.get("reply"))%></div>\\r\\n                    <% if (!hint) { %>\\r\\n                        <div class="btns-reply-ct">\\r\\n                            <div class="btn-edit" data-value="<%=item.get("id")%>"></div>\\r\\n                            <div class="btn-delete" data-value="<%=item.get("id")%>"></div>\\r\\n                        </div>\\r\\n                    <%}%>\\r\\n                <% } else { %>\\r\\n                    <div class="inner-edit-ct">\\r\\n                        <textarea class="msg-reply textarea-fix"><%=item.get("reply")%></textarea>\\r\\n                        <button class="btn normal dlg-btn primary btn-inner-edit btn-fix" id="id-comments-change-popover">textEdit</button>\\r\\n                        <button class="btn normal dlg-btn btn-inner-close">textClose</button>\\r\\n                    </div>\\r\\n                <% } %>\\r\\n                </div>\\r\\n        <% }); %>\\r\\n\\r\\n    <% } %>\\r\\n\\r\\n    <!-- add reply button -->\\r\\n\\r\\n    <% if (!showReplyInPopover && !hideAddReply && !hint) { %>\\r\\n        <% if (replys.length) { %>\\r\\n            <label class="user-reply" style="margin-left: 20px; margin-top: 5px;" role="presentation" tabindex="-1">textAddReply</label>\\r\\n        <% } else { %>\\r\\n            <label class="user-reply" role="presentation" tabindex="-1">textAddReply</label>\\r\\n        <% } %>\\r\\n    <% } %>\\r\\n\\r\\n    <!-- edit buttons -->\\r\\n\\r\\n    <% if (!editTextInPopover && !lock && !hint) { %>\\r\\n        <div class="edit-ct">\\r\\n            <div class="btn-edit"></div>\\r\\n            <div class="btn-delete"></div>\\r\\n            <% if (resolved) { %>\\r\\n                <div class="resolve-ct-check" style="float:left;">\\r\\n                <div class="resolved"></div>\\r\\n                <div class="btn-resolve-check">textResolved</div>\\r\\n            <% } else { %>\\r\\n                <div class="resolve-ct" style="float:left;">\\r\\n                <div class="btn-resolve">textResolve</div>\\r\\n            <% } %>\\r\\n            </div>\\r\\n        </div>\\r\\n    <% } %>\\r\\n\\r\\n    <!-- reply -->\\r\\n\\r\\n    <% if (showReplyInPopover) { %>\\r\\n        <div class="reply-ct">\\r\\n            <textarea class="msg-reply" placeholder="textAddReply"></textarea>\\r\\n            <button class="btn normal dlg-btn primary btn-reply" id="id-comments-change-popover">textReply</button>\\r\\n            <button class="btn normal dlg-btn btn-close">textClose</button>\\r\\n        </div>\\r\\n    <% } %>\\r\\n\\r\\n    <!-- locked user -->\\r\\n\\r\\n    <% if (lock) { %>\\r\\n        <div class="lock-area" style="cursor: default;"></div>\\r\\n        <div class="lock-author" style="cursor: default;"><%=lockuserid%></div>\\r\\n    <% } %>\\r\\n\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Views = Common.Views || {};\r\n
define(\'common/main/lib/view/Comments\',["text!common/main/lib/template/Comments.template", "text!common/main/lib/template/CommentsPanel.template", "text!common/main/lib/template/CommentsPopover.template", "common/main/lib/util/utils", "common/main/lib/component/Button", "common/main/lib/component/ComboBox", "common/main/lib/component/DataView", "common/main/lib/component/Window"], function (commentsTemplate, panelTemplate, popoverTemplate) {\r\n
    function replaceWords(template, words) {\r\n
        var word, value, tpl = template;\r\n
        for (word in words) {\r\n
            if (undefined !== word) {\r\n
                value = words[word];\r\n
                tpl = tpl.replace(new RegExp(word, "g"), value);\r\n
            }\r\n
        }\r\n
        return tpl;\r\n
    }\r\n
    Common.Views.CommentsPopover = Common.UI.Window.extend({\r\n
        initialize: function (options) {\r\n
            var _options = {};\r\n
            _.extend(_options, {\r\n
                closable: false,\r\n
                width: 265,\r\n
                height: 120,\r\n
                header: false,\r\n
                modal: false\r\n
            },\r\n
            options);\r\n
            this.template = options.template || [\'<div class="box">\', \'<div id="id-comments-popover" class="comments-popover"></div>\', \'<div id="id-comments-arrow" class="comments-arrow-left"></div>\', "</div>"].join("");\r\n
            this.store = options.store;\r\n
            this.delegate = options.delegate;\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            this.arrow = {\r\n
                margin: 20,\r\n
                width: 12,\r\n
                height: 34\r\n
            };\r\n
            this.sdkBounds = {\r\n
                width: 0,\r\n
                height: 0,\r\n
                padding: 5,\r\n
                paddingTop: 20\r\n
            };\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            var me = this,\r\n
            t = this.delegate,\r\n
            window = this.$window;\r\n
            window.css({\r\n
                height: "",\r\n
                minHeight: "",\r\n
                overflow: "hidden",\r\n
                position: "absolute",\r\n
                zIndex: "990"\r\n
            });\r\n
            var body = window.find(".body");\r\n
            if (body) {\r\n
                body.css("position", "relative");\r\n
            }\r\n
            var PopoverDataView = Common.UI.DataView.extend((function () {\r\n
                var parentView = me;\r\n
                return {\r\n
                    options: {\r\n
                        handleSelect: false,\r\n
                        scrollable: true,\r\n
                        template: _.template(\'<div class="dataview-ct inner" style="overflow-y: hidden;"></div>\')\r\n
                    },\r\n
                    getTextBox: function () {\r\n
                        var text = $(this.el).find("textarea");\r\n
                        return (text && text.length) ? text : undefined;\r\n
                    },\r\n
                    setFocusToTextBox: function (blur) {\r\n
                        var text = $(this.el).find("textarea");\r\n
                        if (blur) {\r\n
                            text.blur();\r\n
                        } else {\r\n
                            if (text && text.length) {\r\n
                                var val = text.val();\r\n
                                text.focus();\r\n
                                text.val("");\r\n
                                text.val(val);\r\n
                            }\r\n
                        }\r\n
                    },\r\n
                    getActiveTextBoxVal: function () {\r\n
                        var text = $(this.el).find("textarea");\r\n
                        return (text && text.length) ? text.val().trim() : "";\r\n
                    },\r\n
                    autoHeightTextBox: function () {\r\n
                        var view = this,\r\n
                        textBox = this.$el.find("textarea"),\r\n
                        domTextBox = null,\r\n
                        minHeight = 50,\r\n
                        lineHeight = 0,\r\n
                        scrollPos = 0,\r\n
                        oldHeight = 0,\r\n
                        newHeight = 0;\r\n
                        function updateTextBoxHeight() {\r\n
                            scrollPos = $(view.scroller.el).scrollTop();\r\n
                            if (domTextBox.scrollHeight > domTextBox.clientHeight) {\r\n
                                textBox.css({\r\n
                                    height: (domTextBox.scrollHeight + lineHeight) + "px"\r\n
                                });\r\n
                                parentView.calculateSizeOfContent();\r\n
                            } else {\r\n
                                oldHeight = domTextBox.clientHeight;\r\n
                                if (oldHeight >= minHeight) {\r\n
                                    textBox.css({\r\n
                                        height: minHeight + "px"\r\n
                                    });\r\n
                                    if (domTextBox.scrollHeight > domTextBox.clientHeight) {\r\n
                                        newHeight = Math.max(domTextBox.scrollHeight + lineHeight, minHeight);\r\n
                                        textBox.css({\r\n
                                            height: newHeight + "px"\r\n
                                        });\r\n
                                    }\r\n
                                    parentView.calculateSizeOfContent();\r\n
                                    parentView.setLeftTop(me.arrowPosX, me.arrowPosY, me.leftX);\r\n
                                    parentView.calculateSizeOfContent();\r\n
                                }\r\n
                            }\r\n
                            view.scroller.scrollTop(scrollPos);\r\n
                            view.autoScrollToEditButtons();\r\n
                        }\r\n
                        if (textBox && textBox.length) {\r\n
                            domTextBox = textBox.get(0);\r\n
                            if (domTextBox) {\r\n
                                lineHeight = parseInt(textBox.css("lineHeight"), 10) * 0.25;\r\n
                                updateTextBoxHeight();\r\n
                                textBox.bind("input propertychange", updateTextBoxHeight);\r\n
                            }\r\n
                        }\r\n
                        this.textBox = textBox;\r\n
                    },\r\n
                    clearTextBoxBind: function () {\r\n
                        if (this.textBox) {\r\n
                            this.textBox.unbind("input propertychange");\r\n
                            this.textBox = undefined;\r\n
                        }\r\n
                    },\r\n
                    autoScrollToEditButtons: function () {\r\n
                        var button = $("#id-comments-change-popover"),\r\n
                        btnBounds = null,\r\n
                        contentBounds = this.el.getBoundingClientRect(),\r\n
                        moveY = 0,\r\n
                        padding = 7;\r\n
                        if (button.length) {\r\n
                            btnBounds = button.get(0).getBoundingClientRect();\r\n
                            if (btnBounds && contentBounds) {\r\n
                                moveY = contentBounds.bottom - (btnBounds.bottom + padding);\r\n
                                if (moveY < 0) {\r\n
                                    this.scroller.scrollTop(this.scroller.getScrollTop() - moveY);\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                };\r\n
            })());\r\n
            if (PopoverDataView) {\r\n
                if (this.commentsView) {\r\n
                    this.commentsView.render($("#id-comments-popover"));\r\n
                    this.commentsView.onResetItems();\r\n
                } else {\r\n
                    this.commentsView = new PopoverDataView({\r\n
                        el: $("#id-comments-popover"),\r\n
                        store: me.store,\r\n
                        itemTemplate: _.template(replaceWords(popoverTemplate, {\r\n
                            textAddReply: t.textAddReply,\r\n
                            textAdd: t.textAdd,\r\n
                            textCancel: t.textCancel,\r\n
                            textEdit: t.textEdit,\r\n
                            textReply: t.textReply,\r\n
                            textClose: t.textClose,\r\n
                            textResolved: t.textResolved,\r\n
                            textResolve: t.textResolve\r\n
                        }))\r\n
                    });\r\n
                    this.commentsView.on("item:click", function (picker, item, record, e) {\r\n
                        var btn, showEditBox, showReplyBox, commentId, replyId, hideAddReply;\r\n
                        function readdresolves() {\r\n
                            me.renderResolvedComboButtons();\r\n
                            t.renderResolvedComboButtons();\r\n
                            me.update();\r\n
                        }\r\n
                        btn = $(e.target);\r\n
                        if (btn) {\r\n
                            showEditBox = record.get("editTextInPopover");\r\n
                            showReplyBox = record.get("showReplyInPopover");\r\n
                            hideAddReply = record.get("hideAddReply");\r\n
                            commentId = record.get("uid");\r\n
                            replyId = btn.attr("data-value");\r\n
                            if (record.get("hint")) {\r\n
                                t.fireEvent("comment:disableHint", [record]);\r\n
                                return;\r\n
                            }\r\n
                            if (btn.hasClass("btn-edit")) {\r\n
                                if (!_.isUndefined(replyId)) {\r\n
                                    t.fireEvent("comment:closeEditing", [commentId]);\r\n
                                    t.fireEvent("comment:editReply", [commentId, replyId, true]);\r\n
                                    this.replyId = replyId;\r\n
                                    this.autoHeightTextBox();\r\n
                                    me.calculateSizeOfContent();\r\n
                                    me.setLeftTop(me.arrowPosX, me.arrowPosY, me.leftX);\r\n
                                    me.calculateSizeOfContent();\r\n
                                    readdresolves();\r\n
                                    me.hookTextBox();\r\n
                                    this.autoScrollToEditButtons();\r\n
                                    this.setFocusToTextBox();\r\n
                                } else {\r\n
                                    if (!showEditBox) {\r\n
                                        t.fireEvent("comment:closeEditing");\r\n
                                        record.set("editTextInPopover", true);\r\n
                                        t.fireEvent("comment:show", [commentId]);\r\n
                                        this.autoHeightTextBox();\r\n
                                        me.calculateSizeOfContent();\r\n
                                        me.setLeftTop(me.arrowPosX, me.arrowPosY, me.leftX);\r\n
                                        me.calculateSizeOfContent();\r\n
                                        readdresolves();\r\n
                                        me.hookTextBox();\r\n
                                        this.autoScrollToEditButtons();\r\n
                                        this.setFocusToTextBox();\r\n
                                    }\r\n
                                }\r\n
                            } else {\r\n
                                if (btn.hasClass("btn-delete")) {\r\n
                                    if (!_.isUndefined(replyId)) {\r\n
                                        t.fireEvent("comment:removeReply", [commentId, replyId]);\r\n
                                        me.calculateSizeOfContent();\r\n
                                        me.setLeftTop(me.arrowPosX, me.arrowPosY, me.leftX);\r\n
                                        me.calculateSizeOfContent();\r\n
                                    } else {\r\n
                                        t.fireEvent("comment:remove", [commentId]);\r\n
                                    }\r\n
                                    t.fireEvent("comment:closeEditing");\r\n
                                    readdresolves();\r\n
                                } else {\r\n
                                    if (btn.hasClass("user-reply")) {\r\n
                                        t.fireEvent("comment:closeEditing");\r\n
                                        record.set("showReplyInPopover", true);\r\n
                                        me.calculateSizeOfContent();\r\n
                                        me.setLeftTop(me.arrowPosX, me.arrowPosY, me.leftX);\r\n
                                        me.calculateSizeOfContent();\r\n
                                        readdresolves();\r\n
                                        this.autoHeightTextBox();\r\n
                                        me.hookTextBox();\r\n
                                        this.autoScrollToEditButtons();\r\n
                                        this.setFocusToTextBox();\r\n
                                    } else {\r\n
                                        if (btn.hasClass("btn-reply", false)) {\r\n
                                            if (showReplyBox) {\r\n
                                                this.clearTextBoxBind();\r\n
                                                t.fireEvent("comment:addReply", [commentId, this.getActiveTextBoxVal()]);\r\n
                                                t.fireEvent("comment:closeEditing");\r\n
                                                readdresolves();\r\n
                                            }\r\n
                                        } else {\r\n
                                            if (btn.hasClass("btn-close", false)) {\r\n
                                                t.fireEvent("comment:closeEditing", [commentId]);\r\n
                                                me.calculateSizeOfContent();\r\n
                                                t.fireEvent("comment:show", [commentId]);\r\n
                                                readdresolves();\r\n
                                            } else {\r\n
                                                if (btn.hasClass("btn-inner-edit", false)) {\r\n
                                                    if (record.get("dummy")) {\r\n
                                                        t.fireEvent("comment:addDummyComment", [this.getActiveTextBoxVal()]);\r\n
                                                        return;\r\n
                                                    }\r\n
                                                    this.clearTextBoxBind();\r\n
                                                    if (!_.isUndefined(this.replyId)) {\r\n
                                                        t.fireEvent("comment:changeReply", [commentId, this.replyId, this.getActiveTextBoxVal()]);\r\n
                                                        this.replyId = undefined;\r\n
                                                        t.fireEvent("comment:closeEditing");\r\n
                                                    } else {\r\n
                                                        if (showEditBox) {\r\n
                                                            t.fireEvent("comment:change", [commentId, this.getActiveTextBoxVal()]);\r\n
                                                            t.fireEvent("comment:closeEditing");\r\n
                                                            me.calculateSizeOfContent();\r\n
                                                        }\r\n
                                                    }\r\n
                                                    readdresolves();\r\n
                                                } else {\r\n
                                                    if (btn.hasClass("btn-inner-close", false)) {\r\n
                                                        if (record.get("dummy")) {\r\n
                                                            me.hide();\r\n
                                                            return;\r\n
                                                        }\r\n
                                                        if (hideAddReply && this.getActiveTextBoxVal().length > 0) {\r\n
                                                            me.saveText();\r\n
                                                            record.set("hideAddReply", false);\r\n
                                                            this.getTextBox().val(me.textVal);\r\n
                                                            this.autoHeightTextBox();\r\n
                                                        } else {\r\n
                                                            this.clearTextBoxBind();\r\n
                                                            t.fireEvent("comment:closeEditing", [commentId]);\r\n
                                                        }\r\n
                                                        this.replyId = undefined;\r\n
                                                        me.calculateSizeOfContent();\r\n
                                                        me.setLeftTop(me.arrowPosX, me.arrowPosY, me.leftX);\r\n
                                                        me.calculateSizeOfContent();\r\n
                                                        readdresolves();\r\n
                                                    } else {\r\n
                                                        if (btn.hasClass("btn-resolve", false)) {\r\n
                                                            t.fireEvent("comment:resolve", [commentId]);\r\n
                                                            readdresolves();\r\n
                                                        }\r\n
                                                    }\r\n
                                                }\r\n
                                            }\r\n
                                        }\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    });\r\n
                    me.on({\r\n
                        "show": function () {\r\n
                            me.commentsView.autoHeightTextBox();\r\n
                            var text = me.$window.find("textarea");\r\n
                            if (text && text.length) {\r\n
                                text.focus();\r\n
                            }\r\n
                            text.keydown(function (event) {\r\n
                                if (event.keyCode == Common.UI.Keys.ESC) {\r\n
                                    me.hide();\r\n
                                }\r\n
                            });\r\n
                        }\r\n
                    });\r\n
                }\r\n
            }\r\n
        },\r\n
        show: function (animate, loadText, focus, showText) {\r\n
            this.options.animate = animate;\r\n
            var me = this,\r\n
            textBox = this.commentsView.getTextBox();\r\n
            if (loadText && this.textVal) {\r\n
                textBox && textBox.val(this.textVal);\r\n
            }\r\n
            if (showText && showText.length) {\r\n
                textBox && textBox.val(showText);\r\n
            }\r\n
            Common.UI.Window.prototype.show.call(this);\r\n
            this.renderResolvedComboButtons();\r\n
            if (this.commentsView.scroller) {\r\n
                this.commentsView.scroller.update({\r\n
                    minScrollbarLength: 40\r\n
                });\r\n
            }\r\n
            this.hookTextBox();\r\n
        },\r\n
        hide: function () {\r\n
            if (this.handlerHide) {\r\n
                this.handlerHide();\r\n
            }\r\n
            Common.UI.Window.prototype.hide.call(this);\r\n
            if (!_.isUndefined(this.e) && this.e.keyCode == Common.UI.Keys.ESC) {\r\n
                this.e.preventDefault();\r\n
                this.e.stopImmediatePropagation();\r\n
                this.e = undefined;\r\n
            }\r\n
        },\r\n
        update: function () {\r\n
            if (this.commentsView && this.commentsView.scroller) {\r\n
                this.commentsView.scroller.update({\r\n
                    minScrollbarLength: 40\r\n
                });\r\n
            }\r\n
        },\r\n
        isVisible: function () {\r\n
            return (this.$window && this.$window.is(":visible"));\r\n
        },\r\n
        setLeftTop: function (posX, posY, leftX, loadInnerValues) {\r\n
            if (!this.$window) {\r\n
                this.render();\r\n
            }\r\n
            if (loadInnerValues) {\r\n
                posX = this.arrowPosX;\r\n
                posY = this.arrowPosY;\r\n
                leftX = this.leftX;\r\n
            }\r\n
            if (_.isUndefined(posX) && _.isUndefined(posY)) {\r\n
                return;\r\n
            }\r\n
            this.arrowPosX = posX;\r\n
            this.arrowPosY = posY;\r\n
            this.leftX = leftX;\r\n
            var commentsView = $("#id-comments-popover"),\r\n
            arrowView = $("#id-comments-arrow"),\r\n
            editorView = $("#editor_sdk"),\r\n
            editorBounds = null,\r\n
            sdkBoundsHeight = 0,\r\n
            sdkBoundsTop = 0,\r\n
            sdkBoundsLeft = 0,\r\n
            sdkPanelRight = "",\r\n
            sdkPanelRightWidth = 0,\r\n
            sdkPanelLeft = "",\r\n
            sdkPanelLeftWidth = 0,\r\n
            sdkPanelThumbs = "",\r\n
            sdkPanelThumbsWidth = 0,\r\n
            sdkPanelTop = "",\r\n
            sdkPanelHeight = 0,\r\n
            leftPos = 0,\r\n
            windowWidth = 0,\r\n
            outerHeight = 0,\r\n
            topPos = 0,\r\n
            sdkBoundsTopPos = 0;\r\n
            if (commentsView && arrowView && editorView && editorView.get(0)) {\r\n
                editorBounds = editorView.get(0).getBoundingClientRect();\r\n
                if (editorBounds) {\r\n
                    sdkBoundsHeight = editorBounds.height - this.sdkBounds.padding * 2;\r\n
                    this.$window.css({\r\n
                        maxHeight: sdkBoundsHeight + "px"\r\n


]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAABw=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="28" aka="AAAAAAAAABw=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

                    });\r\n
                    this.sdkBounds.width = editorBounds.width;\r\n
                    this.sdkBounds.height = editorBounds.height;\r\n
                    if (!_.isUndefined(posX)) {\r\n
                        sdkPanelRight = $("#id_vertical_scroll");\r\n
                        if (sdkPanelRight.length) {\r\n
                            sdkPanelRightWidth = (sdkPanelRight.css("display") !== "none") ? sdkPanelRight.width() : 0;\r\n
                        } else {\r\n
                            sdkPanelRight = $("#ws-v-scrollbar");\r\n
                            if (sdkPanelRight.length) {\r\n
                                sdkPanelRightWidth = (sdkPanelRight.css("display") !== "none") ? sdkPanelRight.width() : 0;\r\n
                            }\r\n
                        }\r\n
                        this.sdkBounds.width -= sdkPanelRightWidth;\r\n
                        sdkPanelLeft = $("#id_panel_left");\r\n
                        if (sdkPanelLeft.length) {\r\n
                            sdkPanelLeftWidth = (sdkPanelLeft.css("display") !== "none") ? sdkPanelLeft.width() : 0;\r\n
                        }\r\n
                        sdkPanelThumbs = $("#id_panel_thumbnails");\r\n
                        if (sdkPanelThumbs.length) {\r\n
                            sdkPanelThumbsWidth = (sdkPanelThumbs.css("display") !== "none") ? sdkPanelThumbs.width() : 0;\r\n
                            this.sdkBounds.width -= sdkPanelThumbsWidth;\r\n
                        }\r\n
                        leftPos = Math.min(sdkBoundsLeft + posX + this.arrow.width, sdkBoundsLeft + this.sdkBounds.width - this.$window.outerWidth());\r\n
                        leftPos = Math.max(sdkBoundsLeft + sdkPanelLeftWidth + this.arrow.width, leftPos);\r\n
                        arrowView.attr("class", "comments-arrow-left");\r\n
                        if (!_.isUndefined(leftX)) {\r\n
                            windowWidth = this.$window.outerWidth();\r\n
                            if (windowWidth) {\r\n
                                if ((posX + windowWidth > this.sdkBounds.width - this.arrow.width + 5) && (this.leftX > windowWidth)) {\r\n
                                    leftPos = this.leftX - windowWidth + sdkBoundsLeft - this.arrow.width;\r\n
                                    arrowView.attr("class", "comments-arrow-right");\r\n
                                } else {\r\n
                                    arrowView.attr("class", "comments-arrow-left");\r\n
                                    leftPos = sdkBoundsLeft + posX + this.arrow.width;\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                        this.$window.css("left", leftPos + "px");\r\n
                    }\r\n
                    if (!_.isUndefined(posY)) {\r\n
                        sdkPanelTop = $("#id_panel_top");\r\n
                        sdkBoundsTopPos = sdkBoundsTop;\r\n
                        if (sdkPanelTop.length) {\r\n
                            sdkPanelHeight = (sdkPanelTop.css("display") !== "none") ? sdkPanelTop.height() : 0;\r\n
                            sdkBoundsTopPos += this.sdkBounds.paddingTop;\r\n
                        } else {\r\n
                            sdkPanelTop = $("#ws-h-scrollbar");\r\n
                            if (sdkPanelTop.length) {\r\n
                                sdkPanelHeight = (sdkPanelTop.css("display") !== "none") ? sdkPanelTop.height() : 0;\r\n
                                sdkBoundsTopPos -= this.sdkBounds.paddingTop;\r\n
                            }\r\n
                        }\r\n
                        this.sdkBounds.height -= sdkPanelHeight;\r\n
                        outerHeight = this.$window.outerHeight();\r\n
                        topPos = Math.min(sdkBoundsTop + sdkBoundsHeight - outerHeight, this.arrowPosY + sdkBoundsTop - this.arrow.height);\r\n
                        topPos = Math.max(topPos, sdkBoundsTopPos);\r\n
                        this.$window.css("top", topPos + "px");\r\n
                    }\r\n
                }\r\n
            }\r\n
            this.calculateSizeOfContent();\r\n
        },\r\n
        calculateSizeOfContent: function (testVisible) {\r\n
            if (testVisible && !this.$window.is(":visible")) {\r\n
                return;\r\n
            }\r\n
            this.$window.css({\r\n
                overflow: "hidden"\r\n
            });\r\n
            var arrowView = $("#id-comments-arrow"),\r\n
            commentsView = $("#id-comments-popover"),\r\n
            contentBounds = null,\r\n
            editorView = null,\r\n
            editorBounds = null,\r\n
            sdkBoundsHeight = 0,\r\n
            sdkBoundsTop = 0,\r\n
            sdkBoundsLeft = 0,\r\n
            sdkPanelTop = "",\r\n
            sdkPanelHeight = 0,\r\n
            arrowPosY = 0,\r\n
            windowHeight = 0,\r\n
            outerHeight = 0,\r\n
            topPos = 0,\r\n
            sdkBoundsTopPos = 0;\r\n
            if (commentsView && arrowView && commentsView.get(0)) {\r\n
                commentsView.css({\r\n
                    height: "100%"\r\n
                });\r\n
                contentBounds = commentsView.get(0).getBoundingClientRect();\r\n
                if (contentBounds) {\r\n
                    editorView = $("#editor_sdk");\r\n
                    if (editorView && editorView.get(0)) {\r\n
                        editorBounds = editorView.get(0).getBoundingClientRect();\r\n
                        if (editorBounds) {\r\n
                            sdkBoundsHeight = editorBounds.height - this.sdkBounds.padding * 2;\r\n
                            sdkBoundsTopPos = sdkBoundsTop;\r\n
                            windowHeight = this.$window.outerHeight();\r\n
                            sdkPanelTop = $("#id_panel_top");\r\n
                            if (sdkPanelTop.length) {\r\n
                                sdkPanelHeight = (sdkPanelTop.css("display") !== "none") ? sdkPanelTop.height() : 0;\r\n
                                sdkBoundsTopPos += this.sdkBounds.paddingTop;\r\n
                            } else {\r\n
                                sdkPanelTop = $("#ws-h-scrollbar");\r\n
                                if (sdkPanelTop.length) {\r\n
                                    sdkPanelHeight = (sdkPanelTop.css("display") !== "none") ? sdkPanelTop.height() : 0;\r\n
                                    sdkBoundsTopPos -= this.sdkBounds.paddingTop;\r\n
                                }\r\n
                            }\r\n
                            outerHeight = Math.max(commentsView.outerHeight(), this.$window.outerHeight());\r\n
                            if (sdkBoundsHeight < outerHeight) {\r\n
                                this.$window.css({\r\n
                                    maxHeight: sdkBoundsHeight - sdkPanelHeight + "px",\r\n
                                    top: sdkBoundsTop + sdkPanelHeight + "px"\r\n
                                });\r\n
                                commentsView.css({\r\n
                                    height: sdkBoundsHeight - sdkPanelHeight + "px"\r\n
                                });\r\n
                                arrowPosY = Math.min(arrowPosY, sdkBoundsHeight - (sdkPanelHeight + this.arrow.margin + this.arrow.width));\r\n
                                arrowView.css({\r\n
                                    top: arrowPosY + "px"\r\n
                                });\r\n
                            } else {\r\n
                                outerHeight = windowHeight;\r\n
                                if (outerHeight > 0) {\r\n
                                    if (contentBounds.top + outerHeight > sdkBoundsHeight + sdkBoundsTop || contentBounds.height === 0) {\r\n
                                        topPos = Math.min(sdkBoundsTop + sdkBoundsHeight - outerHeight, this.arrowPosY + sdkBoundsTop - this.arrow.height);\r\n
                                        topPos = Math.max(topPos, sdkBoundsTopPos);\r\n
                                        this.$window.css({\r\n
                                            top: topPos + "px"\r\n
                                        });\r\n
                                    }\r\n
                                }\r\n
                                arrowPosY = Math.max(this.arrow.margin, this.arrowPosY - (sdkBoundsHeight - outerHeight) - this.arrow.width);\r\n
                                arrowPosY = Math.min(arrowPosY, outerHeight - this.arrow.margin - this.arrow.width);\r\n
                                arrowView.css({\r\n
                                    top: arrowPosY + "px"\r\n
                                });\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            this.$window.css({\r\n
                overflow: ""\r\n
            });\r\n
        },\r\n
        saveText: function (clear) {\r\n
            this.textVal = undefined;\r\n
            if (this.commentsView) {\r\n
                if (!clear) {\r\n
                    this.textVal = this.commentsView.getActiveTextBoxVal();\r\n
                } else {\r\n
                    this.commentsView.clearTextBoxBind();\r\n
                }\r\n
            }\r\n
        },\r\n
        getEditText: function () {\r\n
            if (this.commentsView) {\r\n
                return this.commentsView.getActiveTextBoxVal();\r\n
            }\r\n
            return undefined;\r\n
        },\r\n
        renderResolvedComboButtons: function () {\r\n
            if (_.isUndefined(this.openComboBoxes)) {\r\n
                this.openComboBoxes = [];\r\n
            }\r\n
            var me = this,\r\n
            i = 0,\r\n
            openCombo, buttons, j = this.openComboBoxes.length - 1;\r\n
            function onSelectResolveComment(comboBox) {\r\n
                if ($(comboBox.el).parent() && $(comboBox.el).parent().parent()) {\r\n
                    var id = ($(comboBox.el).parent().parent()).attr("id");\r\n
                    if (id) {\r\n
                        me.delegate.fireEvent("comment:resolve", [undefined, id]);\r\n
                        me.delegate.renderResolvedComboButtons();\r\n
                        me.renderResolvedComboButtons();\r\n
                    }\r\n
                }\r\n
            }\r\n
            for (; j >= 0; --j) {\r\n
                this.openComboBoxes[j].off();\r\n
                this.openComboBoxes[j].stopListening();\r\n
            }\r\n
            this.openComboBoxes = [];\r\n
            if (this.commentsView) {\r\n
                buttons = $(this.commentsView.el).find(".resolve-ct-check");\r\n
                for (i = buttons.length - 1; i >= 0; --i) {\r\n
                    openCombo = new Common.UI.ComboBox({\r\n
                        template: _.template(["<div>", \'<div class="resolved"></div>\', \'<div class="btn-resolve-check dropdown-toggle" data-toggle="dropdown">\', this.delegate.textResolved, "</div>", \'<span class="comments-caret"></span>\', \'<ul class="dropdown-menu <%= menuCls %>" style="<%= menuStyle %>" role="menu">\', "<% _.each(items, function (item) { %>", \'<li id="<%= item.id %>" data-value="<%= item.value %>"><a href="#"><%= scope.getDisplayValue(item) %></a></li>\', "<% }); %>", "</ul>", "</div>", ].join("")),\r\n
                        menuStyle: "min-width: 55px; margin-top: -7px; margin-left: -2px; padding: 0 0; right: 6px; left: auto;",\r\n
                        data: [{\r\n
                            value: 1,\r\n
                            displayValue: this.delegate.textOpenAgain\r\n
                        }]\r\n
                    });\r\n
                    openCombo.render($(buttons[i]));\r\n
                    openCombo.on("selected", onSelectResolveComment);\r\n
                    this.openComboBoxes.push(openCombo);\r\n
                }\r\n
            }\r\n
        },\r\n
        hookTextBox: function () {\r\n
            var me = this,\r\n
            textBox = this.commentsView.getTextBox();\r\n
            textBox && textBox.keydown(function (event) {\r\n
                if ((event.ctrlKey || event.metaKey) && event.keyCode === Common.UI.Keys.RETURN) {\r\n
                    var buttonChangeComment = $("#id-comments-change-popover");\r\n
                    if (buttonChangeComment && buttonChangeComment.length) {\r\n
                        buttonChangeComment.click();\r\n
                    }\r\n
                    event.stopImmediatePropagation();\r\n
                } else {\r\n
                    if (event.keyCode === Common.UI.Keys.TAB) {\r\n
                        var $this, end, start;\r\n
                        start = this.selectionStart;\r\n
                        end = this.selectionEnd;\r\n
                        $this = $(this);\r\n
                        $this.val($this.val().substring(0, start) + "\\t" + $this.val().substring(end));\r\n
                        this.selectionStart = this.selectionEnd = start + 1;\r\n
                        event.stopImmediatePropagation();\r\n
                        event.preventDefault();\r\n
                    }\r\n
                }\r\n
                me.e = event;\r\n
            });\r\n
        }\r\n
    });\r\n
    Common.Views.Comments = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#left-panel-comments",\r\n
        template: _.template(panelTemplate),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
            this.store = this.options.store;\r\n
            this.popoverComments = this.options.popoverComments;\r\n
        },\r\n
        render: function () {\r\n
            var me = this;\r\n
            $(this.el).html(this.template({\r\n
                textAddCommentToDoc: me.textAddCommentToDoc,\r\n
                textAddComment: me.textAddComment,\r\n
                textCancel: me.textCancel,\r\n
                textEnterCommentHint: me.textEnterCommentHint\r\n
            }));\r\n
            this.buttonAddCommentToDoc = new Common.UI.Button({\r\n
                el: $("#comment-btn-new"),\r\n
                enableToggle: false\r\n
            });\r\n
            this.buttonAdd = new Common.UI.Button({\r\n
                action: "add",\r\n
                el: $("#comment-btn-add"),\r\n
                enableToggle: false\r\n
            });\r\n
            this.buttonCancel = new Common.UI.Button({\r\n
                el: $("#comment-btn-cancel"),\r\n
                enableToggle: false\r\n
            });\r\n
            this.buttonAddCommentToDoc.on("click", _.bind(this.onClickShowBoxDocumentComment, this));\r\n
            this.buttonAdd.on("click", _.bind(this.onClickAddDocumentComment, this));\r\n
            this.buttonCancel.on("click", _.bind(this.onClickCancelDocumentComment, this));\r\n
            this.txtComment = $("#comment-msg-new", this.el);\r\n
            this.txtComment.keydown(function (event) {\r\n
                if ((event.ctrlKey || event.metaKey) && event.keyCode == Common.UI.Keys.RETURN) {\r\n
                    me.onClickAddDocumentComment();\r\n
                    event.stopImmediatePropagation();\r\n
                } else {\r\n
                    if (event.keyCode === Common.UI.Keys.TAB) {\r\n
                        var $this, end, start;\r\n
                        start = this.selectionStart;\r\n
                        end = this.selectionEnd;\r\n
                        $this = $(this);\r\n
                        $this.val($this.val().substring(0, start) + "\\t" + $this.val().substring(end));\r\n
                        this.selectionStart = this.selectionEnd = start + 1;\r\n
                        event.stopImmediatePropagation();\r\n
                        event.preventDefault();\r\n
                    }\r\n
                }\r\n
            });\r\n
            var CommentsPanelDataView = Common.UI.DataView.extend((function () {\r\n
                var parentView = me;\r\n
                return {\r\n
                    options: {\r\n
                        handleSelect: false,\r\n
                        scrollable: true,\r\n
                        listenStoreEvents: false,\r\n
                        template: _.template(\'<div class="dataview-ct inner"></div>\')\r\n
                    },\r\n
                    getTextBox: function () {\r\n
                        var text = $(this.el).find("textarea");\r\n
                        return (text && text.length) ? text : undefined;\r\n
                    },\r\n
                    setFocusToTextBox: function () {\r\n
                        var text = $(this.el).find("textarea");\r\n
                        if (text && text.length) {\r\n
                            var val = text.val();\r\n
                            text.focus();\r\n
                            text.val("");\r\n
                            text.val(val);\r\n
                        }\r\n
                    },\r\n
                    getActiveTextBoxVal: function () {\r\n
                        var text = $(this.el).find("textarea");\r\n
                        return (text && text.length) ? text.val().trim() : "";\r\n
                    },\r\n
                    autoHeightTextBox: function () {\r\n
                        var view = this,\r\n
                        textBox = $(this.el).find("textarea"),\r\n
                        domTextBox = null,\r\n
                        minHeight = 50,\r\n
                        lineHeight = 0,\r\n
                        scrollPos = 0,\r\n
                        oldHeight = 0,\r\n
                        newHeight = 0;\r\n
                        function updateTextBoxHeight() {\r\n
                            if (domTextBox.scrollHeight > domTextBox.clientHeight) {\r\n
                                textBox.css({\r\n
                                    height: (domTextBox.scrollHeight + lineHeight) + "px"\r\n
                                });\r\n
                            } else {\r\n
                                oldHeight = domTextBox.clientHeight;\r\n
                                if (oldHeight >= minHeight) {\r\n
                                    textBox.css({\r\n
                                        height: minHeight + "px"\r\n
                                    });\r\n
                                    if (domTextBox.scrollHeight > domTextBox.clientHeight) {\r\n
                                        newHeight = Math.max(domTextBox.scrollHeight + lineHeight, minHeight);\r\n
                                        textBox.css({\r\n
                                            height: newHeight + "px"\r\n
                                        });\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                            view.autoScrollToEditButtons();\r\n
                        }\r\n
                        if (textBox && textBox.length) {\r\n
                            domTextBox = textBox.get(0);\r\n
                            if (domTextBox) {\r\n
                                lineHeight = parseInt(textBox.css("lineHeight"), 10) * 0.25;\r\n
                                updateTextBoxHeight();\r\n
                                textBox.bind("input propertychange", updateTextBoxHeight);\r\n
                            }\r\n
                        }\r\n
                        this.textBox = textBox;\r\n
                    },\r\n
                    clearTextBoxBind: function () {\r\n
                        if (this.textBox) {\r\n
                            this.textBox.unbind("input propertychange");\r\n
                            this.textBox = undefined;\r\n
                        }\r\n
                    },\r\n
                    autoScrollToEditButtons: function () {\r\n
                        var button = $("#id-comments-change"),\r\n
                        btnBounds = null,\r\n
                        contentBounds = this.el.getBoundingClientRect(),\r\n
                        moveY = 0,\r\n
                        padding = 7;\r\n
                        if (button.length) {\r\n
                            btnBounds = button.get(0).getBoundingClientRect();\r\n
                            if (btnBounds && contentBounds) {\r\n
                                moveY = contentBounds.bottom - (btnBounds.bottom + padding);\r\n
                                if (moveY < 0) {\r\n
                                    this.scroller.scrollTop(this.scroller.getScrollTop() - moveY);\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                };\r\n
            })());\r\n
            if (CommentsPanelDataView) {\r\n
                if (this.commentsView) {\r\n
                    this.commentsView.render($("#comments-messages"));\r\n
                    this.commentsView.onResetItems();\r\n
                } else {\r\n
                    this.commentsView = new CommentsPanelDataView({\r\n
                        el: $("#comments-messages"),\r\n
                        store: me.store,\r\n
                        itemTemplate: _.template(replaceWords(commentsTemplate, {\r\n
                            textAddReply: me.textAddReply,\r\n
                            textAdd: me.textAdd,\r\n
                            textCancel: me.textCancel,\r\n
                            textEdit: me.textEdit,\r\n
                            textReply: me.textReply,\r\n
                            textClose: me.textClose,\r\n
                            textResolved: me.textResolved,\r\n
                            textResolve: me.textResolve\r\n
                        }))\r\n
                    });\r\n
                    this.commentsView.on("item:click", function (picker, item, record, e) {\r\n
                        var btn, showEditBox, showReplyBox, commentId, replyId, hideAddReply;\r\n
                        function readdresolves() {\r\n
                            if (me.popover) {\r\n
                                me.popover.renderResolvedComboButtons();\r\n
                            }\r\n
                            me.renderResolvedComboButtons();\r\n
                            me.update();\r\n
                        }\r\n
                        btn = $(e.target);\r\n
                        if (btn) {\r\n
                            showEditBox = record.get("editText");\r\n
                            showReplyBox = record.get("showReply");\r\n
                            commentId = record.get("uid");\r\n
                            replyId = btn.attr("data-value");\r\n
                            if (btn.hasClass("btn-edit")) {\r\n
                                if (!_.isUndefined(replyId)) {\r\n
                                    me.fireEvent("comment:closeEditing", [commentId]);\r\n
                                    me.fireEvent("comment:editReply", [commentId, replyId]);\r\n
                                    me.commentsView.reply = replyId;\r\n
                                    this.autoHeightTextBox();\r\n
                                    readdresolves();\r\n
                                    me.hookTextBox();\r\n
                                    this.autoScrollToEditButtons();\r\n
                                    this.setFocusToTextBox();\r\n
                                } else {\r\n
                                    if (!showEditBox) {\r\n
                                        me.fireEvent("comment:closeEditing");\r\n
                                        record.set("editText", true);\r\n
                                        this.autoHeightTextBox();\r\n
                                        readdresolves();\r\n
                                        this.setFocusToTextBox();\r\n
                                        me.hookTextBox();\r\n
                                    }\r\n
                                }\r\n
                            } else {\r\n
                                if (btn.hasClass("btn-delete")) {\r\n
                                    if (!_.isUndefined(replyId)) {\r\n
                                        me.fireEvent("comment:removeReply", [commentId, replyId]);\r\n
                                    } else {\r\n
                                        me.fireEvent("comment:remove", [commentId]);\r\n
                                    }\r\n
                                    me.fireEvent("comment:closeEditing");\r\n
                                    readdresolves();\r\n
                                } else {\r\n
                                    if (btn.hasClass("user-reply")) {\r\n
                                        me.fireEvent("comment:closeEditing");\r\n
                                        record.set("showReply", true);\r\n
                                        readdresolves();\r\n
                                        this.autoHeightTextBox();\r\n
                                        me.hookTextBox();\r\n
                                        this.autoScrollToEditButtons();\r\n
                                        this.setFocusToTextBox();\r\n
                                    } else {\r\n
                                        if (btn.hasClass("btn-reply", false)) {\r\n
                                            if (showReplyBox) {\r\n
                                                me.fireEvent("comment:addReply", [commentId, this.getActiveTextBoxVal()]);\r\n
                                                me.fireEvent("comment:closeEditing");\r\n
                                                readdresolves();\r\n
                                            }\r\n
                                        } else {\r\n
                                            if (btn.hasClass("btn-close", false)) {\r\n
                                                me.fireEvent("comment:closeEditing", [commentId]);\r\n
                                                me.renderResolvedComboButtons();\r\n
                                            } else {\r\n
                                                if (btn.hasClass("btn-inner-edit", false)) {\r\n
                                                    if (!_.isUndefined(me.commentsView.reply)) {\r\n
                                                        me.fireEvent("comment:changeReply", [commentId, me.commentsView.reply, this.getActiveTextBoxVal()]);\r\n
                                                        me.commentsView.reply = undefined;\r\n
                                                    } else {\r\n
                                                        if (showEditBox) {\r\n
                                                            me.fireEvent("comment:change", [commentId, this.getActiveTextBoxVal()]);\r\n
                                                        }\r\n
                                                    }\r\n
                                                    me.fireEvent("comment:closeEditing");\r\n
                                                    readdresolves();\r\n
                                                } else {\r\n
                                                    if (btn.hasClass("btn-inner-close", false)) {\r\n
                                                        me.fireEvent("comment:closeEditing");\r\n
                                                        me.commentsView.reply = undefined;\r\n
                                                        readdresolves();\r\n
                                                    } else {\r\n
                                                        if (btn.hasClass("btn-resolve", false)) {\r\n
                                                            me.fireEvent("comment:resolve", [commentId]);\r\n
                                                            readdresolves();\r\n
                                                        } else {\r\n
                                                            if (!btn.hasClass("msg-reply") && !btn.hasClass("btn-resolve-check") && !btn.hasClass("btn-resolve")) {\r\n
                                                                me.fireEvent("comment:show", [commentId, false]);\r\n
                                                            }\r\n
                                                        }\r\n
                                                    }\r\n
                                                }\r\n
                                            }\r\n
                                        }\r\n
                                    }\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    });\r\n
                }\r\n
            }\r\n
            this.update();\r\n
            return this;\r\n
        },\r\n
        update: function () {\r\n
            if (this.commentsView && this.commentsView.scroller) {\r\n
                this.commentsView.scroller.update({\r\n
                    minScrollbarLength: 40\r\n
                });\r\n
            }\r\n
        },\r\n
        getPopover: function (sdkViewName) {\r\n
            if (_.isUndefined(this.popover)) {\r\n
                this.popover = new Common.Views.CommentsPopover({\r\n
                    store: this.popoverComments,\r\n
                    delegate: this,\r\n
                    renderTo: sdkViewName\r\n
                });\r\n
            }\r\n
            return this.popover;\r\n
        },\r\n
        showEditContainer: function (show) {\r\n
            var addCommentLink = $("#comments-add-link-ct", this.el),\r\n
            newCommentBlock = $("#comments-new-comment-ct", this.el),\r\n
            commentMsgBlock = $("#comments-messages", this.el);\r\n
            if (!show) {\r\n
                commentMsgBlock.css("bottom", 45);\r\n
                addCommentLink.css({\r\n
                    display: "table-row"\r\n
                });\r\n
                newCommentBlock.css({\r\n
                    display: "none"\r\n
                });\r\n
            } else {\r\n
                commentMsgBlock.css("bottom", 110);\r\n
                addCommentLink.css({\r\n
                    display: "none"\r\n
                });\r\n
                newCommentBlock.css({\r\n
                    display: "table-row"\r\n
                });\r\n
                this.txtComment.val("");\r\n
                this.txtComment.focus();\r\n
            }\r\n
        },\r\n
        onClickShowBoxDocumentComment: function () {\r\n
            this.fireEvent("comment:closeEditing");\r\n
            this.showEditContainer(true);\r\n
        },\r\n
        onClickAddDocumentComment: function () {\r\n
            this.fireEvent("comment:add", [this, this.txtComment.val().trim(), undefined, false, true]);\r\n
            this.txtComment.val("");\r\n
        },\r\n
        onClickCancelDocumentComment: function () {\r\n
            this.showEditContainer(false);\r\n
        },\r\n
        renderResolvedComboButtons: function () {\r\n
            if (_.isUndefined(this.openComboBoxes)) {\r\n
                this.openComboBoxes = [];\r\n
            }\r\n
            var me = this,\r\n
            i, openCombo, j = this.openComboBoxes.length - 1,\r\n
            buttons = $(this.commentsView.el).find(".resolve-ct-check");\r\n
            function onSelectResolveComment(comboBox) {\r\n
                if ($(comboBox.el).parent() && $(comboBox.el).parent().parent()) {\r\n
                    var id = ($(comboBox.el).parent().parent()).attr("id");\r\n
                    if (id) {\r\n
                        if (arguments[2]) {\r\n
                            arguments[2].stopImmediatePropagation();\r\n
                        }\r\n
                        me.fireEvent("comment:resolve", [undefined, id]);\r\n
                        me.renderResolvedComboButtons();\r\n
                        if (me.popover) {\r\n
                            me.popover.renderResolvedComboButtons();\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            for (j = this.openComboBoxes.length - 1; j >= 0; --j) {\r\n
                this.openComboBoxes[j].off();\r\n
                this.openComboBoxes[j].stopListening();\r\n
            }\r\n
            this.openComboBoxes = [];\r\n
            for (i = buttons.length - 1; i >= 0; --i) {\r\n
                openCombo = new Common.UI.ComboBox({\r\n
                    template: _.template(["<div>", \'<div class="resolved"></div>\', \'<div class="btn-resolve-check dropdown-toggle" data-toggle="dropdown">\', this.textResolved, "</div>", \'<span class="comments-caret"></span>\', \'<ul class="dropdown-menu <%= menuCls %>" style="\', "<%= menuStyle %>", \' role="menu">\', "<% _.each(items, function (item) { %>", \'<li id="<%= item.id %>" data-value="<%= item.value %>"><a href="#"><%= scope.getDisplayValue(item) %></a></li>\', "<% }); %>", "</ul>", "</div>"].join("")),\r\n
                    menuStyle: "min-width: 55px; margin-top: -7px; margin-left: -2px; padding: 0 0; right: 6px; left: auto;",\r\n
                    data: [{\r\n
                        value: 1,\r\n
                        displayValue: this.textOpenAgain\r\n
                    }]\r\n
                });\r\n
                openCombo.render($(buttons[i]));\r\n
                openCombo.on("selected", onSelectResolveComment);\r\n
                this.openComboBoxes.push(openCombo);\r\n
            }\r\n
        },\r\n
        hookTextBox: function () {\r\n
            var me = this,\r\n
            textBox = this.commentsView.getTextBox();\r\n
            textBox && textBox.keydown(function (event) {\r\n
                if ((event.ctrlKey || event.metaKey) && event.keyCode == Common.UI.Keys.RETURN) {\r\n
                    var buttonChangeComment = $("#id-comments-change");\r\n
                    if (buttonChangeComment && buttonChangeComment.length) {\r\n
                        buttonChangeComment.click();\r\n
                    }\r\n
                    event.stopImmediatePropagation();\r\n
                } else {\r\n
                    if (event.keyCode === Common.UI.Keys.TAB) {\r\n
                        var $this, end, start;\r\n
                        start = this.selectionStart;\r\n
                        end = this.selectionEnd;\r\n
                        $this = $(this);\r\n
                        $this.val($this.val().substring(0, start) + "\\t" + $this.val().substring(end));\r\n
                        this.selectionStart = this.selectionEnd = start + 1;\r\n
                        event.stopImmediatePropagation();\r\n
                        event.preventDefault();\r\n
                    }\r\n
                }\r\n
            });\r\n
        },\r\n
        getFixedQuote: function (quote) {\r\n
            return Common.Utils.String.ellipsis(Common.Utils.String.htmlEncode(quote), 120, true);\r\n
        },\r\n
        getUserName: function (username) {\r\n
            return Common.Utils.String.ellipsis(Common.Utils.String.htmlEncode(username), 15, true);\r\n
        },\r\n
        pickLink: function (message) {\r\n
            var arr = [],\r\n
            offset,\r\n
            len;\r\n
            message = Common.Utils.String.htmlEncode(message);\r\n
            message.replace(Common.Utils.emailStrongRe, function (subStr) {\r\n
                offset = arguments[arguments.length - 2];\r\n
                arr.push({\r\n
                    start: offset,\r\n
                    end: subStr.length + offset,\r\n
                    str: \'<a href="\' + subStr + \'">\' + subStr + "</a>"\r\n
                });\r\n
                return "";\r\n
            });\r\n
            message.replace(Common.Utils.ipStrongRe, function (subStr) {\r\n
                offset = arguments[arguments.length - 2];\r\n
                len = subStr.length;\r\n
                var elem = _.find(arr, function (item) {\r\n
                    return ((offset >= item.start) && (offset < item.end) || (offset <= item.start) && (offset + len > item.start));\r\n
                });\r\n
                if (!elem) {\r\n
                    arr.push({\r\n
                        start: offset,\r\n
                        end: len + offset,\r\n
                        str: \'<a href="\' + subStr + \'" target="_blank" data-can-copy="true">\' + subStr + "</a>"\r\n
                    });\r\n
                }\r\n
                return "";\r\n
            });\r\n
            message.replace(Common.Utils.hostnameStrongRe, function (subStr) {\r\n
                var ref = (!/(((^https?)|(^ftp)):\\/\\/)/i.test(subStr)) ? ("http://" + subStr) : subStr;\r\n
                offset = arguments[arguments.length - 2];\r\n
                len = subStr.length;\r\n
                var elem = _.find(arr, function (item) {\r\n
                    return ((offset >= item.start) && (offset < item.end) || (offset <= item.start) && (offset + len > item.start));\r\n
                });\r\n
                if (!elem) {\r\n
                    arr.push({\r\n
                        start: offset,\r\n
                        end: len + offset,\r\n
                        str: \'<a href="\' + ref + \'" target="_blank" data-can-copy="true">\' + subStr + "</a>"\r\n
                    });\r\n
                }\r\n
                return "";\r\n
            });\r\n
            arr = _.sortBy(arr, function (item) {\r\n
                return item.start;\r\n
            });\r\n
            var str_res = (arr.length > 0) ? (message.substring(0, arr[0].start) + arr[0].str) : message;\r\n
            for (var i = 1; i < arr.length; i++) {\r\n
                str_res += (message.substring(arr[i - 1].end, arr[i].start) + arr[i].str);\r\n
            }\r\n
            if (arr.length > 0) {\r\n
                str_res += message.substring(arr[i - 1].end, message.length);\r\n
            }\r\n
            return str_res;\r\n
        },\r\n
        textComments: "Comments",\r\n
        textAnonym: "Guest",\r\n
        textAddCommentToDoc: "Add Comment to Document",\r\n
        textAddComment: "Add Comment",\r\n
        textCancel: "Cancel",\r\n
        textAddReply: "Add Reply",\r\n
        textReply: "Reply",\r\n
        textClose: "Close",\r\n
        textResolved: "Resolved",\r\n
        textResolve: "Resolve",\r\n
        textEnterCommentHint: "Enter your comment here",\r\n
        textEdit: "Edit",\r\n
        textAdd: "Add",\r\n
        textOpenAgain: "Open Again"\r\n
    },\r\n
    Common.Views.Comments || {}));\r\n
});\n
\n
define(\'text!common/main/lib/template/Chat.template\',[],function () { return \'<div id="chat-box">\\r\\n    <div id="chat-users">\\r\\n        <div id="chat-user-ct"></div>\\r\\n    </div>\\r\\n    <div id="chat-messages">\\r\\n        <div id="chat-message-ct"></div>\\r\\n    </div>\\r\\n    <div id="chat-options">\\r\\n        <div id="chat-options-ct">\\r\\n            <textarea id="chat-msg-text"></textarea>\\r\\n            <button id="chat-msg-btn-add" class="btn normal dlg-btn primary"><%=scope.textSend%></button>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Views = Common.Views || {};\r\n
define(\'common/main/lib/view/Chat\',["text!common/main/lib/template/Chat.template", "common/main/lib/util/utils", "common/main/lib/component/BaseView"], function (template) {\r\n
    Common.Views.Chat = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#left-panel-chat",\r\n
        template: _.template(template),\r\n
        storeUsers: undefined,\r\n
        storeMessages: undefined,\r\n
        tplUser: [\'<li id="chat-user-<%= user.get("id") %>"<% if (!user.get("online")) { %> class="offline"<% } %>>\', \'<div class="color" style="background-color: <%= user.get("color") %>;" >\', \'<label class="name"><%= scope.getUserName(user.get("username")) %></label>\', "</div>", "</li>"].join(""),\r\n
        templateUserList: _.template("<ul>" + "<% _.each(users, function(item) { %>" + "<%= _.template(usertpl, {user: item, scope: scope}) %>" + "<% }); %>" + "</ul>"),\r\n
        tplMsg: ["<li>", \'<% if (msg.get("type")==1) { %>\', \'<div class="message service" data-can-copy="true"><%= msg.get("message") %></div>\', "<% } else { %>", \'<div class="user" data-can-copy="true" style="color: <%= msg.get("usercolor") %>;"><%= scope.getUserName(msg.get("username")) %></div>\', \'<label class="message" data-can-copy="true"><%= msg.get("message") %></label>\', "<% } %>", "</li>"].join(""),\r\n
        templateMsgList: _.template("<ul>" + "<% _.each(messages, function(item) { %>" + "<%= _.template(msgtpl, {msg: item, scope: scope}) %>" + "<% }); %>" + "</ul>"),\r\n
        events: {},\r\n
        initialize: function (options) {\r\n
            _.extend(this, options);\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.storeUsers.bind({\r\n
                add: _.bind(this._onAddUser, this),\r\n
                change: _.bind(this._onUsersChanged, this),\r\n
                reset: _.bind(this._onResetUsers, this)\r\n
            });\r\n
            this.storeMessages.bind({\r\n
                add: _.bind(this._onAddMessage, this),\r\n
                reset: _.bind(this._onResetMessages, this)\r\n
            });\r\n
        },\r\n
        render: function (el) {\r\n
            el = el || this.el;\r\n
            $(el).html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            this.panelUsers = $("#chat-users", this.el);\r\n
            this.panelMessages = $("#chat-messages", this.el);\r\n
            this.txtMessage = $("#chat-msg-text", this.el);\r\n
            this.panelUsers.scroller = new Common.UI.Scroller({\r\n
                el: $("#chat-users"),\r\n
                useKeyboard: true,\r\n
                minScrollbarLength: 25\r\n
            });\r\n
            this.panelMessages.scroller = new Common.UI.Scroller({\r\n
                el: $("#chat-messages"),\r\n
                includePadding: true,\r\n
                useKeyboard: true,\r\n
                minScrollbarLength: 40\r\n
            });\r\n
            $("#chat-msg-btn-add", this.el).on("click", _.bind(this._onBtnAddMessage, this));\r\n
            this.txtMessage.on("keydown", _.bind(this._onKeyDown, this));\r\n
            return this;\r\n
        },\r\n
        focus: function () {\r\n
            var me = this;\r\n
            _.defer(function () {\r\n
                me.txtMessage.focus();\r\n
            },\r\n
            100);\r\n
        },\r\n
        _onKeyDown: function (event) {\r\n
            if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                if (event.ctrlKey || event.metaKey) {\r\n
                    this._onBtnAddMessage(event);\r\n
                }\r\n
            } else {\r\n
                if (event.keyCode == Common.UI.Keys.ESC) {\r\n
                    this.hide();\r\n
                }\r\n
            }\r\n
        },\r\n
        _onAddUser: function (m, c, opts) {\r\n
            if (this.panelUsers) {\r\n
                this.panelUsers.find("ul").append(_.template(this.tplUser, {\r\n
                    user: m,\r\n
                    scope: this\r\n
                }));\r\n
                this.panelUsers.scroller.update({\r\n
                    minScrollbarLength: 25\r\n
                });\r\n
            }\r\n
        },\r\n
        _onUsersChanged: function (m) {\r\n
            if (m.changed.online != undefined && this.panelUsers) {\r\n
                this.panelUsers.find("#chat-user-" + m.get("id"))[m.changed.online ? "removeClass" : "addClass"]("offline");\r\n
                this.panelUsers.scroller.update({\r\n
                    minScrollbarLength: 25\r\n
                });\r\n
            }\r\n
        },\r\n
        _onResetUsers: function (c, opts) {\r\n
            if (this.panelUsers) {\r\n
                this.panelUsers.html(this.templateUserList({\r\n
                    users: c.models,\r\n
                    usertpl: this.tplUser,\r\n
                    scope: this\r\n
                }));\r\n
                this.panelUsers.scroller.update({\r\n
                    minScrollbarLength: 25\r\n
                });\r\n
            }\r\n
        },\r\n
        _onAddMessage: function (m, c, opts) {\r\n
            if (this.panelMessages) {\r\n
                var content = this.panelMessages.find("ul");\r\n
                if (content && content.length) {\r\n
                    this._prepareMessage(m);\r\n
                    content.append(_.template(this.tplMsg, {\r\n
                        msg: m,\r\n
                        scope: this\r\n
                    }));\r\n
                    this.panelMessages.scroller.update({\r\n
                        minScrollbarLength: 40\r\n
                    });\r\n
                    this.panelMessages.scroller.scrollTop(content.get(0).getBoundingClientRect().height);\r\n
                }\r\n
            }\r\n
        },\r\n
        _onResetMessages: function (c, opts) {\r\n
            if (this.panelMessages) {\r\n
                var user, color;\r\n
                c.each(function (msg) {\r\n
                    this._prepareMessage(msg);\r\n
                },\r\n
                this);\r\n
                this.panelMessages.html(this.templateMsgList({\r\n
                    messages: c.models,\r\n
                    msgtpl: this.tplMsg,\r\n
                    scope: this\r\n
                }));\r\n
                this.panelMessages.scroller.update({\r\n
                    minScrollbarLength: 40\r\n
                });\r\n
            }\r\n
        },\r\n
        _onBtnAddMessage: function (e) {\r\n
            if (this.txtMessage) {\r\n
                this.fireEvent("message:add", [this, this.txtMessage.val().trim()]);\r\n
                this.txtMessage.val("");\r\n
                this.focus();\r\n
            }\r\n
        },\r\n
        _prepareMessage: function (m) {\r\n
            var user = this.storeUsers.findUser(m.get("userid"));\r\n
            m.set({\r\n
                usercolor: user ? user.get("color") : "#000",\r\n
                message: this._pickLink(Common.Utils.String.htmlEncode(m.get("message")))\r\n
            },\r\n
            {\r\n
                silent: true\r\n
            });\r\n
        },\r\n
        _pickLink: function (message) {\r\n
            var arr = [],\r\n
            offset,\r\n
            len;\r\n
            message.replace(Common.Utils.emailStrongRe, function (subStr) {\r\n
                offset = arguments[arguments.length - 2];\r\n
                arr.push({\r\n
                    start: offset,\r\n
                    end: subStr.length + offset,\r\n
                    str: \'<a href="\' + subStr + \'">\' + subStr + "</a>"\r\n
                });\r\n
                return "";\r\n
            });\r\n
            message.replace(Common.Utils.ipStrongRe, function (subStr) {\r\n
                offset = arguments[arguments.length - 2];\r\n
                len = subStr.length;\r\n
                var elem = _.find(arr, function (item) {\r\n
                    return ((offset >= item.start) && (offset < item.end) || (offset <= item.start) && (offset + len > item.start));\r\n
                });\r\n
                if (!elem) {\r\n
                    arr.push({\r\n
                        start: offset,\r\n
                        end: len + offset,\r\n
                        str: \'<a href="\' + subStr + \'" target="_blank" data-can-copy="true">\' + subStr + "</a>"\r\n
                    });\r\n
                }\r\n
                return "";\r\n
            });\r\n
            message.replace(Common.Utils.hostnameStrongRe, function (subStr) {\r\n
                var ref = (!/(((^https?)|(^ftp)):\\/\\/)/i.test(subStr)) ? ("http://" + subStr) : subStr;\r\n
                offset = arguments[arguments.length - 2];\r\n
                len = subStr.length;\r\n
                var elem = _.find(arr, function (item) {\r\n
                    return ((offset >= item.start) && (offset < item.end) || (offset <= item.start) && (offset + len > item.start));\r\n
                });\r\n
                if (!elem) {\r\n
                    arr.push({\r\n
                        start: offset,\r\n
                        end: len + offset,\r\n
                        str: \'<a href="\' + ref + \'" target="_blank" data-can-copy="true">\' + subStr + "</a>"\r\n
                    });\r\n
                }\r\n
                return "";\r\n
            });\r\n
            arr = _.sortBy(arr, function (item) {\r\n
                return item.start;\r\n
            });\r\n
            var str_res = (arr.length > 0) ? (message.substring(0, arr[0].start) + arr[0].str) : message;\r\n
            for (var i = 1; i < arr.length; i++) {\r\n
                str_res += (message.substring(arr[i - 1].end, arr[i].start) + arr[i].str);\r\n
            }\r\n
            if (arr.length > 0) {\r\n
                str_res += message.substring(arr[i - 1].end, message.length);\r\n
            }\r\n
            return str_res;\r\n
        },\r\n
        getUserName: function (username) {\r\n
            return Common.Utils.String.htmlEncode(username);\r\n
        },\r\n
        hide: function () {\r\n
            Common.UI.BaseView.prototype.hide.call(this, arguments);\r\n
            this.fireEvent("hide", this);\r\n
        },\r\n
        textSend: "Send"\r\n
    },\r\n
    Common.Views.Chat || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/view/SearchDialog\',["common/main/lib/component/Window"], function () {\r\n
    Common.UI.SearchDialog = Common.UI.Window.extend(_.extend({\r\n
        options: {\r\n
            width: 550,\r\n
            title: "Search & Replace",\r\n
            modal: false,\r\n
            cls: "search",\r\n
            toolclose: "hide",\r\n
            alias: "SearchDialog"\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, options || {});\r\n
            this.template = [\'<div class="box">\', \'<div class="input-row">\', \'<span class="btn-placeholder" id="search-placeholder-btn-options"></span>\', \'<input type="text" id="sd-text-search" class="form-control" maxlength="100" placeholder="\' + this.textSearchStart + \'">\', "</div>", \'<div class="input-row">\', \'<input type="text" id="sd-text-replace" class="form-control" maxlength="100" placeholder="\' + this.textReplaceDef + \'">\', "</div>", \'<div class="input-row">\', \'<label class="link" id="search-label-replace" result="replaceshow">\' + this.txtBtnReplace + "</label>", "</div>", "</div>", \'<div class="separator horizontal"/>\', \'<div class="footer right">\', \'<button class="btn normal dlg-btn" result="replace" style="margin-right: 6px;">\' + this.txtBtnReplace + "</button>", \'<button class="btn normal dlg-btn" result="replaceall" style="margin-right: 10px;">\' + this.txtBtnReplaceAll + "</button>", \'<button class="btn normal dlg-btn iconic" result="back" style="margin-right: 6px;"><span class="icon back" /></button>\', \'<button class="btn normal dlg-btn iconic" result="next"><span class="icon next" /></button>\', "</div>"].join("");\r\n
            this.options.tpl = _.template(this.template, this.options);\r\n
            Common.UI.Window.prototype.initialize.call(this, this.options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.miMatchCase = new Common.UI.MenuItem({\r\n
                caption: this.textMatchCase,\r\n
                checkable: true\r\n
            });\r\n
            this.miMatchWord = new Common.UI.MenuItem({\r\n
                caption: this.options.matchwordstr || this.textWholeWords,\r\n
                checkable: true\r\n
            });\r\n
            this.miHighlight = new Common.UI.MenuItem({\r\n
                caption: this.textHighlight,\r\n
                checkable: true\r\n
            });\r\n
            this.btnOptions = new Common.UI.Button({\r\n
                id: "search-btn-options",\r\n
                cls: "btn-toolbar btn-toolbar-default",\r\n
                iconCls: "btn-settings",\r\n
                menu: new Common.UI.Menu({\r\n
                    items: [this.miMatchCase, this.miMatchWord, this.miHighlight]\r\n
                })\r\n
            });\r\n
            if (this.options.extraoptions) {\r\n
                this.btnOptions.menu.addItem({\r\n
                    caption: "--"\r\n
                });\r\n
                this.options.extraoptions.forEach(function (item) {\r\n
                    this.btnOptions.menu.addItem(item);\r\n
                },\r\n
                this);\r\n
            }\r\n
            this.btnOptions.render(this.$window.find("#search-placeholder-btn-options"));\r\n
            if (!this.options.matchcase) {\r\n
                this.miMatchCase.hide();\r\n
            }\r\n
            if (!this.options.matchword) {\r\n
                this.miMatchWord.hide();\r\n
            }\r\n
            if (!this.options.markresult) {\r\n
                this.miHighlight.hide();\r\n
            } else {\r\n
                if (this.options.markresult.applied) {\r\n
                    this.miHighlight.setChecked(true, true);\r\n
                }\r\n
            }\r\n
            if (this.options.mode === "search") {\r\n
                $(this.$window.find(".input-row").get(2)).hide();\r\n
            }\r\n
            this.txtSearch = this.$window.find("#sd-text-search");\r\n
            this.txtReplace = this.$window.find("#sd-text-replace");\r\n
            this.miHighlight.on("toggle", _.bind(this.onHighlight, this));\r\n
            this.$window.find(".btn[result=back]").on("click", _.bind(this.onBtnClick, this, "back"));\r\n
            this.$window.find(".btn[result=next]").on("click", _.bind(this.onBtnClick, this, "next"));\r\n
            this.$window.find(".btn[result=replace]").on("click", _.bind(this.onBtnClick, this, "replace"));\r\n
            this.$window.find(".btn[result=replaceall]").on("click", _.bind(this.onBtnClick, this, "replaceall"));\r\n
            this.$window.find("label[result=replaceshow]").on("click", _.bind(this.onShowReplace, this));\r\n
            this.txtSearch.on("keydown", null, "search", _.bind(this.onKeyPress, this));\r\n
            this.txtReplace.on("keydown", null, "replace", _.bind(this.onKeyPress, this));\r\n
            return this;\r\n
        },\r\n
        show: function (mode) {\r\n
            Common.UI.Window.prototype.show.call(this); ! this.mode && !mode && (mode = "search");\r\n
            if (mode && this.mode != mode) {\r\n
                this.setMode(mode);\r\n
            }\r\n
            if (this.options.markresult && this.miHighlight.checked) {\r\n
                this.fireEvent("search:highlight", [this, true]);\r\n
            }\r\n
            this.focus();\r\n
        },\r\n
        focus: function () {\r\n
            var me = this;\r\n
            _.delay(function () {\r\n
                me.txtSearch.focus();\r\n
                me.txtSearch.select();\r\n
            },\r\n
            300);\r\n
        },\r\n
        onKeyPress: function (event) {\r\n
            if (!this.isLocked()) {\r\n
                if (event.keyCode == Common.UI.Keys.RETURN) {\r\n
                    if (event.data == "search") {\r\n
                        this.onBtnClick("next", event);\r\n
                    } else {\r\n
                        if (event.data == "replace" && this.mode == "replace") {\r\n
                            this.onBtnClick("replace", event);\r\n
                        }\r\n
                    }\r\n
                    event.preventDefault();\r\n
                    event.stopPropagation();\r\n
                } else {\r\n
                    if (event.keyCode == Common.UI.Keys.ESC) {\r\n
                        this.hide();\r\n
                        event.preventDefault();\r\n
                        event.stopPropagation();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onBtnClick: function (action, event) {\r\n
            var opts = {\r\n
                textsearch: this.txtSearch.val(),\r\n
                textreplace: this.txtReplace.val(),\r\n
                matchcase: this.miMatchCase.checked,\r\n
                matchword: this.miMatchWord.checked,\r\n
                highlight: this.miHighlight.checked\r\n
            };\r\n
            this.fireEvent("search:" + action, [this, opts]);\r\n
        },\r\n
        setMode: function (m) {\r\n
            this.mode = m;\r\n
            var $inputs = this.$window.find(".input-row");\r\n
            if (m === "no-replace") {\r\n
                this.setTitle(this.textTitle2);\r\n
                $inputs.eq(1).hide();\r\n
                $inputs.eq(2).hide();\r\n
                this.$window.find(".btn[result=replace]").hide();\r\n
                this.$window.find(".btn[result=replaceall]").hide();\r\n
                if (this.options.matchcase || this.options.matchword || this.options.markresult) {} else {\r\n
                    this.txtSearch.addClass("clear");\r\n
                    this.btnOptions.hide();\r\n
                }\r\n
                this.setHeight(170);\r\n
            } else {\r\n
                this.txtSearch.removeClass("clear");\r\n
                this.setTitle(this.textTitle);\r\n
                if (m === "search") {\r\n
                    $inputs.eq(2).show();\r\n
                    $inputs.eq(1).hide();\r\n
                    this.$window.find(".btn[result=replace]").hide();\r\n
                    this.$window.find(".btn[result=replaceall]").hide();\r\n
                } else {\r\n
                    $inputs.eq(2).hide();\r\n
                    $inputs.eq(1).show();\r\n
                    this.$window.find(".btn[result=replace]").show();\r\n
                    this.$window.find(".btn[result=replaceall]").show();\r\n
                }\r\n
                this.setHeight(200);\r\n
            }\r\n
        },\r\n
        onShowReplace: function (e) {\r\n
            this.setMode("replace");\r\n
            var me = this;\r\n
            _.defer(function () {\r\n
                me.txtReplace.focus();\r\n
            },\r\n
            300);\r\n
        },\r\n
        onHighlight: function (o, value) {\r\n
            this.fireEvent("search:highlight", [this, value]);\r\n
        },\r\n
        getSettings: function () {\r\n
            return {\r\n
                textsearch: this.txtSearch.val(),\r\n
                casesensitive: this.miMatchCase.checked,\r\n
                wholewords: this.miMatchWord.checked\r\n
            };\r\n
        },\r\n
        textTitle: "Search & Replace",\r\n
        textTitle2: "Search",\r\n
        txtBtnReplace: "Replace",\r\n
        txtBtnReplaceAll: "Replace All",\r\n
        textMatchCase: "Case sensitive",\r\n
        textWholeWords: "Whole words only",\r\n
        textHighlight: "Highlight results",\r\n
        textReplaceDef: "Enter the replacement text",\r\n
        textSearchStart: "Enter text for search"\r\n
    },\r\n
    Common.UI.SearchDialog || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/FileMenu.template\',[],function () { return \'<div class="panel-menu">\\r\\n    <li class="fm-first-item"/>\\r\\n    <li id="fm-btn-return" class="fm-btn" />\\r\\n    <li class="devider" />\\r\\n    <li id="fm-btn-save" class="fm-btn" />\\r\\n    <li id="fm-btn-edit" class="fm-btn" />\\r\\n    <li id="fm-btn-download" class="fm-btn" />\\r\\n    <li id="fm-btn-print" class="fm-btn" />\\r\\n    <li class="devider" />\\r\\n    <li id="fm-btn-recent" class="fm-btn" />\\r\\n    <li id="fm-btn-create" class="fm-btn" />\\r\\n    <li class="devider" />\\r\\n    <li id="fm-btn-info" class="fm-btn" />\\r\\n    <li id="fm-btn-rights" class="fm-btn" />\\r\\n    <li class="devider" class="fm-btn" />\\r\\n    <li id="fm-btn-settings" class="fm-btn" />\\r\\n    <li class="devider" />\\r\\n    <li id="fm-btn-help" class="fm-btn" />\\r\\n    <li class="devider" />\\r\\n    <li id="fm-btn-back" class="fm-btn" />\\r\\n</div>\\r\\n<div class="panel-context">\\r\\n    <div id="panel-saveas" class="content-box" />\\r\\n    <div id="panel-recentfiles" class="content-box" />\\r\\n    <div id="panel-createnew" class="content-box" />\\r\\n    <div id="panel-info" class="content-box" />\\r\\n    <div id="panel-rights" class="content-box" />\\r\\n    <div id="panel-settings" class="content-box" />\\r\\n    <div id="panel-help" class="content-box" />\\r\\n</div>\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
define(\'common/main/lib/component/LoadMask\',["common/main/lib/component/BaseView"], function () {\r\n
    Common.UI.LoadMask = Common.UI.BaseView.extend((function () {\r\n
        var ownerEl, maskeEl, loaderEl;\r\n
        return {\r\n
            options: {\r\n
                cls: "",\r\n
                style: "",\r\n
                title: "Loading...",\r\n
                owner: document.body\r\n
            },\r\n
            template: _.template([\'<div id="<%= id %>" class="asc-loadmask-body <%= cls %>" role="presentation" tabindex="-1">\', \'<div class="asc-loadmask-image"></div>\', \'<div class="asc-loadmask-title"><%= title %></div>\', "</div>"].join("")),\r\n
            initialize: function (options) {\r\n
                Common.UI.BaseView.prototype.initialize.call(this, options);\r\n
                this.template = this.options.template || this.template;\r\n
                this.cls = this.options.cls;\r\n
                this.style = this.options.style;\r\n
                this.title = this.options.title;\r\n
                this.owner = this.options.owner;\r\n
            },\r\n
            render: function () {\r\n
                return this;\r\n
            },\r\n
            show: function () {\r\n
                if (maskeEl || loaderEl) {\r\n
                    return;\r\n
                }\r\n
                ownerEl = (this.owner instanceof Common.UI.BaseView) ? $(this.owner.el) : $(this.owner);\r\n
                if (ownerEl.hasClass("masked")) {\r\n
                    return this;\r\n
                }\r\n
                var me = this;\r\n
                maskeEl = $(\'<div class="asc-loadmask"></div>\');\r\n
                loaderEl = $(this.template({\r\n
                    id: me.id,\r\n
                    cls: me.cls,\r\n
                    style: me.style,\r\n
                    title: me.title\r\n
                }));\r\n
                ownerEl.addClass("masked");\r\n
                ownerEl.append(maskeEl);\r\n
                ownerEl.append(loaderEl);\r\n
                loaderEl.css({\r\n
                    top: Math.round(ownerEl.height() / 2 - (loaderEl.height() + parseInt(loaderEl.css("padding-top")) + parseInt(loaderEl.css("padding-bottom"))) / 2) + "px",\r\n
                    left: Math.round(ownerEl.width() / 2 - (loaderEl.width() + parseInt(loaderEl.css("padding-left")) + parseInt(loaderEl.css("padding-right"))) / 2) + "px"\r\n
                });\r\n
                Common.util.Shortcuts.suspendEvents();\r\n
                return this;\r\n
            },\r\n
            hide: function () {\r\n
                ownerEl && ownerEl.removeClass("masked");\r\n
                maskeEl && maskeEl.remove();\r\n
                loaderEl && loaderEl.remove();\r\n
                maskeEl = null;\r\n
                loaderEl = null;\r\n
                Common.util.Shortcuts.resumeEvents();\r\n
            },\r\n
            setTitle: function (title) {\r\n
                this.title = title;\r\n
                if (ownerEl && ownerEl.hasClass("masked") && loaderEl) {\r\n
                    $(".asc-loadmask-title", loaderEl).html(title);\r\n
                }\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. I

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAB0=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="29" aka="AAAAAAAAAB0=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

n accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/view/DocumentAccessDialog\',["common/main/lib/component/Window", "common/main/lib/component/LoadMask"], function () {\r\n
    Common.Views.DocumentAccessDialog = Common.UI.Window.extend(_.extend({\r\n
        initialize: function (options) {\r\n
            var _options = {};\r\n
            _.extend(_options, {\r\n
                title: this.textTitle,\r\n
                width: 850,\r\n
                height: 534,\r\n
                header: true\r\n
            },\r\n
            options);\r\n
            this.template = [\'<div id="id-sharing-placeholder"></div>\'].join("");\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            this.settingsurl = options.settingsurl || "";\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.$window.find("> .body").css({\r\n
                height: "auto",\r\n
                overflow: "hidden"\r\n
            });\r\n
            var iframe = document.createElement("iframe");\r\n
            iframe.width = "100%";\r\n
            iframe.height = 500;\r\n
            iframe.align = "top";\r\n
            iframe.frameBorder = 0;\r\n
            iframe.scrolling = "no";\r\n
            iframe.onload = _.bind(this._onLoad, this);\r\n
            $("#id-sharing-placeholder").append(iframe);\r\n
            this.loadMask = new Common.UI.LoadMask({\r\n
                owner: $("#id-sharing-placeholder")\r\n
            });\r\n
            this.loadMask.setTitle(this.textLoading);\r\n
            this.loadMask.show();\r\n
            iframe.src = this.settingsurl;\r\n
            this._bindWindowEvents.call(this);\r\n
        },\r\n
        _bindWindowEvents: function () {\r\n
            var me = this;\r\n
            if (window.addEventListener) {\r\n
                window.addEventListener("message", function (msg) {\r\n
                    me._onWindowMessage(msg);\r\n
                },\r\n
                false);\r\n
            } else {\r\n
                if (window.attachEvent) {\r\n
                    window.attachEvent("onmessage", function (msg) {\r\n
                        me._onWindowMessage(msg);\r\n
                    });\r\n
                }\r\n
            }\r\n
        },\r\n
        _onWindowMessage: function (msg) {\r\n
            if (msg && window.JSON) {\r\n
                try {\r\n
                    this._onMessage.call(this, window.JSON.parse(msg.data));\r\n
                } catch(e) {}\r\n
            }\r\n
        },\r\n
        _onMessage: function (msg) {\r\n
            if (msg && msg.needUpdate) {\r\n
                this.trigger("accessrights", this, msg.sharingSettings);\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        _onLoad: function () {\r\n
            if (this.loadMask) {\r\n
                this.loadMask.hide();\r\n
            }\r\n
        },\r\n
        textTitle: "Sharing Settings",\r\n
        textLoading: "Loading"\r\n
    },\r\n
    Common.Views.DocumentAccessDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/FileMenuPanels\',["common/main/lib/view/DocumentAccessDialog"], function () { ! SSE.Views.FileMenuPanels && (SSE.Views.FileMenuPanels = {});\r\n
    SSE.Views.FileMenuPanels.ViewSaveAs = Common.UI.BaseView.extend({\r\n
        el: "#panel-saveas",\r\n
        menu: undefined,\r\n
        formats: [[{\r\n
            name: "XLSX",\r\n
            imgCls: "xlsx",\r\n
            type: c_oAscFileType.XLSX\r\n
        },\r\n
        {\r\n
            name: "ODS",\r\n
            imgCls: "ods",\r\n
            type: c_oAscFileType.ODS\r\n
        }], [{\r\n
            name: "CSV",\r\n
            imgCls: "csv",\r\n
            type: c_oAscFileType.CSV\r\n
        },\r\n
        {\r\n
            name: "HTML",\r\n
            imgCls: "html",\r\n
            type: c_oAscFileType.HTML\r\n
        }]],\r\n
        template: _.template(["<table><tbody>", "<% _.each(rows, function(row) { %>", "<tr>", "<% _.each(row, function(item) { %>", \'<td><span class="btn-doc-format <%= item.imgCls %>" /></td>\', "<% }) %>", "</tr>", "<% }) %>", "</tbody></table>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template({\r\n
                rows: this.formats\r\n
            }));\r\n
            $(".btn-doc-format", this.el).on("click", _.bind(this.onFormatClick, this));\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            this.flatFormats = _.flatten(this.formats);\r\n
            return this;\r\n
        },\r\n
        onFormatClick: function (e) {\r\n
            var format = /\\s(\\w+)/.exec(e.currentTarget.className);\r\n
            if (format) {\r\n
                format = format[1];\r\n
                var item = _.findWhere(this.flatFormats, {\r\n
                    imgCls: format\r\n
                });\r\n
                if (item && this.menu) {\r\n
                    this.menu.fireEvent("saveas:format", [this.menu, item.type]);\r\n
                }\r\n
            }\r\n
        }\r\n
    });\r\n
    SSE.Views.FileMenuPanels.Settings = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#panel-settings",\r\n
        menu: undefined,\r\n
        template: _.template([\'<div style="width:100%; height:100%; position: relative;">\', \'<div id="id-settings-menu" style="position: absolute; width:200px; top: 0; bottom: 0;" class="no-padding"></div>\', \'<div id="id-settings-content" style="position: absolute; left: 200px; top: 0; right: 0; bottom: 0;" class="no-padding">\', \'<div id="panel-settings-general" style="width:100%; height:100%;" class="no-padding main-settings-panel active"></div>\', \'<div id="panel-settings-print" style="width:100%; height:100%;" class="no-padding main-settings-panel"></div>\', "</div>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.generalSettings = new SSE.Views.FileMenuPanels.MainSettingsGeneral({\r\n
                menu: this.menu\r\n
            });\r\n
            this.generalSettings.options = {\r\n
                alias: "MainSettingsGeneral"\r\n
            };\r\n
            this.generalSettings.render();\r\n
            this.printSettings = SSE.getController("Print").getView("MainSettingsPrint");\r\n
            this.printSettings.menu = this.menu;\r\n
            this.printSettings.render($("#panel-settings-print"));\r\n
            this.viewSettingsPicker = new Common.UI.DataView({\r\n
                el: $("#id-settings-menu"),\r\n
                store: new Common.UI.DataViewStore([{\r\n
                    name: this.txtGeneral,\r\n
                    panel: this.generalSettings,\r\n
                    iconCls: "mnu-settings-general",\r\n
                    selected: true\r\n
                },\r\n
                {\r\n
                    name: this.txtPrint,\r\n
                    panel: this.printSettings,\r\n
                    iconCls: "mnu-print"\r\n
                }]),\r\n
                itemTemplate: _.template([\'<div id="<%= id %>" class="settings-item-wrap">\', \'<div class="settings-icon <%= iconCls %>" style="display: inline-block;" >\', "</div><%= name %>", "</div>"].join(""))\r\n
            });\r\n
            this.viewSettingsPicker.on("item:select", _.bind(function (dataview, itemview, record) {\r\n
                var panel = record.get("panel");\r\n
                $("#id-settings-content > div").removeClass("active");\r\n
                panel.$el.addClass("active");\r\n
                panel.show();\r\n
            },\r\n
            this));\r\n
            return this;\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this, arguments);\r\n
            var item = this.viewSettingsPicker.getSelectedRec();\r\n
            if (item[0]) {\r\n
                item[0].get("panel").show();\r\n
            }\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = mode;\r\n
            this.generalSettings && this.generalSettings.setMode(this.mode);\r\n
        },\r\n
        txtGeneral: "General",\r\n
        txtPrint: "Print"\r\n
    },\r\n
    SSE.Views.FileMenuPanels.Settings || {}));\r\n
    SSE.Views.MainSettingsPrint = Common.UI.BaseView.extend(_.extend({\r\n
        menu: undefined,\r\n
        template: _.template([\'<table class="main"><tbody>\', "<tr>", \'<td class="left"><label><%= scope.textSettings %></label></td>\', \'<td class="right"><div id="advsettings-print-combo-sheets" class="input-group-nr" /></td>\', "</tr>", \'<tr class="divider"></tr>\', \'<tr class="divider"></tr>\', "<tr>", \'<td class="left"><label><%= scope.textPageSize %></label></td>\', \'<td class="right"><div id="advsettings-print-combo-pages" class="input-group-nr" /></td>\', "</tr>", \'<tr class="divider"></tr>\', "<tr>", \'<td class="left"><label><%= scope.textPageOrientation %></label></td>\', \'<td class="right"><span id="advsettings-print-combo-orient" /></td>\', "</tr>", \'<tr class="divider"></tr>\', "<tr>", \'<td class="left" style="vertical-align: top;"><label><%= scope.strMargins %></label></td>\', \'<td class="right" style="vertical-align: top;"><div id="advsettings-margins">\', \'<table cols="2" class="no-padding">\', "<tr>", "<td><label><%= scope.strTop %></label></td>", "<td><label><%= scope.strBottom %></label></td>", "</tr>", "<tr>", \'<td><div id="advsettings-spin-margin-top"></div></td>\', \'<td><div id="advsettings-spin-margin-bottom"></div></td>\', "</tr>", "<tr>", "<td><label><%= scope.strLeft %></label></td>", "<td><label><%= scope.strRight %></label></td>", "</tr>", "<tr>", \'<td><div id="advsettings-spin-margin-left"></div></td>\', \'<td><div id="advsettings-spin-margin-right"></div></td>\', "</tr>", "</table>", "</div></td>", "</tr>", \'<tr class="divider"></tr>\', "<tr>", \'<td class="left" style="vertical-align: top;"><label><%= scope.strPrint %></label></td>\', \'<td class="right" style="vertical-align: top;"><div id="advsettings-print">\', \'<div id="advsettings-print-chb-grid" style="margin-bottom: 10px;"/>\', \'<div id="advsettings-print-chb-rows"/>\', "</div></td>", "</tr>", \'<tr class="divider"></tr>\', \'<tr class="divider"></tr>\', "<tr>", \'<td class="left"></td>\', \'<td class="right"><button id="advsettings-print-button-save" class="btn normal dlg-btn primary"><%= scope.okButtonText %></button></td>\', "</tr>", "</tbody></table>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
            this.spinners = [];\r\n
            this._initSettings = true;\r\n
        },\r\n
        render: function (parentEl) {\r\n
            if (parentEl) {\r\n
                this.setElement(parentEl, false);\r\n
            }\r\n
            $(this.el).html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            this.cmbSheet = new Common.UI.ComboBox({\r\n
                el: $("#advsettings-print-combo-sheets"),\r\n
                style: "width: 260px;",\r\n
                menuStyle: "min-width: 260px;max-height: 280px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: -255,\r\n
                    displayValue: this.strAllSheets\r\n
                }]\r\n
            });\r\n
            this.cmbPaperSize = new Common.UI.ComboBox({\r\n
                el: $("#advsettings-print-combo-pages"),\r\n
                style: "width: 260px;",\r\n
                menuStyle: "max-height: 280px; min-width: 260px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: "215.9|279.4",\r\n
                    displayValue: "US Letter (21,59cm x 27,94cm)"\r\n
                },\r\n
                {\r\n
                    value: "215.9|355.6",\r\n
                    displayValue: "US Legal (21,59cm x 35,56cm)"\r\n
                },\r\n
                {\r\n
                    value: "210|297",\r\n
                    displayValue: "A4 (21cm x 29,7cm)"\r\n
                },\r\n
                {\r\n
                    value: "148.1|209.9",\r\n
                    displayValue: "A5 (14,81cm x 20,99cm)"\r\n
                },\r\n
                {\r\n
                    value: "176|250.1",\r\n
                    displayValue: "B5 (17,6cm x 25,01cm)"\r\n
                },\r\n
                {\r\n
                    value: "104.8|241.3",\r\n
                    displayValue: "Envelope #10 (10,48cm x 24,13cm)"\r\n
                },\r\n
                {\r\n
                    value: "110.1|220.1",\r\n
                    displayValue: "Envelope DL (11,01cm x 22,01cm)"\r\n
                },\r\n
                {\r\n
                    value: "279.4|431.7",\r\n
                    displayValue: "Tabloid (27,94cm x 43,17cm)"\r\n
                },\r\n
                {\r\n
                    value: "297|420.1",\r\n
                    displayValue: "A3 (29,7cm x 42,01cm)"\r\n
                },\r\n
                {\r\n
                    value: "304.8|457.1",\r\n
                    displayValue: "Tabloid Oversize (30,48cm x 45,71cm)"\r\n
                },\r\n
                {\r\n
                    value: "196.8|273",\r\n
                    displayValue: "ROC 16K (19,68cm x 27,3cm)"\r\n
                },\r\n
                {\r\n
                    value: "119.9|234.9",\r\n
                    displayValue: "Envelope Choukei 3 (11,99cm x 23,49cm)"\r\n
                },\r\n
                {\r\n
                    value: "330.2|482.5",\r\n
                    displayValue: "Super B/A3 (33,02cm x 48,25cm)"\r\n
                }]\r\n
            });\r\n
            this.cmbPaperOrientation = new Common.UI.ComboBox({\r\n
                el: $("#advsettings-print-combo-orient"),\r\n
                style: "width: 200px;",\r\n
                menuStyle: "min-width: 200px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscPageOrientation.PagePortrait,\r\n
                    displayValue: this.strPortrait\r\n
                },\r\n
                {\r\n
                    value: c_oAscPageOrientation.PageLandscape,\r\n
                    displayValue: this.strLandscape\r\n
                }]\r\n
            });\r\n
            this.chPrintGrid = new Common.UI.CheckBox({\r\n
                el: $("#advsettings-print-chb-grid"),\r\n
                labelText: this.textPrintGrid\r\n
            });\r\n
            this.chPrintRows = new Common.UI.CheckBox({\r\n
                el: $("#advsettings-print-chb-rows"),\r\n
                labelText: this.textPrintHeadings\r\n
            });\r\n
            this.spnMarginTop = new Common.UI.MetricSpinner({\r\n
                el: $("#advsettings-spin-margin-top"),\r\n
                step: 0.1,\r\n
                width: 90,\r\n
                defaultUnit: "cm",\r\n
                value: "0 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginTop);\r\n
            this.spnMarginBottom = new Common.UI.MetricSpinner({\r\n
                el: $("#advsettings-spin-margin-bottom"),\r\n
                step: 0.1,\r\n
                width: 90,\r\n
                defaultUnit: "cm",\r\n
                value: "0 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginBottom);\r\n
            this.spnMarginLeft = new Common.UI.MetricSpinner({\r\n
                el: $("#advsettings-spin-margin-left"),\r\n
                step: 0.1,\r\n
                width: 90,\r\n
                defaultUnit: "cm",\r\n
                value: "0.19 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginLeft);\r\n
            this.spnMarginRight = new Common.UI.MetricSpinner({\r\n
                el: $("#advsettings-spin-margin-right"),\r\n
                step: 0.1,\r\n
                width: 90,\r\n
                defaultUnit: "cm",\r\n
                value: "0.19 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginRight);\r\n
            this.btnOk = new Common.UI.Button({\r\n
                el: "#advsettings-print-button-save"\r\n
            });\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            this.fireEvent("render:after", this);\r\n
            return this;\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.1 : 1);\r\n
                }\r\n
            }\r\n
        },\r\n
        applySettings: function () {\r\n
            if (this.menu) {\r\n
                this.menu.fireEvent("settings:apply", [this.menu]);\r\n
            }\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this, arguments);\r\n
            if (this._initSettings) {\r\n
                this.updateMetricUnit();\r\n
                this._initSettings = false;\r\n
            }\r\n
            this.fireEvent("show", this);\r\n
        },\r\n
        okButtonText: "Save",\r\n
        strPortrait: "Portrait",\r\n
        strLandscape: "Landscape",\r\n
        textPrintGrid: "Print Gridlines",\r\n
        textPrintHeadings: "Print Rows and Columns Headings",\r\n
        strLeft: "Left",\r\n
        strRight: "Right",\r\n
        strTop: "Top",\r\n
        strBottom: "Bottom",\r\n
        strMargins: "Margins",\r\n
        textPageSize: "Page Size",\r\n
        textPageOrientation: "Page Orientation",\r\n
        strPrint: "Print",\r\n
        textSettings: "Settings for"\r\n
    },\r\n
    SSE.Views.MainSettingsPrint || {}));\r\n
    SSE.Views.FileMenuPanels.MainSettingsGeneral = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#panel-settings-general",\r\n
        menu: undefined,\r\n
        template: _.template([\'<table class="main"><tbody>\', \'<tr class="coauth">\', \'<td class="left"><label><%= scope.txtLiveComment %></label></td>\', \'<td class="right"><div id="fms-chb-live-comment"/></td>\', "</tr>", \'<tr class="divider coauth"></tr>\', \'<tr class="autosave">\', \'<td class="left"><label><%= scope.textAutoSave %></label></td>\', \'<td class="right"><span id="fms-chb-autosave" /></td>\', "</tr>", \'<tr class="divider autosave"></tr>\', "<tr>", \'<td class="left"><label><%= scope.strZoom %></label></td>\', \'<td class="right"><div id="fms-cmb-zoom" class="input-group-nr" /></td>\', "</tr>", \'<tr class="divider"></tr>\', "<tr>", \'<td class="left"><label><%= scope.strFontRender %></label></td>\', \'<td class="right"><span id="fms-cmb-font-render" /></td>\', "</tr>", \'<tr class="divider"></tr>\', \'<tr class="edit">\', \'<td class="left"><label><%= scope.strUnit %></label></td>\', \'<td class="right"><span id="fms-cmb-unit" /></td>\', "</tr>", \'<tr class="divider edit"></tr>\', "<tr>", \'<td class="left"></td>\', \'<td class="right"><button id="fms-btn-apply" class="btn normal dlg-btn primary"><%= scope.okButtonText %></button></td>\', "</tr>", "</tbody></table>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template({\r\n
                scope: this\r\n
            }));\r\n
            this.chLiveComment = new Common.UI.CheckBox({\r\n
                el: $("#fms-chb-live-comment"),\r\n
                labelText: this.strLiveComment\r\n
            });\r\n
            this.cmbZoom = new Common.UI.ComboBox({\r\n
                el: $("#fms-cmb-zoom"),\r\n
                style: "width: 160px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: 50,\r\n
                    displayValue: "50%"\r\n
                },\r\n
                {\r\n
                    value: 60,\r\n
                    displayValue: "60%"\r\n
                },\r\n
                {\r\n
                    value: 70,\r\n
                    displayValue: "70%"\r\n
                },\r\n
                {\r\n
                    value: 80,\r\n
                    displayValue: "80%"\r\n
                },\r\n
                {\r\n
                    value: 90,\r\n
                    displayValue: "90%"\r\n
                },\r\n
                {\r\n
                    value: 100,\r\n
                    displayValue: "100%"\r\n
                },\r\n
                {\r\n
                    value: 110,\r\n
                    displayValue: "110%"\r\n
                },\r\n
                {\r\n
                    value: 120,\r\n
                    displayValue: "120%"\r\n
                },\r\n
                {\r\n
                    value: 150,\r\n
                    displayValue: "150%"\r\n
                },\r\n
                {\r\n
                    value: 175,\r\n
                    displayValue: "175%"\r\n
                },\r\n
                {\r\n
                    value: 200,\r\n
                    displayValue: "200%"\r\n
                }]\r\n
            });\r\n
            this.cmbFontRender = new Common.UI.ComboBox({\r\n
                el: $("#fms-cmb-font-render"),\r\n
                style: "width: 160px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscFontRenderingModeType.hintingAndSubpixeling,\r\n
                    displayValue: this.txtWin\r\n
                },\r\n
                {\r\n
                    value: c_oAscFontRenderingModeType.noHinting,\r\n
                    displayValue: this.txtMac\r\n
                },\r\n
                {\r\n
                    value: c_oAscFontRenderingModeType.hinting,\r\n
                    displayValue: this.txtNative\r\n
                }]\r\n
            });\r\n
            this.chAutosave = new Common.UI.CheckBox({\r\n
                el: $("#fms-chb-autosave"),\r\n
                labelText: this.strAutosave\r\n
            });\r\n
            this.cmbUnit = new Common.UI.ComboBox({\r\n
                el: $("#fms-cmb-unit"),\r\n
                style: "width: 160px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: Common.Utils.Metric.c_MetricUnits["cm"],\r\n
                    displayValue: this.txtCm\r\n
                },\r\n
                {\r\n
                    value: Common.Utils.Metric.c_MetricUnits["pt"],\r\n
                    displayValue: this.txtPt\r\n
                }]\r\n
            });\r\n
            this.btnApply = new Common.UI.Button({\r\n
                el: "#fms-btn-apply"\r\n
            });\r\n
            this.btnApply.on("click", _.bind(this.applySettings, this));\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this, arguments);\r\n
            this.updateSettings();\r\n
        },\r\n
        setMode: function (mode) {\r\n
            $("tr.autosave", this.el)[mode.isEdit && mode.canAutosave ? "show" : "hide"]();\r\n
            $("tr.coauth", this.el)[mode.canCoAuthoring && mode.isEdit ? "show" : "hide"]();\r\n
        },\r\n
        updateSettings: function () {\r\n
            var value = window.localStorage.getItem("sse-settings-zoom");\r\n
            var item = this.cmbZoom.store.findWhere({\r\n
                value: parseInt(value)\r\n
            });\r\n
            this.cmbZoom.setValue(item ? parseInt(item.get("value")) : 100);\r\n
            value = window.localStorage.getItem("sse-settings-livecomment");\r\n
            this.chLiveComment.setValue(!(value !== null && parseInt(value) == 0));\r\n
            value = window.localStorage.getItem("sse-settings-fontrender");\r\n
            item = this.cmbFontRender.store.findWhere({\r\n
                value: parseInt(value)\r\n
            });\r\n
            this.cmbFontRender.setValue(item ? item.get("value") : (window.devicePixelRatio > 1 ? c_oAscFontRenderingModeType.noHinting : c_oAscFontRenderingModeType.hintingAndSubpixeling));\r\n
            value = window.localStorage.getItem("sse-settings-unit");\r\n
            item = this.cmbUnit.store.findWhere({\r\n
                value: parseInt(value)\r\n
            });\r\n
            this.cmbUnit.setValue(item ? parseInt(item.get("value")) : 0);\r\n
            this._oldUnits = this.cmbUnit.getValue();\r\n
            value = window.localStorage.getItem("sse-settings-autosave");\r\n
            this.chAutosave.setValue(value === null || parseInt(value) == 1);\r\n
        },\r\n
        applySettings: function () {\r\n
            window.localStorage.setItem("sse-settings-zoom", this.cmbZoom.getValue());\r\n
            window.localStorage.setItem("sse-settings-livecomment", this.chLiveComment.isChecked() ? 1 : 0);\r\n
            window.localStorage.setItem("sse-settings-fontrender", this.cmbFontRender.getValue());\r\n
            window.localStorage.setItem("sse-settings-unit", this.cmbUnit.getValue());\r\n
            window.localStorage.setItem("sse-settings-autosave", this.chAutosave.isChecked() ? 1 : 0);\r\n
            if (this.menu) {\r\n
                this.menu.fireEvent("settings:apply", [this.menu]);\r\n
                if (this._oldUnits !== this.cmbUnit.getValue()) {\r\n
                    Common.NotificationCenter.trigger("settings:unitschanged", this);\r\n
                }\r\n
            }\r\n
        },\r\n
        strLiveComment: "Turn on option",\r\n
        strZoom: "Default Zoom Value",\r\n
        okButtonText: "Apply",\r\n
        txtLiveComment: "Live Commenting",\r\n
        txtWin: "as Windows",\r\n
        txtMac: "as OS X",\r\n
        txtNative: "Native",\r\n
        strFontRender: "Font Hinting",\r\n
        strUnit: "Unit of Measurement",\r\n
        txtCm: "Centimeter",\r\n
        txtPt: "Point",\r\n
        strAutosave: "Turn on autosave",\r\n
        textAutoSave: "Autosave"\r\n
    },\r\n
    SSE.Views.FileMenuPanels.MainSettingsGeneral || {}));\r\n
    SSE.Views.FileMenuPanels.RecentFiles = Common.UI.BaseView.extend({\r\n
        el: "#panel-recentfiles",\r\n
        menu: undefined,\r\n
        template: _.template([\'<div id="id-recent-view" style="margin: 20px 0;"></div>\'].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
            this.recent = options.recent;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.viewRecentPicker = new Common.UI.DataView({\r\n
                el: $("#id-recent-view"),\r\n
                store: new Common.UI.DataViewStore(this.recent),\r\n
                itemTemplate: _.template([\'<div class="recent-wrap">\', \'<div class="recent-icon"></div>\', \'<div class="file-name"><%= Common.Utils.String.htmlEncode(title) %></div>\', \'<div class="file-info"><%= Common.Utils.String.htmlEncode(folder) %></div>\', "</div>"].join(""))\r\n
            });\r\n
            this.viewRecentPicker.on("item:click", _.bind(this.onRecentFileClick, this));\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        onRecentFileClick: function (view, itemview, record) {\r\n
            if (this.menu) {\r\n
                this.menu.fireEvent("recent:open", [this.menu, record.get("url")]);\r\n
            }\r\n
        }\r\n
    });\r\n
    SSE.Views.FileMenuPanels.CreateNew = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#panel-createnew",\r\n
        menu: undefined,\r\n
        events: function () {\r\n
            return {\r\n
                "click .blank-document-btn": _.bind(this._onBlankDocument, this),\r\n
                "click .thumb-list .thumb-wrap": _.bind(this._onDocumentTemplate, this)\r\n
            };\r\n
        },\r\n
        template: _.template([\'<h3 style="margin-top: 20px;"><%= scope.fromBlankText %></h3><hr noshade />\', \'<div class="blank-document">\', \'<div class="blank-document-btn"></div>\', \'<div class="blank-document-info">\', "<h3><%= scope.newDocumentText %></h3>", "<%= scope.newDescriptionText %>", "</div>", "</div>", "<h3><%= scope.fromTemplateText %></h3><hr noshade />", \'<div class="thumb-list">\', "<% _.each(docs, function(item) { %>", \'<div class="thumb-wrap" template="<%= item.name %>">\', \'<div class="thumb"<% if (!_.isEmpty(item.icon)) { %> style="background-image: url(<%= item.icon %>);" <% } %> />\', \'<div class="title"><%= item.name %></div>\', "</div>", "<% }) %>", "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template({\r\n
                scope: this,\r\n
                docs: this.options[0].docs\r\n
            }));\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        _onBlankDocument: function () {\r\n
            if (this.menu) {\r\n
                this.menu.fireEvent("create:new", [this.menu, "blank"]);\r\n
            }\r\n
        },\r\n
        _onDocumentTemplate: function (e) {\r\n
            if (this.menu) {\r\n
                this.menu.fireEvent("create:new", [this.menu, e.currentTarget.attributes["template"].value]);\r\n
            }\r\n
        },\r\n
        fromBlankText: "From Blank",\r\n
        newDocumentText: "New Spreadsheet",\r\n
        newDescriptionText: "Create a new blank text document which you will be able to style and format after it is created during the editing. Or choose one of the templates to start a document of a certain type or purpose where some styles have already been pre-applied.",\r\n
        fromTemplateText: "From Template"\r\n
    },\r\n
    SSE.Views.FileMenuPanels.CreateNew || {}));\r\n
    SSE.Views.FileMenuPanels.DocumentInfo = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#panel-info",\r\n
        menu: undefined,\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.rendered = false;\r\n
            this.template = _.template([\'<table class="main">\', "<tr>", \'<td class="left"><label>\' + this.txtTitle + "</label></td>", \'<td class="right"><label id="id-info-title">-</label></td>\', "</tr>", \'<tr class="author">\', \'<td class="left"><label>\' + this.txtAuthor + "</label></td>", \'<td class="right"><span class="userLink" id="id-info-author">-</span></td>\', "</tr>", \'<tr class="placement">\', \'<td class="left"><label>\' + this.txtPlacement + "</label></td>", \'<td class="right"><label id="id-info-placement">-</label></td>\', "</tr>", \'<tr class="date">\', \'<td class="left"><label>\' + this.txtDate + "</label></td>", \'<td class="right"><label id="id-info-date">-</label></td>\', "</tr>", \'<tr class="divider date"></tr>\', "</table>"].join(""));\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.lblTitle = $("#id-info-title");\r\n
            this.lblPlacement = $("#id-info-placement");\r\n
            this.lblDate = $("#id-info-date");\r\n
            this.lblAuthor = $("#id-info-author");\r\n
            this.rendered = true;\r\n
            this.updateInfo(this.doc);\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this, arguments);\r\n
        },\r\n
        hide: function () {\r\n
            Common.UI.BaseView.prototype.hide.call(this, arguments);\r\n
        },\r\n
        updateInfo: function (doc) {\r\n
            this.doc = doc;\r\n
            if (!this.rendered) {\r\n
                return;\r\n
            }\r\n
            doc = doc || {};\r\n
            this.lblTitle.text((doc.title) ? doc.title : "-");\r\n
            if (doc.info) {\r\n
                if (doc.info.author) {\r\n
                    this.lblAuthor.text(doc.info.author);\r\n
                }\r\n
                this._ShowHideInfoItem("author", doc.info.author !== undefined && doc.info.author !== null);\r\n
                if (doc.info.created) {\r\n
                    this.lblDate.text(doc.info.created);\r\n
                }\r\n
                this._ShowHideInfoItem("date", doc.info.created !== undefined && doc.info.created !== null);\r\n
                if (doc.info.folder) {\r\n
                    this.lblPlacement.text(doc.info.folder);\r\n
                }\r\n
                this._ShowHideInfoItem("placement", doc.info.folder !== undefined && doc.info.folder !== null);\r\n
            } else {\r\n
                this._ShowHideDocInfo(false);\r\n
            }\r\n
        },\r\n
        _ShowHideInfoItem: function (cls, visible) {\r\n
            $("tr." + cls, this.el)[visible ? "show" : "hide"]();\r\n
        },\r\n
        _ShowHideDocInfo: function (visible) {\r\n
            this._ShowHideInfoItem("date", visible);\r\n
            this._ShowHideInfoItem("placement", visible);\r\n
            this._ShowHideInfoItem("author", visible);\r\n
        },\r\n
        setMode: function (mode) {\r\n
            return this;\r\n
        },\r\n
        txtTitle: "Document Title",\r\n
        txtAuthor: "Author",\r\n
        txtPlacement: "Placement",\r\n
        txtDate: "Creation Date"\r\n
    },\r\n
    SSE.Views.FileMenuPanels.DocumentInfo || {}));\r\n
    SSE.Views.FileMenuPanels.DocumentRights = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#panel-rights",\r\n
        menu: undefined,\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.rendered = false;\r\n
            this.template = _.template([\'<table class="main">\', \'<tr class="rights">\', \'<td class="left" style="vertical-align: top;"><label>\' + this.txtRights + "</label></td>", \'<td class="right"><div id="id-info-rights"></div></td>\', "</tr>", \'<tr class="edit-rights">\', \'<td class="left"></td><td class="right"><button id="id-info-btn-edit" class="btn normal dlg-btn primary" style="margin-right: 10px;width: auto;">\' + this.txtBtnAccessRights + "</button></td>", "</tr>", "</table>"].join(""));\r\n
            this.templateRights = _.template(["<table>", "<% _.each(users, function(item) { %>", "<tr>", \'<td><span class="userLink"><%= Common.Utils.String.htmlEncode(item.user) %></span></td>\', "<td><%= Common.Utils.String.htmlEncode(item.permissions) %></td>", "</tr>", "<% }); %>", "</table>"].join(""));\r\n
            this.menu = options.menu;\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.cntRights = $("#id-info-rights");\r\n
            this.btnEditRights = new Common.UI.Button({\r\n
                el: "#id-info-btn-edit"\r\n
            });\r\n
            this.btnEditRights.on("click", _.bind(this.changeAccessRights, this));\r\n
            this.rendered = true;\r\n
            this.updateInfo(this.doc);\r\n
            if (_.isUndefined(this.scroller)) {\r\n
                this.scroller = new Common.UI.Scroller({\r\n
                    el: $(this.el),\r\n
                    suppressScrollX: true\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this, arguments);\r\n
        },\r\n
        hide: function () {\r\n
            Common.UI.BaseView.prototype.hide.call(this, arguments);\r\n
        },\r\n
        updateInfo: function (doc) {\r\n
            this.doc = doc;\r\n
            if (!this.rendered) {\r\n
                return;\r\n
            }\r\n
            doc = doc || {};\r\n
            if (doc.info) {\r\n
                if (doc.info.sharingSettings) {\r\n
                    this.cntRights.html(this.templateRights({\r\n
                        users: doc.info.sharingSettings\r\n
                    }));\r\n
                }\r\n
                this._ShowHideInfoItem("rights", doc.info.sharingSettings !== undefined && doc.info.sharingSettings !== null && doc.info.sharingSettings.length > 0);\r\n
                this._ShowHideInfoItem("edit-rights", !!this.sharingSettingsUrl && this.sharingSettingsUrl.length && this._readonlyRights !== true);\r\n
            } else {\r\n
                this._ShowHideDocInfo(false);\r\n
            }\r\n
        },\r\n
        _ShowHideInfoItem: function (cls, visible) {\r\n
            $("tr." + cls, this.el)[visible ? "show" : "hide"]();\r\n
        },\r\n
        _ShowHideDocInfo: function (visible) {\r\n
            this._ShowHideInfoItem("rights", visible);\r\n
            this._ShowHideInfoItem("edit-rights", visible);\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.sharingSettingsUrl = mode.sharingSettingsUrl;\r\n
            return this;\r\n
        },\r\n
        changeAccessRights: function (btn, event, opts) {\r\n
            if (this._docAccessDlg) {\r\n
                return;\r\n
            }\r\n
            var me = this;\r\n
            me._docAccessDlg = new Common.Views.DocumentAccessDialog({\r\n
                settingsurl: this.sharingSettingsUrl\r\n
            });\r\n
            me._docAccessDlg.on("accessrights", function (obj, rights) {\r\n
                me.doc.info.sharingSettings = rights;\r\n
                me._ShowHideInfoItem("rights", me.doc.info.sharingSettings !== undefined && me.doc.info.sharingSettings !== null && me.doc.info.sharingSettings.length > 0);\r\n
                me.cntRights.html(me.templateRights({\r\n
                    users: me.doc.info.sharingSettings\r\n
                }));\r\n
            }).on("close", function (obj) {\r\n
                me._docAccessDlg = undefined;\r\n
            });\r\n
            me._docAccessDlg.show();\r\n
        },\r\n
        onLostEditRights: function () {\r\n
            this._readonlyRights = true;\r\n
            if (!this.rendered) {\r\n
                return;\r\n
            }\r\n
            this._ShowHideInfoItem("edit-rights", false);\r\n
        },\r\n
        txtRights: "Persons who have rights",\r\n
        txtBtnAccessRights: "Change access rights"\r\n
    },\r\n
    SSE.Views.FileMenuPanels.DocumentRights || {}));\r\n
    SSE.Views.FileMenuPanels.Help = Common.UI.BaseView.extend({\r\n
        el: "#panel-help",\r\n
        menu: undefined,\r\n
        template: _.template([\'<div style="width:100%; height:100%; position: relative;">\', \'<div id="id-help-contents" style="position: absolute; width:200px; top: 0; bottom: 0;" class="no-padding"></div>\', \'<div id="id-help-frame" style="position: absolute; left: 200px; top: 0; right: 0; bottom: 0;" class="no-padding"></div>\', "</div>"].join("")),\r\n
        initialize: function (options) {\r\n
            Common.UI.BaseView.prototype.initialize.call(this, arguments);\r\n
            this.menu = options.menu;\r\n
            this.urlPref = "resources/help/en/";\r\n
            this.itemclicked = false;\r\n
            this.en_data = [{\r\n
                src: "UsageInstructions/OpenCreateNew.htm",\r\n
                name: "Create a new spreadsheet or open an existing one",\r\n
                headername: "Usage Instructions",\r\n
                selected: true\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/ManageSheets.htm",\r\n
                name: "Manage sheets"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/InsertDeleteCells.htm",\r\n
                name: "Insert or delete cells, rows, and columns"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/CopyPasteData.htm",\r\n
                name: "Copy and paste data"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/FontTypeSizeStyle.htm",\r\n
                name: "Set font type, size, style, and colors"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/AlignText.htm",\r\n
                name: "Align data in cells"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/AddBorders.htm",\r\n
                name: "Add borders"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/MergeCells.htm",\r\n
                name: "Merge cells"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/ClearFormatting.htm",\r\n
                name: "Clear text, format in a cell"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/SortData.htm",\r\n
                name: "Sort data"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/InsertFunction.htm",\r\n
                name: "Insert function"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/ChangeNumberFormat.htm",\r\n
                name: "Change number format"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/UndoRedo.htm",\r\n
                name: "Undo/redo your actions"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/ViewDocInfo.htm",\r\n
                name: "View file information"\r\n
            },\r\n
            {\r\n
                src: "UsageInstructions/SavePrintDownload.htm",\r\n
                name: "Save/print/download your spreadsheet"\r\n
            },\r\n
            {\r\n
                src: "HelpfulHints/About.htm",\r\n
                name: "About ONLYOFFICE Spreadsheet Editor",\r\n
                headername: "Helpful Hints"\r\n
            },\r\n
            {\r\n
                src: "HelpfulHints/SupportedFormats.htm",\r\n
                name: "Supported Formats of Spreadsheets"\r\n
            },\r\n
            {\r\n
                src: "HelpfulHints/Navigation.htm",\r\n
                name: "Navigation through Your Spreadsheet"\r\n
            },\r\n
            {\r\n
                src: "HelpfulHints/Search.htm",\r\n
                name: "Search Function"\r\n
            },\r\n
            {\r\n
                src: "HelpfulHints/KeyboardShortcuts.htm",\r\n
                name: "Keyboard Shortcuts"\r\n
            }];\r\n
            if (Common.Utils.isIE) {\r\n
                window.onhelp = function () {\r\n
                    return false;\r\n
                };\r\n
            }\r\n
        },\r\n
        render: function () {\r\n
            $(this.el).html(this.template());\r\n
            this.viewHelpPicker = new Common.UI.DataView({\r\n
                el: $("#id-help-contents"),\r\n
                store: new Common.UI.DataViewStore([]),\r\n
                keyMoveDirection: "vertical",\r\n
                itemTemplate: _.template([\'<div id="<%= id %>" class="help-item-wrap">\', \'<div class="caption"><%= name %></div>\', "</div>"].join(""))\r\n
            });\r\n
            this.viewHelpPicker.on("item:add", _.bind(function (dataview, itemview, record) {\r\n
                if (record.has("headername")) {\r\n
                    $(itemview.el).before(\'<div class="header-name">\' + record.get("headername") + "</div>");\r\n
                }\r\n
            },\r\n
            this));\r\n
            this.viewHelpPicker.on("item:select", _.bind(function (dataview, itemview, record) {\r\n
                this.itemclicked = true;\r\n
                this.iFrame.src = this.urlPref + record.get("src");\r\n
            },\r\n
            this));\r\n
            this.iFrame = document.createElement("iframe");\r\n
            this.iFrame.src = "";\r\n
            this.iFrame.align = "top";\r\n
            this.iFrame.frameBorder = "0";\r\n
            this.iFrame.width = "100%";\r\n
            this.iFrame.height = "100%";\r\n
            this.iFrame.onload = _.bind(function () {\r\n
                if (!this.itemclicked) {\r\n
                    var src = arguments[0].currentTarget.contentDocument.URL;\r\n
                    var rec = this.viewHelpPicker.store.find(function (record) {\r\n
                        return (src.indexOf(record.get("src")) > 0);\r\n
                    });\r\n
                    if (rec) {\r\n
                        this.viewHelpPicker.selectRecord(rec, true);\r\n
                        this.viewHelpPicker.scrollToRecord(rec);\r\n
                    }\r\n
                }\r\n
                this.itemclicked = false;\r\n
            },\r\n
            this);\r\n
            $("#id-help-frame").append(this.iFrame);\r\n
            return this;\r\n
        },\r\n
        setLangConfig: function (lang) {\r\n
            var me = this;\r\n
            var store = this.viewHelpPicker.store;\r\n
            if (lang) {\r\n
                lang = lang.split("-")[0];\r\n
                var config = {\r\n
                    dataType: "json",\r\n
                    error: function () {\r\n
                        if (me.urlPref.indexOf("resources/help/en/") < 0) {\r\n
                            me.urlPref = "resources/help/en/";\r\n
                            store.url = "resources/help/en/Contents.json";\r\n
                            store.fetch(config);\r\n
                        } else {\r\n
                            me.urlPref = "resources/help/en/";\r\n
                            store.reset(me.en_data);\r\n
                        }\r\n
                    },\r\n
                    success: function () {\r\n
                        var rec = store.at(0);\r\n
                        me.viewHelpPicker.selectRecord(rec);\r\n
                        me.iFrame.src = me.urlPref + rec.get("src");\r\n
                    }\r\n
                };\r\n
                store.url = "resources/help/" + lang + "/Contents.json";\r\n
                store.fetch(config);\r\n
                this.urlPref = "resources/help/" + lang + "/";\r\n
            }\r\n
        },\r\n
        show: function () {\r\n
            Common.UI.BaseView.prototype.show.call(this);\r\n
            if (!this._scrollerInited) {\r\n
                this.viewHelpPicker.scroller.update();\r\n
                this._scrollerInited = true;\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/FileMenu\',["text!spreadsheeteditor/main/app/template/FileMenu.template", "underscore", "common/main/lib/component/BaseView"], function (tpl, _) {\r\n
    SSE.Views.FileMenu = Common.UI.BaseView.extend(_.extend({\r\n
        el: "#file-menu-panel",\r\n
        template: _.template(tpl),\r\n
        events: function () {\r\n
            return {\r\n
                "click .fm-btn": _.bind(function (event) {\r\n
                    var $item = $(event.currentTarget);\r\n
                    if (!$item.hasClass("active")) {\r\n
                        $(".fm-btn", this.el).removeClass("active");\r\n
                        $item.addClass("active");\r\n
                    }\r\n
                    var item = _.findWhere(this.items, {\r\n
                        el: event.currentTarget\r\n
                    });\r\n
                    if (item) {\r\n
                        var panel = this.panels[item.options.action];\r\n
                        this.fireEvent("item:click", [this, item.options.action, !!panel]);\r\n
                        if (panel) {\r\n
                            this.$el.find(".content-box:visible").hide();\r\n
                            this.active = item.options.action;\r\n
                            panel.show();\r\n
                        }\r\n
                    }\r\n
                },\r\n
                this)\r\n
            };\r\n
        },\r\n
        initialize: function () {},\r\n
        render: function () {\r\n
            this.$el = $(this.el);\r\n
            this.$el.html(this.template());\r\n
            this.items = [];\r\n
            this.items.push(new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-return", this.el),\r\n
                action: "back",\r\n
                caption: this.btnReturnCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-save", this.el),\r\n
                action: "save",\r\n
                caption: this.btnSaveCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-edit", this.el),\r\n
                action: "edit",\r\n
                caption: this.btnToEditCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-download", this.el),\r\n
                action: "saveas",\r\n
                caption: this.btnDownloadCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-print", this.el),\r\n
                action: "print",\r\n
                caption: this.btnPrintCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-recent", this.el),\r\n
                action: "recent",\r\n
                caption: this.btnRecentFilesCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-create", this.el),\r\n
                action: "new",\r\n
                caption: this.btnCreateNewCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-info", this.el),\r\n
                action: "info",\r\n
                caption: this.btnInfoCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-rights", this.el),\r\n
                action: "rights",\r\n
                caption: this.btnRightsCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-settings", this.el),\r\n
                action: "opts",\r\n
                caption: this.btnSettingsCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-help", this.el),\r\n
                action: "help",\r\n
                caption: this.btnHelpCaption,\r\n
                canFocused: false\r\n
            }), new Common.UI.MenuItem({\r\n
                el: $("#fm-btn-back", this.el),\r\n
                action: "exit",\r\n
                caption: this.btnBackCaption,\r\n
                canFocused: false\r\n
            }));\r\n
            var me = this;\r\n
            this.panels = {};\r\n
            require(["spreadsheeteditor/main/app/view/FileMenuPanels"], function () {\r\n
                me.panels = {\r\n
                    "saveas": (new SSE.Views.FileMenuPanels.ViewSaveAs({\r\n
                        menu: me\r\n
                    })).render(),\r\n
                    "opts": (new SSE.Views.FileMenuPanels.Settings({\r\n
                        menu: me\r\n
                    })).render(),\r\n
                    "info": (new SSE.Views.FileMenuPanels.DocumentInfo({\r\n
                        menu: me\r\n
                    })).render(),\r\n
                    "rights": (new SSE.Views.FileMenuPanels.DocumentRights({\r\n
                        menu: me\r\n
                    })).render(),\r\n
                    "help": (new SSE.Views.FileMenuPanels.Help({\r\n
                        menu: me\r\n
                    })).render()\r\n
                };\r\n
                me.$el.find(".content-box").hide();\r\n
            });\r\n
            return this;\r\n
        },\r\n
        show: function (panel) {\r\n
            if (this.isVisible() && panel === undefined) {\r\n
                return;\r\n
            }\r\n
            if (!panel) {\r\n
                panel = this.active || (this.mode.canDownload ? "saveas" : "info");\r\n
            }\r\n
            this.$el.show();\r\n
            this.selectMenu(panel);\r\n
            if (this.mode.isEdit) {\r\n
                SSE.getController("Toolbar").DisableToolbar(true);\r\n
            }\r\n
            this.api.asc_enableKeyEvents(false);\r\n
        },\r\n
        hide: function () {\r\n
            this.$el.hide();\r\n
            if (this.mode.isEdit) {\r\n
                SSE.getController("Toolbar").DisableToolbar(false);\r\n
            }\r\n
            this.api.asc_enableKeyEvents(true);\r\n
        },\r\n
        applyMode: function () {\r\n
            this.items[5][this.mode.canOpenRecent ? "show" : "hide"]();\r\n
            this.items[6][this.mode.canCreateNew ? "show" : "hide"]();\r\n
            this.items[6].$el.find("+.devider")[this.mode.canCreateNew ? "show" : "hide"]();\r\n
            this.items[3][this.mode.canDownload ? "show" : "hide"]();\r\n
            this.items[1][this.mode.isEdit ? "show" : "hide"]();\r\n
            this.items[2][!this.mode.isEdit && this.mode.canEdit ? "show" : "hide"]();\r\n
            this.items[8][(this.document && this.document.info && (this.document.info.sharingSettings && this.document.info.sharingSettings.length > 0 || this.mode.sharingSettingsUrl && this.mode.sharingSettingsUrl.length)) ? "show" : "hide"]();\r\n
            this.items[9][this.mode.isEdit ? "show" : "hide"]();\r\n
            this.items[9].$el.find("+.devider")[this.mode.isEdit ? "show" : "hide"]();\r\n
            this.panels["opts"].setMode(this.mode);\r\n
            this.panels["info"].setMode(this.mode).updateInfo(this.document);\r\n
            this.panels["rights"].setMode(this.mode).updateInfo(this.document);\r\n
            if (this.mode.canCreateNew) {\r\n
                if (this.mode.templates && this.mode.templates.length) {\r\n
                    $("a", this.items[6].$el).text(this.btnCreateNewCaption + "...");\r\n
                    this.panels["new"] = ((new SSE.Views.FileMenuPanels.CreateNew({\r\n
                        menu: this,\r\n
                        docs: this.mode.templates\r\n
                    })).render());\r\n
                }\r\n
            }\r\n
            if (this.mode.canOpenRecent) {\r\n
                if (this.mode.recent) {\r\n
                    this.panels["recent"] = (new SSE.Views.FileMenuPanels.RecentFiles({\r\n
                        menu: this,\r\n
                        recent: this.mode.recent\r\n
                    })).render();\r\n
                }\r\n
            }\r\n
            this.panels["help"].setLangConfig(this.mode.lang);\r\n
        },\r\n
        setMode: function (mode, delay) {\r\n
            if (mode.isDisconnected) {\r\n
                this.mode.canEdit = this.mode.isEdit = false;\r\n
                this.mode.canOpenRecent = this.mode.canCreateNew = false;\r\n
            } else {\r\n
                this.mode = mode;\r\n
            }\r\n
            if (!delay) {\r\n
                this.applyMode();\r\n
            }\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
        },\r\n
        loadDocument: function (data) {\r\n
            this.document = data.doc;\r\n
        },\r\n
        selectMenu: function (menu) {\r\n
            if (menu) {\r\n
                var item = this._getMenuItem(menu),\r\n
                panel = this.panels[menu];\r\n
                if (item && panel) {\r\n
                    $(".fm-btn", this.el).removeClass("active");\r\n
                    item.$el.addClass("active");\r\n
                    this.$el.find(".content-box:visible").hide();\r\n
                    panel.show();\r\n
                    this.active = menu;\r\n
                }\r\n
            }\r\n
        },\r\n
        _getMenuItem: function (action) {\r\n
            return _.find(this.items, function (item) {\r\n
                return item.options.action == action;\r\n
            });\r\n
        },\r\n
        btnSaveCaption: "Save",\r\n
        btnDownloadCaption: "Download as...",\r\n
        btnInfoCaption: "Document Info...",\r\n
        btnRightsCaption: "Access Rights...",\r\n
        btnCreateNewCaption: "Create New",\r\n
        btnRecentFilesCaption: "Open Recent...",\r\n
        btnPrintCaption: "Print",\r\n
        btnHelpCaption: "Help...",\r\n
        btnReturnCaption: "Back to Document",\r\n
        btnToEditCaption: "Edit Document",\r\n
        btnBackCaption: "Maximize (Minimize)",\r\n
        btnSettingsCaption: "Advanced Settings..."\r\n
    },\r\n
    SSE.Views.FileMenu || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/LeftMenu\',["text!spreadsheeteditor/main/app/template/LeftMenu.template", "jquery", "underscore", "backbone", "common/main/lib/component/Button", "common/main/lib/view/About", "common/main/lib/view/Comments", "common/main/lib/view/Chat", "common/main/lib/view/SearchDialog", "spreadsheeteditor/main/app/view/FileMenu"], function (menuTemplate, $, _, Backbone) {\r\n
    var SCALE_MIN = 40;\r\n
    var MENU_SCALE_PART = 300;\r\n
    SSE.Views.LeftMenu = Backbone.View.extend(_.extend({\r\n
        el: "#left-menu",\r\n
        template: _.template(menuTemplate),\r\n
        events: function () {\r\n
            return {\r\n
                "click #left-btn-comments": _.bind(this.onCoauthOptions, this),\r\n
                "click #left-btn-chat": _.bind(this.onCoauthOptions, this),\r\n
                "click #left-btn-support": function () {\r\n
                    var config = this.mode.customization;\r\n
                    config && !!config.feedback && !!config.feedback.url ? window.open(config.feedback.url) : window.open("http://feedback.onlyoffice.com/");\r\n
                }\r\n
            };\r\n
        },\r\n
        initialize: function () {\r\n
            this.minimizedMode = true;\r\n
        },\r\n
        render: function () {\r\n
            var el = $(this.el);\r\n
            el.html(this.template({}));\r\n
            this.btnFile = new Common.UI.Button({\r\n
                action: "file",\r\n
                el: $("#left-btn-file", this.el),\r\n
                hint: this.tipFile + Common.Utils.String.platformKey("Alt+F"),\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "leftMenuGroup"\r\n
            });\r\n
            this.btnSearch = new Common.UI.Button({\r\n
                action: "search",\r\n
                el: $("#left-btn-search", this.el),\r\n
                hint: this.tipSearch + Common.Utils.String.platformKey("Ctrl+F"),\r\n
                disabled: true,\r\n
                enableToggle: true\r\n
            });\r\n
            this.btnAbout = new Common.UI.Button({\r\n
                action: "about",\r\n
                el: $("#left-btn-about", this.el),\r\n
                hint: this.tipAbout,\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "leftMenuGroup"\r\n
            });\r\n
            this.btnSupport = new Common.UI.Button({\r\n
                action: "support",\r\n
                el: $("#left-btn-support", this.el),\r\n
                hint: this.tipSupport,\r\n
                disabled: true\r\n
            });\r\n
            this.btnComments = new Common.UI.Button({\r\n
                el: $("#left-btn-comments", this.el),\r\n
                hint: this.tipComments + Common.Utils.String.platformKey("Ctrl+Shift+H"),\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "leftMenuGroup"\r\n
            });\r\n
            this.btnChat = new Common.UI.Button({\r\n
                el: $("#left-btn-chat", this.el),\r\n
                hint: this.tipChat + Common.Utils.String.platformKey("Ctrl+Alt+Q", null, function (string) {\r\n
                    return Common.Utils.isMac ? string.replace(/Ctrl|ctrl/g, "âŒƒ") : string;\r\n
                }),\r\n
                enableToggle: true,\r\n
                disabled: true,\r\n
                toggleGroup: "leftMenuGroup"\r\n
            });\r\n
            this.btnComments.hide();\r\n
            this.btnChat.hide();\r\n
            this.btnComments.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.btnChat.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.btnSearch.on("click", _.bind(this.onBtnMenuClick, this));\r\n
            this.btnAbout.on("toggle", _.bind(this.onBtnMenuToggle, this));\r\n
            this.btnFile.on("toggle", _.bind(this.onBtnMenuToggle, this));\r\n
            var menuFile = new SSE.Views.FileMenu({});\r\n
            menuFile.options = {\r\n
                alias: "FileMenu"\r\n
            };\r\n
            this.btnFile.panel = menuFile.render()

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAB4=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="30" aka="AAAAAAAAAB4=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

;\r\n
            this.btnAbout.panel = (new Common.Views.About({\r\n
                el: $("#about-menu-panel"),\r\n
                appName: "Spreadsheet Editor"\r\n
            })).render();\r\n
            return this;\r\n
        },\r\n
        onBtnMenuToggle: function (btn, state) {\r\n
            if (state) {\r\n
                this.btnFile.pressed && this.fireEvent("file:show", this);\r\n
                btn.panel["show"]();\r\n
                this.$el.width(SCALE_MIN);\r\n
                if (this.btnSearch.isActive()) {\r\n
                    this.btnSearch.toggle(false);\r\n
                }\r\n
            } else {\r\n
                (this.btnFile.id == btn.id) && this.fireEvent("file:hide", this);\r\n
                btn.panel["hide"]();\r\n
            }\r\n
            if (this.mode.isEdit) {\r\n
                SSE.getController("Toolbar").DisableToolbar(state == true);\r\n
            }\r\n
            Common.NotificationCenter.trigger("layout:changed", "leftmenu");\r\n
        },\r\n
        onBtnMenuClick: function (btn, e) {\r\n
            this.btnFile.toggle(false);\r\n
            this.btnAbout.toggle(false);\r\n
            if (btn.options.action == "search") {} else {\r\n
                if (btn.pressed) {\r\n
                    if (! (this.$el.width() > SCALE_MIN)) {\r\n
                        this.$el.width(localStorage.getItem("sse-mainmenu-width") || MENU_SCALE_PART);\r\n
                    }\r\n
                } else {\r\n
                    localStorage.setItem("sse-mainmenu-width", this.$el.width());\r\n
                    this.$el.width(SCALE_MIN);\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("layout:changed", "leftmenu");\r\n
        },\r\n
        onCoauthOptions: function (e) {\r\n
            if (this.mode.canCoAuthoring) {\r\n
                if (this.mode.canComments) {\r\n
                    this.panelComments[this.btnComments.pressed ? "show" : "hide"]();\r\n
                    this.fireEvent((this.btnComments.pressed) ? "comments:show": "comments:hide", this);\r\n
                }\r\n
                if (this.mode.canChat) {\r\n
                    if (this.btnChat.pressed) {\r\n
                        if (this.btnChat.$el.hasClass("notify")) {\r\n
                            this.btnChat.$el.removeClass("notify");\r\n
                        }\r\n
                        this.panelChat.show();\r\n
                        this.panelChat.focus();\r\n
                    } else {\r\n
                        this.panelChat["hide"]();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        setOptionsPanel: function (name, panel) {\r\n
            if (name == "chat") {\r\n
                this.panelChat = panel.render("#left-panel-chat");\r\n
            } else {\r\n
                if (name == "comment") {\r\n
                    this.panelComments = panel;\r\n
                }\r\n
            }\r\n
        },\r\n
        markCoauthOptions: function (opt) {\r\n
            if (this.btnChat.isVisible() && !this.btnChat.isDisabled() && !this.btnChat.pressed) {\r\n
                this.btnChat.$el.addClass("notify");\r\n
            }\r\n
        },\r\n
        close: function (menu) {\r\n
            this.btnFile.toggle(false);\r\n
            this.btnAbout.toggle(false);\r\n
            this.$el.width(SCALE_MIN);\r\n
            if (this.mode.canCoAuthoring) {\r\n
                if (this.mode.canComments) {\r\n
                    this.panelComments["hide"]();\r\n
                    if (this.btnComments.pressed) {\r\n
                        this.fireEvent("comments:hide", this);\r\n
                    }\r\n
                    this.btnComments.toggle(false, true);\r\n
                }\r\n
                if (this.mode.canChat) {\r\n
                    this.panelChat["hide"]();\r\n
                    this.btnChat.toggle(false, true);\r\n
                }\r\n
            }\r\n
        },\r\n
        isOpened: function () {\r\n
            var isopened = this.btnFile.pressed || this.btnSearch.pressed; ! isopened && (isopened = this.btnComments.pressed || this.btnChat.pressed);\r\n
            return isopened;\r\n
        },\r\n
        disableMenu: function (menu, disable) {\r\n
            this.btnFile.setDisabled(false);\r\n
            this.btnAbout.setDisabled(false);\r\n
            this.btnSupport.setDisabled(false);\r\n
            this.btnSearch.setDisabled(false);\r\n
            this.btnComments.setDisabled(false);\r\n
            this.btnChat.setDisabled(false);\r\n
        },\r\n
        showMenu: function (menu) {\r\n
            var re = /^(\\w+):?(\\w*)$/.exec(menu);\r\n
            if (re[1] == "file") {\r\n
                if (!this.btnFile.pressed) {\r\n
                    this.btnFile.toggle(true);\r\n
                    this.btnFile.$el.focus();\r\n
                }\r\n
                this.btnFile.panel.show(re[2].length ? re[2] : undefined);\r\n
            } else {\r\n
                if (menu == "chat") {\r\n
                    if (this.btnChat.isVisible() && !this.btnChat.isDisabled() && !this.btnChat.pressed) {\r\n
                        this.btnChat.toggle(true);\r\n
                        this.onBtnMenuClick(this.btnChat);\r\n
                        this.onCoauthOptions();\r\n
                        this.panelChat.focus();\r\n
                    }\r\n
                } else {\r\n
                    if (menu == "comments") {\r\n
                        if (this.btnComments.isVisible() && !this.btnComments.isDisabled() && !this.btnComments.pressed) {\r\n
                            this.btnComments.toggle(true);\r\n
                            this.onBtnMenuClick(this.btnComments);\r\n
                            this.onCoauthOptions();\r\n
                            this.btnComments.$el.focus();\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        getMenu: function (type) {\r\n
            switch (type) {\r\n
            case "file":\r\n
                return this.btnFile.panel;\r\n
            case "about":\r\n
                return this.btnAbout.panel;\r\n
            default:\r\n
                return null;\r\n
            }\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = mode;\r\n
            return this;\r\n
        },\r\n
        tipComments: "Comments",\r\n
        tipChat: "Chat",\r\n
        tipAbout: "About",\r\n
        tipSupport: "Feedback & Support",\r\n
        tipFile: "File",\r\n
        tipSearch: "Search"\r\n
    },\r\n
    SSE.Views.LeftMenu || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/LeftMenu\',["core", "common/main/lib/util/Shortcuts", "spreadsheeteditor/main/app/view/LeftMenu", "spreadsheeteditor/main/app/view/FileMenu"], function () {\r\n
    SSE.Controllers.LeftMenu = Backbone.Controller.extend(_.extend({\r\n
        views: ["LeftMenu", "FileMenu"],\r\n
        initialize: function () {\r\n
            this.addListeners({\r\n
                "Common.Views.Chat": {\r\n
                    "hide": _.bind(this.onHideChat, this)\r\n
                },\r\n
                "Statusbar": {\r\n
                    "click:users": _.bind(this.clickStatusbarUsers, this)\r\n
                },\r\n
                "LeftMenu": {\r\n
                    "file:show": _.bind(this.fileShowHide, this, true),\r\n
                    "file:hide": _.bind(this.fileShowHide, this, false),\r\n
                    "comments:show": _.bind(this.commentsShowHide, this, true),\r\n
                    "comments:hide": _.bind(this.commentsShowHide, this, false),\r\n
                },\r\n
                "Common.Views.About": {\r\n
                    "show": _.bind(this.aboutShowHide, this, true),\r\n
                    "hide": _.bind(this.aboutShowHide, this, false)\r\n
                },\r\n
                "FileMenu": {\r\n
                    "item:click": _.bind(this.clickMenuFileItem, this),\r\n
                    "saveas:format": _.bind(this.clickSaveAsFormat, this),\r\n
                    "settings:apply": _.bind(this.applySettings, this),\r\n
                    "create:new": _.bind(this.onCreateNew, this),\r\n
                    "recent:open": _.bind(this.onOpenRecent, this)\r\n
                },\r\n
                "Toolbar": {\r\n
                    "file:settings": _.bind(this.clickToolbarSettings, this)\r\n
                },\r\n
                "SearchDialog": {\r\n
                    "hide": _.bind(this.onSearchDlgHide, this),\r\n
                    "search:back": _.bind(this.onQuerySearch, this, "back"),\r\n
                    "search:next": _.bind(this.onQuerySearch, this, "next"),\r\n
                    "search:replace": _.bind(this.onQueryReplace, this),\r\n
                    "search:replaceall": _.bind(this.onQueryReplaceAll, this)\r\n
                }\r\n
            });\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.leftMenu = this.createView("LeftMenu").render();\r\n
            this.leftMenu.btnSearch.on("toggle", _.bind(this.onMenuSearch, this));\r\n
            Common.util.Shortcuts.delegateShortcuts({\r\n
                shortcuts: {\r\n
                    "command+shift+s,ctrl+shift+s": _.bind(this.onShortcut, this, "save"),\r\n
                    "command+f,ctrl+f": _.bind(this.onShortcut, this, "search"),\r\n
                    "command+h,ctrl+h": _.bind(this.onShortcut, this, "replace"),\r\n
                    "alt+f": _.bind(this.onShortcut, this, "file"),\r\n
                    "esc": _.bind(this.onShortcut, this, "escape"),\r\n
                    "ctrl+alt+q": _.bind(this.onShortcut, this, "chat"),\r\n
                    "command+shift+h,ctrl+shift+h": _.bind(this.onShortcut, this, "comments"),\r\n
                    "f1": _.bind(this.onShortcut, this, "help")\r\n
                }\r\n
            });\r\n
            Common.util.Shortcuts.suspendEvents();\r\n
            var me = this;\r\n
            this.leftMenu.$el.find("button").each(function () {\r\n
                $(this).on("keydown", function (e) {\r\n
                    if (Common.UI.Keys.RETURN === e.keyCode || Common.UI.Keys.SPACE === e.keyCode) {\r\n
                        me.leftMenu.btnFile.toggle(false);\r\n
                        me.leftMenu.btnAbout.toggle(false);\r\n
                        this.blur();\r\n
                        e.preventDefault();\r\n
                        me.api.asc_enableKeyEvents(true);\r\n
                    }\r\n
                });\r\n
            });\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            this.api.asc_registerCallback("asc_onRenameCellTextEnd", _.bind(this.onRenameText, this));\r\n
            this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onApiServerDisconnect, this));\r\n
            Common.NotificationCenter.on("api:disconnect", _.bind(this.onApiServerDisconnect, this));\r\n
            if (this.mode.canCoAuthoring && this.mode.canChat) {\r\n
                this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage", _.bind(this.onApiChatMessage, this));\r\n
            }\r\n
            if (!this.mode.isEditDiagram) {\r\n
                this.api.asc_registerCallback("asc_onEditCell", _.bind(this.onApiEditCell, this));\r\n
            }\r\n
            this.leftMenu.getMenu("file").setApi(api);\r\n
            return this;\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = mode;\r\n
            this.leftMenu.setMode(mode);\r\n
            this.leftMenu.getMenu("file").setMode(mode);\r\n
            return this;\r\n
        },\r\n
        createDelayedElements: function () {\r\n
            if (this.mode.canCoAuthoring) {\r\n
                this.leftMenu.btnComments[this.mode.isEdit && this.mode.canComments ? "show" : "hide"]();\r\n
                if (this.mode.canComments) {\r\n
                    this.leftMenu.setOptionsPanel("comment", this.getApplication().getController("Common.Controllers.Comments").getView("Common.Views.Comments"));\r\n
                }\r\n
                this.leftMenu.btnChat[this.mode.canChat ? "show" : "hide"]();\r\n
                if (this.mode.canChat) {\r\n
                    this.leftMenu.setOptionsPanel("chat", this.getApplication().getController("Common.Controllers.Chat").getView("Common.Views.Chat"));\r\n
                }\r\n
            } else {\r\n
                this.leftMenu.btnChat.hide();\r\n
                this.leftMenu.btnComments.hide();\r\n
            }\r\n
            Common.util.Shortcuts.resumeEvents();\r\n
            if (!this.mode.isEditDiagram) {\r\n
                Common.NotificationCenter.on("cells:range", _.bind(this.onCellsRange, this));\r\n
            }\r\n
            return this;\r\n
        },\r\n
        clickMenuFileItem: function (menu, action, isopts) {\r\n
            var close_menu = true;\r\n
            switch (action) {\r\n
            case "back":\r\n
                break;\r\n
            case "save":\r\n
                this.api.asc_Save();\r\n
                break;\r\n
            case "print":\r\n
                this.api.asc_Print();\r\n
                break;\r\n
            case "exit":\r\n
                Common.Gateway.goBack();\r\n
                break;\r\n
            case "edit":\r\n
                Common.Gateway.requestEditRights();\r\n
                break;\r\n
            case "new":\r\n
                if (isopts) {\r\n
                    close_menu = false;\r\n
                } else {\r\n
                    this.onCreateNew(undefined, "blank");\r\n
                }\r\n
                break;\r\n
            default:\r\n
                close_menu = false;\r\n
            }\r\n
            if (close_menu) {\r\n
                menu.hide();\r\n
                this.leftMenu.btnFile.toggle(false, true);\r\n
            }\r\n
        },\r\n
        clickSaveAsFormat: function (menu, format) {\r\n
            if (format == c_oAscFileType.CSV || format != c_oAscFileType.XLSX && this.api.asc_drawingObjectsExist()) {\r\n
                Common.UI.warning({\r\n
                    closable: false,\r\n
                    title: this.textWarning,\r\n
                    msg: this.warnDownloadAs,\r\n
                    buttons: ["ok", "cancel"],\r\n
                    callback: _.bind(function (btn) {\r\n
                        if (btn == "ok") {\r\n
                            this.api.asc_DownloadAs(format);\r\n
                            menu.hide();\r\n
                            this.leftMenu.btnFile.toggle(false, true);\r\n
                        }\r\n
                    },\r\n
                    this)\r\n
                });\r\n
            } else {\r\n
                this.api.asc_DownloadAs(format);\r\n
                menu.hide();\r\n
                this.leftMenu.btnFile.toggle(false, true);\r\n
            }\r\n
        },\r\n
        applySettings: function (menu) {\r\n
            this.api.asc_setFontRenderingMode(parseInt(window.localStorage.getItem("sse-settings-fontrender")));\r\n
            var value = window.localStorage.getItem("sse-settings-livecomment");\r\n
            (!(value !== null && parseInt(value) == 0)) ? this.api.asc_showComments() : this.api.asc_hideComments();\r\n
            if (this.mode.canAutosave) {\r\n
                value = window.localStorage.getItem("sse-settings-autosave");\r\n
                this.api.asc_setAutoSaveGap(parseInt(value));\r\n
            }\r\n
            menu.hide();\r\n
            this.leftMenu.btnFile.toggle(false, true);\r\n
        },\r\n
        onCreateNew: function (menu, type) {\r\n
            if (this.mode.nativeApp === true) {\r\n
                this.api.asc_openNewDocument(type == "blank" ? "" : type);\r\n
            } else {\r\n
                var newDocumentPage = window.open(_.template("<%= url %>?title=<%= title %>" + \'<% if (doctype != "blank") { %>&template=<%= doctype %><% } %>\' + "&action=create&doctype=spreadsheet", {\r\n
                    url: this.mode.createUrl,\r\n
                    title: this.newDocumentTitle,\r\n
                    doctype: type\r\n
                }));\r\n
                if (newDocumentPage) {\r\n
                    newDocumentPage.focus();\r\n
                }\r\n
            }\r\n
            if (menu) {\r\n
                menu.hide();\r\n
                this.leftMenu.btnFile.toggle(false, true);\r\n
            }\r\n
        },\r\n
        onOpenRecent: function (menu, url) {\r\n
            if (menu) {\r\n
                menu.hide();\r\n
                this.leftMenu.btnFile.toggle(false, true);\r\n
            }\r\n
            var recentDocPage = window.open(url);\r\n
            if (recentDocPage) {\r\n
                recentDocPage.focus();\r\n
            }\r\n
            Common.component.Analytics.trackEvent("Open Recent");\r\n
        },\r\n
        clickToolbarSettings: function (obj) {\r\n
            if (this.leftMenu.btnFile.pressed && this.leftMenu.btnFile.panel.active == "opts") {\r\n
                this.leftMenu.close();\r\n
            } else {\r\n
                this.leftMenu.showMenu("file:opts");\r\n
            }\r\n
        },\r\n
        clickStatusbarUsers: function () {\r\n
            if (this.mode.canCoAuthoring && this.mode.canChat) {\r\n
                if (this.leftMenu.btnChat.pressed) {\r\n
                    this.leftMenu.close();\r\n
                } else {\r\n
                    this.leftMenu.showMenu("chat");\r\n
                }\r\n
            }\r\n
        },\r\n
        onHideChat: function () {\r\n
            $(this.leftMenu.btnChat.el).blur();\r\n
            Common.NotificationCenter.trigger("layout:changed", "leftmenu");\r\n
        },\r\n
        onQuerySearch: function (d, w, opts) {\r\n
            if (opts.textsearch && opts.textsearch.length) {\r\n
                var options = this.dlgSearch.findOptions;\r\n
                options.asc_setFindWhat(opts.textsearch);\r\n
                options.asc_setScanForward(d != "back");\r\n
                options.asc_setIsMatchCase(opts.matchcase);\r\n
                options.asc_setIsWholeCell(opts.matchword);\r\n
                options.asc_setScanOnOnlySheet(this.dlgSearch.menuWithin.menu.items[0].checked);\r\n
                options.asc_setScanByRows(this.dlgSearch.menuSearch.menu.items[0].checked);\r\n
                options.asc_setLookIn(this.dlgSearch.menuLookin.menu.items[0].checked ? c_oAscFindLookIn.Formulas : c_oAscFindLookIn.Value);\r\n
                if (!this.api.asc_findText(options)) {\r\n
                    var me = this;\r\n
                    Common.UI.info({\r\n
                        msg: this.textNoTextFound,\r\n
                        callback: function () {\r\n
                            me.dlgSearch.focus();\r\n
                        }\r\n
                    });\r\n
                }\r\n
            }\r\n
        },\r\n
        onQueryReplace: function (w, opts) {\r\n
            if (!_.isEmpty(opts.textsearch) && !_.isEmpty(opts.textreplace)) {\r\n
                this.api.isReplaceAll = false;\r\n
                var options = this.dlgSearch.findOptions;\r\n
                options.asc_setFindWhat(opts.textsearch);\r\n
                options.asc_setReplaceWith(opts.textreplace);\r\n
                options.asc_setIsMatchCase(opts.matchcase);\r\n
                options.asc_setIsWholeCell(opts.matchword);\r\n
                options.asc_setScanOnOnlySheet(this.dlgSearch.menuWithin.menu.items[0].checked);\r\n
                options.asc_setScanByRows(this.dlgSearch.menuSearch.menu.items[0].checked);\r\n
                options.asc_setLookIn(this.dlgSearch.menuLookin.menu.items[0].checked ? c_oAscFindLookIn.Formulas : c_oAscFindLookIn.Value);\r\n
                options.asc_setIsReplaceAll(false);\r\n
                this.api.asc_replaceText(options);\r\n
            }\r\n
        },\r\n
        onQueryReplaceAll: function (w, opts) {\r\n
            if (!_.isEmpty(opts.textsearch) && !_.isEmpty(opts.textreplace)) {\r\n
                this.api.isReplaceAll = true;\r\n
                var options = this.dlgSearch.findOptions;\r\n
                options.asc_setFindWhat(opts.textsearch);\r\n
                options.asc_setReplaceWith(opts.textreplace);\r\n
                options.asc_setIsMatchCase(opts.matchcase);\r\n
                options.asc_setIsWholeCell(opts.matchword);\r\n
                options.asc_setScanOnOnlySheet(this.dlgSearch.menuWithin.menu.items[0].checked);\r\n
                options.asc_setScanByRows(this.dlgSearch.menuSearch.menu.items[0].checked);\r\n
                options.asc_setLookIn(this.dlgSearch.menuLookin.menu.items[0].checked ? c_oAscFindLookIn.Formulas : c_oAscFindLookIn.Value);\r\n
                options.asc_setIsReplaceAll(true);\r\n
                this.api.asc_replaceText(options);\r\n
            }\r\n
        },\r\n
        showSearchDlg: function (show, action) {\r\n
            if (!this.dlgSearch) {\r\n
                var menuWithin = new Common.UI.MenuItem({\r\n
                    caption: this.textWithin,\r\n
                    menu: new Common.UI.Menu({\r\n
                        menuAlign: "tl-tr",\r\n
                        items: [{\r\n
                            caption: this.textSheet,\r\n
                            toggleGroup: "searchWithih",\r\n
                            checkable: true,\r\n
                            checked: true\r\n
                        },\r\n
                        {\r\n
                            caption: this.textWorkbook,\r\n
                            toggleGroup: "searchWithih",\r\n
                            checkable: true,\r\n
                            checked: false\r\n
                        }]\r\n
                    })\r\n
                });\r\n
                var menuSearch = new Common.UI.MenuItem({\r\n
                    caption: this.textSearch,\r\n
                    menu: new Common.UI.Menu({\r\n
                        menuAlign: "tl-tr",\r\n
                        items: [{\r\n
                            caption: this.textByRows,\r\n
                            toggleGroup: "searchByrows",\r\n
                            checkable: true,\r\n
                            checked: true\r\n
                        },\r\n
                        {\r\n
                            caption: this.textByColumns,\r\n
                            toggleGroup: "searchByrows",\r\n
                            checkable: true,\r\n
                            checked: false\r\n
                        }]\r\n
                    })\r\n
                });\r\n
                var menuLookin = new Common.UI.MenuItem({\r\n
                    caption: this.textLookin,\r\n
                    menu: new Common.UI.Menu({\r\n
                        menuAlign: "tl-tr",\r\n
                        items: [{\r\n
                            caption: this.textFormulas,\r\n
                            toggleGroup: "searchLookin",\r\n
                            checkable: true,\r\n
                            checked: true\r\n
                        },\r\n
                        {\r\n
                            caption: this.textValues,\r\n
                            toggleGroup: "searchLookin",\r\n
                            checkable: true,\r\n
                            checked: false\r\n
                        }]\r\n
                    })\r\n
                });\r\n
                this.dlgSearch = (new Common.UI.SearchDialog({\r\n
                    matchcase: true,\r\n
                    matchword: true,\r\n
                    matchwordstr: this.textItemEntireCell,\r\n
                    markresult: false,\r\n
                    extraoptions: [menuWithin, menuSearch, menuLookin]\r\n
                }));\r\n
                this.dlgSearch.menuWithin = menuWithin;\r\n
                this.dlgSearch.menuSearch = menuSearch;\r\n
                this.dlgSearch.menuLookin = menuLookin;\r\n
                this.dlgSearch.findOptions = new Asc.asc_CFindOptions();\r\n
            }\r\n
            if (show) {\r\n
                var mode = this.mode.isEdit ? (action || undefined) : "no-replace";\r\n
                if (this.dlgSearch.isVisible()) {\r\n
                    this.dlgSearch.setMode(mode);\r\n
                    this.dlgSearch.focus();\r\n
                } else {\r\n
                    this.dlgSearch.show(mode);\r\n
                }\r\n
                this.api.asc_closeCellEditor();\r\n
            } else {\r\n
                this.dlgSearch["hide"]();\r\n
            }\r\n
        },\r\n
        onMenuSearch: function (obj, show) {\r\n
            this.showSearchDlg(show);\r\n
        },\r\n
        onSearchDlgHide: function () {\r\n
            this.leftMenu.btnSearch.toggle(false, true);\r\n
            $(this.leftMenu.btnSearch.el).blur();\r\n
            this.api.asc_enableKeyEvents(true);\r\n
        },\r\n
        onRenameText: function (found, replaced) {\r\n
            var me = this;\r\n
            if (this.api.isReplaceAll) {\r\n
                Common.UI.info({\r\n
                    msg: (found) ? ((!found - replaced) ? Common.Utils.String.format(this.textReplaceSuccess, replaced) : Common.Utils.String.format(this.textReplaceSkipped, found - replaced)) : this.textNoTextFound,\r\n
                    callback: function () {\r\n
                        me.dlgSearch.focus();\r\n
                    }\r\n
                });\r\n
            } else {\r\n
                var sett = this.dlgSearch.getSettings();\r\n
                var options = this.dlgSearch.findOptions;\r\n
                options.asc_setFindWhat(sett.textsearch);\r\n
                options.asc_setScanForward(true);\r\n
                options.asc_setIsMatchCase(sett.matchcase);\r\n
                options.asc_setIsWholeCell(sett.matchword);\r\n
                options.asc_setScanOnOnlySheet(this.dlgSearch.menuWithin.menu.items[0].checked);\r\n
                options.asc_setScanByRows(this.dlgSearch.menuSearch.menu.items[0].checked);\r\n
                options.asc_setLookIn(this.dlgSearch.menuLookin.menu.items[0].checked ? c_oAscFindLookIn.Formulas : c_oAscFindLookIn.Value);\r\n
                if (!me.api.asc_findText(options)) {\r\n
                    Common.UI.info({\r\n
                        msg: this.textNoTextFound,\r\n
                        callback: function () {\r\n
                            me.dlgSearch.focus();\r\n
                        }\r\n
                    });\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiServerDisconnect: function () {\r\n
            this.mode.isEdit = false;\r\n
            this.leftMenu.close();\r\n
            this.leftMenu.btnComments.setDisabled(true);\r\n
            this.leftMenu.btnChat.setDisabled(true);\r\n
            this.leftMenu.getMenu("file").setMode({\r\n
                isDisconnected: true\r\n
            });\r\n
            if (this.dlgSearch) {\r\n
                this.leftMenu.btnSearch.toggle(false, true);\r\n
                this.dlgSearch["hide"]();\r\n
            }\r\n
        },\r\n
        onApiChatMessage: function () {\r\n
            this.leftMenu.markCoauthOptions();\r\n
        },\r\n
        commentsShowHide: function (state) {\r\n
            if (this.api) {\r\n
                var value = window.localStorage.getItem("sse-settings-livecomment");\r\n
                if (value !== null && parseInt(value) == 0) {\r\n
                    (state) ? this.api.asc_showComments() : this.api.asc_hideComments();\r\n
                }\r\n
                if (state) {\r\n
                    this.getApplication().getController("Common.Controllers.Comments").focusOnInput();\r\n
                }\r\n
                this.api.asc_enableKeyEvents(!state);\r\n
                if (!state) {\r\n
                    $(this.leftMenu.btnComments.el).blur();\r\n
                }\r\n
            }\r\n
        },\r\n
        fileShowHide: function (state) {\r\n
            if (this.api) {\r\n
                this.api.asc_closeCellEditor();\r\n
                this.api.asc_enableKeyEvents(!state);\r\n
                if (!state) {\r\n
                    $(this.leftMenu.btnFile.el).blur();\r\n
                }\r\n
            }\r\n
        },\r\n
        aboutShowHide: function (state) {\r\n
            if (this.api) {\r\n
                this.api.asc_closeCellEditor();\r\n
                this.api.asc_enableKeyEvents(!state);\r\n
                if (!state) {\r\n
                    $(this.leftMenu.btnAbout.el).blur();\r\n
                }\r\n
            }\r\n
        },\r\n
        onShortcut: function (s, e) {\r\n
            if (this.mode.isEditDiagram && s != "escape") {\r\n
                return false;\r\n
            }\r\n
            switch (s) {\r\n
            case "replace":\r\n
                case "search":\r\n
                if (!this.leftMenu.btnSearch.isDisabled()) {\r\n
                    Common.UI.Menu.Manager.hideAll();\r\n
                    this.showSearchDlg(true, s);\r\n
                    this.leftMenu.btnSearch.toggle(true, true);\r\n
                    this.leftMenu.btnFile.toggle(false);\r\n
                    this.leftMenu.btnAbout.toggle(false);\r\n
                }\r\n
                return false;\r\n
            case "save":\r\n
                if (this.mode.canDownload && !this.leftMenu.btnFile.isDisabled()) {\r\n
                    Common.UI.Menu.Manager.hideAll();\r\n
                    this.leftMenu.showMenu("file:saveas");\r\n
                }\r\n
                return false;\r\n
            case "help":\r\n
                if (!this.leftMenu.btnFile.isDisabled()) {\r\n
                    Common.UI.Menu.Manager.hideAll();\r\n
                    this.api.asc_closeCellEditor();\r\n
                    this.leftMenu.showMenu("file:help");\r\n
                }\r\n
                return false;\r\n
            case "file":\r\n
                if (!this.leftMenu.btnFile.isDisabled()) {\r\n
                    Common.UI.Menu.Manager.hideAll();\r\n
                    this.leftMenu.showMenu("file");\r\n
                }\r\n
                return false;\r\n
            case "escape":\r\n
                var statusbar = SSE.getController("Statusbar");\r\n
                var menu_opened = statusbar.statusbar.$el.find(\'.open > [data-toggle="dropdown"]\');\r\n
                if (menu_opened.length) {\r\n
                    $.fn.dropdown.Constructor.prototype.keydown.call(menu_opened[0], e);\r\n
                    return false;\r\n
                }\r\n
                if (this.leftMenu.btnFile.pressed || this.leftMenu.btnAbout.pressed || $(e.target).parents("#left-menu").length && this.api.isCellEdited !== true) {\r\n
                    this.leftMenu.close();\r\n
                    Common.NotificationCenter.trigger("layout:changed", "leftmenu");\r\n
                    return false;\r\n
                }\r\n
                if (this.mode.isEditDiagram) {\r\n
                    menu_opened = $(document.body).find(".open > .dropdown-menu");\r\n
                    if (!this.api.isCellEdited && !menu_opened.length) {\r\n
                        Common.Gateway.internalMessage("shortcut", {\r\n
                            key: "escape"\r\n
                        });\r\n
                        return false;\r\n
                    }\r\n
                }\r\n
                break;\r\n
            case "chat":\r\n
                if (this.mode.canCoAuthoring && this.mode.canChat) {\r\n
                    Common.UI.Menu.Manager.hideAll();\r\n
                    this.leftMenu.showMenu("chat");\r\n
                }\r\n
                return false;\r\n
            case "comments":\r\n
                if (this.mode.canCoAuthoring && this.mode.isEdit && this.mode.canComments) {\r\n
                    Common.UI.Menu.Manager.hideAll();\r\n
                    this.leftMenu.showMenu("comments");\r\n
                    this.getApplication().getController("Common.Controllers.Comments").focusOnInput();\r\n
                }\r\n
                return false;\r\n
            }\r\n
        },\r\n
        onCellsRange: function (status) {\r\n
            var isRangeSelection = (status != c_oAscSelectionDialogType.None);\r\n
            this.leftMenu.btnFile.setDisabled(isRangeSelection);\r\n
            this.leftMenu.btnAbout.setDisabled(isRangeSelection);\r\n
            this.leftMenu.btnSearch.setDisabled(isRangeSelection);\r\n
        },\r\n
        onApiEditCell: function (state) {\r\n
            var isEditFormula = (state == c_oAscCellEditorState.editFormula);\r\n
            this.leftMenu.btnFile.setDisabled(isEditFormula);\r\n
            this.leftMenu.btnAbout.setDisabled(isEditFormula);\r\n
            this.leftMenu.btnSearch.setDisabled(isEditFormula);\r\n
        },\r\n
        textNoTextFound: "Text not found",\r\n
        newDocumentTitle: "Unnamed document",\r\n
        textItemEntireCell: "Entire cell contents",\r\n
        requestEditRightsText: "Requesting editing rights...",\r\n
        textReplaceSuccess: "Search has been done. {0} occurrences have been replaced",\r\n
        textReplaceSkipped: "The replacement has been made. {0} occurrences were skipped.",\r\n
        warnDownloadAs: "If you continue saving in this format all features except the text will be lost.<br>Are you sure you want to continue?",\r\n
        textWarning : "Warning",\r\n
        textSheet: "Sheet",\r\n
        textWorkbook: "Workbook",\r\n
        textByColumns: "By columns",\r\n
        textByRows: "By rows",\r\n
        textFormulas: "Formulas",\r\n
        textValues: "Values",\r\n
        textWithin: "Within",\r\n
        textSearch: "Search",\r\n
        textLookin: "Look in"\r\n
    },\r\n
    SSE.Controllers.LeftMenu || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.IrregularStack = function (config) {\r\n
    var _stack = [];\r\n
    var _compare = function (obj1, obj2) {\r\n
        if (typeof obj1 === "object" && typeof obj2 === "object" && window.JSON) {\r\n
            return window.JSON.stringify(obj1) === window.JSON.stringify(obj2);\r\n
        }\r\n
        return obj1 === obj2;\r\n
    };\r\n
    config = config || {};\r\n
    var _strongCompare = config.strongCompare || _compare;\r\n
    var _weakCompare = config.weakCompare || _compare;\r\n
    var _indexOf = function (obj, compare) {\r\n
        for (var i = _stack.length - 1; i >= 0; i--) {\r\n
            if (compare(_stack[i], obj)) {\r\n
                return i;\r\n
            }\r\n
        }\r\n
        return -1;\r\n
    };\r\n
    var _push = function (obj) {\r\n
        _stack.push(obj);\r\n
    };\r\n
    var _pop = function (obj) {\r\n
        var index = _indexOf(obj, _strongCompare);\r\n
        if (index != -1) {\r\n
            var removed = _stack.splice(index, 1);\r\n
            return removed[0];\r\n
        }\r\n
        return undefined;\r\n
    };\r\n
    var _get = function (obj) {\r\n
        var index = _indexOf(obj, _weakCompare);\r\n
        if (index != -1) {\r\n
            return _stack[index];\r\n
        }\r\n
        return undefined;\r\n
    };\r\n
    var _exist = function (obj) {\r\n
        return ! (_indexOf(obj, _strongCompare) < 0);\r\n
    };\r\n
    return {\r\n
        push: _push,\r\n
        pop: _pop,\r\n
        get: _get,\r\n
        exist: _exist\r\n
    };\r\n
};\n
define("irregularstack", function(){});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Controllers = Common.Controllers || {};\r\n
define(\'common/main/lib/controller/Fonts\',["core", "common/main/lib/collection/Fonts"], function () {\r\n
    Common.Controllers.Fonts = Backbone.Controller.extend((function () {\r\n
        var FONT_TYPE_USERUSED = 4;\r\n
        function isFontSaved(store, rec) {\r\n
            var out = rec.get("type") == FONT_TYPE_USERUSED,\r\n
            i = -1,\r\n
            c = store.length,\r\n
            su,\r\n
            n = rec.get("name");\r\n
            while (!out && ++i < c) {\r\n
                su = store.at(i);\r\n
                if (su.get("type") != FONT_TYPE_USERUSED) {\r\n
                    break;\r\n
                }\r\n
                out = su.get("name") == n;\r\n
            }\r\n
            return out;\r\n
        }\r\n
        function onSelectFont(combo, record) {\r\n
            if (combo.showlastused && !isFontSaved(combo.store, record)) {}\r\n
        }\r\n
        function onApiFontChange(fontobj) {\r\n
            Common.NotificationCenter.trigger("fonts:change", fontobj);\r\n
        }\r\n
        function onApiLoadFonts(fonts, select) {\r\n
            var fontsArray = [];\r\n
            _.each(fonts, function (font) {\r\n
                var fontId = font.asc_getFontId();\r\n
                fontsArray.push({\r\n
                    id: _.isEmpty(fontId) ? Common.UI.getId() : fontId,\r\n
                    name: font.asc_getFontName(),\r\n
                    imgidx: font.asc_getFontThumbnail(),\r\n
                    type: font.asc_getFontType()\r\n
                });\r\n
            });\r\n
            var store = this.getCollection("Common.Collections.Fonts");\r\n
            if (store) {\r\n
                store.add(fontsArray);\r\n
            }\r\n
            Common.NotificationCenter.trigger("fonts:load", store, select);\r\n
        }\r\n
        return {\r\n
            models: ["Common.Models.Fonts"],\r\n
            collections: ["Common.Collections.Fonts"],\r\n
            views: [],\r\n
            initialize: function () {\r\n
                Common.NotificationCenter.on("fonts:select", _.bind(onSelectFont, this));\r\n
            },\r\n
            onLaunch: function () {},\r\n
            setApi: function (api) {\r\n
                this.api = api;\r\n
                this.api.asc_registerCallback("asc_onInitEditorFonts", _.bind(onApiLoadFonts, this));\r\n
                this.api.asc_registerCallback("asc_onFontFamily", _.bind(onApiFontChange, this));\r\n
            },\r\n
            loadFonts: function (select) {\r\n
                if (this.api) {\r\n
                    var fonts = this.api.get_PropertyEditorFonts();\r\n
                    if (fonts) {\r\n
                        onApiLoadFonts.call(this, fonts, select);\r\n
                    }\r\n
                }\r\n
            }\r\n
        };\r\n
    })());\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/model/ShapeGroup\',["backbone"], function (Backbone) {\r\n
    SSE.Models = SSE.Models || {};\r\n
    SSE.Models.ShapeModel = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                imageUrl: null,\r\n
                data: null\r\n
            };\r\n
        }\r\n
    });\r\n
    SSE.Models.ShapeGroup = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                groupName: null,\r\n
                groupId: null,\r\n
                groupStore: null\r\n
            };\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/collection/ShapeGroups\',["backbone", "spreadsheeteditor/main/app/model/ShapeGroup"], function (Backbone) {\r\n
    if (Common === undefined) {\r\n
        var Common = {};\r\n
    }\r\n
    Common.Collections = Common.Collections || {};\r\n
    SSE.Collections.ShapeGroups = Backbone.Collection.extend({\r\n
        model: SSE.Models.ShapeGroup\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/model/Formula\',["backbone"], function (Backbone) {\r\n
    SSE.Models = SSE.Models || {};\r\n
    SSE.Models.FormulaModel = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                index: 0,\r\n
                group: null,\r\n
                name: null,\r\n
                args: null\r\n
            };\r\n
        }\r\n
    });\r\n
    SSE.Models.FormulaGroup = Backbone.Model.extend({\r\n
        defaults: function () {\r\n
            return {\r\n
                id: Common.UI.getId(),\r\n
                index: 0,\r\n
                name: null,\r\n
                store: null,\r\n
                functions: []\r\n
            };\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/collection/FormulaGroups\',["backbone", "spreadsheeteditor/main/app/model/Formula"], function (Backbone) {\r\n
    SSE.Collections = SSE.Collections || {};\r\n
    SSE.Collections.FormulaGroups = Backbone.Collection.extend({\r\n
        model: SSE.Models.FormulaGroup\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/FormulaDialog\',["common/main/lib/component/Window", "spreadsheeteditor/main/app/collection/FormulaGroups"], function () {\r\n
    SSE.Views = SSE.Views || {};\r\n
    SSE.Views.FormulaDialog = Common.UI.Window.extend(_.extend({\r\n
        applyFunction: undefined,\r\n
        initialize: function (options) {\r\n
            var t = this,\r\n
            _options = {};\r\n
            _.extend(_options, {\r\n
                width: 300,\r\n
                height: 490,\r\n
                contentWidth: 390,\r\n
                header: true,\r\n
                cls: "formula-dlg",\r\n
                contentTemplate: "",\r\n
                title: t.txtTitle,\r\n
                items: []\r\n
            },\r\n
            options);\r\n
            this.template = options.template || [\'<div class="box" style="height:\' + (_options.height - 85) + \'px;">\', \'<div class="content-panel" >\', \'<label class="header">\' + t.textGroupDescription + "</label>", \'<div id="formula-dlg-combo-group" class="input-group-nr" style="margin-top: 10px"/>\', \'<label class="header" style="margin-top:10px">\' + t.textListDescription + "</label>", \'<div id="formula-dlg-combo-functions" class="combo-functions"/>\', \'<label id="formula-dlg-args" style="margin-top: 10px">\' + "</label>", "</div>", "</div>", \'<div class="separator horizontal"/>\', \'<div class="footer center">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;">\' + t.okButtonText + "</button>", \'<button class="btn normal dlg-btn" result="cancel">\' + t.cancelButtonText + "</button>", "</div>"].join("");\r\n
            this.api = options.api;\r\n
            this.formulasGroups = options.formulasGroups;\r\n
            this.handler = options.handler;\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            this.$window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
            this.syntaxLabel = $("#formula-dlg-args");\r\n
            this.fillFormulasGroups();\r\n
            this.fillFunctions("All");\r\n
        },\r\n
        show: function () {\r\n
            if (this.$window) {\r\n
                var main_width, main_height, top, left, win_height = this.initConfig.height;\r\n
                if (window.innerHeight === undefined) {\r\n
                    main_width = document.documentElement.offsetWidth;\r\n
                    main_height = document.documentElement.offsetHeight;\r\n
                } else {\r\n
                    main_width = window.innerWidth;\r\n
                    main_height = window.innerHeight;\r\n
                }\r\n
                top = ((parseInt(main_height, 10) - parseInt(win_height, 10)) / 2) * 0.9;\r\n
                left = (parseInt(main_width, 10) - parseInt(this.initConfig.width, 10)) / 2;\r\n
                this.$window.css("left", Math.floor(left));\r\n
                this.$window.css("top", Math.floor(top));\r\n
            }\r\n
            Common.UI.Window.prototype.show.call(this);\r\n
            this.mask = $(".modals-mask");\r\n
            this.mask.on("mousedown", _.bind(this.onUpdateFocus, this));\r\n
            this.$window.on("mousedown", _.bind(this.onUpdateFocus, this));\r\n
            if (this.cmbListFunctions) {\r\n
                _.delay(function (me) {\r\n
                    me.cmbListFunctions.$el.find(".listview").focus();\r\n
                },\r\n
                100, this);\r\n
            }\r\n
        },\r\n
        hide: function () {\r\n
            this.mask.off("mousedown", _.bind(this.onUpdateFocus, this));\r\n
            this.$window.off("mousedown", _.bind(this.onUpdateFocus, this));\r\n
            Common.UI.Window.prototype.hide.call(this);\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            if ("ok" === event.currentTarget.attributes["result"].value) {\r\n
                if (this.handler) {\r\n
                    this.handler.call(this, this.applyFunction);\r\n
                }\r\n
            }\r\n
            this.hide();\r\n
        },\r\n
        onDblClickFunction: function () {\r\n
            if (this.handler) {\r\n
                this.handler.call(this, this.applyFunction);\r\n
            }\r\n
            this.hide();\r\n
        },\r\n
        onSelectGroup: function (combo, record) {\r\n
            if (!_.isUndefined(record) && !_.isUndefined(record.value)) {\r\n
                if (record.value < this.formulasGroups.length) {\r\n
                    this.fillFunctions(this.formulasGroups.at(record.value).get("name"));\r\n
                }\r\n
            }\r\n
            this.onUpdateFocus();\r\n
        },\r\n
        onSelectFunction: function (listView, itemView, record) {\r\n
            var funcId, functions, func;\r\n
            if (this.formulasGroups) {\r\n
                funcId = record.get("id");\r\n
                if (!_.isUndefined(funcId)) {\r\n
                    functions = this.formulasGroups.at(0).get("functions");\r\n
                    if (functions) {\r\n
                        func = _.find(functions, function (f) {\r\n
                            if (f.get("index") === funcId) {\r\n
                                return f;\r\n
                            }\r\n
                            return null;\r\n
                        });\r\n
                        if (func) {\r\n
                            this.applyFunction = func.get("name");\r\n
                            this.syntaxLabel.text(this.syntaxText + ": " + this.applyFunction + func.get("args"));\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onPrimary: function (list, record, event) {\r\n
            if (this.handler) {\r\n
                this.handler.call(this, this.applyFunction);\r\n
            }\r\n
            this.hide();\r\n
        },\r\n
        onUpdateFocus: function () {\r\n
            _.delay(function (me) {\r\n
                me.cmbListFunctions.$el.find(".listview").focus();\r\n
            },\r\n
            100, this);\r\n
        },\r\n
        fillFormulasGroups: function () {\r\n
            if (this.formulasGroups) {\r\n
                var descriptions = {\r\n
                    "All": this.sCategoryAll,\r\n
                    "Cube": this.sCategoryCube,\r\n
                    "Database": this.sCategoryDatabase,\r\n
                    "DateAndTime": this.sCategoryDateTime,\r\n
                    "Engineering": this.sCategoryEngineering,\r\n
                    "Financial": this.sCategoryFinancial,\r\n
                    "Information": this.sCategoryInformation,\r\n
                    "Logical": this.sCategoryLogical,\r\n
                    "LookupAndReference": this.sCategoryLookupAndReference,\r\n
                    "Mathematic": this.sCategoryMathematics,\r\n
                    "Statistical": this.sCategoryStatistical,\r\n
                    "TextAndData": this.sCategoryTextData\r\n
                };\r\n
                var i, groupsListItems = [],\r\n
                length = this.formulasGroups.length;\r\n
                for (i = 0; i < length; ++i) {\r\n
                    if (this.formulasGroups.at(i).get("functions").length) {\r\n
                        groupsListItems.push({\r\n
                            value: this.formulasGroups.at(i).get("index"),\r\n
                            displayValue: descriptions[this.formulasGroups.at(i).get("name")]\r\n
                        });\r\n
                    }\r\n
                }\r\n
                if (!this.cmbFuncGroup) {\r\n
                    this.cmbFuncGroup = new Common.UI.ComboBox({\r\n
                        el: $("#formula-dlg-combo-group"),\r\n
                        menuStyle: "min-width: 268px;",\r\n
                        cls: "input-group-nr",\r\n
                        data: groupsListItems,\r\n
                        editable: false\r\n
                    });\r\n
                    this.cmbFuncGroup.setValue(0);\r\n
                    this.cmbFuncGroup.on("selected", _.bind(this.onSelectGroup, this));\r\n
                } else {\r\n
                    this.cmbFuncGroup.setData(groupsListItems);\r\n
                }\r\n
            }\r\n
        },\r\n
        fillFunctions: function (name) {\r\n
            if (this.formulasGroups) {\r\n
                if (!this.cmbListFunctions && !this.functions) {\r\n
                    this.functions = new Common.UI.DataViewStore();\r\n
                    this.cmbListFunctions = new Common.UI.ListView({\r\n
                        el: $("#formula-dlg-combo-functions"),\r\n
                        store: this.functions,\r\n
                        itemTemplate: _.template(\'<div id="<%= id %>" class="list-item" style="pointer-events:none;"><%= value %></div>\')\r\n
                    });\r\n
                    this.cmbListFunctions.on("item:select", _.bind(this.onSelectFunction, this));\r\n
                    this.cmbListFunctions.on("item:dblclick", _.bind(this.onDblClickFunction, this));\r\n
                    this.cmbListFunctions.on("entervalue", _.bind(this.onPrimary, this));\r\n
                    this.cmbListFunctions.onKeyDown = _.bind(this.onKeyDown, this.cmbListFunctions);\r\n
                    this.cmbListFunctions.$el.find(".listview").focus();\r\n
                    this.cmbListFunctions.scrollToRecord = _.bind(this.onScrollToRecordCustom, this.cmbListFunctions);\r\n
                }\r\n
                if (this.functions) {\r\n
                    this.functions.reset();\r\n
                    var i = 0,\r\n
                    length = 0,\r\n
                    functions = null,\r\n
                    group = this.formulasGroups.findWhere({\r\n
                        name: name\r\n
                    });\r\n
                    if (group) {\r\n
                        functions = group.get("functions");\r\n
                        if (functions && functions.length) {\r\n
                            length = functions.length;\r\n
                            for (i = 0; i < length; ++i) {\r\n
                                this.functions.push(new Common.UI.DataViewModel({\r\n
                                    id: functions[i].get("index"),\r\n
                                    selected: i < 1,\r\n
                                    allowSelected: true,\r\n
                                    value: functions[i].get("name")\r\n
                                }));\r\n
                            }\r\n
                            this.applyFunction = functions[0].get("name");\r\n
                            this.syntaxLabel.text(this.syntaxText + ": " + this.applyFunction + functions[0].get("args"));\r\n
                            this.cmbListFunctions.scroller.update({\r\n
                                minScrollbarLength: 40,\r\n
                                alwaysVisibleY: true\r\n
                            });\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onKeyDown: function (e, event) {\r\n
            var i = 0,\r\n
            record = null,\r\n
            me = this,\r\n
            charVal = "",\r\n
            value = "",\r\n
            firstRecord = null,\r\n
            recSelect = false,\r\n
            innerEl = null,\r\n
            isEqualSelectRecord = false,\r\n
            selectRecord = null,\r\n
            needNextRecord = false;\r\n
            if (this.disabled) {\r\n
                return;\r\n
            }\r\n
            if (_.isUndefined(undefined)) {\r\n
                event = e;\r\n
            }\r\n
            function selectItem(item) {\r\n
                me.selectRecord(item);\r\n
                me.scrollToRecord(item);\r\n
                innerEl = $(me.el).find(".inner");\r\n
                me.scroller.scrollTop(innerEl.scrollTop(), 0);\r\n
                event.preventDefault();\r\n
                event.stopPropagation();\r\n
            }\r\n
            charVal = String.fromCharCode(e.keyCode);\r\n
            if (e.keyCode > 64 && e.keyCode < 91 && charVal && charVal.length) {\r\n
                selectRecord = this.store.findWhere({\r\n
                    selected: true\r\n
                });\r\n
                if (selectRecord) {\r\n
                    value = selectRecord.get("value");\r\n
                    isEqualSelectRecord = (value && value.length && value[0] === charVal);\r\n
                }\r\n
                for (i = 0; i < this.store.length; ++i) {\r\n
                    record = this.store.at(i);\r\n
                    value = record.get("value");\r\n
                    if (value[0] === charVal) {\r\n
                        if (null === firstRecord) {\r\n
                            firstRecord = record;\r\n
                        }\r\n
                        if (isEqualSelectRecord) {\r\n
                            if (selectRecord === record) {\r\n
                                isEqualSelectRecord = false;\r\n
                            }\r\n
                            continue;\r\n
                        }\r\n
                        if (record.get("selected")) {\r\n
                            continue;\r\n
                        }\r\n
                        selectItem(record);\r\n
                        return;\r\n
                    }\r\n
                }\r\n
                if (firstRecord) {\r\n
                    selectItem(firstRecord);\r\n
                    return;\r\n
                }\r\n
            }\r\n
            Common.UI.DataView.prototype.onKeyDown.call(this, e, event);\r\n
        },\r\n
        onScrollToRecordCustom: function (record) {\r\n
            var innerEl = $(this.el).find(".inner");\r\n
            var inner_top = innerEl.offset().top;\r\n
            var div = innerEl.find("#" + record.get("id")).parent();\r\n
            var div_top = div.offset().top;\r\n
            if (div_top < inner_top || div_top + div.height() > inner_top + innerEl.height()) {\r\n
                if (this.scroller) {\r\n
                    this.scroller.scrollTop(innerEl.scrollTop() + div_top - inner_top, 0);\r\n
                } else {\r\n
                    innerEl.scrollTop(innerEl.scrollTop() + div_top - inner_top);\r\n
                }\r\n
            }\r\n
        },\r\n
        cancelButtonText: "Cancel",\r\n
        okButtonText: "Ok",\r\n
        sCategoryAll: "All",\r\n
        sCategoryLogical: "Logical",\r\n
        sCategoryCube: "Cube",\r\n
        sCategoryDatabase: "Database",\r\n
        sCategoryDateTime: "Date and time",\r\n
        sCategoryEngineering: "Engineering",\r\n
        sCategoryFinancial: "Financial",\r\n
        sCategoryInformation: "Information",\r\n
        sCategoryLookupAndReference: "LookupAndReference",\r\n
        sCategoryMathematics: "Math and trigonometry",\r\n
        sCategoryStatistical: "Statistical",\r\n
        sCategoryTextData: "Text and data",\r\n
        textGroupDescription: "Select Function Group",\r\n
        textListDescription: "Select Function",\r\n
        sDescription: "Description",\r\n
        txtTitle: "Insert Function",\r\n
        syntaxText: "Syntax"\r\n
    },\r\n
    SSE.Views.FormulaDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public 

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAB8=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="31" aka="AAAAAAAAAB8=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/FormulaDialog\',["core", "spreadsheeteditor/main/app/collection/FormulaGroups", "spreadsheeteditor/main/app/view/FormulaDialog"], function () {\r\n
    SSE.Controllers = SSE.Controllers || {};\r\n
    SSE.Controllers.FormulaDialog = Backbone.Controller.extend({\r\n
        models: [],\r\n
        views: ["FormulaDialog"],\r\n
        collections: ["FormulaGroups"],\r\n
        initialize: function () {},\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            if (this.formulasGroups && this.api) {\r\n
                this.loadingFormulas();\r\n
                var me = this;\r\n
                this.formulas = new SSE.Views.FormulaDialog({\r\n
                    api: this.api,\r\n
                    toolclose: "hide",\r\n
                    formulasGroups: this.formulasGroups,\r\n
                    handler: function (func) {\r\n
                        if (func && me.api) {\r\n
                            me.api.asc_insertFormula(func);\r\n
                        }\r\n
                    }\r\n
                });\r\n
                this.formulas.on({\r\n
                    "hide": function () {\r\n
                        if (me.api) {\r\n
                            me.api.asc_enableKeyEvents(true);\r\n
                        }\r\n
                    }\r\n
                });\r\n
            }\r\n
            return this;\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.formulasGroups = this.getApplication().getCollection("FormulaGroups");\r\n
        },\r\n
        showDialog: function () {\r\n
            if (this.formulas) {\r\n
                this.formulas.show();\r\n
            }\r\n
        },\r\n
        hideDialog: function () {\r\n
            if (this.formulas && this.formulas.isVisible()) {\r\n
                this.formulas.hide();\r\n
            }\r\n
        },\r\n
        loadingFormulas: function () {\r\n
            var i = 0,\r\n
            j = 0,\r\n
            ascGroupName, ascFunctions, functions, store = this.formulasGroups,\r\n
            formulaGroup = null,\r\n
            index = 0,\r\n
            funcInd = 0,\r\n
            info = null,\r\n
            allFunctions = [],\r\n
            allFunctionsGroup = null;\r\n
            if (store) {\r\n
                allFunctionsGroup = new SSE.Models.FormulaGroup({\r\n
                    name: "All",\r\n
                    index: index,\r\n
                    store: store\r\n
                });\r\n
                if (allFunctionsGroup) {\r\n
                    index += 1;\r\n
                    store.push(allFunctionsGroup);\r\n
                    info = this.api.asc_getFormulasInfo();\r\n
                    for (i = 0; i < info.length; i += 1) {\r\n
                        ascGroupName = info[i].asc_getGroupName();\r\n
                        ascFunctions = info[i].asc_getFormulasArray();\r\n
                        formulaGroup = new SSE.Models.FormulaGroup({\r\n
                            name: ascGroupName,\r\n
                            index: index,\r\n
                            store: store\r\n
                        });\r\n
                        index += 1;\r\n
                        functions = [];\r\n
                        for (j = 0; j < ascFunctions.length; j += 1) {\r\n
                            var func = new SSE.Models.FormulaModel({\r\n
                                index: funcInd,\r\n
                                group: ascGroupName,\r\n
                                name: ascFunctions[j].asc_getName(),\r\n
                                args: ascFunctions[j].asc_getArguments()\r\n
                            });\r\n
                            funcInd += 1;\r\n
                            functions.push(func);\r\n
                            allFunctions.push(func);\r\n
                        }\r\n
                        formulaGroup.set("functions", functions);\r\n
                        store.push(formulaGroup);\r\n
                    }\r\n
                    allFunctionsGroup.set("functions", _.sortBy(allFunctions, function (model) {\r\n
                        return model.get("name");\r\n
                    }));\r\n
                }\r\n
            }\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/OpenDialog\',["common/main/lib/component/Window"], function () {\r\n
    SSE.Views = SSE.Views || {};\r\n
    SSE.Views.OpenDialog = Common.UI.Window.extend(_.extend({\r\n
        applyFunction: undefined,\r\n
        initialize: function (options) {\r\n
            var t = this,\r\n
            _options = {};\r\n
            _.extend(_options, {\r\n
                width: 250,\r\n
                height: 220,\r\n
                contentWidth: 390,\r\n
                header: true,\r\n
                cls: "open-dlg",\r\n
                contentTemplate: "",\r\n
                title: t.txtTitle\r\n
            },\r\n
            options);\r\n
            this.template = options.template || [\'<div class="box" style="height:\' + (_options.height - 85) + \'px;">\', \'<div class="content-panel" >\', \'<label class="header">\' + t.txtEncoding + "</label>", \'<div id="id-codepages-combo" class="input-group-nr" style="margin-top:10px;margin-bottom:10px;"></div>\', \'<label class="header">\' + t.txtDelimiter + "</label>", \'<div id="id-delimiters-combo" class="input-group-nr" style="margin-top:10px;max-width: 110px;"></div>\', "</div>", "</div>", \'<div class="separator horizontal"/>\', \'<div class="footer center">\', \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right:10px;">\' + t.okButtonText + "</button>", "</div>"].join("");\r\n
            this.handler = options.handler;\r\n
            this.codepages = options.codepages;\r\n
            this.settings = options.settings;\r\n
            _options.tpl = _.template(this.template, _options);\r\n
            Common.UI.Window.prototype.initialize.call(this, _options);\r\n
        },\r\n
        render: function () {\r\n
            Common.UI.Window.prototype.render.call(this);\r\n
            if (this.$window) {\r\n
                this.$window.find(".tool").hide();\r\n
                this.$window.find(".dlg-btn").on("click", _.bind(this.onBtnClick, this));\r\n
                this.initCodePages();\r\n
            }\r\n
        },\r\n
        onBtnClick: function (event) {\r\n
            if (this.handler && this.cmbEncoding && this.cmbDelimiter) {\r\n
                this.handler.call(this, this.cmbEncoding.getValue(), this.cmbDelimiter.getValue());\r\n
            }\r\n
            this.close();\r\n
        },\r\n
        initCodePages: function () {\r\n
            var i, c, codepage, encodedata = [],\r\n
            listItems = [],\r\n
            length = 0;\r\n
            if (this.codepages) {\r\n
                encodedata = [];\r\n
                for (i = 0; i < this.codepages.length; ++i) {\r\n
                    codepage = this.codepages[i];\r\n
                    c = [];\r\n
                    c[0] = codepage.asc_getCodePage();\r\n
                    c[1] = codepage.asc_getCodePageName();\r\n
                    encodedata.push(c);\r\n
                }\r\n
            } else {\r\n
                encodedata = [[37, "IBM EBCDIC (US-Canada)"], [437, "OEM United States"], [500, "IBM EBCDIC (International)"], [708, "Arabic (ASMO 708)"], [720, "Arabic (DOS)"], [737, "Greek (DOS)"], [775, "Baltic (DOS)"], [850, "Western European (DOS)"], [852, "Central European (DOS)"], [855, "OEM Cyrillic"], [857, "Turkish (DOS)"], [858, "OEM Multilingual Latin I"], [860, "Portuguese (DOS)"], [861, "Icelandic (DOS)"], [862, "Hebrew (DOS)"], [863, "French Canadian (DOS)"], [864, "Arabic (864) "], [865, "Nordic (DOS)"], [866, "Cyrillic (DOS)"], [869, "Greek, Modern (DOS)"], [870, "IBM EBCDIC (Multilingual Latin-2)"], [874, "Thai (Windows)"], [875, "IBM EBCDIC (Greek Modern)"], [932, "Japanese (Shift-JIS)"], [936, "Chinese Simplified (GB2312)"], [949, "Korean"], [950, "Chinese Traditional (Big5)"], [1026, "IBM EBCDIC (Turkish Latin-5)"], [1047, "IBM Latin-1"], [1140, "IBM EBCDIC (US-Canada-Euro)"], [1141, "IBM EBCDIC (Germany-Euro)"], [1142, "IBM EBCDIC (Denmark-Norway-Euro)"], [1143, "IBM EBCDIC (Finland-Sweden-Euro)"], [1144, "IBM EBCDIC (Italy-Euro)"], [1145, "IBM EBCDIC (Spain-Euro)"], [1146, "IBM EBCDIC (UK-Euro)"], [1147, "IBM EBCDIC (France-Euro)"], [1148, "IBM EBCDIC (International-Euro)"], [1149, "IBM EBCDIC (Icelandic-Euro)"], [1200, "Unicode"], [1201, "Unicode (Big-Endian)"], [1250, "Central European (Windows)"], [1251, "Cyrillic (Windows)"], [1252, "Western European (Windows)"], [1253, "Greek (Windows)"], [1254, "Turkish (Windows)"], [1255, "Hebrew (Windows) "], [1256, "Arabic (Windows) "], [1257, "Baltic (Windows)"], [1258, "Vietnamese (Windows)"], [1361, "Korean (Johab)"], [10000, "Western European (Mac)"], [10001, "Japanese (Mac)"], [10002, "Chinese Traditional (Mac)"], [10003, "Korean (Mac)"], [10004, "Arabic (Mac) "], [10005, "Hebrew (Mac)"], [10006, "Greek (Mac) "], [10007, "Cyrillic (Mac)"], [10008, "Chinese Simplified (Mac)"], [10010, "Romanian (Mac)"], [10017, "Ukrainian (Mac)"], [10021, "Thai (Mac)"], [10029, "Central European (Mac) "], [10079, "Icelandic (Mac)"], [10081, "Turkish (Mac)"], [10082, "Croatian (Mac)"], [12000, "Unicode (UTF-32)"], [12001, "Unicode (UTF-32 Big-Endian)"], [20000, "Chinese Traditional (CNS)"], [20001, "TCA Taiwan"], [20002, "Chinese Traditional (Eten)"], [20003, "IBM5550 Taiwan"], [20004, "TeleText Taiwan"], [20005, "Wang Taiwan"], [20105, "Western European (IA5)"], [20106, "German (IA5)"], [20107, "Swedish (IA5) "], [20108, "Norwegian (IA5) "], [20127, "US-ASCII"], [20261, "T.61 "], [20269, "ISO-6937"], [20273, "IBM EBCDIC (Germany)"], [20277, "IBM EBCDIC (Denmark-Norway) "], [20278, "IBM EBCDIC (Finland-Sweden)"], [20280, "IBM EBCDIC (Italy)"], [20284, "IBM EBCDIC (Spain)"], [20285, "IBM EBCDIC (UK)"], [20290, "IBM EBCDIC (Japanese katakana)"], [20297, "IBM EBCDIC (France)"], [20420, "IBM EBCDIC (Arabic)"], [20423, "IBM EBCDIC (Greek)"], [20424, "IBM EBCDIC (Hebrew)"], [20833, "IBM EBCDIC (Korean Extended)"], [20838, "IBM EBCDIC (Thai)"], [20866, "Cyrillic (KOI8-R)"], [20871, "IBM EBCDIC (Icelandic) "], [20880, "IBM EBCDIC (Cyrillic Russian)"], [20905, "IBM EBCDIC (Turkish)"], [20924, "IBM Latin-1 "], [20932, "Japanese (JIS 0208-1990 and 0212-1990)"], [20936, "Chinese Simplified (GB2312-80) "], [20949, "Korean Wansung "], [21025, "IBM EBCDIC (Cyrillic Serbian-Bulgarian)"], [21866, "Cyrillic (KOI8-U)"], [28591, "Western European (ISO) "], [28592, "Central European (ISO)"], [28593, "Latin 3 (ISO)"], [28594, "Baltic (ISO)"], [28595, "Cyrillic (ISO) "], [28596, "Arabic (ISO)"], [28597, "Greek (ISO) "], [28598, "Hebrew (ISO-Visual)"], [28599, "Turkish (ISO)"], [28603, "Estonian (ISO)"], [28605, "Latin 9 (ISO)"], [29001, "Europa"], [38598, "Hebrew (ISO-Logical)"], [50220, "Japanese (JIS)"], [50221, "Japanese (JIS-Allow 1 byte Kana) "], [50222, "Japanese (JIS-Allow 1 byte Kana - SO/SI)"], [50225, "Korean (ISO)"], [50227, "Chinese Simplified (ISO-2022)"], [51932, "Japanese (EUC)"], [51936, "Chinese Simplified (EUC) "], [51949, "Korean (EUC)"], [52936, "Chinese Simplified (HZ)"], [54936, "Chinese Simplified (GB18030)"], [57002, "ISCII Devanagari "], [57003, "ISCII Bengali "], [57004, "ISCII Tamil"], [57005, "ISCII Telugu "], [57006, "ISCII Assamese "], [57007, "ISCII Oriya"], [57008, "ISCII Kannada"], [57009, "ISCII Malayalam "], [57010, "ISCII Gujarati"], [57011, "ISCII Punjabi"], [65000, "Unicode (UTF-7)"], [65001, "Unicode (UTF-8)"]];\r\n
            }\r\n
            length = encodedata.length;\r\n
            if (length) {\r\n
                for (i = 0; i < length; ++i) {\r\n
                    listItems.push({\r\n
                        value: encodedata[i][0],\r\n
                        displayValue: encodedata[i][1]\r\n
                    });\r\n
                }\r\n
                this.cmbEncoding = new Common.UI.ComboBox({\r\n
                    el: $("#id-codepages-combo", this.$window),\r\n
                    menuStyle: "min-width: 220px;",\r\n
                    cls: "input-group-nr",\r\n
                    menuCls: "scrollable-menu",\r\n
                    data: listItems,\r\n
                    editable: false\r\n
                });\r\n
                this.cmbDelimiter = new Common.UI.ComboBox({\r\n
                    el: $("#id-delimiters-combo", this.$window),\r\n
                    menuStyle: "min-width: 110px;",\r\n
                    cls: "input-group-nr",\r\n
                    data: [{\r\n
                        value: 4,\r\n
                        displayValue: ","\r\n
                    },\r\n
                    {\r\n
                        value: 2,\r\n
                        displayValue: ";"\r\n
                    },\r\n
                    {\r\n
                        value: 3,\r\n
                        displayValue: ":"\r\n
                    },\r\n
                    {\r\n
                        value: 1,\r\n
                        displayValue: this.txtTab\r\n
                    },\r\n
                    {\r\n
                        value: 5,\r\n
                        displayValue: this.txtSpace\r\n
                    }],\r\n
                    editable: false\r\n
                });\r\n
                this.cmbDelimiter.setValue(4);\r\n
                if (encodedata.length) {\r\n
                    this.cmbEncoding.setValue(encodedata[0][0]);\r\n
                    if (this.settings && this.settings.asc_getCodePage()) {\r\n
                        this.cmbEncoding.setValue(this.settings.asc_getCodePage());\r\n
                    }\r\n
                    if (this.settings && this.settings.asc_getDelimiter()) {\r\n
                        this.cmbDelimiter.setValue(this.settings.asc_getDelimiter());\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        okButtonText: "OK",\r\n
        cancelButtonText: "Cancel",\r\n
        txtDelimiter: "Delimiter",\r\n
        txtEncoding: "Encoding ",\r\n
        txtSpace: "Space",\r\n
        txtTab: "Tab",\r\n
        txtTitle: "Choose CSV options"\r\n
    },\r\n
    SSE.Views.OpenDialog || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/Main\',["core", "irregularstack", "common/main/lib/component/Window", "common/main/lib/component/LoadMask", "common/main/lib/component/Tooltip", "common/main/lib/controller/Fonts", "spreadsheeteditor/main/app/collection/ShapeGroups", "spreadsheeteditor/main/app/collection/TableTemplates", "spreadsheeteditor/main/app/controller/FormulaDialog", "spreadsheeteditor/main/app/view/OpenDialog"], function () {\r\n
    SSE.Controllers.Main = Backbone.Controller.extend(_.extend((function () {\r\n
        var InitApplication = -254;\r\n
        var ApplyEditRights = -255;\r\n
        var LoadingDocument = -256;\r\n
        var mapCustomizationElements = {\r\n
            about: "button#left-btn-about",\r\n
            feedback: "button#left-btn-support",\r\n
            goback: "#fm-btn-back > a, #header-back > div"\r\n
        };\r\n
        return {\r\n
            models: [],\r\n
            collections: ["ShapeGroups", "TableTemplates"],\r\n
            views: [],\r\n
            initialize: function () {},\r\n
            onLaunch: function () {\r\n
                window.asc_CCommentData = window.Asc.asc_CCommentData || window.asc_CCommentData;\r\n
                window.storagename = "table";\r\n
                this._state = {};\r\n
                if (!Common.Utils.isBrowserSupported()) {\r\n
                    Common.Utils.showBrowserRestriction();\r\n
                    Common.Gateway.reportError(undefined, this.unsupportedBrowserErrorText);\r\n
                    return;\r\n
                } else {}\r\n
                var value = window.localStorage.getItem("sse-settings-fontrender");\r\n
                if (value === null) {\r\n
                    value = window.devicePixelRatio > 1 ? "1" : "3";\r\n
                }\r\n
                this.api = new Asc.spreadsheet_api("editor_sdk", "ce-cell-content");\r\n
                this.api.asc_setFontRenderingMode(parseInt(value));\r\n
                this.api.asc_Init("../../../sdk/Fonts/");\r\n
                this.api.asc_registerCallback("asc_onOpenDocumentProgress", _.bind(this.onOpenDocument, this));\r\n
                this.api.asc_registerCallback("asc_onEndAction", _.bind(this.onLongActionEnd, this));\r\n
                this.api.asc_registerCallback("asc_onError", _.bind(this.onError, this));\r\n
                this.api.asc_registerCallback("asc_onÐ¡oAuthoringDisconnect", _.bind(this.onCoAuthoringDisconnect, this));\r\n
                this.api.asc_registerCallback("asc_onAdvancedOptions", _.bind(this.onAdvancedOptions, this));\r\n
                this.api.asc_registerCallback("asc_onDocumentUpdateVersion", _.bind(this.onUpdateVersion, this));\r\n
                Common.NotificationCenter.on("api:disconnect", _.bind(this.onCoAuthoringDisconnect, this));\r\n
                this.stackLongActions = new Common.IrregularStack({\r\n
                    strongCompare: this._compareActionStrong,\r\n
                    weakCompare: this._compareActionWeak\r\n
                });\r\n
                this.stackLongActions.push({\r\n
                    id: InitApplication,\r\n
                    type: c_oAscAsyncActionType.BlockInteraction\r\n
                });\r\n
                this.isShowOpenDialog = false;\r\n
                this.editorConfig = {};\r\n
                Common.Gateway.on("init", _.bind(this.loadConfig, this));\r\n
                Common.Gateway.on("showmessage", _.bind(this.onExternalMessage, this));\r\n
                Common.Gateway.on("opendocument", _.bind(this.loadDocument, this));\r\n
                Common.Gateway.on("internalcommand", _.bind(this.onInternalCommand, this));\r\n
                Common.Gateway.ready();\r\n
                this.getApplication().getController("Viewport").setApi(this.api);\r\n
                var me = this;\r\n
                $(document.body).on("focus", "input, textarea:not(#ce-cell-content)", function (e) {\r\n
                    if (e && e.target && e.target.id && e.target.id === "clipboard-helper-text") {\r\n
                        me.api.asc_enableKeyEvents(true);\r\n
                        return;\r\n
                    }\r\n
                    if (this.isAppDisabled === true) {\r\n
                        return;\r\n
                    }\r\n
                    me.api.asc_enableKeyEvents(false);\r\n
                });\r\n
                $("#editor_sdk").focus(function (e) {\r\n
                    if (this.isAppDisabled === true) {\r\n
                        return;\r\n
                    }\r\n
                    if (!me.isModalShowed) {\r\n
                        me.api.asc_enableKeyEvents(true);\r\n
                    }\r\n
                });\r\n
                $(document.body).on("blur", "input, textarea", function (e) {\r\n
                    if (this.isAppDisabled === true) {\r\n
                        return;\r\n
                    }\r\n
                    if (!me.isModalShowed) {\r\n
                        me.api.asc_enableKeyEvents(true);\r\n
                    }\r\n
                });\r\n
                Common.NotificationCenter.on({\r\n
                    "modal:show": function (e) {\r\n
                        me.isModalShowed = true;\r\n
                        me.api.asc_enableKeyEvents(false);\r\n
                    },\r\n
                    "modal:close": function (dlg) {\r\n
                        if (dlg && dlg.$lastmodal && dlg.$lastmodal.size() < 1) {\r\n
                            me.isModalShowed = false;\r\n
                            me.api.asc_enableKeyEvents(true);\r\n
                        }\r\n
                    },\r\n
                    "modal:hide": function (dlg) {\r\n
                        if (dlg && dlg.$lastmodal && dlg.$lastmodal.size() < 1) {\r\n
                            me.isModalShowed = false;\r\n
                            me.api.asc_enableKeyEvents(true);\r\n
                        }\r\n
                    },\r\n
                    "edit:complete": _.bind(this.onEditComplete, this),\r\n
                    "settings:unitschanged": _.bind(this.unitsChanged, this)\r\n
                });\r\n
                this.initNames();\r\n
                Common.util.Shortcuts.delegateShortcuts({\r\n
                    shortcuts: {\r\n
                        "command+s,ctrl+s": _.bind(function (e) {\r\n
                            e.preventDefault();\r\n
                            e.stopPropagation();\r\n
                        },\r\n
                        this)\r\n
                    }\r\n
                });\r\n
            },\r\n
            loadConfig: function (data) {\r\n
                this.editorConfig = $.extend(this.editorConfig, data.config);\r\n
                if ((this.editorConfig.user === undefined || this.editorConfig.user === null)) {\r\n
                    this.editorConfig.user = {};\r\n
                    if (this.editorConfig.users) {\r\n
                        this.editorConfig.userId = this.editorConfig.userId || 0;\r\n
                        for (var i = 0; i < this.editorConfig.users.length; i++) {\r\n
                            if (this.editorConfig.users[i].id === this.editorConfig.userId) {\r\n
                                this.editorConfig.user = {\r\n
                                    id: this.editorConfig.users[i].id,\r\n
                                    name: this.editorConfig.users[i].username\r\n
                                };\r\n
                                break;\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
                this.editorConfig.user.id = this.editorConfig.user.id || ("uid-" + Date.now());\r\n
                this.editorConfig.user.name = this.editorConfig.user.name || this.textAnonymous;\r\n
                this.appOptions = {};\r\n
                this.appOptions.user = this.editorConfig.user;\r\n
                this.appOptions.canBack = this.editorConfig.nativeApp !== true && this.editorConfig.canBackToFolder === true;\r\n
                this.appOptions.nativeApp = this.editorConfig.nativeApp === true;\r\n
                this.appOptions.isDesktopApp = this.editorConfig.targetApp == "desktop";\r\n
                this.appOptions.canCreateNew = !_.isEmpty(this.editorConfig.createUrl) && !this.appOptions.isDesktopApp;\r\n
                this.appOptions.canOpenRecent = this.editorConfig.nativeApp !== true && this.editorConfig.recent !== undefined && !this.appOptions.isDesktopApp;\r\n
                this.appOptions.templates = this.editorConfig.templates;\r\n
                this.appOptions.recent = this.editorConfig.recent;\r\n
                this.appOptions.createUrl = this.editorConfig.createUrl;\r\n
                this.appOptions.lang = this.editorConfig.lang;\r\n
                this.appOptions.canAutosave = -1;\r\n
                this.appOptions.canAnalytics = false;\r\n
                this.appOptions.sharingSettingsUrl = this.editorConfig.sharingSettingsUrl;\r\n
                this.appOptions.isEditDiagram = this.editorConfig.mode == "editdiagram";\r\n
                this.appOptions.customization = this.editorConfig.customization;\r\n
                this.headerView = this.getApplication().getController("Viewport").getView("Common.Views.Header");\r\n
                this.headerView.setCanBack(this.editorConfig.canBackToFolder === true);\r\n
                if (this.editorConfig.lang) {\r\n
                    this.api.asc_setLocale(this.editorConfig.lang);\r\n
                }\r\n
            },\r\n
            loadDocument: function (data) {\r\n
                this.appOptions.spreadsheet = data.doc;\r\n
                this.permissions = {};\r\n
                var docInfo = {};\r\n
                if (data.doc) {\r\n
                    this.permissions = _.extend(this.permissions, data.doc.permissions);\r\n
                    docInfo.Id = data.doc.key;\r\n
                    docInfo.Url = data.doc.url;\r\n
                    docInfo.Data = data.doc.data;\r\n
                    docInfo.Title = data.doc.title;\r\n
                    docInfo.Format = data.doc.fileType;\r\n
                    docInfo.Options = data.doc.options;\r\n
                    docInfo.UserId = this.editorConfig.user.id;\r\n
                    docInfo.UserName = this.editorConfig.user.name;\r\n
                    docInfo.VKey = data.doc.vkey;\r\n
                    docInfo.Origin = data.doc.origin;\r\n
                    docInfo.CallbackUrl = this.editorConfig.callbackUrl;\r\n
                    this.headerView.setDocumentCaption(data.doc.title);\r\n
                }\r\n
                if (this.appOptions.isEditDiagram) {\r\n
                    this.onEditorPermissions(undefined);\r\n
                } else {\r\n
                    this.api.asc_registerCallback("asc_onGetEditorPermissions", _.bind(this.onEditorPermissions, this));\r\n
                    this.api.asc_setDocInfo(docInfo);\r\n
                    this.api.asc_getEditorPermissions();\r\n
                }\r\n
            },\r\n
            onSave: function (data) {\r\n
                this.api.asc_Save();\r\n
            },\r\n
            onProcessSaveResult: function (data) {\r\n
                //XXX\r\n
                //this.api.asc_OnSaveEnd(data.result);\r\n
                if (data && data.result === false) {\r\n
                    Common.UI.error({\r\n
                        title: this.criticalErrorTitle,\r\n
                        msg: _.isEmpty(data.message) ? this.errorProcessSaveResult : data.message\r\n
                    });\r\n
                }\r\n
            },\r\n
            onProcessRightsChange: function (data) {\r\n
                if (data && data.enabled === false) {\r\n
                    this.api.asc_coAuthoringDisconnect();\r\n
                    this.getApplication().getController("LeftMenu").leftMenu.getMenu("file").panels["rights"].onLostEditRights();\r\n
                    Common.UI.warning({\r\n
                        title: this.notcriticalErrorTitle,\r\n
                        msg: _.isEmpty(data.message) ? this.warnProcessRightsChange : data.message\r\n
                    });\r\n
                }\r\n
            },\r\n
            onProcessMouse: function (data) {\r\n
                if (data.type == "mouseup") {\r\n
                    var editor = document.getElementById("editor_sdk");\r\n
                    if (editor) {\r\n
                        var rect = editor.getBoundingClientRect();\r\n
                        var event = window.event || arguments.callee.caller.arguments[0];\r\n
                        this.api.asc_onMouseUp(event, data.x - rect.left, data.y - rect.top);\r\n
                    }\r\n
                }\r\n
            },\r\n
            goBack: function () {\r\n
                Common.Gateway.goBack();\r\n
            },\r\n
            onEditComplete: function (cmp, opts) {\r\n
                if (opts && opts.restorefocus && this.api.isCEditorFocused) {\r\n
                    this.formulaInput.blur();\r\n
                    this.formulaInput.focus();\r\n
                } else {\r\n
                    this.getApplication().getController("DocumentHolder").getView("DocumentHolder").focus();\r\n
                    this.api.isCEditorFocused = false;\r\n
                }\r\n
            },\r\n
            onLongActionBegin: function (type, id) {\r\n
                var action = {\r\n
                    id: id,\r\n
                    type: type\r\n
                };\r\n
                this.stackLongActions.push(action);\r\n
                this.setLongActionView(action);\r\n
            },\r\n
            onLongActionEnd: function (type, id) {\r\n
                var action = {\r\n
                    id: id,\r\n
                    type: type\r\n
                };\r\n
                this.stackLongActions.pop(action);\r\n
                this.headerView.setDocumentCaption(this.api.asc_getDocumentName());\r\n
                this.updateWindowTitle(this.api.asc_isDocumentModified(), true);\r\n
                if (type === c_oAscAsyncActionType.BlockInteraction && id == c_oAscAsyncAction.Open) {\r\n
                    Common.Gateway.internalMessage("documentReady", {});\r\n
                    this.onDocumentReady();\r\n
                }\r\n
                action = this.stackLongActions.get({\r\n
                    type: c_oAscAsyncActionType.Information\r\n
                });\r\n
                action && this.setLongActionView(action);\r\n
                if (id == c_oAscAsyncAction.Save) {\r\n
                    this.toolbarView.synchronizeChanges();\r\n
                }\r\n
                action = this.stackLongActions.get({\r\n
                    type: c_oAscAsyncActionType.BlockInteraction\r\n
                });\r\n
                if (action) {\r\n
                    this.setLongActionView(action);\r\n
                } else {\r\n
                    this.loadMask && this.loadMask.hide();\r\n
                    if (type == c_oAscAsyncActionType.BlockInteraction) {\r\n
                        this.onEditComplete(this.loadMask, {\r\n
                            restorefocus: true\r\n
                        });\r\n
                    }\r\n
                }\r\n
            },\r\n
            setLongActionView: function (action) {\r\n
                var title = "";\r\n
                switch (action.id) {\r\n
                case c_oAscAsyncAction.Open:\r\n
                    title = this.openTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.Save:\r\n
                    title = this.saveTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.LoadDocumentFonts:\r\n
                    title = this.loadFontsTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.LoadDocumentImages:\r\n
                    title = this.loadImagesTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.LoadFont:\r\n
                    title = this.loadFontTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.LoadImage:\r\n
                    title = this.loadImageTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.DownloadAs:\r\n
                    title = this.downloadTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.Print:\r\n
                    title = this.printTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.UploadImage:\r\n
                    title = this.uploadImageTitleText;\r\n
                    break;\r\n
                case c_oAscAsyncAction.Recalc:\r\n
                    title = this.titleRecalcFormulas;\r\n
                    break;\r\n
                case c_oAscAsyncAction.SlowOperation:\r\n
                    title = this.textPleaseWait;\r\n
                    break;\r\n
                case c_oAscAsyncAction["PrepareToSave"]:\r\n
                    title = this.savePreparingText;\r\n
                    break;\r\n
                case ApplyEditRights:\r\n
                    title = this.txtEditingMode;\r\n
                    break;\r\n
                case LoadingDocument:\r\n
                    title = this.loadingDocumentTitleText;\r\n
                    break;\r\n
                }\r\n
                if (action.type == c_oAscAsyncActionType.BlockInteraction) { ! this.loadMask && (this.loadMask = new Common.UI.LoadMask({\r\n
                        owner: $("#viewport")\r\n
                    }));\r\n
                    this.loadMask.setTitle(title);\r\n
                    if (!this.isShowOpenDialog) {\r\n
                        this.loadMask.show();\r\n
                    }\r\n
                }\r\n
            },\r\n
            onApplyEditRights: function (data) {\r\n
                if (data) {\r\n
                    if (data.allowed) {\r\n
                        this.onLongActionBegin(c_oAscAsyncActionType["BlockInteraction"], ApplyEditRights);\r\n
                        this.appOptions.isEdit = true;\r\n
                        var me = this;\r\n
                        setTimeout(function () {\r\n
                            me.applyModeCommonElements();\r\n
                            me.applyModeEditorElements("view");\r\n
                            me.api.asc_setViewerMode(false);\r\n
                            var application = me.getApplication();\r\n
                            var documentHolderController = application.getController("DocumentHolder");\r\n
                            application.getController("LeftMenu").setMode(me.appOptions).createDelayedElements();\r\n
                            Common.NotificationCenter.trigger("layout:changed", "main");\r\n
                            var timer_sl = setInterval(function () {\r\n
                                if (window.styles_loaded) {\r\n
                                    clearInterval(timer_sl);\r\n
                                    documentHolderController.getView("DocumentHolder").createDelayedElements();\r\n
                                    documentHolderController.resetApi();\r\n
                                    application.getController("Toolbar").createDelayedElements();\r\n
                                    application.getController("RightMenu").createDelayedElements();\r\n
                                    application.getController("Statusbar").getView("Statusbar").update();\r\n
                                    application.getController("CellEditor").setMode(me.appOptions);\r\n
                                    me.api.asc_registerCallback("asc_onInitEditorShapes", _.bind(me.fillAutoShapes, me));\r\n
                                    me.api.asc_registerCallback("asc_onSaveUrl", _.bind(me.onSaveUrl, me));\r\n
                                    me.api.asc_registerCallback("asc_onDocumentModifiedChanged", _.bind(me.onDocumentModifiedChanged, me));\r\n
                                    me.api.asc_registerCallback("asc_onDocumentCanSaveChanged", _.bind(me.onDocumentCanSaveChanged, me));\r\n
                                    me.updateThemeColors();\r\n
                                    application.getController("FormulaDialog").setApi(me.api);\r\n
                                }\r\n
                            },\r\n
                            50);\r\n
                        },\r\n
                        50);\r\n
                    } else {\r\n
                        Common.UI.info({\r\n
                            title: this.requestEditFailedTitleText,\r\n
                            msg: data.message || this.requestEditFailedMessageText\r\n
                        });\r\n
                    }\r\n
                }\r\n
            },\r\n
            onDocumentReady: function () {\r\n
                if (this._isDocReady) {\r\n
                    return;\r\n
                }\r\n
                var me = this,\r\n
                value, tips = [];\r\n
                me._isDocReady = true;\r\n
                me.hidePreloader();\r\n
                me.onLongActionEnd(c_oAscAsyncActionType["BlockInteraction"], LoadingDocument);\r\n
                value = this.appOptions.isEditDiagram ? 100 : window.localStorage.getItem("sse-settings-zoom");\r\n
                this.api.asc_setZoom(!value ? 1 : parseInt(value) / 100);\r\n
                value = window.localStorage.getItem("sse-settings-livecomment");\r\n
                this.isLiveCommenting = !(value !== null && parseInt(value) == 0);\r\n
                this.isLiveCommenting ? this.api.asc_showComments() : this.api.asc_hideComments();\r\n
                me.api.asc_registerCallback("asc_onStartAction", _.bind(me.onLongActionBegin, me));\r\n
                me.api.asc_registerCallback("asc_onConfirmAction", _.bind(me.onConfirmAction, me));\r\n
                me.api.asc_registerCallback("asc_onActiveSheetChanged", _.bind(me.onActiveSheetChanged, me));\r\n
                var application = me.getApplication();\r\n
                me.headerView.setDocumentCaption(me.api.asc_getDocumentName());\r\n
                me.updateWindowTitle(me.api.asc_isDocumentModified(), true);\r\n
                var toolbarController = application.getController("Toolbar"),\r\n
                statusbarController = application.getController("Statusbar"),\r\n
                documentHolderController = application.getController("DocumentHolder"),\r\n
                rightmenuController = application.getController("RightMenu"),\r\n
                leftmenuController = application.getController("LeftMenu"),\r\n
                celleditorController = application.getController("CellEditor"),\r\n
                statusbarView = statusbarController.getView("Statusbar"),\r\n
                leftMenuView = leftmenuController.getView("LeftMenu"),\r\n
                documentHolderView = documentHolderController.getView("DocumentHolder"),\r\n
                chatController = application.getController("Common.Controllers.Chat");\r\n
                leftMenuView.getMenu("file").loadDocument({\r\n
                    doc: me.appOptions.spreadsheet\r\n
                });\r\n
                leftmenuController.setMode(me.appOptions).createDelayedElements().setApi(me.api);\r\n
                leftMenuView.disableMenu("all", false);\r\n
                if (!me.appOptions.isEditDiagram && me.appOptions.canBranding) {\r\n
                    me.getApplication().getController("LeftMenu").leftMenu.getMenu("about").setLicInfo(me.editorConfig.customization);\r\n
                }\r\n
                documentHolderController.setApi(me.api).loadConfig({\r\n
                    config: me.editorConfig\r\n
                });\r\n
                celleditorController.setApi(me.api).setMode(this.appOptions);\r\n
                celleditorController.onApiCellSelection(me.api.asc_getCellInfo());\r\n
                chatController.setApi(this.api).setMode(this.appOptions);\r\n
                statusbarController.createDelayedElements();\r\n
                statusbarController.setApi(me.api);\r\n
                documentHolderView.setApi(me.api);\r\n
                statusbarView.update();\r\n
                this.formulaInput = celleditorController.getView("CellEditor").$el.find("textarea");\r\n
                if (me.appOptions.isEdit) {\r\n
                    if (me.needToUpdateVersion) {\r\n
                        Common.NotificationCenter.trigger("api:disconnect");\r\n
                        toolbarController.onApiCoAuthoringDisconnect();\r\n
                    }\r\n
                    var timer_sl = setInterval(function () {\r\n
                        if (window.styles_loaded || me.appOptions.isEditDiagram) {\r\n
                            clearInterval(timer_sl);\r\n
                            Common.NotificationCenter.trigger("comments:updatefilter", {\r\n
                                property: "uid",\r\n
                                value: new RegExp("^(doc_|sheet" + me.api.asc_getActiveWorksheetId() + "_)")\r\n
                            });\r\n
                            documentHolderView.createDelayedElements();\r\n
                            toolbarController.createDelayedElements();\r\n
                            rightmenuController.createDelayedElements();\r\n
                            if (!me.appOptions.isEditDiagram) {\r\n
                                me.api.asc_registerCallback("asc_onInitEditorShapes", _.bind(me.fillAutoShapes, me));\r\n
                                me.updateThemeColors();\r\n
                            }\r\n
                            me.api.asc_registerCallback("asc_onSaveUrl", _.bind(me.onSaveUrl, me));\r\n
                            me.api.asc_registerCallback("asc_onDocumentModifiedChanged", _.bind(me.onDocumentModifiedChanged, me));\r\n
                            me.api.asc_registerCallback("asc_onDocumentCanSaveChanged", _.bind(me.onDocumentCanSaveChanged, me));\r\n
                            var formulasDlgController = application.getController("FormulaDialog");\r\n
                            if (formulasDlgController) {\r\n
                                formulasDlgController.setApi(me.api);\r\n
                            }\r\n
                            if (me.needToUpdateVersion) {\r\n
                                toolbarController.onApiCoAuthoringDisconnect();\r\n
                            }\r\n
                        }\r\n
                    },\r\n
                    50);\r\n
                }\r\n
                if (me.appOptions.canAutosave) {\r\n
                    value = window.localStorage.getItem("sse-settings-autosave");\r\n
                    value = (value !== null) ? parseInt(value) : 1;\r\n
                } else {\r\n
                    value = 0;\r\n
                }\r\n
                me.api.asc_setAutoSaveGap(value);\r\n
                if (me.appOptions.canAnalytics) {\r\n
                    Common.component.Analytics.initialize("UA-12442749-13", "Spreadsheet Editor");\r\n
                }\r\n
                Common.Gateway.on("applyeditrights", _.bind(me.onApplyEditRights, me));\r\n
                Common.Gateway.on("save", _.bind(me.onSave, me));\r\n
                Common.Gateway.on("processsaveresult", _.bind(me.onProcessSaveResult, me));\r\n
                Common.Gateway.on("processrightschange", _.bind(me.onProcessRightsChange, me));\r\n
                Common.Gateway.on("processmouse", _.bind(me.onProcessMouse, me));\r\n
                $(document).on("contextmenu", _.bind(me.onContextMenu, me));\r\n
                if ( !! window["AscDesktopEditor"]) {\r\n
                    Common.Utils.isIE9m && tips.push(me.warnBrowserIE9); ! Common.Utils.isGecko && !me.appOptions.isEditDiagram && !me.appOptions.nativeApp && (Math.abs(me.getBrowseZoomLevel() - 1) > 0.1) && tips.push(Common.Utils.String.platformKey(me.warnBrowserZoom, "{0}"));\r\n
                    if (tips.length) {\r\n
                        me.showTips(tips);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onOpenDocument: function (progress) {\r\n
                var elem = document.getElementById("loadmask-text");\r\n
                var proc = (progress.CurrentFont + progress.CurrentImage) / (progress.FontsCount + progress.ImagesCount);\r\n
                proc = this.textLoadingDocument + ": " + Math.round(proc * 100) + "%";\r\n
                elem ? elem.innerHTML = proc : this.loadMask.setTitle(proc);\r\n
            },\r\n
            onEditorPermissions: function (params) {\r\n
                if (params) {\r\n
                    this.permissions.edit !== false && (this.permissions.edit = params.asc_getCanEdit());\r\n
                    this.permissions.download !== false && (this.permissions.download = params.asc_getCanDownload());\r\n
                    this.appOptions.canAutosave = this.editorConfig.canAutosave !== false && params.asc_getIsAutosaveEnable();\r\n
                    this.appOptions.canAnalytics = params.asc_getIsAnalyticsEnable();\r\n
                    this.appOptions.canCoAuthoring = true;\r\n
                    this.appOptions.canLicense = params.asc_getCanLicense ? params.asc_getCanLicense() : false;\r\n
                    this.appOptions.canComments = this.appOptions.canLicense && !((typeof(this.editorConfig.customization) == "object") && this.editorConfig.customization.comments === false);\r\n
                    this.appOptions.canChat = this.appOptions.canLicense && !((typeof(this.editorConfig.customization) == "object") && this.editorConfig.customization.chat === false);\r\n
                    this.appOptions.canBranding = params.asc_getCanBranding() && (typeof(this.editorConfig.customization) == "object");\r\n
                    if (this.appOptions.canBranding) {\r\n
                        this.headerView.setBranding(this.editorConfig.customization);\r\n
                    }\r\n
                }\r\n
                this.appOptions.canEdit = this.permissions.edit === true;\r\n
                this.appOptions.isEdit = this.permissions.edit === true && this.editorConfig.mode !== "view";\r\n
                this.appOptions.canDownload = !this.appOptions.nativeApp && (this.permissions.download !== undefined ? this.permissions.download : true);\r\n
                this.applyModeCommonElements();\r\n
                this.applyModeEditorElements();\r\n
                this.api.asc_setViewerMode(!this.appOptions.isEdit);\r\n
                this.appOptions.isEditDiagram ? this.api.asc_LoadEmptyDocument() : this.api.asc_LoadDocument();\r\n
                if (!this.appOptions.isEdit) {\r\n
                    this.hidePreloader();\r\n
                    this.onLongActionBegin(c_oAscAsyncActionType.BlockInteraction, LoadingDocument);\r\n
                }\r\n
            },\r\n
            applyModeCommonElements: function () {\r\n
                window.editor_elements_prepared = true;\r\n
                var value = window.localStorage.getItem("sse-hidden-title");\r\n
                value = this.appOptions.isEdit && (value !== null && parseInt(value) == 1);\r\n
                var app = this.getApplication(),\r\n
                viewport = app.getController("Viewport").getView("Viewport"),\r\n
                statusbarView = app.getController("Statusbar").getView("Statusbar");\r\n
                if (this.headerView) {\r\n
                    this.headerView.setHeaderCaption(this.appOptions.isEdit ? "Spreadsheet Editor" : "Spreadsheet Viewer");\r\n
                    this.headerView.setVisible(!this.appOptions.nativeApp && !value && !this.appOptions.isDesktopApp && !this.appOptions.isEditDiagram);\r\n
                }\r\n
                viewport && viewport.setMode(this.appOptions, true);\r\n
                statusbarView && statusbarView.setMode(this.appOptions);\r\n
                app.getController("DocumentHolder").setMode(this.appOptions);\r\n
                if (this.appOptions.isEditDiagram) {\r\n
                    statusbarView.hide();\r\n
                    app.getController("LeftMenu").getView("LeftMenu").hide();\r\n
                    $(window).mouseup(function (e) {\r\n
                        Common.Gateway.internalMessage("processMouse", {\r\n
                            event: "mouse:up"\r\n
                        });\r\n
                    }).mousemove($.proxy(function (e) {\r\n
                        if (this.isDiagramDrag) {\r\n
                            Common.Gateway.internalMessage("processMouse", {\r\n
                                event: "mouse:move",\r\n
                                pagex: e.pageX,\r\n
                                pagey: e.pageY\r\n
                            });\r\n
                        }\r\n
                    },\r\n
                    this));\r\n
                }\r\n
                if (this.api) {\r\n
                    var translateChart = new Asc.asc_CChartTranslate();\r\n
                    translateChart.asc_setTitle(this.txtDiagramTitle);\r\n
                    translateChart.asc_setXAxis(this.txtXAxis);\r\n
                    translateChart.asc_setYAxis(this.txtYAxis);\r\n
                    translateChart.asc_setSeries(this.txtSeries);\r\n
                    this.api.asc_setChartTranslate(translateChart);\r\n
                }\r\n
                if (!this.appOptions.isEditDiagram) {\r\n
                    this.api.asc_registerCallback("asc_onSendThemeColors", _.bind(this.onSendThemeColors, this));\r\n
                }\r\n
            },\r\n
            applyModeEditorElements: function (prevmode) {\r\n
                if (this.appOptions.isEdit) {\r\n
                    var me = this,\r\n
                    application = this.getApplication(),\r\n
                    toolbarController = application.getController("Toolbar"),\r\n
                    statusbarController = application.getController("Statusbar"),\r\n
                    rightmenuController = application.getController("RightMenu"),\r\n
                    printController = application.getController("Print"),\r\n
                    commentsController = application.getController("Common.Controllers.Comments"),\r\n
                    fontsControllers = application.getController("Common.Controllers.Fonts");\r\n
                    fontsControllers && fontsControllers.setApi(me.api);\r\n
                    toolbarController && toolbarController.setApi(me.api);\r\n
                    if (commentsController) {\r\n
                        commentsController.setMode(this.appOptions);\r\n
                        commentsController.setConfig({\r\n
                            config: me.editorConfig,\r\n
                            sdkviewname: "#ws-canvas-outer",\r\n
                            hintmode: true\r\n
                        },\r\n
                        me.api);\r\n
                    }\r\n
                    rightmenuController && rightmenuController.setApi(me.api);\r\n
                    printController && printController.setApi(me.api);\r\n
                    if (statusbarController) {\r\n
                        statusbarController.getView("Statusbar").changeViewMode(true);\r\n
                    }\r\n
                    if (prevmode == "view") {\r\n
                        if (commentsController) {\r\n
                            Common.NotificationCenter.trigger("comments:updatefilter", {\r\n
                                property: "uid",\r\n
                                value: new RegExp("^(doc_|sheet" + this.api.asc_getActiveWorksheetId() + "_)")\r\n
                            });\r\n
                        }\r\n
                    }\r\n
                    var viewport = this.getApplication().getController("Viewport").getView("Viewport");\r\n
                    viewport.applyEditorMode();\r\n
                    this.toolbarView = toolbarController.getView("Toolbar");\r\n
                    _.each([this.toolbarView, rightmenuController.getView("RightMenu")], function (view) {\r\n
                        if (view) {\r\n
                            view.setMode(me.appOptions);\r\n
                            view.setApi(me.api);\r\n
                        }\r\n
                    });\r\n
                    if (this.toolbarView) {\r\n
                        this.toolbarView.on("insertimage", _.bind(me.onInsertImage, me));\r\n
                        this.toolbarView.on("insertshape", _.bind(me.onInsertShape, me));\r\n
                        this.toolbarView.on("insertchart", _.bind(me.onInsertChart, me));\r\n
                    }\r\n
                    var value = window.localStorage.getItem("sse-settings-unit");\r\n
                    Common.Utils.Metric.setCurrentMetric((value !== null) ? parseInt(value) : Common.Utils.Metric.c_MetricUnits.cm);\r\n
                    if (!me.appOptions.isEditDiagram) {\r\n
                        var options = {};\r\n
                        JSON.parse(window.localStorage.getItem("sse-hidden-title")) && (options.title = true);\r\n
                        JSON.parse(window.localStorage.getItem("sse-hidden-formula")) && (options.formula = true);\r\n
                        JSON.parse(window.localStorage.getItem("sse-hidden-headings")) && (options.headings = true);\r\n
                        application.getController("Toolbar").hideElements(options);\r\n
                    } else {\r\n
                        rightmenuController.getView("RightMenu").hide();\r\n
                    }\r\n
                    if (me.stackLongActions.exist({\r\n
                        id: ApplyEditRights,\r\n
                        type: c_oAscAsyncActionType["BlockInteraction"]\r\n
                    })) {\r\n
                        me.onLongActionEnd(c_oAscAsyncActionType["BlockInteraction"], ApplyEditRights);\r\n
                    } else {\r\n
                        if (!this._isDocReady) {\r\n
                            me.hidePreloader();\r\n
                            me.onLongActionBegin(c_oAscAsyncActionType["BlockInteraction"], LoadingDocument);\r\n
                        }\r\n
                    }\r\n
                    window.onbeforeunload = _.bind(me.onBeforeUnload, me);\r\n
                }\r\n
            },\r\n
            onExternalMessage: function (msg) {\r\n
                if (msg) {\r\n
                    var tip = msg.msg.charAt(0).toUpperCase() + msg.msg.substring(1),\r\n
                    title = (msg.severity.indexOf("error") >= 0) ? this.criticalErrorTitle : this.notcriticalErrorTitle;\r\n
                    this.showTips([tip], false, title);\r\n
                    Common.component.Analytics.trackEvent("External Error", msg.title);\r\n
                }\r\n
            },\r\n
            onError: function (id, level, errData) {\r\n
                this.hidePreloader();\r\n
                this.onLongActionEnd(c_oAscAsyncActionType.BlockInteraction, LoadingDocument);\r\n
                var config = {\r\n
                    closable: false\r\n
                };\r\n
                switch (id) {\r\n
                case c_oAscError.ID.Unknown:\r\n
                    config.msg = this.unknownErrorText;\r\n
                    break;\r\n
                case c_oAscError.ID.ConvertationTimeout:\r\n
                    config.msg = this.convertationTimeoutText;\r\n
                    break;\r\n
                case c_oAscError.ID.ConvertationError:\r\n
                    config.msg = this.convertationErrorText;\r\n
                    break;\r\n
                case c_oAscError.ID.DownloadError:\r\n
                    config.msg = this.downloadErrorText;\r\n
                    break;\r\n
                case c_oAscError.ID.UplImageSize:\r\n
                    config.msg = this.uploadImageSizeMessage;\r\n
                    break;\r\n
                case c_oAscError.ID.UplImageExt:\r\n
                    config.msg = this.uploadImageExtMessage;\r\n
                    break;\r\n
                case c_oAscError.ID.UplImageFileCount:\r\n
                    config.msg = this.uploadImageFileCountMessage;\r\n
                    break;\r\n
                case c_oAscError.ID.PastInMergeAreaError:\r\n
                    config.msg = this.pastInMergeAreaError;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlWrongCountParentheses:\r\n
                    config.msg = this.errorWrongBracketsCount;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlWrongOperator:\r\n
                    config.msg = this.errorWrongOperator;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlWrongMaxArgument:\r\n
                    config.msg = this.errorCountArgExceed;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlWrongCountArgument:\r\n
                    config.msg = this.errorCountArg;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlWrongFunctionName:\r\n
                    config.msg = this.errorFormulaName;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlAnotherParsingError:\r\n
                    config.msg = this.errorFormulaParsing;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlWrongArgumentRange:\r\n
                    config.msg = this.errorArgsRange;\r\n
                    break;\r\n
                case c_oAscError.ID.UnexpectedGuid:\r\n
                    config.msg = this.errorUnexpectedGuid;\r\n
                    break;\r\n
                case c_oAscError.ID.Database:\r\n
                    config.msg = this.errorDatabaseConnection;\r\n
                    break;\r\n
                case c_oAscError.ID.FileRequest:\r\n
                    config.msg = this.errorFileRequest;\r\n
                    break;\r\n
                case c_oAscError.ID.FileVKey:\r\n
                    config.msg = this.errorFileVKey;\r\n
                    break;\r\n
                case c_oAscError.ID.StockChartError:\r\n
                    config.msg = this.errorStockChart;\r\n
                    break;\r\n
                case c_oAscError.ID.DataRangeError:\r\n
                    config.msg = this.errorDataRange;\r\n
                    break;\r\n
                case c_oAscError.ID.FrmlOperandExpected:\r\n
                    config.msg = this.errorOperandExpected;\r\n
                    break;\r\n
                case c_oAscError.ID.VKeyEncrypt:\r\n
                    config.msg = this.errorKeyEncrypt;\r\n
                    break;\r\n
                case c_oAscError.ID.KeyExpire:\r\n
                    config.msg = this.errorKeyExpire;\r\n
                    break;\r\n
                case c_oAscError.ID.UserCountExceed:\r\n
                    config.msg = this.errorUsersExceed;\r\n
                    break;\r\n
                case c_oAscError.ID.CannotMoveRange:\r\n
                    config.msg = this.errorMoveRange;\r\n
                    break;\r\n
                case c_oAscError.ID.UplImageUrl:\r\n
                    config.msg = this.errorBadImageUrl;\r\n
                    break;\r\n
                case c_oAscError.ID.CoAuthoringDisconnect:\r\n
                    config.msg = this.errorCoAuthoringDisconnect;\r\n
                    break;\r\n
                case c_oAscError.ID.ConvertationPassword:\r\n
                    config.msg = this.errorFilePassProtect;\r\n
                    break;\r\n
                case c_oAscError.ID.AutoFilterDataRangeError:\r\n
                    config.msg = this.errorAutoFilterDataRange;\r\n
                    break;\r\n
                case c_oAscError.ID.AutoFilterChangeFormatTableError:\r\n
                    config.msg = this.errorAutoFilterChangeFormatTable;\r\n
                    break;\r\n
                case c_oAscError.ID.AutoFilterChangeError:\r\n
                    config.msg = this.errorAutoFilterChange;\r\n
                    break;\r\n
                case c_oAscError.ID.CannotFillRange:\r\n
                    config.msg = this.errorFillRange;\r\n
                    break;\r\n
                case c_oAscError.ID.UserDrop:\r\n
                    config.msg = this.errorUserDrop;\r\n
                    break;\r\n
                default:\r\n
                    config.msg = this.errorDefaultMessage.replace("%1", id);\r\n
                    break;\r\n
                }\r\n
                if (level == c_oAscError.Level.Critical) {\r\n
                    Common.Gateway.reportError(id, config.msg);\r\n
                    config.title = this.criticalErrorTitle;\r\n
                    config.iconCls = "error";\r\n
                    if (this.editorConfig.canBackToFolder) {\r\n
                        config.msg += "<br/><br/>" + this.criticalErrorExtText;\r\n
                        config.callback = function (btn) {\r\n
                            if (btn == "ok") {\r\n
                                Common.Gateway.goBack();\r\n
                            }\r\n
                        };\r\n
                    }\r\n
                } else {\r\n
                    config.title = this.notcriticalErrorTitle;\r\n
                    config.iconCls = "warn";\r\n
                    config.buttons = ["ok"];\r\n
                    config.callback = _.bind(function (btn) {\r\n
                        this.onEditComplete();\r\n
                    },\r\n
                    this);\r\n
                }\r\n
                if ($(".asc-window.modal.alert:visible").length < 1) {\r\n
                    Common.UI.alert(config);\r\n
                    Common.component.Analytics.trackEvent("Internal Error", id.toString());\r\n
                }\r\n
            },\r\n
            onCoAuthoringDisconnect: function () {\r\n
                this.getApplication().getController("Viewport").getView("Viewport").setMode({\r\n
                    isDisconnected: true\r\n
                });\r\n
            },\r\n
            getBrowseZoomLevel: function () {\r\n
                if (Common.Utils.isIE) {\r\n
                    return screen.logicalXDPI / screen.deviceXDPI;\r\n
                } else {\r\n
                    var zoom = window.outerWidth / document.documentElement.clientWidth;\r\n
                    if (Common.Utils.isSafari) {\r\n
                        zoom = Math.floor(zoom * 10) / 10;\r\n
                    }\r\n
                    return zoom;\r\n
                }\r\n
            },\r\n
            showTips: function (strings, autohide, title) {\r\n
                var me = this;\r\n
                if (!strings.length) {\r\n
                    return;\r\n
                }\r\n
                if (typeof(strings) != "object") {\r\n
                    strings = [strings];\r\n
                }\r\n
                function showNextTip() {\r\n
                    var str_tip = strings.shift();\r\n
                    if (str_tip) {\r\n
                        str_tip += me.textCloseTip;\r\n
                        tooltip.setTitle(str_tip);\r\n
                        tooltip.show();\r\n
                    }\r\n
                }\r\n
                if (!this.tooltip) {\r\n
                    this.tooltip = new Common.UI.Tooltip({\r\n
                        owner: this.toolbarView,\r\n
                        hideonclick: true,\r\n
                        placement: "bottom",\r\n
                        cls: "main-info",\r\n
                        offset: 30\r\n
                    });\r\n
                }\r\n
                var tooltip = this.tooltip;\r\n
                tooltip.on("tooltip:hide", function () {\r\n
                    setTimeout(showNextTip, 300);\r\n
                });\r\n
                showNextTip();\r\n
            },\r\n
            updateWindowTitle: function (change, force) {\r\n
                if (this._state.isDocModified !== change || force) {\r\n
                    var title = this.defaultTitleText;\r\n
                    if (!_.isEmpty(this.headerView.getDocumentCaption())) {\r\n
                        title = this.headerView.getDocumentCaption() + " - " + title;\r\n
                    }\r\n
                    if (change) {\r\n
                        if (!_.isUndefined(title)) {\r\n
                            title = "* " + title;\r\n
                            this.headerView.setDocumentCaption(this.headerView.getDocumentCaption() + "*", true);\r\n
                        }\r\n
                    } else {\r\n
                        this.headerView.setDocumentCaption(this.headerView.getDocumentCaption());\r\n
                    }\r\n
                    if (window.document.title != title) {\r\n
                        window.document.title = title;\r\n
                    }\r\n
                    this._state.isDocModified = change;\r\n
                }\r\n
            },\r\n
            onDocumentChanged: function () {},\r\n
            onDocumentModifiedChanged: function (change) {\r\n
                this.updateWindowTitle(change);\r\n
                Common.Gateway.setDocumentModified(change);\r\n
                if (this.toolbarView && this.api) {\r\n
                    var isSyncButton = $(".btn-icon", this.toolbarView.btnSave.cmpEl).hasClass("btn-synch");\r\n
                    var cansave = this.api.asc_isDocumentCanSave();\r\n
                    if (this.toolbarView.btnSave.isDisabled() !== (!cansave && !isSyncButton)) {\r\n
                        this.toolbarView.btnSave.setDisabled(!cansave);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onDocumentCanSaveChanged: function (isCanSave) {\r\n
                if (this.toolbarView) {\r\n
                    var isSyncButton = $(".btn-icon", this.toolbarView.btnSave.cmpEl).hasClass("btn-synch");\r\n
            

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAACA=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="32" aka="AAAAAAAAACA=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

        if (this.toolbarView.btnSave.isDisabled() !== (!isCanSave && !isSyncButton)) {\r\n
                        this.toolbarView.btnSave.setDisabled(!isCanSave && !isSyncButton);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onBeforeUnload: function () {\r\n
                var isEdit = this.permissions.edit === true && this.editorConfig.mode !== "view" && this.editorConfig.mode !== "editdiagram";\r\n
                if (isEdit && this.api.asc_isDocumentModified()) {\r\n
                    return this.leavePageText;\r\n
                }\r\n
            },\r\n
            hidePreloader: function () {\r\n
                if ( !! this.appOptions.customization && !this.appOptions.customization.done) {\r\n
                    this.appOptions.customization.done = true;\r\n
                    Common.Utils.applyCustomization(this.appOptions.customization, mapCustomizationElements);\r\n
                }\r\n
                this.stackLongActions.pop({\r\n
                    id: InitApplication,\r\n
                    type: c_oAscAsyncActionType.BlockInteraction\r\n
                });\r\n
                Common.NotificationCenter.trigger("layout:changed", "main");\r\n
                $("#loading-mask").hide().remove();\r\n
            },\r\n
            onSaveUrl: function (url) {\r\n
                Common.Gateway.save(url);\r\n
            },\r\n
            onUpdateVersion: function (callback) {\r\n
                var me = this;\r\n
                me.needToUpdateVersion = true;\r\n
                me.onLongActionEnd(c_oAscAsyncActionType["BlockInteraction"], LoadingDocument);\r\n
                Common.UI.error({\r\n
                    msg: this.errorUpdateVersion,\r\n
                    callback: function () {\r\n
                        _.defer(function () {\r\n
                            Common.Gateway.updateVersion();\r\n
                            if (callback) {\r\n
                                callback.call(me);\r\n
                            }\r\n
                            me.onLongActionBegin(c_oAscAsyncActionType["BlockInteraction"], LoadingDocument);\r\n
                        });\r\n
                    }\r\n
                });\r\n
            },\r\n
            onAdvancedOptions: function (advOptions) {\r\n
                if (advOptions.asc_getOptionId() == c_oAscAdvancedOptionsID.CSV) {\r\n
                    var me = this;\r\n
                    var dlg = new SSE.Views.OpenDialog({\r\n
                        codepages: advOptions.asc_getOptions().asc_getCodePages(),\r\n
                        settings: advOptions.asc_getOptions().asc_getRecommendedSettings(),\r\n
                        handler: function (encoding, delimiter) {\r\n
                            me.isShowOpenDialog = false;\r\n
                            if (me && me.api) {\r\n
                                me.api.asc_setAdvancedOptions(c_oAscAdvancedOptionsID.CSV, new Asc.asc_CCSVAdvancedOptions(encoding, delimiter));\r\n
                                me.loadMask && me.loadMask.show();\r\n
                            }\r\n
                        }\r\n
                    });\r\n
                    this.isShowOpenDialog = true;\r\n
                    this.loadMask && this.loadMask.hide();\r\n
                    this.onLongActionEnd(c_oAscAsyncActionType.BlockInteraction, LoadingDocument);\r\n
                    dlg.show();\r\n
                }\r\n
            },\r\n
            onActiveSheetChanged: function (index) {\r\n
                if (!this.appOptions.isEditDiagram && window.editor_elements_prepared) {\r\n
                    this.application.getController("Statusbar").selectTab(index);\r\n
                    if (this.appOptions.isEdit) {\r\n
                        Common.NotificationCenter.trigger("comments:updatefilter", {\r\n
                            property: "uid",\r\n
                            value: new RegExp("^(doc_|sheet" + this.api.asc_getWorksheetId(index) + "_)")\r\n
                        },\r\n
                        false);\r\n
                    }\r\n
                }\r\n
            },\r\n
            onConfirmAction: function (id, apiCallback) {\r\n
                if (id == c_oAscConfirm.ConfirmReplaceRange) {\r\n
                    var me = this;\r\n
                    Common.UI.warning({\r\n
                        closable: false,\r\n
                        title: this.notcriticalErrorTitle,\r\n
                        msg: this.confirmMoveCellRange,\r\n
                        buttons: ["yes", "no"],\r\n
                        callback: _.bind(function (btn) {\r\n
                            if (apiCallback) {\r\n
                                apiCallback(btn === "ok");\r\n
                            }\r\n
                            if (btn == "ok") {\r\n
                                me.onEditComplete(me.application.getController("DocumentHolder").getView("DocumentHolder"));\r\n
                            }\r\n
                        },\r\n
                        this)\r\n
                    });\r\n
                }\r\n
            },\r\n
            initNames: function () {\r\n
                this.shapeGroupNames = [this.txtBasicShapes, this.txtFiguredArrows, this.txtMath, this.txtCharts, this.txtStarsRibbons, this.txtCallouts, this.txtButtons, this.txtRectangles, this.txtLines];\r\n
            },\r\n
            fillAutoShapes: function (groupNames, shapes) {\r\n
                if (_.isEmpty(shapes) || _.isEmpty(groupNames) || shapes.length != groupNames.length) {\r\n
                    return;\r\n
                }\r\n
                var me = this,\r\n
                shapegrouparray = [],\r\n
                shapeStore = this.getCollection("ShapeGroups");\r\n
                shapeStore.reset();\r\n
                var groupscount = groupNames.length;\r\n
                _.each(groupNames, function (groupName, index) {\r\n
                    var store = new Backbone.Collection([], {\r\n
                        model: SSE.Models.ShapeModel\r\n
                    });\r\n
                    var cols = (shapes[index].length) > 18 ? 7 : 6,\r\n
                    height = Math.ceil(shapes[index].length / cols) * 35 + 3,\r\n
                    width = 30 * cols;\r\n
                    _.each(shapes[index], function (shape, idx) {\r\n
                        store.add({\r\n
                            imageUrl: shape.Image,\r\n
                            data: {\r\n
                                shapeType: shape.Type\r\n
                            },\r\n
                            tip: me.textShape + " " + (idx + 1),\r\n
                            allowSelected: false,\r\n
                            selected: false\r\n
                        });\r\n
                    });\r\n
                    shapegrouparray.push({\r\n
                        groupName: me.shapeGroupNames[index],\r\n
                        groupStore: store,\r\n
                        groupWidth: width,\r\n
                        groupHeight: height\r\n
                    });\r\n
                });\r\n
                if (groupscount > 0) {\r\n
                    var store = new Backbone.Collection([], {\r\n
                        model: SSE.Models.ShapeModel\r\n
                    });\r\n
                    var cols = (shapes[groupscount - 1].length - 3) > 18 ? 7 : 6,\r\n
                    height = Math.ceil((shapes[groupscount - 1].length - 3) / cols) * 35 + 3,\r\n
                    width = 30 * cols;\r\n
                    for (var i = 0; i < shapes[groupscount - 1].length - 3; i++) {\r\n
                        var shape = shapes[groupscount - 1][i];\r\n
                        store.add({\r\n
                            imageUrl: shape.Image,\r\n
                            data: {\r\n
                                shapeType: shape.Type\r\n
                            },\r\n
                            allowSelected: false,\r\n
                            selected: false\r\n
                        });\r\n
                    }\r\n
                    shapegrouparray.push({\r\n
                        groupName: me.shapeGroupNames[groupscount - 1],\r\n
                        groupStore: store,\r\n
                        groupWidth: width,\r\n
                        groupHeight: height\r\n
                    });\r\n
                }\r\n
                shapeStore.add(shapegrouparray);\r\n
                setTimeout(function () {\r\n
                    me.getApplication().getController("Toolbar").fillAutoShapes();\r\n
                },\r\n
                50);\r\n
            },\r\n
            updateThemeColors: function () {\r\n
                var me = this;\r\n
                setTimeout(function () {\r\n
                    me.getApplication().getController("RightMenu").UpdateThemeColors();\r\n
                },\r\n
                50);\r\n
                setTimeout(function () {\r\n
                    me.getApplication().getController("Toolbar").updateThemeColors();\r\n
                },\r\n
                50);\r\n
                setTimeout(function () {\r\n
                    me.getApplication().getController("Statusbar").updateThemeColors();\r\n
                },\r\n
                50);\r\n
            },\r\n
            onSendThemeColors: function (colors, standart_colors) {\r\n
                Common.Utils.ThemeColor.setColors(colors, standart_colors);\r\n
                if (window.styles_loaded && !this.appOptions.isEditDiagram) {\r\n
                    this.updateThemeColors();\r\n
                }\r\n
            },\r\n
            loadLanguages: function () {},\r\n
            onInsertImage: function () {\r\n
                this.getApplication().getController("RightMenu").onInsertImage();\r\n
            },\r\n
            onInsertChart: function () {\r\n
                this.getApplication().getController("RightMenu").onInsertChart();\r\n
            },\r\n
            onInsertShape: function () {\r\n
                this.getApplication().getController("RightMenu").onInsertShape();\r\n
            },\r\n
            onInternalCommand: function (data) {\r\n
                if (data) {\r\n
                    switch (data.command) {\r\n
                    case "setChartData":\r\n
                        this.setChartData(data.data);\r\n
                        break;\r\n
                    case "save":\r\n
                        this.api.asc_Save();\r\n
                        break;\r\n
                    case "getChartData":\r\n
                        this.getChartData();\r\n
                        break;\r\n
                    case "clearChartData":\r\n
                        this.clearChartData();\r\n
                        break;\r\n
                    case "setAppDisabled":\r\n
                        this.isAppDisabled = data.data;\r\n
                        this.api.asc_enableKeyEvents(false);\r\n
                        break;\r\n
                    case "queryClose":\r\n
                        if ($("body .asc-window:visible").length === 0) {\r\n
                            Common.Gateway.internalMessage("canClose", {\r\n
                                mr: data.data.mr,\r\n
                                answer: true\r\n
                            });\r\n
                        }\r\n
                        break;\r\n
                    case "window:drag":\r\n
                        this.isDiagramDrag = data.data;\r\n
                        break;\r\n
                    case "processmouse":\r\n
                        this.onProcessMouse(data.data);\r\n
                        break;\r\n
                    }\r\n
                }\r\n
            },\r\n
            setChartData: function (chart) {\r\n
                if (typeof chart === "object" && this.api) {\r\n
                    this.api.asc_addChartDrawingObject(chart);\r\n
                }\r\n
            },\r\n
            getChartData: function () {\r\n
                if (this.api) {\r\n
                    var chartData = this.api.asc_getWordChartObject();\r\n
                    if (typeof chartData === "object") {\r\n
                        Common.Gateway.internalMessage("chartData", {\r\n
                            data: chartData\r\n
                        });\r\n
                    }\r\n
                }\r\n
            },\r\n
            clearChartData: function () {\r\n
                this.api && this.api.asc_cleanWorksheet();\r\n
            },\r\n
            unitsChanged: function (m) {\r\n
                var value = window.localStorage.getItem("sse-settings-unit");\r\n
                Common.Utils.Metric.setCurrentMetric((value !== null) ? parseInt(value) : Common.Utils.Metric.c_MetricUnits.cm);\r\n
                this.getApplication().getController("RightMenu").updateMetricUnit();\r\n
                this.getApplication().getController("Print").getView("MainSettingsPrint").updateMetricUnit();\r\n
            },\r\n
            _compareActionStrong: function (obj1, obj2) {\r\n
                return obj1.id === obj2.id && obj1.type === obj2.type;\r\n
            },\r\n
            _compareActionWeak: function (obj1, obj2) {\r\n
                return obj1.type === obj2.type;\r\n
            },\r\n
            onContextMenu: function (event) {\r\n
                var canCopyAttr = event.target.getAttribute("data-can-copy"),\r\n
                isInputEl = (event.target instanceof HTMLInputElement) || (event.target instanceof HTMLTextAreaElement);\r\n
                if ((isInputEl && canCopyAttr === "false") || (!isInputEl && canCopyAttr !== "true")) {\r\n
                    event.stopPropagation();\r\n
                    event.preventDefault();\r\n
                    return false;\r\n
                }\r\n
            },\r\n
            leavePageText: "You have unsaved changes in this document. Click \'Stay on this Page\' then \'Save\' to save them. Click \'Leave this Page\' to discard all the unsaved changes.",\r\n
            criticalErrorTitle: "Error",\r\n
            notcriticalErrorTitle: "Warning",\r\n
            errorDefaultMessage: "Error code: %1",\r\n
            criticalErrorExtText: \'Press "Ok" to to back to document list.\',\r\n
            openTitleText: "Opening Document",\r\n
            openTextText: "Opening document...",\r\n
            saveTitleText: "Saving Document",\r\n
            saveTextText: "Saving document...",\r\n
            loadFontsTitleText: "Loading Data",\r\n
            loadFontsTextText: "Loading data...",\r\n
            loadImagesTitleText: "Loading Images",\r\n
            loadImagesTextText: "Loading images...",\r\n
            loadFontTitleText: "Loading Data",\r\n
            loadFontTextText: "Loading data...",\r\n
            loadImageTitleText: "Loading Image",\r\n
            loadImageTextText: "Loading image...",\r\n
            downloadTitleText: "Downloading Document",\r\n
            downloadTextText: "Downloading document...",\r\n
            printTitleText: "Printing Document",\r\n
            printTextText: "Printing document...",\r\n
            uploadImageTitleText: "Uploading Image",\r\n
            uploadImageTextText: "Uploading image...",\r\n
            savePreparingText: "Preparing to save",\r\n
            savePreparingTitle: "Preparing to save. Please wait...",\r\n
            loadingDocumentTitleText: "Loading Document",\r\n
            uploadImageSizeMessage: "Maximium image size limit exceeded.",\r\n
            uploadImageExtMessage: "Unknown image format.",\r\n
            uploadImageFileCountMessage: "No images uploaded.",\r\n
            reloadButtonText: "Reload Page",\r\n
            unknownErrorText: "Unknown error.",\r\n
            convertationTimeoutText: "Convertation timeout exceeded.",\r\n
            convertationErrorText: "Convertation failed.",\r\n
            downloadErrorText: "Download failed.",\r\n
            unsupportedBrowserErrorText: "Your browser is not supported.",\r\n
            requestEditFailedTitleText: "Access denied",\r\n
            requestEditFailedMessageText: "Someone is editing this document right now. Please try again later.",\r\n
            warnBrowserZoom: "Your browser\'s current zoom setting is not fully supported. Please reset to the default zoom by pressing Ctrl+0.",\r\n
            warnBrowserIE9: "The application has low capabilities on IE9. Use IE10 or higher",\r\n
            pastInMergeAreaError: "Cannot change part of a merged cell",\r\n
            titleRecalcFormulas: "Calculating formulas...",\r\n
            textRecalcFormulas: "Calculating formulas...",\r\n
            textPleaseWait: "It\'s working hard. Please wait...",\r\n
            errorWrongBracketsCount: "Found an error in the formula entered.<br>Wrong cout of brackets.",\r\n
            errorWrongOperator: "Found an error in the formula entered.<br>Wrong operator.",\r\n
            errorCountArgExceed: "Found an error in the formula entered.<br>Count of arguments exceeded.",\r\n
            errorCountArg: "Found an error in the formula entered.<br>Invalid number of arguments.",\r\n
            errorFormulaName: "Found an error in the formula entered.<br>Incorrect formula name.",\r\n
            errorFormulaParsing: "Internal error while the formula parsing.",\r\n
            errorArgsRange: "Found an error in the formula entered.<br>Incorrect arguments range.",\r\n
            errorUnexpectedGuid: "External error.<br>Unexpected Guid. Please, contact support.",\r\n
            errorDatabaseConnection: "External error.<br>Database connection error. Please, contact support.",\r\n
            errorFileRequest: "External error.<br>File Request. Please, contact support.",\r\n
            errorFileVKey: "External error.<br>Incorrect securety key. Please, contact support.",\r\n
            errorStockChart: "Incorrect row order. To build a stock chart place the data on the sheet in the following order:<br> opening price, max price, min price, closing price.",\r\n
            errorDataRange: "Incorrect data range.",\r\n
            errorOperandExpected: "Operand expected",\r\n
            errorKeyEncrypt: "Unknown key descriptor",\r\n
            errorKeyExpire: "Key descriptor expired",\r\n
            errorUsersExceed: "Count of users was exceed",\r\n
            errorMoveRange: "Cann\'t change a part of merged cell",\r\n
            errorBadImageUrl: "Image url is incorrect",\r\n
            errorCoAuthoringDisconnect: "Server connection lost. You can\'t edit anymore.",\r\n
            errorFilePassProtect: "The document is password protected.",\r\n
            txtEditingMode: "Set editing mode...",\r\n
            textLoadingDocument: "LOADING DOCUMENT",\r\n
            textConfirm: "Confirmation",\r\n
            confirmMoveCellRange: "The destination cell\'s range can contain data. Continue the operation?",\r\n
            textYes : "Yes",\r\n
            textNo: "No",\r\n
            textAnonymous: "Anonymous",\r\n
            txtBasicShapes: "Basic Shapes",\r\n
            txtFiguredArrows: "Figured Arrows",\r\n
            txtMath: "Math",\r\n
            txtCharts: "Charts",\r\n
            txtStarsRibbons: "Stars & Ribbons",\r\n
            txtCallouts: "Callouts",\r\n
            txtButtons: "Buttons",\r\n
            txtRectangles: "Rectangles",\r\n
            txtLines: "Lines",\r\n
            txtDiagramTitle: "Diagram Title",\r\n
            txtXAxis: "X Axis",\r\n
            txtYAxis: "Y Axis",\r\n
            txtSeries: "Seria",\r\n
            warnProcessRightsChange: "You have been denied the right to edit the file.",\r\n
            errorProcessSaveResult: "Saving is failed.",\r\n
            errorAutoFilterDataRange: "The operation could not be done for the selected range of cells.<br>Select a uniform data range inside or outside the tableÂ and try again.",\r\n
            errorAutoFilterChangeFormatTable: "The operation could not be done for the selected cells as you cannot move a part of the table.<br>Select another data range so that the whole table was shifted and try again.",\r\n
            errorAutoFilterChange: "The operation is not allowed, as it is attempting to shift cells in a table on your worksheet.",\r\n
            textCloseTip: "\\nClick to close the tip.",\r\n
            textShape: "Shape",\r\n
            errorFillRange: "Could not fill the selected range of cells.<br>All the merged cells need to be the same size.",\r\n
            errorUpdateVersion: "The file version has been changed. The page will be reloaded.",\r\n
            defaultTitleText: "ONLYOFFICE Spreadsheet Editor",\r\n
            errorUserDrop: "The file cannot be accessed right now."\r\n
        };\r\n
    })(), SSE.Controllers.Main || {}));\r\n
});\n
\n
define(\'text!spreadsheeteditor/main/app/template/PrintSettings.template\',[],function () { return \'<div class="settings-panel active">\\r\\n    <div class="padding-large inner-content" >\\r\\n        <div id="printadv-dlg-radio-current" class="padding-small" style="display: block;"></div>\\r\\n        <div id="printadv-dlg-radio-all" class="padding-small" style="display: block;"></div>\\r\\n        <div id="printadv-dlg-radio-selection" style="display: block;"></div>\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"/>\\r\\n    <div class="padding-large inner-content" >\\r\\n        <div id="printadv-dlg-combo-pages" class="input-group-nr" />\\r\\n    </div>\\r\\n    <div class="separator horizontal padding-large"/>\\r\\n    <div class="padding-large inner-content" >\\r\\n        <span id="printadv-dlg-combo-orient" />\\r\\n    </div>\\r\\n    <div id="printadv-dlg-content-to-hide">\\r\\n        <div class="separator horizontal padding-large"/>\\r\\n        <div class="padding-large inner-content" >\\r\\n            <table cols="2" class="no-padding">\\r\\n            <tr>\\r\\n                <td><label><%= scope.strTop %></label></td>\\r\\n                <td><label><%= scope.strBottom %></label></td>\\r\\n                </tr>\\r\\n            <tr>\\r\\n                <td class="padding-small"><div id="printadv-dlg-spin-margin-top" style="margin-right: 15px;"></div></td>\\r\\n                <td class="padding-small"><div id="printadv-dlg-spin-margin-bottom"></div></td>\\r\\n            </tr>\\r\\n            <tr>\\r\\n                <td><label><%= scope.strLeft %></label></td>\\r\\n                <td><label><%= scope.strRight %></label></td>\\r\\n                </tr>\\r\\n            <tr>\\r\\n                <td><div id="printadv-dlg-spin-margin-left" style="margin-right: 15px;"></div></td>\\r\\n                <td><div id="printadv-dlg-spin-margin-right"></div></td>\\r\\n                </tr>\\r\\n            </table>\\r\\n        </div>\\r\\n        <div class="separator horizontal padding-large"/>\\r\\n        <!--<div class="padding-large inner-content" >-->\\r\\n            <!--<div id="printadv-dlg-radio-actual" class="padding-small" style="display: block;"></div>-->\\r\\n            <!--<div id="printadv-dlg-radio-fit" class="" style="display: block;"></div>-->\\r\\n        <!--</div>-->\\r\\n        <!--<div class="separator horizontal padding-large"/>-->\\r\\n        <div class="inner-content">\\r\\n            <div id="printadv-dlg-chb-grid" style="margin-bottom: 10px;"/>\\r\\n            <div id="printadv-dlg-chb-rows"/>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\';});\n
\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/view/PrintSettings\',["text!spreadsheeteditor/main/app/template/PrintSettings.template", "common/main/lib/view/AdvancedSettingsWindow", "common/main/lib/component/MetricSpinner", "common/main/lib/component/CheckBox", "common/main/lib/component/RadioBox", "common/main/lib/component/ListView"], function (contentTemplate) {\r\n
    SSE.Views.PrintSettings = Common.Views.AdvancedSettingsWindow.extend(_.extend({\r\n
        options: {\r\n
            alias: "PrintSettings",\r\n
            contentWidth: 280,\r\n
            height: 482\r\n
        },\r\n
        initialize: function (options) {\r\n
            _.extend(this.options, {\r\n
                title: this.textTitle,\r\n
                template: [\'<div class="box" style="height:\' + (this.options.height - 85) + \'px;">\', \'<div class="menu-panel" style="overflow: hidden;">\', \'<div style="height: 90px; line-height: 90px;" class="div-category">\' + this.textPrintRange + "</div>", \'<div style="height: 55px; line-height: 55px;" class="div-category">\' + this.textPageSize + "</div>", \'<div style="height: 55px; line-height: 55px;" class="div-category">\' + this.textPageOrientation + "</div>", \'<div style="height: 122px; line-height: 122px;" class="div-category">\' + this.strMargins + "</div>", \'<div style="height: 73px; line-height: 73px;" class="div-category">\' + this.strPrint + "</div>", "</div>", \'<div class="separator"/>\', \'<div class="content-panel">\' + _.template(contentTemplate)({\r\n
                    scope: this\r\n
                }) + "</div>", "</div>", \'<div class="separator horizontal"/>\', \'<div class="footer justify">\', \'<button id="printadv-dlg-btn-hide" class="btn btn-text-default" style="margin-right: 55px; width: 100px;">\' + this.textHideDetails + "</button>", \'<button class="btn normal dlg-btn primary" result="ok" style="margin-right: 10px;  width: 150px;">\' + this.btnPrint + "</button>", \'<button class="btn normal dlg-btn" result="cancel" style="width: 86px;">\' + this.cancelButtonText + "</button>", "</div>"].join("")\r\n
            },\r\n
            options);\r\n
            Common.Views.AdvancedSettingsWindow.prototype.initialize.call(this, this.options);\r\n
            this.spinners = [];\r\n
        },\r\n
        render: function () {\r\n
            Common.Views.AdvancedSettingsWindow.prototype.render.call(this);\r\n
            this.radioCurrent = new Common.UI.RadioBox({\r\n
                el: $("#printadv-dlg-radio-current"),\r\n
                labelText: this.textCurrentSheet,\r\n
                name: "asc-radio-printrange",\r\n
                checked: true\r\n
            });\r\n
            this.radioCurrent.on("change", _.bind(this.onRadioRangeChange, this));\r\n
            this.radioAll = new Common.UI.RadioBox({\r\n
                el: $("#printadv-dlg-radio-all"),\r\n
                labelText: this.textAllSheets,\r\n
                name: "asc-radio-printrange"\r\n
            });\r\n
            this.radioAll.on("change", _.bind(this.onRadioRangeChange, this));\r\n
            this.radioSelection = new Common.UI.RadioBox({\r\n
                el: $("#printadv-dlg-radio-selection"),\r\n
                labelText: this.textSelection,\r\n
                name: "asc-radio-printrange"\r\n
            });\r\n
            this.radioSelection.on("change", _.bind(this.onRadioRangeChange, this));\r\n
            this.cmbPaperSize = new Common.UI.ComboBox({\r\n
                el: $("#printadv-dlg-combo-pages"),\r\n
                style: "width: 260px;",\r\n
                menuStyle: "max-height: 280px; min-width: 260px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: "215.9|279.4",\r\n
                    displayValue: "US Letter (21,59cm x 27,94cm)"\r\n
                },\r\n
                {\r\n
                    value: "215.9|355.6",\r\n
                    displayValue: "US Legal (21,59cm x 35,56cm)"\r\n
                },\r\n
                {\r\n
                    value: "210|297",\r\n
                    displayValue: "A4 (21cm x 29,7cm)"\r\n
                },\r\n
                {\r\n
                    value: "148.1|209.9",\r\n
                    displayValue: "A5 (14,81cm x 20,99cm)"\r\n
                },\r\n
                {\r\n
                    value: "176|250.1",\r\n
                    displayValue: "B5 (17,6cm x 25,01cm)"\r\n
                },\r\n
                {\r\n
                    value: "104.8|241.3",\r\n
                    displayValue: "Envelope #10 (10,48cm x 24,13cm)"\r\n
                },\r\n
                {\r\n
                    value: "110.1|220.1",\r\n
                    displayValue: "Envelope DL (11,01cm x 22,01cm)"\r\n
                },\r\n
                {\r\n
                    value: "279.4|431.7",\r\n
                    displayValue: "Tabloid (27,94cm x 43,17cm)"\r\n
                },\r\n
                {\r\n
                    value: "297|420.1",\r\n
                    displayValue: "A3 (29,7cm x 42,01cm)"\r\n
                },\r\n
                {\r\n
                    value: "304.8|457.1",\r\n
                    displayValue: "Tabloid Oversize (30,48cm x 45,71cm)"\r\n
                },\r\n
                {\r\n
                    value: "196.8|273",\r\n
                    displayValue: "ROC 16K (19,68cm x 27,3cm)"\r\n
                },\r\n
                {\r\n
                    value: "119.9|234.9",\r\n
                    displayValue: "Envelope Choukei 3 (11,99cm x 23,49cm)"\r\n
                },\r\n
                {\r\n
                    value: "330.2|482.5",\r\n
                    displayValue: "Super B/A3 (33,02cm x 48,25cm)"\r\n
                }]\r\n
            });\r\n
            this.cmbPaperOrientation = new Common.UI.ComboBox({\r\n
                el: $("#printadv-dlg-combo-orient"),\r\n
                style: "width: 115px;",\r\n
                menuStyle: "min-width: 115px;",\r\n
                editable: false,\r\n
                cls: "input-group-nr",\r\n
                data: [{\r\n
                    value: c_oAscPageOrientation.PagePortrait,\r\n
                    displayValue: this.strPortrait\r\n
                },\r\n
                {\r\n
                    value: c_oAscPageOrientation.PageLandscape,\r\n
                    displayValue: this.strLandscape\r\n
                }]\r\n
            });\r\n
            this.chPrintGrid = new Common.UI.CheckBox({\r\n
                el: $("#printadv-dlg-chb-grid"),\r\n
                labelText: this.textPrintGrid\r\n
            });\r\n
            this.chPrintRows = new Common.UI.CheckBox({\r\n
                el: $("#printadv-dlg-chb-rows"),\r\n
                labelText: this.textPrintHeadings\r\n
            });\r\n
            this.spnMarginTop = new Common.UI.MetricSpinner({\r\n
                el: $("#printadv-dlg-spin-margin-top"),\r\n
                step: 0.1,\r\n
                width: 115,\r\n
                defaultUnit: "cm",\r\n
                value: "0 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginTop);\r\n
            this.spnMarginBottom = new Common.UI.MetricSpinner({\r\n
                el: $("#printadv-dlg-spin-margin-bottom"),\r\n
                step: 0.1,\r\n
                width: 115,\r\n
                defaultUnit: "cm",\r\n
                value: "0 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginBottom);\r\n
            this.spnMarginLeft = new Common.UI.MetricSpinner({\r\n
                el: $("#printadv-dlg-spin-margin-left"),\r\n
                step: 0.1,\r\n
                width: 115,\r\n
                defaultUnit: "cm",\r\n
                value: "0.19 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginLeft);\r\n
            this.spnMarginRight = new Common.UI.MetricSpinner({\r\n
                el: $("#printadv-dlg-spin-margin-right"),\r\n
                step: 0.1,\r\n
                width: 115,\r\n
                defaultUnit: "cm",\r\n
                value: "0.19 cm",\r\n
                maxValue: 48.25,\r\n
                minValue: 0\r\n
            });\r\n
            this.spinners.push(this.spnMarginRight);\r\n
            this.btnHide = new Common.UI.Button({\r\n
                el: $("#printadv-dlg-btn-hide")\r\n
            });\r\n
            this.btnHide.on("click", _.bind(this.handlerShowDetails, this));\r\n
            this.panelDetails = $("#printadv-dlg-content-to-hide");\r\n
            this.updateMetricUnit();\r\n
            this.options.afterrender && this.options.afterrender.call(this);\r\n
        },\r\n
        setRange: function (value) {\r\n
            (value == c_oAscPrintType.ActiveSheets) ? this.radioCurrent.setValue(true) : ((value == c_oAscPrintType.EntireWorkbook) ? this.radioAll.setValue(true) : this.radioSelection.setValue(true));\r\n
        },\r\n
        setLayout: function (value) {},\r\n
        getRange: function () {\r\n
            return (this.radioCurrent.getValue() ? c_oAscPrintType.ActiveSheets : (this.radioAll.getValue() ? c_oAscPrintType.EntireWorkbook : c_oAscPrintType.Selection));\r\n
        },\r\n
        getLayout: function () {},\r\n
        onRadioRangeChange: function (radio, newvalue) {\r\n
            if (newvalue) {\r\n
                this.fireEvent("changerange", this);\r\n
            }\r\n
        },\r\n
        updateMetricUnit: function () {\r\n
            if (this.spinners) {\r\n
                for (var i = 0; i < this.spinners.length; i++) {\r\n
                    var spinner = this.spinners[i];\r\n
                    spinner.setDefaultUnit(Common.Utils.Metric.metricName[Common.Utils.Metric.getCurrentMetric()]);\r\n
                    spinner.setStep(Common.Utils.Metric.getCurrentMetric() == Common.Utils.Metric.c_MetricUnits.cm ? 0.1 : 1);\r\n
                }\r\n
            }\r\n
        },\r\n
        handlerShowDetails: function (btn) {\r\n
            if (!this.extended) {\r\n
                this.extended = true;\r\n
                this.panelDetails.css({\r\n
                    "display": "none"\r\n
                });\r\n
                this.setHeight(286);\r\n
                btn.setCaption(this.textShowDetails);\r\n
            } else {\r\n
                this.extended = false;\r\n
                this.panelDetails.css({\r\n
                    "display": "block"\r\n
                });\r\n
                this.setHeight(482);\r\n
                btn.setCaption(this.textHideDetails);\r\n
            }\r\n
        },\r\n
        textTitle: "Print Settings",\r\n
        strLeft: "Left",\r\n
        strRight: "Right",\r\n
        strTop: "Top",\r\n
        strBottom: "Bottom",\r\n
        strPortrait: "Portrait",\r\n
        strLandscape: "Landscape",\r\n
        textPrintGrid: "Print Gridlines",\r\n
        textPrintHeadings: "Print Rows and Columns Headings",\r\n
        textPageSize: "Page Size",\r\n
        textPageOrientation: "Page Orientation",\r\n
        strMargins: "Margins",\r\n
        strPrint: "Print",\r\n
        btnPrint: "Save & Print",\r\n
        textPrintRange: "Print Range",\r\n
        textLayout: "Layout",\r\n
        textCurrentSheet: "Current Sheet",\r\n
        textAllSheets: "All Sheets",\r\n
        textSelection: "Selection",\r\n
        textActualSize: "Actual Size",\r\n
        textFit: "Fit to width",\r\n
        textShowDetails: "Show Details",\r\n
        cancelButtonText: "Cancel",\r\n
        textHideDetails: "Hide Details"\r\n
    },\r\n
    SSE.Views.PrintSettings || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'spreadsheeteditor/main/app/controller/Print\',["core", "spreadsheeteditor/main/app/view/FileMenuPanels", "spreadsheeteditor/main/app/view/PrintSettings"], function () {\r\n
    SSE.Controllers.Print = Backbone.Controller.extend(_.extend({\r\n
        views: ["MainSettingsPrint"],\r\n
        initialize: function () {\r\n
            this.adjPrintParams = new Asc.asc_CAdjustPrint();\r\n
            this.adjPrintParams.asc_setPrintType(c_oAscPrintType.ActiveSheets);\r\n
            this.adjPrintParams.asc_setLayoutPageType(c_oAscLayoutPageType.ActualSize);\r\n
            this.diffParams = {};\r\n
            this.addListeners({\r\n
                "MainSettingsPrint": {\r\n
                    "show": _.bind(this.onShowMainSettingsPrint, this),\r\n
                    "render:after": _.bind(this.onAfterRender, this)\r\n
                },\r\n
                "Statusbar": {\r\n
                    "updatesheetsinfo": _.bind(function () {\r\n
                        if (this.printSettings.isVisible()) {\r\n
                            this.updateSettings();\r\n
                        } else {\r\n
                            this.isFillSheets = false;\r\n
                            this.diffParams = {};\r\n
                        }\r\n
                    },\r\n
                    this)\r\n
                },\r\n
                "PrintSettings": {\r\n
                    "changerange": _.bind(this.onChangeRange, this)\r\n
                }\r\n
            });\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.printSettings = this.createView("MainSettingsPrint");\r\n
        },\r\n
        onAfterRender: function (view) {\r\n
            this.printSettings.cmbSheet.on("selected", _.bind(this.comboSheetsChange, this));\r\n
            this.printSettings.btnOk.on("click", _.bind(this.querySavePrintSettings, this));\r\n
            var toolbar = SSE.getController("Toolbar").getView("Toolbar");\r\n
            if (toolbar) {\r\n
                toolbar.mnuPrint.on("item:click", _.bind(this.openPrintSettings, this));\r\n
            }\r\n
        },\r\n
        setApi: function (o) {\r\n
            this.api = o;\r\n
        },\r\n
        updateSettings: function () {\r\n
            var wc = this.api.asc_getWorksheetsCount(),\r\n
            i = -1;\r\n
            var items = [{\r\n
                displayValue: this.strAllSheets,\r\n
                value: -255\r\n
            }];\r\n
            while (++i < wc) {\r\n
                if (!this.api.asc_isWorksheetHidden(i)) {\r\n
                    items.push({\r\n
                        displayValue: this.api.asc_getWorksheetName(i),\r\n
                        value: i\r\n
                    });\r\n
                }\r\n
            }\r\n
            this.printSettings.cmbSheet.store.reset(items);\r\n
            var item = this.printSettings.cmbSheet.store.findWhere({\r\n
                value: this.printSettings.cmbSheet.getValue()\r\n
            }) || this.printSettings.cmbSheet.store.findWhere({\r\n
                value: this.api.asc_getActiveWorksheetIndex()\r\n
            });\r\n
            if (item) {\r\n
                this.printSettings.cmbSheet.setValue(item.get("value"));\r\n
            }\r\n
        },\r\n
        comboSheetsChange: function (combo, record) {\r\n
            var newvalue = record.value;\r\n
            if (newvalue == -255) {\r\n
                this.indeterminatePageOptions(this.printSettings);\r\n
            } else {\r\n
                this.fillPageOptions(this.printSettings, this.api.asc_getPageOptions(newvalue));\r\n
            }\r\n
        },\r\n
        isDiffRefill: function () {\r\n
            for (var item in this.diffParams) {\r\n
                if (this.diffParams[item] == undefined) {\r\n
                    return true;\r\n
                }\r\n
            }\r\n
            return item == undefined;\r\n
        },\r\n
        indeterminatePageOptions: function (panel) {\r\n
            if (this.isDiffRefill()) {\r\n
                var wc = this.api.asc_getWorksheetsCount();\r\n
                if (wc == 1) {\r\n
                    this.diffParams.orientation = false;\r\n
                    this.diffParams.size = false;\r\n
                    this.diffParams.headings = false;\r\n
                    this.diffParams.grid = false;\r\n
                    this.diffParams.margintop = false;\r\n
                    this.diffParams.marginright = false;\r\n
                    this.diffParams.marginbottom = false;\r\n
                    this.diffParams.marginleft = false;\r\n
                } else {\r\n
                    var index = 0;\r\n
                    var opts = this.api.asc_getPageOptions(index),\r\n
                    opts_next;\r\n
                    while (++index < wc) {\r\n
                        opts_next = this.api.asc_getPageOptions(index);\r\n
                        if (this.diffParams.orientation == undefined) {\r\n
                            this.diffParams.orientation = opts.asc_getPageSetup().asc_getOrientation() != opts_next.asc_getPageSetup().asc_getOrientation();\r\n
                        }\r\n
                        if (this.diffParams.size == undefined) {\r\n
                            this.diffParams.size = (opts.asc_getPageSetup().asc_getWidth() != opts_next.asc_getPageSetup().asc_getWidth() || opts.asc_getPageSetup().asc_getHeight() != opts_next.asc_getPageSetup().asc_getHeight());\r\n
                        }\r\n
                        if (this.diffParams.headings == undefined) {\r\n
                            this.diffParams.headings = opts.asc_getHeadings() != opts_next.asc_getHeadings();\r\n
                        }\r\n
                        if (this.diffParams.grid == undefined) {\r\n
                            this.diffParams.grid = opts.asc_getGridLines() != opts_next.asc_getGridLines();\r\n
                        }\r\n
                        if (this.diffParams.margintop == undefined) {\r\n
                            this.diffParams.margintop = Math.abs(opts.asc_getPageMargins().asc_getTop() - opts_next.asc_getPageMargins().asc_getTop()) > 0.001;\r\n
                        }\r\n
                        if (this.diffParams.marginright == undefined) {\r\n
                            this.diffParams.marginright = Math.abs(opts.asc_getPageMargins().asc_getRight() - opts_next.asc_getPageMargins().asc_getRight()) > 0.001;\r\n
                        }\r\n
                        if (this.diffParams.marginbottom == undefined) {\r\n
                            this.diffParams.marginbottom = Math.abs(opts.asc_getPageMargins().asc_getBottom() - opts_next.asc_getPageMargins().asc_getBottom()) > 0.001;\r\n
                        }\r\n
                        if (this.diffParams.marginleft == undefined) {\r\n
                            this.diffParams.marginleft = Math.abs(opts.asc_getPageMargins().asc_getLeft() - opts_next.asc_getPageMargins().asc_getLeft()) > 0.001;\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (this.diffParams.orientation) {\r\n
                panel.cmbPaperOrientation.setValue("-");\r\n
            }\r\n
            if (this.diffParams.size) {\r\n
                panel.cmbPaperSize.setValue("-");\r\n
            }\r\n
            if (this.diffParams.margintop) {\r\n
                panel.spnMarginTop.setValue("-");\r\n
            }\r\n
            if (this.diffParams.marginright) {\r\n
                panel.spnMarginRight.setValue("-");\r\n
            }\r\n
            if (this.diffParams.marginbottom) {\r\n
                panel.spnMarginBottom.setValue("-");\r\n
            }\r\n
            if (this.diffParams.marginleft) {\r\n
                panel.spnMarginLeft.setValue("-");\r\n
            }\r\n
            if (this.diffParams.grid) {\r\n
                panel.chPrintGrid.setValue("indeterminate");\r\n
            }\r\n
            if (this.diffParams.headings) {\r\n
                panel.chPrintRows.setValue("indeterminate");\r\n
            }\r\n
        },\r\n
        fillPageOptions: function (panel, props) {\r\n
            var opt = props.asc_getPageSetup();\r\n
            var item = panel.cmbPaperOrientation.store.findWhere({\r\n
                value: opt.asc_getOrientation()\r\n
            });\r\n
            if (item) {\r\n
                panel.cmbPaperOrientation.setValue(item.get("value"));\r\n
            }\r\n
            var w = opt.asc_getWidth();\r\n
            var h = opt.asc_getHeight();\r\n
            item = panel.cmbPaperSize.store.findWhere({\r\n
                value: w + "|" + h\r\n
            });\r\n
            if (item) {\r\n
                panel.cmbPaperSize.setValue(item.get("value"));\r\n
            } else {\r\n
                panel.cmbPaperSize.setValue("Custom (" + w + " x " + h);\r\n
            }\r\n
            opt = props.asc_getPageMargins();\r\n
            panel.spnMarginLeft.setValue(Common.Utils.Metric.fnRecalcFromMM(opt.asc_getLeft()));\r\n
            panel.spnMarginTop.setValue(Common.Utils.Metric.fnRecalcFromMM(opt.asc_getTop()));\r\n
            panel.spnMarginRight.setValue(Common.Utils.Metric.fnRecalcFromMM(opt.asc_getRight()));\r\n
            panel.spnMarginBottom.setValue(Common.Utils.Metric.fnRecalcFromMM(opt.asc_getBottom()));\r\n
            panel.chPrintGrid.setValue(props.asc_getGridLines());\r\n
            panel.chPrintRows.setValue(props.asc_getHeadings());\r\n
        },\r\n
        fillPrintOptions: function (panel, props) {\r\n
            panel.setRange(props.asc_getPrintType());\r\n
        },\r\n
        getPageOptions: function (panel) {\r\n
            var props = new Asc.asc_CPageOptions();\r\n
            props.asc_setGridLines(panel.chPrintGrid.getValue() == "indeterminate" ? undefined : panel.chPrintGrid.getValue() == "checked" ? 1 : 0);\r\n
            props.asc_setHeadings(panel.chPrintRows.getValue() == "indeterminate" ? undefined : panel.chPrintRows.getValue() == "checked" ? 1 : 0);\r\n
            var opt = new Asc.asc_CPageSetup();\r\n
            opt.asc_setOrientation(panel.cmbPaperOrientation.getValue() == "-" ? undefined : panel.cmbPaperOrientation.getValue());\r\n
            var pagew = /^\\d{3}\\.?\\d*/.exec(panel.cmbPaperSize.getValue());\r\n
            var pageh = /\\d{3}\\.?\\d*$/.exec(panel.cmbPaperSize.getValue());\r\n
            opt.asc_setWidth(!pagew ? undefined : parseFloat(pagew[0]));\r\n
            opt.asc_setHeight(!pageh ? undefined : parseFloat(pageh[0]));\r\n
            props.asc_setPageSetup(opt);\r\n
            opt = new Asc.asc_CPageMargins();\r\n
            opt.asc_setLeft(panel.spnMarginLeft.getValue() == "-" ? undefined : Common.Utils.Metric.fnRecalcToMM(panel.spnMarginLeft.getNumberValue()));\r\n
            opt.asc_setTop(panel.spnMarginTop.getValue() == "-" ? undefined : Common.Utils.Metric.fnRecalcToMM(panel.spnMarginTop.getNumberValue()));\r\n
            opt.asc_setRight(panel.spnMarginRight.getValue() == "-" ? undefined : Common.Utils.Metric.fnRecalcToMM(panel.spnMarginRight.getNumberValue()));\r\n
            opt.asc_setBottom(panel.spnMarginBottom.getValue() == "-" ? undefined : Common.Utils.Metric.fnRecalcToMM(panel.spnMarginBottom.getNumberValue()));\r\n
            props.asc_setPageMargins(opt);\r\n
            return props;\r\n
        },\r\n
        savePageOptions: function (panel, index) {\r\n
            var opts = this.getPageOptions(panel);\r\n
            if (index == -255) {\r\n
                var wc = this.api.asc_getWorksheetsCount();\r\n
                index = -1;\r\n
                while (++index < wc) {\r\n
                    this.api.asc_setPageOptions(opts, index);\r\n
                }\r\n
                if (this.diffParams.orientation) {\r\n
                    this.diffParams.orientation = opts.asc_getPageSetup().asc_getOrientation() == undefined;\r\n
                }\r\n
                if (this.diffParams.size) {\r\n
                    this.diffParams.size = (opts.asc_getPageSetup().asc_getWidth() == undefined || opts.asc_getPageSetup().asc_getHeight() == undefined);\r\n
                }\r\n
                if (this.diffParams.headings) {\r\n
                    this.diffParams.headings = opts.asc_getHeadings() == undefined;\r\n
                }\r\n
                if (this.diffParams.grid) {\r\n
                    this.diffParams.grid = opts.asc_getGridLines() == undefined;\r\n
                }\r\n
                if (this.diffParams.margintop) {\r\n
                    this.diffParams.margintop = opts.asc_getPageMargins().asc_getTop() == undefined;\r\n
                }\r\n
                if (this.diffParams.marginright) {\r\n
                    this.diffParams.marginright = opts.asc_getPageMargins().asc_getRight() == undefined;\r\n
                }\r\n
                if (this.diffParams.marginbottom) {\r\n
                    this.diffParams.marginbottom = opts.asc_getPageMargins().asc_getBottom() == undefined;\r\n
                }\r\n
                if (this.diffParams.marginleft) {\r\n
                    this.diffParams.marginleft = opts.asc_getPageMargins().asc_getLeft() == undefined;\r\n
                }\r\n
            } else {\r\n
                this.api.asc_setPageOptions(opts, index);\r\n
                this.diffParams = {};\r\n
            }\r\n
        },\r\n
        onShowMainSettingsPrint: function () {\r\n
            if (!this.isFillSheets) {\r\n
                this.isFillSheets = true;\r\n
                this.updateSettings();\r\n
            }\r\n
            if (!this.isUpdatedSettings) {\r\n
                this.isUpdatedSettings = true;\r\n
                var item = this.printSettings.cmbSheet.store.findWhere({\r\n
                    value: this.api.asc_getActiveWorksheetIndex()\r\n
                });\r\n
                if (item) {\r\n
                    this.printSettings.cmbSheet.setValue(item.get("value"));\r\n
                    this.comboSheetsChange(this.printSettings.cmbSheet, item.toJSON());\r\n
                }\r\n
            }\r\n
        },\r\n
        openPrintSettings: function (menu, item) {\r\n
            if (item.value === "options" && this.api) {\r\n
                this.printSettingsDlg = (new SSE.Views.PrintSettings({\r\n
                    handler: _.bind(this.resultPrintSettings, this),\r\n
                    afterrender: _.bind(function () {\r\n
                        this.fillPageOptions(this.printSettingsDlg, this.api.asc_getPageOptions());\r\n
                        this.fillPrintOptions(this.printSettingsDlg, this.adjPrintParams);\r\n
                    },\r\n
                    this)\r\n
                }));\r\n
                this.printSettingsDlg.show();\r\n
            }\r\n
        },\r\n
        resultPrintSettings: function (result, value) {\r\n
            var view = SSE.getController("Toolbar").getView("Toolbar");\r\n
            if (result == "ok") {\r\n
                if (this.checkMargins(this.printSettingsDlg)) {\r\n
                    this.savePageOptions(this.printSettingsDlg, this.printSettingsDlg.getRange() == c_oAscPrintType.EntireWorkbook ? -255 : undefined);\r\n
                    this.adjPrintParams.asc_setPrintType(this.printSettingsDlg.getRange());\r\n
                    this.api.asc_Print(this.adjPrintParams);\r\n
                    this.isUpdatedSettings = false;\r\n
                } else {\r\n
                    return true;\r\n
                }\r\n
            }\r\n
            Common.NotificationCenter.trigger("edit:complete", view);\r\n
        },\r\n
        onChangeRange: function () {\r\n
            var newvalue = this.printSettingsDlg.getRange();\r\n
            if (newvalue == c_oAscPrintType.EntireWorkbook) {\r\n
                this.indeterminatePageOptions(this.printSettingsDlg);\r\n
            } else {\r\n
                if (this.lastCheckedRange == c_oAscPrintType.EntireWorkbook) {\r\n
                    this.fillPageOptions(this.printSettingsDlg, this.api.asc_getPageOptions());\r\n
                }\r\n
            }\r\n
            this.lastCheckedRange = newvalue;\r\n
        },\r\n
        querySavePrintSettings: function () {\r\n
            if (this.checkMargins(this.printSettings)) {\r\n
                this.savePageOptions(this.printSettings, this.printSettings.cmbSheet.getValue());\r\n
                this.printSettings.applySettings();\r\n
            }\r\n
        },\r\n
        checkMargins: function (panel) {\r\n
            if (panel.cmbPaperOrientation.getValue() == c_oAscPageOrientation.PagePortrait) {\r\n
                var pagewidth = /^\\d{3}\\.?\\d*/.exec(panel.cmbPaperSize.getValue());\r\n
                var pageheight = /\\d{3}\\.?\\d*$/.exec(panel.cmbPaperSize.getValue());\r\n
            } else {\r\n
                pageheight = /^\\d{3}\\.?\\d*/.exec(panel.cmbPaperSize.getValue());\r\n
                pagewidth = /\\d{3}\\.?\\d*$/.exec(panel.cmbPaperSize.getValue());\r\n
            }\r\n
            pagewidth = parseFloat(pagewidth[0]);\r\n
            pageheight = parseFloat(pageheight[0]);\r\n
            var ml = Common.Utils.Metric.fnRecalcToMM(panel.spnMarginLeft.getNumberValue());\r\n
            var mr = Common.Utils.Metric.fnRecalcToMM(panel.spnMarginRight.getNumberValue());\r\n
            var mt = Common.Utils.Metric.fnRecalcToMM(panel.spnMarginTop.getNumberValue());\r\n
            var mb = Common.Utils.Metric.fnRecalcToMM(panel.spnMarginBottom.getNumberValue());\r\n
            var result = false;\r\n
            if (ml > pagewidth) {\r\n
                result = "left";\r\n
            } else {\r\n
                if (mr > pagewidth - ml) {\r\n
                    result = "right";\r\n
                } else {\r\n
                    if (mt > pageheight) {\r\n
                        result = "top";\r\n
                    } else {\r\n
                        if (mb > pageheight - mt) {\r\n
                            result = "bottom";\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            if (result) {\r\n
                Common.UI.warning({\r\n
                    title: this.textWarning,\r\n
                    msg: this.warnCheckMargings,\r\n
                    callback: function (btn, text) {\r\n
                        switch (result) {\r\n
                        case "left":\r\n
                            panel.spnMarginLeft.$el.focus();\r\n
                            return;\r\n
                        case "right":\r\n
                            panel.spnMarginRight.$el.focus();\r\n
                            return;\r\n
                        case "top":\r\n
                            panel.spnMarginTop.$el.focus();\r\n
                            return;\r\n
                        case "bottom":\r\n
                            panel.spnMarginBottom.$el.focus();\r\n
                            return;\r\n
                        }\r\n
                    }\r\n
                });\r\n
                return false;\r\n
            }\r\n
            return true;\r\n
        },\r\n
        warnCheckMargings: "Margins are incorrect",\r\n
        strAllSheets: "All Sheets",\r\n
        textWarning: "Warning"\r\n
    },\r\n
    SSE.Controllers.Print || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Models = Common.Models || {};\r\n
define(\'common/main/lib/model/Comment\',["underscore", "backbone", "common/main/lib/component/BaseView"], function (_, Backbone) {\r\n
    Common.Models.Comment = Backbone.Model.extend({\r\n
        defaults: {\r\n
            uid: 0,\r\n
            userid: 0,\r\n
            username: "Guest",\r\n
            date: undefined,\r\n
            quote: "",\r\n
            comment: "",\r\n
            resolved: false,\r\n
            lock: false,\r\n
            lockuserid: "",\r\n
            unattached: false,\r\n
            id: Common.UI.getId(),\r\n
            time: 0,\r\n
            showReply: false,\r\n
            showReplyInPopover: false,\r\n
            editText: false,\r\n
            editTextInPopover: false,\r\n
            last: undefined,\r\n
            replys: [],\r\n
            hideAddReply: false,\r\n
            scope: null,\r\n
            hide: false,\r\n
            hint: false,\r\n
            dummy: undefined\r\n
        }\r\n
    });\r\n
    Common.Models.Reply = Backbone.Model.extend({\r\n
        defaults: {\r\n
            time: 0,\r\n
            userid: 0,\r\n
            username: "Guest",\r\n
            reply: "",\r\n
            date: undefined,\r\n
            id: Common.UI.getId(),\r\n
            editText: false,\r\n
            editTextInPopover: false,\r\n
            scope: null\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Collections = Common.Collections || {};\r\n
define(\'common/main/lib/collection/Comments\',["underscore", "backbone", "common/main/lib/model/Comment"], function (_, Backbone) {\r\n
    Common.Collections.Comments = Backbone.Collection.extend({\r\n
        model: Common.Models.Comment,\r\n
        clearEditing: function () {\r\n
            this.each(function (comment) {\r\n
                comment.set("editText", false);\r\n
                comment.set("editTextInPopover", false);\r\n
                comment.set("showReply", false);\r\n
                comment.set("showReplyInPopover", false);\r\n
                comment.set("hideAddReply", false);\r\n
            });\r\n
        },\r\n
        getCommentsReplysCount: function (userid) {\r\n
            var cnt = 0;\r\n
            this.each(function (comment) {\r\n
                if (comment.get("userid") == userid) {\r\n
                    cnt++;\r\n
                }\r\n
                var rpl = comment.get("replys");\r\n
                if (rpl && rpl.length > 0) {\r\n
                    rpl.forEach(function (reply) {\r\n
                        if (reply.get("userid") == userid) {\r\n
                            cnt++;\r\n
                        }\r\n
                    });\r\n
                }\r\n
            });\r\n
            return cnt;\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 if (Common === undefined) {\r\n
    var Common = {};\r\n
}\r\n
Common.Controllers = Common.Controllers || {};\r\n
define(\'common/main/lib/controller/Comments\',["core", "common/main/lib/model/Comment", "common/main/lib/collection/Comments", "common/main/lib/view/Comments"], function () {\r\n
    function buildCommentData() {\r\n
        if (typeof asc_CCommentDataWord !== "undefined") {\r\n
            return new asc_CCommentDataWord(null);\r\n
        }\r\n
        return new asc_CCommentData(null);\r\n
    }\r\n
    Common.Controllers.Comments = Backbone.Controller.extend(_.extend({\r\n
        models: [],\r\n
        collections: ["Common.Collections.Comments"],\r\n
        views: ["Common.Views.Comments", "Common.Views.CommentsPopover"],\r\n
        sdkViewName: "#id_main",\r\n
        subEditStrings: {},\r\n
        filter: undefined,\r\n
        hintmode: false,\r\n
        isSelectedComment: false,\r\n
        uids: [],\r\n
        oldUids: [],\r\n
        isDummyComment: false,\r\n
        initialize: function () {\r\n
            this.addListeners({\r\n
                "Common.Views.Comments": {\r\n
                    "comment:add": _.bind(this.onCreateComment, this),\r\n
                    "comment:change": _.bind(this.onChangeComment, this),\r\n
                    "comment:remove": _.bind(this.onRemoveComment, this),\r\n
                    "comment:resolve": _.bind(this.onResolveComment, this),\r\n
                    "comment:show": _.bind(this.onShowComment, this),\r\n
                    "comment:addReply": _.bind(this.onAddReplyComment, this),\r\n
                    "comment:changeReply": _.bind(this.onChangeReplyComment, this),\r\n
                    "comment:removeReply": _.bind(this.onRemoveReplyComment, this),\r\n
                    "comment:editReply": _.bind(this.onShowEditReplyComment, this),\r\n
                    "comment:closeEditing": _.bind(this.closeEditing, this),\r\n
                    "comment:disableHint": _.bind(this.disableHint, this),\r\n
                    "comment:addDummyComment": _.bind(this.onAddDummyComment, this)\r\n
                }\r\n
            });\r\n
            Common.NotificationCenter.on("comments:updatefilter", _.bind(this.onUpdateFilter, this));\r\n
        },\r\n
        onLaunch: function () {\r\n
            this.collection = this.getApplication().getCollection("Common.Collections.Comments");\r\n
            if (this.collection) {\r\n
                this.collection.comparator = function (collection) {\r\n
                    return -collection.get("time");\r\n
                };\r\n
            }\r\n
            this.popoverComments = new Common.Collections.Comments();\r\n
            if (this.popoverComments) {\r\n
                this.popoverComments.comparator = function (collection) {\r\n
                    return -collection.get("time");\r\n
                };\r\n
            }\r\n
            this.view = this.createView("Common.Views.Comments", {\r\n
                store: this.collection,\r\n
                popoverComments: this.popoverComments\r\n
            });\r\n
            this.view.render();\r\n
            this.bindViewEvents(this.view, this.events);\r\n
        },\r\n
        setConfig: function (data, api) {\r\n
            this.setApi(api);\r\n
            if (data) {\r\n
                this.currentUserId = data.config.user.id;\r\n
                this.currentUserName = data.config.user.name;\r\n
                this.sdkViewName = data["sdkviewname"] || this.sdkViewName;\r\n
                this.hintmode = data["hintmode"] || false;\r\n
            }\r\n
        },\r\n
        setApi

]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAACE=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="33" aka="AAAAAAAAACE=">
    <pickle>
      <global name="Pdata" module="OFS.Image"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value> <string encoding="cdata"><![CDATA[

: function (api) {\r\n
            if (api) {\r\n
                this.api = api;\r\n
                this.api.asc_registerCallback("asc_onAddComment", _.bind(this.onApiAddComment, this));\r\n
                this.api.asc_registerCallback("asc_onAddComments", _.bind(this.onApiAddComments, this));\r\n
                this.api.asc_registerCallback("asc_onRemoveComment", _.bind(this.onApiRemoveComment, this));\r\n
                this.api.asc_registerCallback("asc_onChangeComments", _.bind(this.onChangeComments, this));\r\n
                this.api.asc_registerCallback("asc_onRemoveComments", _.bind(this.onRemoveComments, this));\r\n
                this.api.asc_registerCallback("asc_onChangeCommentData", _.bind(this.onApiChangeCommentData, this));\r\n
                this.api.asc_registerCallback("asc_onLockComment", _.bind(this.onApiLockComment, this));\r\n
                this.api.asc_registerCallback("asc_onUnLockComment", _.bind(this.onApiUnLockComment, this));\r\n
                this.api.asc_registerCallback("asc_onShowComment", _.bind(this.onApiShowComment, this));\r\n
                this.api.asc_registerCallback("asc_onHideComment", _.bind(this.onApiHideComment, this));\r\n
                this.api.asc_registerCallback("asc_onUpdateCommentPosition", _.bind(this.onApiUpdateCommentPosition, this));\r\n
                this.api.asc_registerCallback("asc_onDocumentPlaceChanged", _.bind(this.onDocumentPlaceChanged, this));\r\n
            }\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = mode;\r\n
            return this;\r\n
        },\r\n
        onCreateComment: function (panel, commentVal, editMode, hidereply, documentFlag) {\r\n
            if (this.api && commentVal && commentVal.length > 0) {\r\n
                var comment = buildCommentData();\r\n
                if (comment) {\r\n
                    this.showPopover = true;\r\n
                    this.editPopover = editMode ? true : false;\r\n
                    this.hidereply = hidereply;\r\n
                    this.isSelectedComment = false;\r\n
                    this.uids = [];\r\n
                    comment.asc_putText(commentVal);\r\n
                    comment.asc_putTime(this.utcDateToString(new Date()));\r\n
                    comment.asc_putUserId(this.currentUserId);\r\n
                    comment.asc_putUserName(this.currentUserName);\r\n
                    comment.asc_putSolved(false);\r\n
                    if (!_.isUndefined(comment.asc_putDocumentFlag)) {\r\n
                        comment.asc_putDocumentFlag(documentFlag);\r\n
                    }\r\n
                    this.api.asc_addComment(comment);\r\n
                    this.view.showEditContainer(false);\r\n
                }\r\n
            }\r\n
            this.view.txtComment.focus();\r\n
        },\r\n
        onRemoveComment: function (id) {\r\n
            if (this.api && id) {\r\n
                this.api.asc_removeComment(id);\r\n
            }\r\n
        },\r\n
        onResolveComment: function (uid, id) {\r\n
            var t = this,\r\n
            reply = null,\r\n
            addReply = null,\r\n
            ascComment = buildCommentData(),\r\n
            comment = t.findComment(uid, id);\r\n
            if (_.isUndefined(uid)) {\r\n
                uid = comment.get("uid");\r\n
            }\r\n
            if (ascComment && comment) {\r\n
                ascComment.asc_putText(comment.get("comment"));\r\n
                ascComment.asc_putQuoteText(comment.get("quote"));\r\n
                ascComment.asc_putTime(t.utcDateToString(new Date(comment.get("time"))));\r\n
                ascComment.asc_putUserId(t.currentUserId);\r\n
                ascComment.asc_putUserName(t.currentUserName);\r\n
                ascComment.asc_putSolved(!comment.get("resolved"));\r\n
                if (!_.isUndefined(ascComment.asc_putDocumentFlag)) {\r\n
                    ascComment.asc_putDocumentFlag(comment.get("unattached"));\r\n
                }\r\n
                reply = comment.get("replys");\r\n
                if (reply && reply.length) {\r\n
                    reply.forEach(function (reply) {\r\n
                        addReply = buildCommentData();\r\n
                        if (addReply) {\r\n
                            addReply.asc_putText(reply.get("reply"));\r\n
                            addReply.asc_putTime(t.utcDateToString(new Date(reply.get("time"))));\r\n
                            addReply.asc_putUserId(reply.get("userid"));\r\n
                            addReply.asc_putUserName(reply.get("username"));\r\n
                            ascComment.asc_addReply(addReply);\r\n
                        }\r\n
                    });\r\n
                }\r\n
                t.api.asc_changeComment(uid, ascComment);\r\n
                return true;\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onShowComment: function (id, selected) {\r\n
            var comment = this.findComment(id, undefined);\r\n
            if (comment) {\r\n
                if (null !== comment.get("quote")) {\r\n
                    if (this.api) {\r\n
                        if (this.hintmode) {\r\n
                            this.animate = true;\r\n
                            if (comment.get("unattached")) {\r\n
                                if (this.getPopover()) {\r\n
                                    this.getPopover().hide();\r\n
                                    return;\r\n
                                }\r\n
                            }\r\n
                        } else {\r\n
                            var model = this.popoverComments.findWhere({\r\n
                                uid: id\r\n
                            });\r\n
                            if (model) {\r\n
                                return;\r\n
                            }\r\n
                        }\r\n
                        if (!_.isUndefined(selected) && this.hintmode) {\r\n
                            this.isSelectedComment = selected;\r\n
                        }\r\n
                        this.api.asc_selectComment(id);\r\n
                        this.api.asc_showComment(id, false);\r\n
                    }\r\n
                } else {\r\n
                    if (this.hintmode) {\r\n
                        this.api.asc_selectComment(id);\r\n
                    }\r\n
                    if (this.getPopover()) {\r\n
                        this.getPopover().hide();\r\n
                    }\r\n
                    this.isSelectedComment = false;\r\n
                    this.uids = [];\r\n
                }\r\n
            }\r\n
        },\r\n
        onChangeComment: function (id, commentVal) {\r\n
            if (commentVal && commentVal.length > 0) {\r\n
                var t = this,\r\n
                comment2 = null,\r\n
                reply = null,\r\n
                addReply = null,\r\n
                ascComment = buildCommentData(),\r\n
                comment = t.findComment(id);\r\n
                if (comment && ascComment) {\r\n
                    ascComment.asc_putText(commentVal);\r\n
                    ascComment.asc_putQuoteText(comment.get("quote"));\r\n
                    ascComment.asc_putTime(t.utcDateToString(new Date(comment.get("time"))));\r\n
                    ascComment.asc_putUserId(t.currentUserId);\r\n
                    ascComment.asc_putUserName(t.currentUserName);\r\n
                    ascComment.asc_putSolved(comment.get("resolved"));\r\n
                    if (!_.isUndefined(ascComment.asc_putDocumentFlag)) {\r\n
                        ascComment.asc_putDocumentFlag(comment.get("unattached"));\r\n
                    }\r\n
                    comment.set("editTextInPopover", false);\r\n
                    comment2 = t.findPopupComment(id);\r\n
                    if (comment2) {\r\n
                        comment2.set("editTextInPopover", false);\r\n
                    }\r\n
                    if (t.subEditStrings[id]) {\r\n
                        delete t.subEditStrings[id];\r\n
                    }\r\n
                    if (t.subEditStrings[id + "-R"]) {\r\n
                        delete t.subEditStrings[id + "-R"];\r\n
                    }\r\n
                    reply = comment.get("replys");\r\n
                    if (reply && reply.length) {\r\n
                        reply.forEach(function (reply) {\r\n
                            addReply = buildCommentData();\r\n
                            if (addReply) {\r\n
                                addReply.asc_putText(reply.get("reply"));\r\n
                                addReply.asc_putTime(t.utcDateToString(new Date(reply.get("time"))));\r\n
                                addReply.asc_putUserId(reply.get("userid"));\r\n
                                addReply.asc_putUserName(reply.get("username"));\r\n
                                ascComment.asc_addReply(addReply);\r\n
                            }\r\n
                        });\r\n
                    }\r\n
                    t.api.asc_changeComment(id, ascComment);\r\n
                    return true;\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onChangeReplyComment: function (id, replyId, replyVal) {\r\n
            if (replyVal && replyVal.length > 0) {\r\n
                var me = this,\r\n
                reply = null,\r\n
                addReply = null,\r\n
                ascComment = buildCommentData(),\r\n
                comment = me.findComment(id);\r\n
                if (ascComment && comment) {\r\n
                    ascComment.asc_putText(comment.get("comment"));\r\n
                    ascComment.asc_putQuoteText(comment.get("quote"));\r\n
                    ascComment.asc_putTime(me.utcDateToString(new Date(comment.get("time"))));\r\n
                    ascComment.asc_putUserId(comment.get("userid"));\r\n
                    ascComment.asc_putUserName(comment.get("username"));\r\n
                    ascComment.asc_putSolved(comment.get("resolved"));\r\n
                    if (!_.isUndefined(ascComment.asc_putDocumentFlag)) {\r\n
                        ascComment.asc_putDocumentFlag(comment.get("unattached"));\r\n
                    }\r\n
                    reply = comment.get("replys");\r\n
                    if (reply && reply.length) {\r\n
                        reply.forEach(function (reply) {\r\n
                            addReply = buildCommentData();\r\n
                            if (addReply) {\r\n
                                if (reply.get("id") === replyId && !_.isUndefined(replyVal)) {\r\n
                                    addReply.asc_putText(replyVal);\r\n
                                    addReply.asc_putUserId(me.currentUserId);\r\n
                                    addReply.asc_putUserName(me.currentUserName);\r\n
                                } else {\r\n
                                    addReply.asc_putText(reply.get("reply"));\r\n
                                    addReply.asc_putUserId(reply.get("userid"));\r\n
                                    addReply.asc_putUserName(reply.get("username"));\r\n
                                }\r\n
                                addReply.asc_putTime(me.utcDateToString(new Date(reply.get("time"))));\r\n
                                ascComment.asc_addReply(addReply);\r\n
                            }\r\n
                        });\r\n
                    }\r\n
                    me.api.asc_changeComment(id, ascComment);\r\n
                    return true;\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onAddReplyComment: function (id, replyVal) {\r\n
            if (replyVal.length > 0) {\r\n
                var me = this,\r\n
                uid = null,\r\n
                reply = null,\r\n
                addReply = null,\r\n
                ascComment = buildCommentData(),\r\n
                comment = me.findComment(id);\r\n
                if (ascComment && comment) {\r\n
                    uid = comment.get("uid");\r\n
                    if (uid) {\r\n
                        if (me.subEditStrings[uid]) {\r\n
                            delete me.subEditStrings[uid];\r\n
                        }\r\n
                        if (me.subEditStrings[uid + "-R"]) {\r\n
                            delete me.subEditStrings[uid + "-R"];\r\n
                        }\r\n
                        comment.set("showReplyInPopover", false);\r\n
                    }\r\n
                    ascComment.asc_putText(comment.get("comment"));\r\n
                    ascComment.asc_putQuoteText(comment.get("quote"));\r\n
                    ascComment.asc_putTime(me.utcDateToString(new Date(comment.get("time"))));\r\n
                    ascComment.asc_putUserId(comment.get("userid"));\r\n
                    ascComment.asc_putUserName(comment.get("username"));\r\n
                    ascComment.asc_putSolved(comment.get("resolved"));\r\n
                    if (!_.isUndefined(ascComment.asc_putDocumentFlag)) {\r\n
                        ascComment.asc_putDocumentFlag(comment.get("unattached"));\r\n
                    }\r\n
                    reply = comment.get("replys");\r\n
                    if (reply && reply.length) {\r\n
                        reply.forEach(function (reply) {\r\n
                            addReply = buildCommentData();\r\n
                            if (addReply) {\r\n
                                addReply.asc_putText(reply.get("reply"));\r\n
                                addReply.asc_putTime(me.utcDateToString(new Date(reply.get("time"))));\r\n
                                addReply.asc_putUserId(reply.get("userid"));\r\n
                                addReply.asc_putUserName(reply.get("username"));\r\n
                                ascComment.asc_addReply(addReply);\r\n
                            }\r\n
                        });\r\n
                    }\r\n
                    addReply = buildCommentData();\r\n
                    if (addReply) {\r\n
                        addReply.asc_putText(replyVal);\r\n
                        addReply.asc_putTime(me.utcDateToString(new Date()));\r\n
                        addReply.asc_putUserId(me.currentUserId);\r\n
                        addReply.asc_putUserName(me.currentUserName);\r\n
                        ascComment.asc_addReply(addReply);\r\n
                        me.api.asc_changeComment(id, ascComment);\r\n
                        return true;\r\n
                    }\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onRemoveReplyComment: function (id, replyId) {\r\n
            if (!_.isUndefined(id) && !_.isUndefined(replyId)) {\r\n
                var me = this,\r\n
                replies = null,\r\n
                addReply = null,\r\n
                ascComment = buildCommentData(),\r\n
                comment = me.findComment(id);\r\n
                if (ascComment && comment) {\r\n
                    ascComment.asc_putText(comment.get("comment"));\r\n
                    ascComment.asc_putQuoteText(comment.get("quote"));\r\n
                    ascComment.asc_putTime(me.utcDateToString(new Date(comment.get("time"))));\r\n
                    ascComment.asc_putUserId(comment.get("userid"));\r\n
                    ascComment.asc_putUserName(comment.get("username"));\r\n
                    ascComment.asc_putSolved(comment.get("resolved"));\r\n
                    if (!_.isUndefined(ascComment.asc_putDocumentFlag)) {\r\n
                        ascComment.asc_putDocumentFlag(comment.get("unattached"));\r\n
                    }\r\n
                    replies = comment.get("replys");\r\n
                    if (replies && replies.length) {\r\n
                        replies.forEach(function (reply) {\r\n
                            if (reply.get("id") !== replyId) {\r\n
                                addReply = buildCommentData();\r\n
                                if (addReply) {\r\n
                                    addReply.asc_putText(reply.get("reply"));\r\n
                                    addReply.asc_putTime(me.utcDateToString(new Date(reply.get("time"))));\r\n
                                    addReply.asc_putUserId(reply.get("userid"));\r\n
                                    addReply.asc_putUserName(reply.get("username"));\r\n
                                    ascComment.asc_addReply(addReply);\r\n
                                }\r\n
                            }\r\n
                        });\r\n
                    }\r\n
                    me.api.asc_changeComment(id, ascComment);\r\n
                    return true;\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onShowEditReplyComment: function (id, replyId, inpopover) {\r\n
            var i, model, repliesSrc, repliesCopy;\r\n
            if (!_.isUndefined(id) && !_.isUndefined(replyId)) {\r\n
                if (inpopover) {\r\n
                    model = this.popoverComments.findWhere({\r\n
                        uid: id\r\n
                    });\r\n
                    if (model) {\r\n
                        repliesSrc = model.get("replys");\r\n
                        repliesCopy = _.clone(model.get("replys"));\r\n
                        if (repliesCopy) {\r\n
                            for (i = 0; i < repliesCopy.length; ++i) {\r\n
                                if (replyId === repliesCopy[i].get("id")) {\r\n
                                    repliesCopy[i].set("editTextInPopover", true);\r\n
                                    repliesSrc.length = 0;\r\n
                                    model.set("replys", repliesCopy);\r\n
                                    return true;\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                } else {\r\n
                    model = this.collection.findWhere({\r\n
                        uid: id\r\n
                    });\r\n
                    if (model) {\r\n
                        repliesSrc = model.get("replys");\r\n
                        repliesCopy = _.clone(model.get("replys"));\r\n
                        if (repliesCopy) {\r\n
                            for (i = 0; i < repliesCopy.length; ++i) {\r\n
                                if (replyId === repliesCopy[i].get("id")) {\r\n
                                    repliesCopy[i].set("editText", true);\r\n
                                    repliesSrc.length = 0;\r\n
                                    model.set("replys", repliesCopy);\r\n
                                    return true;\r\n
                                }\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
            return false;\r\n
        },\r\n
        onUpdateFilter: function (filter, applyOnly) {\r\n
            if (filter) {\r\n
                this.filter = {\r\n
                    property: filter.property,\r\n
                    value: filter.value\r\n
                };\r\n
                if (!applyOnly) {\r\n
                    if (this.getPopover()) {\r\n
                        this.getPopover().hide();\r\n
                    }\r\n
                }\r\n
                var t = this,\r\n
                endComment = null;\r\n
                this.collection.each(function (model) {\r\n
                    var prop = model.get(t.filter.property);\r\n
                    if (prop) {\r\n
                        model.set("hide", (null === prop.match(t.filter.value)));\r\n
                    }\r\n
                    if (model.get("last")) {\r\n
                        model.set("last", false);\r\n
                    }\r\n
                    if (!model.get("hide")) {\r\n
                        endComment = model;\r\n
                    }\r\n
                });\r\n
                if (endComment) {\r\n
                    endComment.set("last", true);\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiAddComment: function (id, data) {\r\n
            var comment = this.readSDKComment(id, data);\r\n
            if (comment) {\r\n
                this.collection.push(comment);\r\n
                this.updateComments(true);\r\n
                if (this.showPopover) {\r\n
                    if (null !== data.asc_getQuoteText()) {\r\n
                        this.api.asc_selectComment(id);\r\n
                        this.api.asc_showComment(id, true);\r\n
                    }\r\n
                    this.showPopover = undefined;\r\n
                    this.editPopover = false;\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiAddComments: function (data) {\r\n
            for (var i = 0; i < data.length; ++i) {\r\n
                var comment = this.readSDKComment(data[i].Id, data[i].Comment);\r\n
                this.collection.push(comment);\r\n
            }\r\n
            this.updateComments(true);\r\n
        },\r\n
        onApiRemoveComment: function (id, silentUpdate) {\r\n
            if (this.collection.length) {\r\n
                var model = this.collection.findWhere({\r\n
                    uid: id\r\n
                });\r\n
                if (model) {\r\n
                    this.collection.remove(model);\r\n
                    if (!silentUpdate) {\r\n
                        this.updateComments(true);\r\n
                    }\r\n
                }\r\n
                if (this.popoverComments.length) {\r\n
                    model = this.popoverComments.findWhere({\r\n
                        uid: id\r\n
                    });\r\n
                    if (model) {\r\n
                        this.popoverComments.remove(model);\r\n
                        if (0 === this.popoverComments.length) {\r\n
                            if (this.getPopover()) {\r\n
                                this.getPopover().hide();\r\n
                            }\r\n
                        }\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onChangeComments: function (data) {\r\n
            for (var i = 0; i < data.length; ++i) {\r\n
                this.onApiChangeCommentData(data[i].Comment.Id, data[i].Comment, true);\r\n
            }\r\n
            this.updateComments(true);\r\n
        },\r\n
        onRemoveComments: function (data) {\r\n
            for (var i = 0; i < data.length; ++i) {\r\n
                this.onApiRemoveComment(data[i], true);\r\n
            }\r\n
            this.updateComments(true);\r\n
        },\r\n
        onApiChangeCommentData: function (id, data, silentUpdate) {\r\n
            var t = this,\r\n
            i = 0,\r\n
            date = null,\r\n
            replies = null,\r\n
            repliesCount = 0,\r\n
            dateReply = null,\r\n
            comment = this.findComment(id);\r\n
            if (comment) {\r\n
                t = this;\r\n
                date = (data.asc_getTime() == "") ? new Date() : new Date(this.stringUtcToLocalDate(data.asc_getTime()));\r\n
                comment.set("comment", data.asc_getText());\r\n
                comment.set("userid", data.asc_getUserId());\r\n
                comment.set("username", data.asc_getUserName());\r\n
                comment.set("resolved", data.asc_getSolved());\r\n
                comment.set("quote", data.asc_getQuoteText());\r\n
                comment.set("time", date.getTime());\r\n
                comment.set("date", t.dateToLocaleTimeString(date));\r\n
                replies = _.clone(comment.get("replys"));\r\n
                replies.length = 0;\r\n
                repliesCount = data.asc_getRepliesCount();\r\n
                for (i = 0; i < repliesCount; ++i) {\r\n
                    dateReply = (data.asc_getReply(i).asc_getTime() == "") ? new Date() : new Date(this.stringUtcToLocalDate(data.asc_getReply(i).asc_getTime()));\r\n
                    replies.push(new Common.Models.Reply({\r\n
                        id: Common.UI.getId(),\r\n
                        userid: data.asc_getReply(i).asc_getUserId(),\r\n
                        username: data.asc_getReply(i).asc_getUserName(),\r\n
                        date: t.dateToLocaleTimeString(dateReply),\r\n
                        reply: data.asc_getReply(i).asc_getText(),\r\n
                        time: dateReply.getTime(),\r\n
                        editText: false,\r\n
                        editTextInPopover: false,\r\n
                        showReplyInPopover: false,\r\n
                        scope: t.view\r\n
                    }));\r\n
                }\r\n
                replies.sort(function (a, b) {\r\n
                    return a.get("time") - b.get("time");\r\n
                });\r\n
                comment.set("replys", replies);\r\n
                if (!silentUpdate) {\r\n
                    this.updateComments(false, true);\r\n
                    if (this.getPopover() && this.getPopover().isVisible()) {\r\n
                        this.api.asc_showComment(id, true);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiLockComment: function (id, userId) {\r\n
            var cur = this.findComment(id),\r\n
            usersStore = null,\r\n
            user = null;\r\n
            if (cur) {\r\n
                usersStore = this.getApplication().getCollection("Common.Collections.Users");\r\n
                if (usersStore) {\r\n
                    user = usersStore.findWhere({\r\n
                        id: userId\r\n
                    });\r\n
                    if (user) {\r\n
                        cur.set("lock", true);\r\n
                        cur.set("lockuserid", this.view.getUserName(user.get("username")));\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onApiUnLockComment: function (id) {\r\n
            var cur = this.findComment(id);\r\n
            if (cur) {\r\n
                cur.set("lock", false);\r\n
            }\r\n
        },\r\n
        onApiShowComment: function (uids, posX, posY, leftX, opts, hint) {\r\n
            if (hint && this.isSelectedComment && (0 === _.difference(this.uids, uids).length)) {\r\n
                return;\r\n
            }\r\n
            if (this.mode && !this.mode.canComments) {\r\n
                hint = true;\r\n
            }\r\n
            if (this.getPopover()) {\r\n
                this.clearDummyComment();\r\n
                if (this.isSelectedComment && (0 === _.difference(this.uids, uids).length)) {\r\n
                    if (this.api) {\r\n
                        this.getPopover().commentsView.setFocusToTextBox(true);\r\n
                        this.api.asc_enableKeyEvents(true);\r\n
                    }\r\n
                    return;\r\n
                }\r\n
                var i = 0,\r\n
                saveTxtId = "",\r\n
                saveTxtReplyId = "",\r\n
                comment = null,\r\n
                text = "",\r\n
                animate = true;\r\n
                this.popoverComments.reset();\r\n
                for (i = 0; i < uids.length; ++i) {\r\n
                    saveTxtId = uids[i];\r\n
                    saveTxtReplyId = uids[i] + "-R";\r\n
                    comment = this.findComment(saveTxtId);\r\n
                    if (this.subEditStrings[saveTxtId]) {\r\n
                        comment.set("editTextInPopover", true);\r\n
                        text = this.subEditStrings[saveTxtId];\r\n
                    } else {\r\n
                        if (this.subEditStrings[saveTxtReplyId]) {\r\n
                            comment.set("showReplyInPopover", true);\r\n
                            text = this.subEditStrings[saveTxtReplyId];\r\n
                        }\r\n
                    }\r\n
                    comment.set("hint", !_.isUndefined(hint) ? hint : false);\r\n
                    if (!hint && this.hintmode) {\r\n
                        if (0 === _.difference(this.uids, uids).length && (this.uids.length === 0)) {\r\n
                            animate = false;\r\n
                        }\r\n
                        if (this.oldUids.length && (0 === _.difference(this.oldUids, uids).length)) {\r\n
                            animate = false;\r\n
                            this.oldUids = [];\r\n
                        }\r\n
                    }\r\n
                    if (this.animate) {\r\n
                        animate = this.animate;\r\n
                        this.animate = false;\r\n
                    }\r\n
                    this.isSelectedComment = !hint;\r\n
                    this.uids = _.clone(uids);\r\n
                    this.popoverComments.push(comment);\r\n
                }\r\n
                if (this.getPopover().isVisible()) {\r\n
                    this.getPopover().hide();\r\n
                }\r\n
                this.getPopover().setLeftTop(posX, posY, leftX);\r\n
                this.getPopover().show(animate, false, true, text);\r\n
            }\r\n
        },\r\n
        onApiHideComment: function (hint) {\r\n
            var t = this;\r\n
            if (this.getPopover()) {\r\n
                if (this.isSelectedComment && hint) {\r\n
                    return;\r\n
                }\r\n
                this.popoverComments.each(function (model) {\r\n
                    if (model.get("editTextInPopover")) {\r\n
                        t.subEditStrings[model.get("uid")] = t.getPopover().getEditText();\r\n
                    }\r\n
                    if (model.get("showReplyInPopover")) {\r\n
                        t.subEditStrings[model.get("uid") + "-R"] = t.getPopover().getEditText();\r\n
                    }\r\n
                });\r\n
                this.getPopover().saveText(true);\r\n
                this.getPopover().hide();\r\n
                this.collection.clearEditing();\r\n
                this.popoverComments.clearEditing();\r\n
                this.oldUids = _.clone(this.uids);\r\n
                this.isSelectedComment = false;\r\n
                this.uids = [];\r\n
                this.popoverComments.reset();\r\n
            }\r\n
        },\r\n
        onApiUpdateCommentPosition: function (uids, posX, posY, leftX) {\r\n
            var i, useAnimation = false,\r\n
            comment = null,\r\n
            text = undefined,\r\n
            saveTxtId = "",\r\n
            saveTxtReplyId = "";\r\n
            if (this.getPopover()) {\r\n
                this.getPopover().saveText();\r\n
                if (posY < 0 || this.getPopover().sdkBounds.height < posY || (!_.isUndefined(leftX) && this.getPopover().sdkBounds.width < leftX)) {\r\n
                    this.getPopover().hide();\r\n
                } else {\r\n
                    if (0 === this.popoverComments.length) {\r\n
                        this.popoverComments.reset();\r\n
                        for (i = 0; i < uids.length; ++i) {\r\n
                            saveTxtId = uids[i];\r\n
                            saveTxtReplyId = uids[i] + "-R";\r\n
                            comment = this.findComment(saveTxtId);\r\n
                            if (this.subEditStrings[saveTxtId]) {\r\n
                                comment.set("editTextInPopover", true);\r\n
                                text = this.subEditStrings[saveTxtId];\r\n
                            } else {\r\n
                                if (this.subEditStrings[saveTxtReplyId]) {\r\n
                                    comment.set("showReplyInPopover", true);\r\n
                                    text = this.subEditStrings[saveTxtReplyId];\r\n
                                }\r\n
                            }\r\n
                            this.popoverComments.push(comment);\r\n
                        }\r\n
                        useAnimation = true;\r\n
                        this.getPopover().show(useAnimation, undefined, undefined, text);\r\n
                    } else {\r\n
                        if (!this.getPopover().isVisible()) {\r\n
                            this.getPopover().show(false, undefined, undefined, text);\r\n
                        }\r\n
                    }\r\n
                    this.getPopover().setLeftTop(posX, posY, leftX);\r\n
                }\r\n
            }\r\n
        },\r\n
        onDocumentPlaceChanged: function () {\r\n
            if (this.isDummyComment && this.getPopover()) {\r\n
                if (this.getPopover().isVisible()) {\r\n
                    var anchor = this.api.asc_getAnchorPosition();\r\n
                    if (anchor) {\r\n
                        this.getPopover().setLeftTop(anchor.asc_getX() + anchor.asc_getWidth(), anchor.asc_getY(), this.hintmode ? anchor.asc_getX() : undefined);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        updateComments: function (needRender, disableSort) {\r\n
            var i, end = true;\r\n
            if (_.isUndefined(disableSort)) {\r\n
                this.collection.sort();\r\n
            }\r\n
            if (needRender) {\r\n
                for (i = this.collection.length - 1; i >= 0; --i) {\r\n
                    if (end) {\r\n
                        this.collection.at(i).set("last", true, {\r\n
                            silent: true\r\n
                        });\r\n
                    } else {\r\n
                        if (this.collection.at(i).get("last")) {\r\n
                            this.collection.at(i).set("last", false, {\r\n
                                silent: true\r\n
                            });\r\n
                        }\r\n
                    }\r\n
                    end = false;\r\n
                }\r\n
                this.onUpdateFilter(this.filter, true);\r\n
                this.view.render();\r\n
            }\r\n
            this.view.renderResolvedComboButtons();\r\n
            this.view.update();\r\n
        },\r\n
        findComment: function (uid, id) {\r\n
            if (_.isUndefined(uid)) {\r\n
                return this.collection.findWhere({\r\n
                    id: id\r\n
                });\r\n
            }\r\n
            return this.collection.findWhere({\r\n
                uid: uid\r\n
            });\r\n
        },\r\n
        findPopupComment: function (id) {\r\n
            return this.popoverComments.findWhere({\r\n
                id: id\r\n
            });\r\n
        },\r\n
        closeEditing: function (id) {\r\n
            var t = this;\r\n
            if (!_.isUndefined(id)) {\r\n
                var comment2 = this.findPopupComment(id);\r\n
                if (comment2) {\r\n
                    comment2.set("editTextInPopover", false);\r\n
                    comment2.set("showReplyInPopover", false);\r\n
                }\r\n
                if (this.subEditStrings[id]) {\r\n
                    delete this.subEditStrings[id];\r\n
                }\r\n
                if (this.subEditStrings[id + "-R"]) {\r\n
                    delete this.subEditStrings[id + "-R"];\r\n
                }\r\n
            }\r\n
            this.collection.clearEditing();\r\n
            this.collection.each(function (model) {\r\n
                var replies = _.clone(model.get("replys"));\r\n
                model.get("replys").length = 0;\r\n
                replies.forEach(function (reply) {\r\n
                    if (reply.get("editText")) {\r\n
                        reply.set("editText", false);\r\n
                    }\r\n
                    if (reply.get("editTextInPopover")) {\r\n
                        reply.set("editTextInPopover", false);\r\n
                    }\r\n
                });\r\n
                model.set("replys", replies);\r\n
            });\r\n
            this.view.showEditContainer(false);\r\n
            this.view.update();\r\n
        },\r\n
        disableHint: function (comment) {\r\n
            if (comment && this.mode.canComments) {\r\n
                comment.set("hint", false);\r\n
                this.isSelectedComment = true;\r\n
            }\r\n
        },\r\n
        blockPopover: function (flag) {\r\n
            this.isSelectedComment = flag;\r\n
            if (flag) {\r\n
                if (this.getPopover().isVisible()) {\r\n
                    this.getPopover().hide();\r\n
                }\r\n
            }\r\n
        },\r\n
        getPopover: function () {\r\n
            return this.view.getPopover(this.sdkViewName);\r\n
        },\r\n
        readSDKComment: function (id, data) {\r\n
            var date = (data.asc_getTime() == "") ? new Date() : new Date(this.stringUtcToLocalDate(data.asc_getTime()));\r\n
            var comment = new Common.Models.Comment({\r\n
                uid: id,\r\n
                userid: data.asc_getUserId(),\r\n
                username: data.asc_getUserName(),\r\n
                date: this.dateToLocaleTimeString(date),\r\n
                quote: data.asc_getQuoteText(),\r\n
                comment: data.asc_getText(),\r\n
                resolved: data.asc_getSolved(),\r\n
                unattached: !_.isUndefined(data.asc_getDocumentFlag) ? data.asc_getDocumentFlag() : false,\r\n
                id: Common.UI.getId(),\r\n
                time: date.getTime(),\r\n
                showReply: false,\r\n
                editText: false,\r\n
                last: undefined,\r\n
                editTextInPopover: (this.editPopover ? true : false),\r\n
                showReplyInPopover: false,\r\n
                hideAddReply: !_.isUndefined(this.hidereply) ? this.hidereply : (this.showPopover ? true : false),\r\n
                scope: this.view\r\n
            });\r\n
            if (comment) {\r\n
                var replies = this.readSDKReplies(data);\r\n
                if (replies.length) {\r\n
                    comment.set("replys", replies);\r\n
                }\r\n
            }\r\n
            return comment;\r\n
        },\r\n
        readSDKReplies: function (data) {\r\n
            var i = 0,\r\n
            replies = [],\r\n
            date = null;\r\n
            var repliesCount = data.asc_getRepliesCount();\r\n
            if (repliesCount) {\r\n
                for (i = 0; i < repliesCount; ++i) {\r\n
                    date = (data.asc_getReply(i).asc_getTime() == "") ? new Date() : new Date(this.stringUtcToLocalDate(data.asc_getReply(i).asc_getTime()));\r\n
                    replies.push(new Common.Models.Reply({\r\n
                        id: Common.UI.getId(),\r\n
                        userid: data.asc_getReply(i).asc_getUserId(),\r\n
                        username: data.asc_getReply(i).asc_getUserName(),\r\n
                        date: this.dateToLocaleTimeString(date),\r\n
                        reply: data.asc_getReply(i).asc_getText(),\r\n
                        time: date.getTime(),\r\n
                        editText: false,\r\n
                        editTextInPopover: false,\r\n
                        showReplyInPopover: false,\r\n
                        scope: this.view\r\n
                    }));\r\n
                }\r\n
                replies.sort(function (a, b) {\r\n
                    return a.get("time") - b.get("time");\r\n
                });\r\n
            }\r\n
            return replies;\r\n
        },\r\n
        addDummyComment: function () {\r\n
            if (this.api) {\r\n
                var me = this,\r\n
                anchor = null,\r\n
                date = new Date(),\r\n
                dialog = this.getPopover();\r\n
                if (dialog) {\r\n
                    if (this.popoverComments.length) {\r\n
                        _.delay(function () {\r\n
                            me.api.asc_enableKeyEvents(false);\r\n
                            dialog.commentsView.setFocusToTextBox();\r\n
                        },\r\n
                        200);\r\n
                        return;\r\n
                    }\r\n
                    var comment = new Common.Models.Comment({\r\n
                        id: -1,\r\n
                        time: date.getTime(),\r\n
                        date: this.dateToLocaleTimeString(date),\r\n
                        userid: this.currentUserId,\r\n
                        username: this.currentUserName,\r\n
                        editTextInPopover: true,\r\n
                        showReplyInPopover: false,\r\n
                        hideAddReply: true,\r\n
                        scope: this.view,\r\n
                        dummy: true\r\n
                    });\r\n
                    this.popoverComments.reset();\r\n
                    this.popoverComments.push(comment);\r\n
                    this.uids = [];\r\n
                    this.isSelectedComment = true;\r\n
                    this.isDummyComment = true;\r\n
                    if (!_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)) {\r\n
                        me.api.asc_SetDocumentPlaceChangedEnabled(true);\r\n
                    }\r\n
                    dialog.handlerHide = (function () {});\r\n
                    if (dialog.isVisible()) {\r\n
                        dialog.hide();\r\n
                    }\r\n
                    dialog.handlerHide = (function () {\r\n
                        me.clearDummyComment();\r\n
                    });\r\n
                    anchor = this.api.asc_getAnchorPosition();\r\n
                    if (anchor) {\r\n
                        dialog.setLeftTop(anchor.asc_getX() + anchor.asc_getWidth(), anchor.asc_getY(), this.hintmode ? anchor.asc_getX() : undefined);\r\n
                        dialog.show(true, false, true);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        onAddDummyComment: function (commentVal) {\r\n
            if (this.api && commentVal && commentVal.length > 0) {\r\n
                var comment = buildCommentData();\r\n
                if (comment) {\r\n
                    this.showPopover = true;\r\n
                    this.editPopover = false;\r\n
                    this.hidereply = false;\r\n
                    this.isSelectedComment = false;\r\n
                    this.uids = [];\r\n
                    this.isDummyComment = false;\r\n
                    this.popoverComments.reset();\r\n
                    comment.asc_putText(commentVal);\r\n
                    comment.asc_putTime(this.utcDateToString(new Date()));\r\n
                    comment.asc_putUserId(this.currentUserId);\r\n
                    comment.asc_putUserName(this.currentUserName);\r\n
                    comment.asc_putSolved(false);\r\n
                    if (!_.isUndefined(comment.asc_putDocumentFlag)) {\r\n
                        comment.asc_putDocumentFlag(false);\r\n
                    }\r\n
                    this.api.asc_addComment(comment);\r\n
                    this.view.showEditContainer(false);\r\n
                    if (!_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)) {\r\n
                        this.api.asc_SetDocumentPlaceChangedEnabled(false);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        clearDummyComment: function () {\r\n
            if (this.isDummyComment) {\r\n
                this.isDummyComment = false;\r\n
                this.showPopover = true;\r\n
                this.editPopover = false;\r\n
                this.hidereply = false;\r\n
                this.isSelectedComment = false;\r\n
                this.uids = [];\r\n
                var dialog = this.getPopover();\r\n
                if (dialog) {\r\n
                    dialog.handlerHide = (function () {});\r\n
                    if (dialog.isVisible()) {\r\n
                        dialog.hide();\r\n
                    }\r\n
                }\r\n
                this.popoverComments.reset();\r\n
                if (!_.isUndefined(this.api.asc_SetDocumentPlaceChangedEnabled)) {\r\n
                    this.api.asc_SetDocumentPlaceChangedEnabled(false);\r\n
                }\r\n
            }\r\n
        },\r\n
        onEditComments: function (comments) {\r\n
            if (this.api) {\r\n
                var i = 0,\r\n
                t = this,\r\n
                comment = null;\r\n
                var anchor = this.api.asc_getAnchorPosition();\r\n
                if (anchor) {\r\n
                    this.isSelectedComment = true;\r\n
                    this.popoverComments.reset();\r\n
                    for (i = 0; i < comments.length; ++i) {\r\n
                        comment = this.findComment(comments[i].asc_getId());\r\n
                        comment.set("editTextInPopover", true);\r\n
                        comment.set("hint", false);\r\n
                        this.popoverComments.push(comment);\r\n
                    }\r\n
                    if (this.getPopover()) {\r\n
                        if (this.getPopover().isVisible()) {\r\n
                            this.getPopover().hide();\r\n
                        }\r\n
                        this.getPopover().setLeftTop(anchor.asc_getX() + anchor.asc_getWidth(), anchor.asc_getY(), this.hintmode ? anchor.asc_getX() : undefined);\r\n
                        this.getPopover().show(true, false, true);\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        focusOnInput: function () {\r\n
            if (this.view && this.api) {\r\n
                var panel = $("#comments-new-comment-ct", this.view.el);\r\n
                if (panel && panel.length) {\r\n
                    if ("none" !== panel.css("display")) {\r\n
                        this.api.asc_enableKeyEvents(false);\r\n
                        this.view.txtComment.focus();\r\n
                    }\r\n
                }\r\n
            }\r\n
        },\r\n
        timeZoneOffsetInMs: (new Date()).getTimezoneOffset() * 60000,\r\n
        stringUtcToLocalDate: function (date) {\r\n
            if (typeof date === "string") {\r\n
                return parseInt(date) + this.timeZoneOffsetInMs;\r\n
            }\r\n
            return 0;\r\n
        },\r\n
        utcDateToString: function (date) {\r\n
            if (Object.prototype.toString.call(date) === "[object Date]") {\r\n
                return (date.getTime() - this.timeZoneOffsetInMs).toString();\r\n
            }\r\n
            return "";\r\n
        },\r\n
        dateToLocaleTimeString: function (date) {\r\n
            function format(date) {\r\n
                var strTime, hours = date.getHours(),\r\n
                minutes = date.getMinutes(),\r\n
                ampm = hours >= 12 ? "pm" : "am";\r\n
                hours = hours % 12;\r\n
                hours = hours ? hours : 12;\r\n
                minutes = minutes < 10 ? "0" + minutes : minutes;\r\n
                strTime = hours + ":" + minutes + " " + ampm;\r\n
                return strTime;\r\n
            }\r\n
            return (date.getMonth() + 1) + "/" + (date.getDate()) + "/" + date.getFullYear() + " " + format(date);\r\n
        }\r\n
    },\r\n
    Common.Controllers.Comments || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/model/User\',["backbone"], function (Backbone) {\r\n
    Common.Models = Common.Models || {};\r\n
    Common.Models.User = Backbone.Model.extend({\r\n
        defaults: {\r\n
            id: undefined,\r\n
            username: "Guest",\r\n
            color: "#fff",\r\n
            colorval: null,\r\n
            online: false\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/collection/Users\',["backbone", "common/main/lib/model/User"], function (Backbone) {\r\n
    Common.Collections = Common.Collections || {};\r\n
    Common.Collections.Users = Backbone.Collection.extend({\r\n
        model: Common.Models.User,\r\n
        getOnlineCount: function () {\r\n
            var count = 0;\r\n
            this.each(function (user) {\r\n
                user.online && count++;\r\n
            });\r\n
            return count;\r\n
        },\r\n
        findUser: function (id) {\r\n
            return this.find(function (model) {\r\n
                return model.get("id") == id;\r\n
            });\r\n
        }\r\n
    });\r\n
    Common.Collections.HistoryUsers = Backbone.Collection.extend({\r\n
        model: Common.Models.User,\r\n
        findUser: function (id) {\r\n
            return this.find(function (model) {\r\n
                return model.get("id") == id;\r\n
            });\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/model/ChatMessage\',["backbone"], function (Backbone) {\r\n
    Common.Models = Common.Models || {};\r\n
    Common.Models.ChatMessage = Backbone.Model.extend({\r\n
        defaults: {\r\n
            type: 0,\r\n
            userid: null,\r\n
            username: "",\r\n
            message: ""\r\n
        }\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/collection/ChatMessages\',["backbone", "common/main/lib/model/ChatMessage"], function (Backbone) { ! Common.Collections && (Common.Collections = {});\r\n
    Common.Collections.ChatMessages = Backbone.Collection.extend({\r\n
        model: Common.Models.ChatMessage\r\n
    });\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 define(\'common/main/lib/controller/Chat\',["core", "common/main/lib/collection/Users", "common/main/lib/collection/ChatMessages", "common/main/lib/view/Chat"], function () {\r\n
    Common.Controllers.Chat = Backbone.Controller.extend(_.extend({\r\n
        models: [],\r\n
        collections: ["Common.Collections.Users", "Common.Collections.ChatMessages"],\r\n
        views: ["Common.Views.Chat"],\r\n
        initialize: function () {\r\n
            this.addListeners({\r\n
                "Common.Views.Chat": {\r\n
                    "message:add": _.bind(this.onSendMessage, this)\r\n
                }\r\n
            });\r\n
        },\r\n
        events: {},\r\n
        onLaunch: function () {\r\n
            this.panelChat = this.createView("Common.Views.Chat", {\r\n
                storeUsers: this.getApplication().getCollection("Common.Collections.Users"),\r\n
                storeMessages: this.getApplication().getCollection("Common.Collections.ChatMessages")\r\n
            });\r\n
        },\r\n
        setMode: function (mode) {\r\n
            this.mode = mode;\r\n
            if (this.api) {\r\n
                if (this.mode.canCoAuthoring && this.mode.canChat) {\r\n
                    this.api.asc_registerCallback("asc_onCoAuthoringChatReceiveMessage", _.bind(this.onReceiveMessage, this));\r\n
                }\r\n
                this.api.asc_registerCallback("asc_onAuthParticipantsChanged", _.bind(this.onUsersChanged, this));\r\n
                this.api.asc_registerCallback("asc_onConnectionStateChanged", _.bind(this.onUserConnection, this));\r\n
                this.api.asc_coAuthoringGetUsers();\r\n
                if (this.mode.canCoAuthoring && this.mode.canChat) {\r\n
                    this.api.asc_coAuthoringChatGetMessages();\r\n
                }\r\n
            }\r\n
            return this;\r\n
        },\r\n
        setApi: function (api) {\r\n
            this.api = api;\r\n
            return this;\r\n
        },\r\n
        onUsersChanged: function (users) {\r\n
            if (!this.mode.canCoAuthoring) {\r\n
                var len = 0;\r\n
                for (name in users) {\r\n
                    if (undefined !== name) {\r\n
                        len++;\r\n
                    }\r\n
                }\r\n
                if (len > 2 && this._isCoAuthoringStopped == undefined) {\r\n
                    this._isCoAuthoringStopped = true;\r\n
                    this.api.asc_coAuthoringDisconnect();\r\n
                    Common.NotificationCenter.trigger("api:disconnect");\r\n
                    setTimeout(_.bind(function () {\r\n
                        Common.UI.alert({\r\n
                            closable: false,\r\n
                            title: this.notcriticalErrorTitle,\r\n
                            msg: this.textUserLimit,\r\n
                            iconCls: "warn",\r\n
                            buttons: ["ok"]\r\n
                        });\r\n
                    },\r\n
                    this), 100);\r\n
                    return;\r\n
                }\r\n
            }\r\n
            var usersStore = this.getApplication().getCollection("Common.Collections.Users");\r\n
            if (usersStore) {\r\n
                var arrUsers = [],\r\n
                name,\r\n
                user;\r\n
                for (name in users) {\r\n
                    if (undefined !== name) {\r\n
                        user = users[name];\r\n
                        if (user) {\r\n
                            arrUsers.push(new Common.Models.User({\r\n
                                id: user.asc_getId(),\r\n
                                username: user.asc_getUserName(),\r\n
                                online: true,\r\n
                                color: user.asc_getColor()\r\n
                            }));\r\n
                        }\r\n
                    }\r\n
                }\r\n
                usersStore[usersStore.size() > 0 ? "add" : "reset"](arrUsers);\r\n
            }\r\n
        },\r\n
        onUserConnection: function (change) {\r\n
            var usersStore = this.getApplication().getCollection("Common.Collections.Users");\r\n
            if (usersStore) {\r\n
                var user = usersStore.findUser(change.asc_getId());\r\n
                if (!user) {\r\n
                    usersStore.add(new Common.Models.User({\r\n
                        id: change.asc_getId(),\r\n
                        username: change.asc_getUserName(),\r\n
                        online: change.asc_getState(),\r\n
                        color: change.asc_getColor()\r\n
                    }));\r\n
                } else {\r\n
                    user.set({\r\n
                        online: change.asc_getState()\r\n
                    });\r\n
                }\r\n
            }\r\n
        },\r\n
        onReceiveMessage: function (messages) {\r\n
            var msgStore = this.getApplication().getCollection("Common.Collections.ChatMessages");\r\n
            if (msgStore) {\r\n
                var array = [];\r\n
                messages.forEach(function (msg) {\r\n
                    array.push(new Common.Models.ChatMessage({\r\n
                        userid: msg.user,\r\n
                        message: msg.message,\r\n
                        username: msg.username\r\n
                    }));\r\n
                });\r\n
                msgStore[msgStore.size() > 0 ? "add" : "reset"](array);\r\n
            }\r\n
        },\r\n
        onSendMessage: function (panel, text) {\r\n
            if (text.length > 0) {\r\n
                var splitString = function (string, chunkSize) {\r\n
                    var chunks = [];\r\n
                    while (string) {\r\n
                        if (string.length < chunkSize) {\r\n
                            chunks.push(string);\r\n
                            break;\r\n
                        } else {\r\n
                            chunks.push(string.substr(0, chunkSize));\r\n
                            string = string.substr(chunkSize);\r\n
                        }\r\n
                    }\r\n
                    return chunks;\r\n
                };\r\n
                var me = this;\r\n
                splitString(text, 2048).forEach(function (message) {\r\n
                    me.api.asc_coAuthoringChatSendMessage(message);\r\n
                });\r\n
            }\r\n
        },\r\n
        notcriticalErrorTitle: "Warning",\r\n
        textUserLimit: \'You are using ONLYOFFICE Editors free version.<br>Only two users can co-edit the document simultaneously.<br>Want more? Consider buying ONLYOFFICE Editors Pro version.<br><a href="http://www.onlyoffice.com" target="_blank">Read more</a>\'\r\n
    },\r\n
    Common.Controllers.Chat || {}));\r\n
});\n
/*\r\n
 * (c) Copyright Ascensio System SIA 2010-2015\r\n
 *\r\n
 * This program is a free software product. You can redistribute it and/or \r\n
 * modify it under the terms of the GNU Affero General Public License (AGPL) \r\n
 * version 3 as published by the Free Software Foundation. In accordance with \r\n
 * Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect \r\n
 * that Ascensio System SIA expressly excludes the warranty of non-infringement\r\n
 * of any third-party rights.\r\n
 *\r\n
 * This program is distributed WITHOUT ANY WARRANTY; without even the implied \r\n
 * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR  PURPOSE. For \r\n
 * details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\r\n
 *\r\n
 * You can contact Ascensio System SIA at Lubanas st. 125a-25, Riga, Latvia,\r\n
 * EU, LV-1021.\r\n
 *\r\n
 * The  interactive user interfaces in modified source and object code versions\r\n
 * of the Program must display Appropriate Legal Notices, as required under \r\n
 * Section 5 of the GNU AGPL version 3.\r\n
 *\r\n
 * Pursuant to Section 7(b) of the License you must retain the original Product\r\n
 * logo when distributing the program. Pursuant to Section 7(e) we decline to\r\n
 * grant you any rights under trademark law for use of our trademarks.\r\n
 *\r\n
 * All the Product\'s GUI elements, including illustrations and icon sets, as\r\n
 * well as technical writing content are licensed under the terms of the\r\n
 * Creative Commons Attribution-ShareAlike 4.0 International. See the License\r\n
 * terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\r\n
 *\r\n
 */\r\n
 "use strict";\r\n
require.config({\r\n
    baseUrl: "../../",\r\n
    waitSeconds: 360,\r\n
    paths: {\r\n
        jquery: "../vendor/jquery/jquery",\r\n
        underscore: "../vendor/underscore/underscore",\r\n
        backbone: "../vendor/backbone/backbone",\r\n
        bootstrap: "../vendor/bootstrap/dist/js/bootstrap",\r\n
        text: "../vendor/requirejs-text/text",\r\n
        perfectscrollbar: "common/main/lib/mods/perfect-scrollbar",\r\n
        jmousewheel: "../vendor/perfect-scrollbar/src/jquery.mousewheel",\r\n
        xregexp: "../vendor/xregexp/xregexp-all-min",\r\n
        sockjs: "../vendor/sockjs/sockjs.min",\r\n
        allfonts: "../sdk/Common/AllFonts",\r\n
        sdk: "../sdk/Excel/sdk-all",\r\n
        api: "api/documents/api",\r\n
        core: "common/main/lib/core/application",\r\n
        notification: "common/main/lib/core/NotificationCenter",\r\n
        keymaster: "common/main/lib/core/keymaster",\r\n
        tip: "common/main/lib/util/Tip",\r\n
        analytics: "common/Analytics",\r\n
        gateway: "common/Gateway",\r\n
        locale: "common/locale",\r\n
        irregularstack: "common/IrregularStack"\r\n
    },\r\n
    shim: {\r\n
        underscore: {\r\n
            exports: "_"\r\n
        },\r\n
        backbone: {\r\n
            deps: ["underscore", "jquery"],\r\n
            exports: "Backbone"\r\n
        },\r\n
        bootstrap: {\r\n
            deps: ["jquery"]\r\n
        },\r\n
        perfectscrollbar: {\r\n
            deps: ["jmousewheel"]\r\n
        },\r\n
        notification: {\r\n
            deps: ["backbone"]\r\n
        },\r\n
        core: {\r\n
            deps: ["backbone", "notification", "irregularstack"]\r\n
        },\r\n
        sdk: {\r\n
            deps: ["jquery", "underscore", "allfonts", "xregexp", "sockjs"]\r\n
        },\r\n
        gateway: {\r\n
            deps: ["jquery"]\r\n
        },\r\n
        analytics: {\r\n
            deps: ["jquery"]\r\n
        }\r\n
    }\r\n
});\r\n
require(["backbone", "bootstrap", "core", "sdk", "api", "analytics", "gateway", "locale"], function (Backbone, Bootstrap, Core) {\r\n
    Backbone.history.start();\r\n
    var app = new Backbone.Application({\r\n
        nameSpace: "SSE",\r\n
        autoCreate: false,\r\n
        controllers: ["Viewport", "DocumentHolder", "CellEditor", "FormulaDialog", "Print", "Toolbar", "Statusbar", "RightMenu", "LeftMenu", "Main", "Common.Controllers.Fonts", "Common.Controllers.Chat", "Common.Controllers.Comments"]\r\n
    });\r\n
    Common.Locale.apply();\r\n
    require(["spreadsheeteditor/main/app/controller/Viewport", "spreadsheeteditor/main/app/controller/DocumentHolder", "spreadsheeteditor/main/app/controller/CellEditor", "spreadsheeteditor/main/app/controller/Toolbar", "spreadsheeteditor/main/app/controller/Statusbar", "spreadsheeteditor/main/app/controller/RightMenu", "spreadsheeteditor/main/app/controller/LeftMenu", "spreadsheeteditor/main/app/controller/Main", "spreadsheeteditor/main/app/controller/Print", "spreadsheeteditor/main/app/view/ParagraphSettings", "spreadsheeteditor/main/app/view/ImageSettings", "spreadsheeteditor/main/app/view/ChartSettings", "spreadsheeteditor/main/app/view/ShapeSettings", "common/main/lib/util/utils", "common/main/lib/controller/Fonts", "common/main/lib/controller/Comments", "common/main/lib/controller/Chat"], function () {\r\n
        app.start();\r\n
    });\r\n
});\n
define("../apps/spreadsheeteditor/main/app.js", function(){});\n
\n


]]></string> </value>
        </item>
        <item>
            <key> <string>next</string> </key>
            <value>
              <none/>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
</ZopeData>
