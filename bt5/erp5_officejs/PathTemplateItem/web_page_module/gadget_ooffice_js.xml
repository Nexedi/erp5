<?xml version="1.0"?>
<ZopeData>
  <record id="1" aka="AAAAAAAAAAE=">
    <pickle>
      <global name="Web Script" module="erp5.portal_type"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>_Access_contents_information_Permission</string> </key>
            <value>
              <tuple>
                <string>Anonymous</string>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Associate</string>
                <string>Auditor</string>
                <string>Manager</string>
                <string>Owner</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_Add_portal_content_Permission</string> </key>
            <value>
              <tuple>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_Change_local_roles_Permission</string> </key>
            <value>
              <tuple>
                <string>Assignor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_Modify_portal_content_Permission</string> </key>
            <value>
              <tuple>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Manager</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>_View_Permission</string> </key>
            <value>
              <tuple>
                <string>Anonymous</string>
                <string>Assignee</string>
                <string>Assignor</string>
                <string>Associate</string>
                <string>Auditor</string>
                <string>Manager</string>
                <string>Owner</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>categories</string> </key>
            <value>
              <tuple>
                <string>contributor/person_module/1</string>
              </tuple>
            </value>
        </item>
        <item>
            <key> <string>content_md5</string> </key>
            <value>
              <none/>
            </value>
        </item>
        <item>
            <key> <string>content_type</string> </key>
            <value> <string>text/html</string> </value>
        </item>
        <item>
            <key> <string>default_reference</string> </key>
            <value> <string>gadget_ooffice.js</string> </value>
        </item>
        <item>
            <key> <string>description</string> </key>
            <value>
              <none/>
            </value>
        </item>
        <item>
            <key> <string>id</string> </key>
            <value> <string>gadget_ooffice_js</string> </value>
        </item>
        <item>
            <key> <string>language</string> </key>
            <value>
              <none/>
            </value>
        </item>
        <item>
            <key> <string>portal_type</string> </key>
            <value> <string>Web Script</string> </value>
        </item>
        <item>
            <key> <string>short_title</string> </key>
            <value>
              <none/>
            </value>
        </item>
        <item>
            <key> <string>text_content</string> </key>
            <value> <string>/*global window, rJS, RSVP, DocsAPI, console, document*/\n
/*jslint nomen: true, maxlen:80, indent:2*/\n
(function (rJS, RSVP, DocsAPI) {\n
  "use strict";\n
  // Document Editor event handlers\n
  //function onRequestHistory() {\n
  //  docEditor.refreshHistory({\n
  //    \'currentVersion\': 3,\n
  //    \'history\': [\n
  //      {\n
  //        \'user\': {\n
  //          id: \'8952d4ee-e8a5-42bf-86f0-6cd77801ec15\',\n
  //          name: \'РўР°С‚СЊСЏРЅР° Р©РµСЂР±Р°РєРѕРІР°\'\n
  //        },\n
  //        \'changes\': null,\n
  //        \'created\': \'1/18/2015 6:38 PM\',\n
  //        \'version\': 1,\n
  //        \'version_group\': 1,\n
  //        \'key\': \'wyX9AwRq_677SWKjhfk=\'\n
  //      },\n
  //      {\n
  //        \'user\': {\n
  //          id: \'8952d4ee-e8a5-42bf-86f0-6cd77801ec15\',\n
  //          name: \'РўР°С‚СЊСЏРЅР° Р©РµСЂР±Р°РєРѕРІР°\'\n
  //        },\n
  //        \'changes\': [\n
  //          {\n
  //            \'user\': {\n
  //              id: \'8952d4ee-e8a5-42bf-86f0-6cd77801ec15\',\n
  //              name: \'РўР°С‚СЊСЏРЅР° Р©РµСЂР±Р°РєРѕРІР°\'\n
  //            },\n
  //            \'created\': \'1/19/2015 6:30 PM\'\n
  //          },\n
  //          {\n
  //            \'user\': {\n
  //              \'userid\': \'8952d4ee-e8a5-42bf-11f0-6cd77801ec15\',\n
  //              \'username\': \'РђР»РµРєСЃР°РЅРґСЂ РўСЂРѕС„РёРјРѕРІ\'\n
  //            },\n
  //            \'created\': \'1/19/2015 6:32 PM\'\n
  //          },\n
  //          {\n
  //            \'user\': {\n
  //              id: \'8952d4ee-e8a5-42bf-86f0-6cd77801ec15\',\n
  //              name: \'РўР°С‚СЊСЏРЅР° Р©РµСЂР±Р°РєРѕРІР°\'\n
  //            },\n
  //            \'created\': \'1/19/2015 6:38 PM\'\n
  //          }\n
  //        ],\n
  //        \'created\': \'2/19/2015 6:38 PM\',\n
  //        \'version\': 2,\n
  //        \'version_group\': 1,\n
  //        \'key\': \'wyX9AwRq_677SWKjhfk=\'\n
  //      },\n
  //      {\n
  //        \'user\': {\n
  //          id: \'895255ee-e8a5-42bf-86f0-6cd77801ec15\',\n
  //          name: \'Me\'\n
  //        },\n
  //        \'changes\': null,\n
  //        \'created\': \'2/21/2015 6:38 PM\',\n
  //        \'version\': 3,\n
  //        \'version_group\': 2,\n
  //        \'key\': \'wyX9AwRq_677SWKjhfk=\'\n
  //      },\n
  //      {\n
  //        \'user\': {\n
  //          id: \'8952d4ee-e8a5-42bf-11f0-6cd77801ec15\',\n
  //          name: \'РђР»РµРєСЃР°РЅРґСЂ РўСЂРѕС„РёРјРѕРІ\'\n
  //        },\n
  //        \'changes\': null,\n
  //        \'created\': \'2/22/2015 6:37 PM\',\n
  //        \'version\': 4,\n
  //        \'version_group\': 3,\n
  //        \'key\': \'wyX9AwRq_677SWKjhfk=\'\n
  //      },\n
  //      {\n
  //        \'user\': {\n
  //          id: \'8952d4ee-e8a5-42bf-11f0-6cd33801ec15\',\n
  //          name: \'Р›РµРѕРЅРёРґ РћСЂР»РѕРІ\'\n
  //        },\n
  //        \'changes\': null,\n
  //        \'created\': \'2/24/2015 6:29 PM\',\n
  //        \'version\': 5,\n
  //        \'version_group\': 3,\n
  //        \'key\': \'wyX9AwRq_677SWKjhfk=\'\n
  //      }]\n
  //  });\n
  //}\n
  //\n
  //function onRequestHistoryData(revision) {\n
  //  docEditor.setHistoryData(\n
  //      {\n
  //        \'version\': revision.data,\n
  //        \'url\': \'http://isa2\',\n
  //        \'urlDiff\': \'http://isa2\'\n
  //      }\n
  //  );\n
  //}\n
  //\n
  //function onRequestHistoryClose() {\n
  //  // reload page\n
  //}\n
  //\n
  function onDocEditorReady(event) {\n
    if (event.target) {\n
      console.log(\'Ready! Editor: \', event.target);\n
    }\n
  }\n
\n
  function onError(event) {\n
    console.log(event.data);\n
    // critical error happened\n
    // examine event.data.errorCode and event.data.errorDescription for details\n
  }\n
\n
  rJS(window)\n
    .ready(function (g) {\n
      g.props = {save_defer: null};\n
    })\n
    .ready(function (g) {\n
      return g.getElement()\n
        .push(function (element) {\n
          g.props.cfg = {\n
            mode: \'edit\',\n
            lang: \'en\',\n
            canAutosave: false,\n
            canCoAuthoring: false,\n
            canBackToFolder: true,\n
            canCreateNew: true,\n
            createUrl: \'http://www.example.com/create\',\n
            user: {\n
              id: \'uid-901\',\n
              name: \'Hamish Mitchell\'\n
            },\n
            recent: [\n
              {\n
                title: \'Memory.docx\',\n
                url: \'http://onlyoffice.com\',\n
                folder: \'Document Editor\'\n
              },\n
              {\n
                title: \'Description.doc\',\n
                url: \'http://onlyoffice.com\',\n
                folder: \'Document Editor\'\n
              },\n
              {\n
                title: \'DocEditor_right.xsl\',\n
                url: \'http://onlyoffice.com\',\n
                folder: \'Spreadsheet Editor\'\n
              },\n
              {\n
                title: \'api.rtf\',\n
                url: \'http://onlyoffice.com\',\n
                folder: \'Unnamed folder\'\n
              }\n
            ],\n
            templates: [\n
              {\n
                name: \'Contracts\',\n
                icon: \'../../api/documents/resources/templates/contracts.png\'\n
              },\n
              {\n
                name: \'Letter\',\n
                icon: \'../../api/documents/resources/templates/letter.png\'\n
              },\n
              {\n
                name: \'List\',\n
                icon: \'../../api/documents/resources/templates/list.png\'\n
              },\n
              {\n
                name: \'Plan\',\n
                icon: \'../../api/documents/resources/templates/plan.png\'\n
              }\n
            ],\n
            embedded: {\n
              embedUrl: \'http://onlyoffice.com/embed\',\n
              fullscreenUrl: \'http://onlyoffice.com/fullscreen\',\n
              saveUrl: \'http://onlyoffice.com/download\',\n
              shareUrl: \'http://tl.com/72b4la97\',\n
              toolbarDocked: \'top\'\n
            },\n
            customization: {\n
              //logoUrl: \'header logo url\', // default size 88 x 30\n
              //logoUrlEmbedded: \'header logo url\', // default size 88 x 30\n
              //backgroundColor: \'#ffffff\',\n
              //textColor: \'#ff0000\',\n
              //customer: {\n
              //    name: \'SuperPuper\',\n
              //    address: \'New-York, 125f-25\',\n
              //    mail: \'support@gmail.com\',\n
              //    www: \'www.superpuper.com\',\n
              //    info: \'Some info\',\n
              // logo:\'https://img.imgsmail.ru/r/default/portal/0.1.29/logo.png\'\n
              //},\n
              //goback: {text: \'Go To London\'}\n
              about: true,\n
              feedback: true\n
            }\n
          };\n
          g.props.element = element;\n
        });\n
    })\n
    .declareAcquiredMethod("triggerSubmit", "triggerSubmit")\n
    .declareAcquiredMethod("triggerMaximize", "triggerMaximize")\n
    .declareAcquiredMethod("setFillStyle", "setFillStyle")\n
    .declareMethod(\'render\', function (options) {\n
      var placeholder = \'oospreadsheet_gadget\',\n
        g = this,\n
        documentType,\n
        magic_to_format_map = {\n
          \'DOCY;\' : \'text\',\n
          \'XLSY;\' : \'spreadsheet\',\n
          \'PPTY;\' : \'presentation\'\n
        };\n
      if (options.value === undefined) {\n
        options.value = \'\';\n
        documentType = options.portal_type;\n
      } else {\n
        documentType = magic_to_format_map[options.value.substring(0, 5)];\n
        if (documentType === undefined) {\n
          g.props\n
            .element\n
            .getElementsByClassName(placeholder)[0]\n
            .textContent = options.value;\n
          return {};\n
        }\n
      }\n
      return g.setFillStyle()\n
        .push(function (size) {\n
          g.props.docEditor = new DocsAPI.DocEditor(placeholder, {\n
            //type: urlParams[\'type\'],\n
            width: size.width,\n
            height: size.height,\n
            documentType: documentType,\n
            document: {\n
              //key: undefined,\n
              //url: undefined,\n
              title: options.title,\n
              //fileType: undefined,\n
              //vkey: undefined,\n
              data: options.value || "",\n
              permissions: {\n
                edit: true,\n
                download: true,\n
                reader: true\n
              }\n
            },\n
            editorConfig: g.props.cfg,\n
            events: {\n
              \'onReady\': onDocEditorReady,\n
              \'onBack\': function (event) {\n
                g.triggerMaximize()\n
                  .push(function (size) {\n
                    var iframe = g.props.element.querySelector(\'iframe\');\n
                    iframe.style.height = size.height;\n
                    iframe.style.width = size.width;\n
\n
                  });\n
              },\n
              // \'onDocumentStateChange\': function (event) {\n
              //   if (!event.data) {\n
              //     save_button.click();\n
              //   }\n
              // },\n
              \'onRequestEditRights\': function (event) {\n
                // occurs whenever the user tryes to enter edit mode\n
                g.props.docEditor.applyEditRights(true,\n
                  "Someone is editing this document right now." +\n
                  " Please try again later.");\n
              },\n
              //\'onRequestHistory\': onRequestHistory,\n
              //\'onRequestHistoryData\': onRequestHistoryData,\n
              //\'onRequestHistoryClose\': onRequestHistoryClose,\n
              \'onSave\': function (event) {\n
                var result = {};\n
                if (g.props.save_defer === null) {\n
                  g.triggerSubmit();\n
                } else {\n
                  result[g.props.key] = event.data;\n
                  g.props.save_defer.resolve(result);\n
                  g.props.save_defer = null;\n
                }\n
                return true;\n
                // if you want to async save process return false\n
                // and call api.processSaveResult when ready\n
                // g.props.docEditor.processSaveResult();\n
              },\n
              \'onError\': onError\n
            }\n
          });\n
          g.props.key = options.key || "text_content";\n
          g.props.value = options.value;\n
          // g.fullscreen();\n
          return {};\n
        });\n
    })\n
\n
    .declareMethod(\'getContent\', function () {\n
      var g = this;\n
      g.props.save_defer = RSVP.defer();\n
      g.props.docEditor.save();\n
      return g.props.save_defer.promise;\n
    });\n
\n
}(rJS, RSVP, DocsAPI));</string> </value>
        </item>
        <item>
            <key> <string>version</string> </key>
            <value>
              <none/>
            </value>
        </item>
        <item>
            <key> <string>workflow_history</string> </key>
            <value>
              <persistent> <string encoding="base64">AAAAAAAAAAI=</string> </persistent>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="2" aka="AAAAAAAAAAI=">
    <pickle>
      <global name="PersistentMapping" module="Persistence.mapping"/>
    </pickle>
    <pickle>
      <dictionary>
        <item>
            <key> <string>data</string> </key>
            <value>
              <dictionary>
                <item>
                    <key> <string>document_publication_workflow</string> </key>
                    <value>
                      <persistent> <string encoding="base64">AAAAAAAAAAM=</string> </persistent>
                    </value>
                </item>
                <item>
                    <key> <string>edit_workflow</string> </key>
                    <value>
                      <persistent> <string encoding="base64">AAAAAAAAAAQ=</string> </persistent>
                    </value>
                </item>
              </dictionary>
            </value>
        </item>
      </dictionary>
    </pickle>
  </record>
  <record id="3" aka="AAAAAAAAAAM=">
    <pickle>
      <global name="WorkflowHistoryList" module="Products.ERP5Type.patches.WorkflowTool"/>
    </pickle>
    <pickle>
      <tuple>
        <none/>
        <list>
          <dictionary>
            <item>
                <key> <string>action</string> </key>
                <value> <string>publish_alive</string> </value>
            </item>
            <item>
                <key> <string>actor</string> </key>
                <value> <string>cedric.le.ninivin</string> </value>
            </item>
            <item>
                <key> <string>comment</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>error_message</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>time</string> </key>
                <value>
                  <object>
                    <klass>
                      <global name="DateTime" module="DateTime.DateTime"/>
                    </klass>
                    <tuple>
                      <none/>
                    </tuple>
                    <state>
                      <tuple>
                        <float>1448024013.93</float>
                        <string>UTC</string>
                      </tuple>
                    </state>
                  </object>
                </value>
            </item>
            <item>
                <key> <string>validation_state</string> </key>
                <value> <string>published_alive</string> </value>
            </item>
          </dictionary>
        </list>
      </tuple>
    </pickle>
  </record>
  <record id="4" aka="AAAAAAAAAAQ=">
    <pickle>
      <global name="WorkflowHistoryList" module="Products.ERP5Type.patches.WorkflowTool"/>
    </pickle>
    <pickle>
      <tuple>
        <none/>
        <list>
          <dictionary>
            <item>
                <key> <string>action</string> </key>
                <value> <string>edit</string> </value>
            </item>
            <item>
                <key> <string>actor</string> </key>
                <value> <string>zope</string> </value>
            </item>
            <item>
                <key> <string>comment</string> </key>
                <value>
                  <none/>
                </value>
            </item>
            <item>
                <key> <string>error_message</string> </key>
                <value> <string></string> </value>
            </item>
            <item>
                <key> <string>serial</string> </key>
                <value> <string>948.52265.56945.58436</string> </value>
            </item>
            <item>
                <key> <string>state</string> </key>
                <value> <string>current</string> </value>
            </item>
            <item>
                <key> <string>time</string> </key>
                <value>
                  <object>
                    <klass>
                      <global name="DateTime" module="DateTime.DateTime"/>
                    </klass>
                    <tuple>
                      <none/>
                    </tuple>
                    <state>
                      <tuple>
                        <float>1454097524.73</float>
                        <string>UTC</string>
                      </tuple>
                    </state>
                  </object>
                </value>
            </item>
          </dictionary>
        </list>
      </tuple>
    </pickle>
  </record>
</ZopeData>
