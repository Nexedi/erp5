<section>
<!--<test>
  <table style="display: none;" class="test">
    <tbody>
      <tr>
        <td colspan="3">&lt;span metal:use-macro="container/Zuite_viewTestMacroLibrary/macros/init_test_environment"&gt;init&lt;/span&gt;</td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/Zuite_setUpPersonTest</td>
        <td></td>
      </tr>
      <tr>
        <td>verifyTextPresent</td>
        <td>Init Ok</td>
        <td></td>
      </tr>
      <tr class="" style="opacity: 1;">
        <td colspan="3">&lt;span metal:use-macro="container/Zuite_viewTestMacroLibrary/macros/wait_for_activities"&gt; Wait for activities &lt;/span&gt;</td>
      </tr>
      <tr class="" style="opacity: 1;">
        <td colspan="3">&lt;span metal:use-macro="container/Zuite_viewTestMacroLibrary/macros/login_as_functional_test_user"&gt;Login As Functional Test User&lt;/span&gt;</td>
      </tr>
    </tbody>
  </table>
</test>-->
<h1>Agenda</h1>

<ul>
	<li>Configure Mailhost</li>
</ul>

<details open="">
<p>&nbsp;</p>

<p>This tutorial teaches how to configure wendelin to allow user registration.</p>

<p><strong>Note</strong>: This feature is enabled only if wendelin configuration the&nbsp;<strong>Setup default data lake security model&nbsp;</strong>was checked.&nbsp;</p>

<p>&nbsp;</p>
</details>
</section>

<section class="screenshot">
<h1>Configure Mailhost</h1>
<img alt="" src="wendelin-configureMailhost.screenshot?format=" style="font-size: 13px;" title="" type="image/svg+xml" />
<details open="">
<p>Open <strong>https://YOUR_INSTANCE_URL/erp5/MailHost/manage_main</strong> to access the mail host configuration in the Zope interface (Wendelin is built on top of Zope).</p>

<p>Add a SMTP mailhost and <strong>login/password</strong> for the alias under which an email should be forwarded/sent.</p>

<p>Make sure the <strong>Port</strong> is also correctly set to your email provider&#39;s correct SMTP port.</p>

<p>Click <strong>Save</strong>&nbsp;<strong>Changes</strong> when done to continue.</p>
</details>
</section>

<section class="screenshot">
<h1>Register</h1>
<img alt="" src="wendelin-register.user.screenshot?format=" style="font-size: 13px;" title="" type="image/svg+xml" />
<details open="">
<p>Once the mailhost is configured users can register.</p>

<p>Open <strong>https://YOUR_INSTANCE_URL/erp5/web_site_module/default_wendelin_data_lake/</strong> and on left side panel click on <strong>Register.</strong></p>

<p><b>Note:&nbsp;</b>Pay attention on <b>/&nbsp;</b>(slash) at the end of the url, it is mandatory.&nbsp;</p>

<p><b>Note: </b>Registration works only if user is not logged in. Thus,&nbsp;before registering a new user make sure that you are not logged in with any user.&nbsp;</p>

<p>After filling the form and clicking on Register you will get an email to the specified email address with further instructions.&nbsp;</p>
</details>
<test>
  <table style="display: none;" class="test">
    <tbody>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/logout</td>
        <td></td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/erp5/web_site_module/default_wendelin_data_lake/#/?page=register</td>
        <td></td>
      </tr>
      <tr>
        <td>waitForElementPresent</td>
        <td>//input[@name="your_first_name"]</td>
        <td></td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="your_first_name"]</td>
        <td>TestFirstName</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="your_last_name"]</td>
        <td>TestLastName</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="your_email"]</td>
        <td>test@example.com</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="your_reference"]</td>
        <td>TestReference</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="your_password"]</td>
        <td>TestPassword</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="your_confirm_password"]</td>
        <td>TestPassword</td>
      </tr>
      <tr>
        <td>click</td>
        <td>//input[@type="submit" and @value="Register"]</td>
        <td></td>
      </tr>
      <tr>
        <td>pause</td>
        <td>10000</td>
        <td></td>
      </tr>
      <tr>
        <td>assertTextPresent</td>
        <td>Registration submitted.</td>
        <td></td>
      </tr>

      <tr>
        <td>openAndWait</td>
        <td>${base_url}/login_form</td>
        <td></td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="__ac_name"]</td>
        <td>functional_test_username</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="__ac_password"]</td>
        <td>secret</td>
      </tr>
      <tr>
        <td>clickAndWait</td>
        <td>//input[@name="logged_in:method"]</td>
        <td></td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/erp5/view</td>
        <td></td>
      </tr>

      <tr>
        <td>pause</td>
        <td>20000</td>
        <td></td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/erp5/portal_activities/</td>
        <td></td>
      </tr>
      <tr>
        <td>click</td>
        <td>//table//tbody//tr[1]//td[2]//a</td>
        <td></td>
      </tr>
      <tr>
        <td>pause</td>
        <td>2000</td>
        <td></td>
      </tr>
      
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/erp5/event_module/</td>
        <td></td>
      </tr>
      <tr>
        <td>click</td>
        <td>//th[@class="listbox-table-header-cell"][4]//button[@type="submit" and @title="Ascending Display"]</td>
        <td></td>
      </tr>
      <tr>
        <td>click</td>
        <td>//td[@class="listbox-table-data-cell"]//a[contains(@href,'/event_module/')]</td>
        <td></td>
      </tr>
      <tr>
        <td>pause</td>
        <td>10000</td>
        <td></td>
      </tr>

      <tr>
        <td>store</td>
        <td>javascript{
        link = String(selenium.browserbot.getCurrentWindow().document.getElementsByTagName("pre")[0].innerText).match("(>https.*<)")[0];
        link.substring(1, link.length-1);
        }</td>
        <td>welcomelink</td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${welcomelink}</td>
        <td></td>
      </tr>
      <tr>
        <td>assertTextPresent</td>
        <td>activated</td>
        <td></td>
      </tr>

      <tr>
        <td>pause</td>
        <td>40000</td>
        <td></td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/erp5/portal_activities/</td>
        <td></td>
      </tr>
      <tr>
        <td>click</td>
        <td>//table//tbody//tr[1]//td[2]//a</td>
        <td></td>
      </tr>
      <tr>
        <td>pause</td>
        <td>2000</td>
        <td></td>
      </tr>

      <tr>
        <td>openAndWait</td>
        <td>${base_url}/logout</td>
        <td></td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/login_form</td>
        <td></td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="__ac_name"]</td>
        <td>TestReference</td>
      </tr>
      <tr>
        <td>type</td>
        <td>//input[@name="__ac_password"]</td>
        <td>TestPassword</td>
      </tr>
      <tr>
        <td>clickAndWait</td>
        <td>//input[@name="logged_in:method"]</td>
        <td></td>
      </tr>
      <tr>
        <td>pause</td>
        <td>3000</td>
        <td></td>
      </tr>
      <tr>
        <td>openAndWait</td>
        <td>${base_url}/erp5/view</td>
        <td></td>
      </tr>
      <tr>
        <td>assertTextPresent</td>
        <td>TestReference</td>
        <td></td>
      </tr>
    </tbody>
  </table>
</test>
</section>