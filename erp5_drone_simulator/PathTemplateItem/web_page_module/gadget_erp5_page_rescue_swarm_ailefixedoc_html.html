<!doctype html>
<html>

  <head>
      <link rel="stylesheet" type="text/css" href="../css/documentation.css">
      <script src="gadget_erp5_page_rescue_swarm_documentation.js"></script>
      <title>Drone A Aile Fixe API Documentation</title>
  </head>

  <body>

    <div class="documentation">

      <h1>Drone a Aile Fixe API</h1>

      <h3>API functions</h3>

      <!-- Start -->
      <h4 class="item-name" id="start"><span>onStart</span><span>: void</span></h4>
      <p class="item-descr">Function called one time on drone start.</p>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">me.onStart = function() {<br>
        &nbsp;&nbsp;//one time execution code<br>
        }
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- Update -->
      <h4 class="item-name" id="update"><span>onUpdate</span><span>: void</span></h4>
      <p class="item-descr">Function called on game update, 60 times / second. <br></p>
      <div>
        <h5 class="item-param-1">Param</h5>
        <h5 class="item-param-2">Description</h5>
      </div>
      <div>
        <p class="item-param-1">timestamp: Integer</p>
        <p class="item-param-2">timestamp in milliseconds from UNIX epoch</p>
      </div>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">me.onUpdate = function(timestamp) {<br>
        &nbsp;&nbsp;//code executed 60 times per second<br>
        }
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- GetMsg -->
      <h4 class="item-name" id="getMsg"><span>onGetMsg</span><span>: void</span></h4>
      <p class="item-descr">Function called when drone receives a message.</p>
      <div>
        <h5 class="item-param-1">Param</h5>
        <h5 class="item-param-2">Description</h5>
      </div>
      <div>
        <p class="item-param-1">msg: String</p>
        <p class="item-param-2">Content of the message</p>
      </div>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">me.onGetMsg = function (msg) {<br>
        &nbsp;&nbsp; //process msg
        <br> }
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- sendMsg -->
      <h4 class="item-name" id="sendMsg"><span>sendMsg</span><span>: void</span></h4>
      <p class="item-descr">Send a message to another drone (or to all team drones).<br></p>
      <div>
        <h5 class="item-param-1">Param</h5>
        <h5 class="item-param-2">Description</h5>
      </div>
      <div>
        <p class="item-param-1">msg: String</p>
        <p class="item-param-2">The message to send.</p>
      </div>
      <div>
        <p class="item-param-1">id ?: Integer</p>
        <p class="item-param-2">ID of the recipient. Leave empty to send to all team drones.</p>
      </div>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        me.sendMsg("My broadcast message");<br>
        me.sendMsg("To my friend 0", 0);
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- getCurrentPosition -->
      <h4 class="item-name" id="getCurrentPosition"><span>getCurrentPosition</span><span>: dictionary</span></h4>
      <p class="item-descr">
        Get drone current position geo-coordinates.<br>
        {<br>
        &nbsp;&nbsp;x: number, //latitude<br>
        &nbsp;&nbsp;y: number, //longitude<br>
        &nbsp;&nbsp;z: number&nbsp;&nbsp;//meters<br>
        }<br>
      </p>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        var current_position = me.getCurrentPosition();<br>
        console.log(current_position);<br>
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- setTargetCoordinates -->
      <h4 class="item-name" id="setTargetCoordinates"><span>setTargetCoordinates</span><span>: dictionary</span></h4>
      <p class="item-descr">
        Set a target point expressed in geo coordinates. The drone will move straight to this point.
      </p>
      <div>
        <h5 class="item-param-1">Param</h5>
        <h5 class="item-param-2">Description</h5>
      </div>
      <div>
        <p class="item-param-1">X: Integer</p>
        <p class="item-param-2">X value - latitude.</p>
      </div>
      <div>
        <p class="item-param-1">Y: Integer</p>
        <p class="item-param-2">Y value - longitude.</p>
      </div>
      <div>
        <p class="item-param-1">Z: Integer</p>
        <p class="item-param-2">Z value - altitude in meters.</p>
      </div>
      <div>
        <p class="item-param-1">loiter_ratio ?: Integer</p>
        <p class="item-param-2">Loiter ratio in meters. If less than 30, loiter is skipped</p>
      </div>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        me.setTargetCoordinates(lat, lon, altitude);<br>
        me.setTargetCoordinates(lat, lon, altitude, 100);<br>
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- setAltitude -->
      <h4 class="item-name" id="setAltitude"><span>setAltitude</span><span>: void</span></h4>
      <p class="item-descr">Set the drone altitude in meters. The drone will move to reach the given value.</p>
      <p class="item-descr">Drone movement will be straight or loiter depending on skip_loiter parameter.</p>
      <div>
        <h5 class="item-param-1">Param</h5>
        <h5 class="item-param-2">Description</h5>
      </div>
      <div>
        <p class="item-param-1">altitude: Integer</p>
        <p class="item-param-2">Altitude value</p>
      </div>
      <div>
        <p class="item-param-1">skip_loiter ?: Boolean</p>
        <p class="item-param-2">By default the drone will loiter while changing the altitude. If this parameter is true, it will move straight to the given altitude.</p>
      </div>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">me.setAltitude(me.start_altitude, true) //or<br>
        me.setAltitude(100)<br>
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- loiter -->
      <h4 class="item-name" id="loiter"><span>loiter</span><span>: void</span></h4>
      <p class="item-descr">
        Set the drone to loiter mode, it will loiter around last target coordinates set, if the set loiter_ratio is greater than 30.
      </p>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        me.loiter();
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- doParachute -->
      <h4 class="item-name" id="doParachute"><span>doParachute</span><span>: void</span><b>- TODO!</b></h4>
      <p class="item-descr">
        Indicates the drone to delploy the parachute to finish the landing.
      </p>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        me.doParachute()<br>
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- landed -->
      <h4 class="item-name" id="landed"><span>landed</span><span>: Boolean</span><b>- TODO!</b></h4>
      <p class="item-descr">
        Indicates if the drone has landed (reached the floor altitude).
      </p>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        if (me.landed()) {<br>
        &nbsp;&nbsp;//do something<br>
        }<br>
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->

      <!-- exit -->
      <h4 class="item-name" id="exit"><span>exit</span><span>: Boolean</span><b>- TODO!</b></h4>
      <p class="item-descr">
        Finishes the drone flight.
      </p>
      <h5 class="item-param-1">Example</h5>
      <p class="item-example">
        me.exit()<br>
      </p>
      <div class="line"></div> <!-- ----------------------------------------------------------- -->
      
      
      <b>TODO: (), drone_dict property (leader, lat, lon, altitudeAbs) </b>
      
        <p class="item-example">
          * Leo Paul and you must have a beautiful web page on Nexedi ERP5 explaining the "drone a aile fixe" API
this document must list the functions, explain why they are needed
this document must list the parameters type and return type. And explain why such type has been decided
for now, we mostly followed the work previsouly done by Leo Paul I suppose
but before working with us, he was discussing a lot with Thomas and JP to decide what should be the API, type of coordinate, etc
so, I would like first to have a first version of this document explaining the current status, so that we could add Thomas in the loop after to decide what should be changed
maybe Leo Paul already has something like this, no idea
so, better wait for him to know where to start
        </p>
      
    </div>

  </body>
</html>